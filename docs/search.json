[
  {
    "objectID": "ggproto.html",
    "href": "ggproto.html",
    "title": "\n1 ggproto 对象",
    "section": "",
    "text": "Codelibrary(tidyverse)\n#&gt; Warning: package 'purrr' was built under R version 4.5.2\n#&gt; Warning: package 'stringr' was built under R version 4.5.2\n#&gt; Warning: package 'forcats' was built under R version 4.5.2\n#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.6\n#&gt; ✔ forcats   1.0.1     ✔ stringr   1.6.0\n#&gt; ✔ ggplot2   4.0.1     ✔ tibble    3.3.0\n#&gt; ✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n#&gt; ✔ purrr     1.2.0     \n#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#&gt; ✖ dplyr::filter() masks stats::filter()\n#&gt; ✖ dplyr::lag()    masks stats::lag()\n#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\np &lt;- ggplot(mpg, aes(displ, hwy, color = drv)) + \n  geom_point(position = \"jitter\") +\n  geom_smooth(method = \"lm\", formula = y ~ x) + \n  facet_wrap(vars(year)) + \n  ggtitle(\"A plot for expository purposes\")\np\n\n\n\n\n\n\n\n\nCodeggprint &lt;- function(x) {\n  data &lt;- ggplot_build(x)\n  gtable &lt;- ggplot_gtable(data)\n  grid::grid.newpage()\n  grid::grid.draw(gtable)\n  return(invisible(x))\n}\nggprint(p)\n\n\n\n\n\n\n\n\nCodep_built &lt;- ggplot_build(p)\n\np_built $data %&gt;% map(head) %&gt;% map(as_tibble)\n#&gt; [[1]]\n#&gt; # A tibble: 6 × 10\n#&gt;       x     y colour  PANEL group shape fill   size alpha stroke\n#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;fct&gt; &lt;int&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;dbl&gt; &lt;lgl&gt;  &lt;dbl&gt;\n#&gt; 1  1.81  28.7 #00BA38 1         2    19 NA      1.5 NA       0.5\n#&gt; 2  1.83  28.7 #00BA38 1         2    19 NA      1.5 NA       0.5\n#&gt; 3  2.79  26.2 #00BA38 1         2    19 NA      1.5 NA       0.5\n#&gt; 4  2.82  25.9 #00BA38 1         2    19 NA      1.5 NA       0.5\n#&gt; 5  1.82  25.6 #F8766D 1         1    19 NA      1.5 NA       0.5\n#&gt; 6  1.79  25.4 #F8766D 1         1    19 NA      1.5 NA       0.5\n#&gt; \n#&gt; [[2]]\n#&gt; # A tibble: 6 × 14\n#&gt;       x     y  ymin  ymax    se flipped_aes colour  PANEL group fill   linewidth\n#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;       &lt;chr&gt;   &lt;fct&gt; &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;\n#&gt; 1  1.8   24.3  23.1  25.6 0.625 FALSE       #F8766D 1         1 #9999…         1\n#&gt; 2  1.86  24.2  22.9  25.4 0.612 FALSE       #F8766D 1         1 #9999…         1\n#&gt; 3  1.92  24.0  22.8  25.2 0.598 FALSE       #F8766D 1         1 #9999…         1\n#&gt; 4  1.98  23.9  22.7  25.0 0.585 FALSE       #F8766D 1         1 #9999…         1\n#&gt; 5  2.04  23.7  22.6  24.9 0.572 FALSE       #F8766D 1         1 #9999…         1\n#&gt; 6  2.10  23.5  22.4  24.7 0.559 FALSE       #F8766D 1         1 #9999…         1\n#&gt; # ℹ 3 more variables: linetype &lt;int&gt;, weight &lt;dbl&gt;, alpha &lt;dbl&gt;\np_built $layout\n#&gt; &lt;ggproto object: Class Layout, gg&gt;\n#&gt;     coord: &lt;ggproto object: Class CoordCartesian, Coord, gg&gt;\n#&gt;         aspect: function\n#&gt;         backtransform_range: function\n#&gt;         clip: on\n#&gt;         default: TRUE\n#&gt;         distance: function\n#&gt;         draw_panel: function\n#&gt;         expand: TRUE\n#&gt;         is_free: function\n#&gt;         is_linear: function\n#&gt;         labels: function\n#&gt;         limits: list\n#&gt;         modify_scales: function\n#&gt;         range: function\n#&gt;         ratio: NULL\n#&gt;         render_axis_h: function\n#&gt;         render_axis_v: function\n#&gt;         render_bg: function\n#&gt;         render_fg: function\n#&gt;         reverse: none\n#&gt;         setup_data: function\n#&gt;         setup_layout: function\n#&gt;         setup_panel_guides: function\n#&gt;         setup_panel_params: function\n#&gt;         setup_params: function\n#&gt;         train_panel_guides: function\n#&gt;         transform: function\n#&gt;         super:  &lt;ggproto object: Class CoordCartesian, Coord, gg&gt;\n#&gt;     coord_params: list\n#&gt;     facet: &lt;ggproto object: Class FacetWrap, Facet, gg&gt;\n#&gt;         attach_axes: function\n#&gt;         attach_strips: function\n#&gt;         compute_layout: function\n#&gt;         draw_back: function\n#&gt;         draw_front: function\n#&gt;         draw_labels: function\n#&gt;         draw_panel_content: function\n#&gt;         draw_panels: function\n#&gt;         finish_data: function\n#&gt;         format_strip_labels: function\n#&gt;         init_gtable: function\n#&gt;         init_scales: function\n#&gt;         map_data: function\n#&gt;         params: list\n#&gt;         set_panel_size: function\n#&gt;         setup_data: function\n#&gt;         setup_panel_params: function\n#&gt;         setup_params: function\n#&gt;         shrink: TRUE\n#&gt;         train_scales: function\n#&gt;         vars: function\n#&gt;         super:  &lt;ggproto object: Class FacetWrap, Facet, gg&gt;\n#&gt;     facet_params: list\n#&gt;     finish_data: function\n#&gt;     get_scales: function\n#&gt;     layout: data.frame\n#&gt;     map_position: function\n#&gt;     panel_params: list\n#&gt;     panel_scales_x: list\n#&gt;     panel_scales_y: list\n#&gt;     render: function\n#&gt;     render_labels: function\n#&gt;     reset_scales: function\n#&gt;     resolve_label: function\n#&gt;     setup: function\n#&gt;     setup_panel_guides: function\n#&gt;     setup_panel_params: function\n#&gt;     train_position: function\n#&gt;     super:  &lt;ggproto object: Class Layout, gg&gt;\np_built $plot\n\n\n\n\n\n\n\n\nCodep_gtable &lt;- ggplot_gtable(p_built)\np_gtable\n#&gt; TableGrob (17 x 17) \"layout\": 25 grobs\n#&gt;     z         cells             name\n#&gt; 1   0 ( 1-17, 1-17)       background\n#&gt; 2   1 (10-10, 7- 7)        panel-1-1\n#&gt; 3   1 (10-10,11-11)        panel-2-1\n#&gt; 4   3 ( 8- 8, 7- 7)       axis-t-1-1\n#&gt; 5   3 ( 8- 8,11-11)       axis-t-2-1\n#&gt; 6   3 (11-11, 7- 7)       axis-b-1-1\n#&gt; 7   3 (11-11,11-11)       axis-b-2-1\n#&gt; 8   3 (10-10,10-10)       axis-l-1-2\n#&gt; 9   3 (10-10, 6- 6)       axis-l-1-1\n#&gt; 10  3 (10-10,12-12)       axis-r-1-2\n#&gt; 11  3 (10-10, 8- 8)       axis-r-1-1\n#&gt; 12  2 ( 9- 9, 7- 7)      strip-t-1-1\n#&gt; 13  2 ( 9- 9,11-11)      strip-t-2-1\n#&gt; 14  4 ( 7- 7, 7-11)           xlab-t\n#&gt; 15  5 (12-12, 7-11)           xlab-b\n#&gt; 16  6 (10-10, 5- 5)           ylab-l\n#&gt; 17  7 (10-10,13-13)           ylab-r\n#&gt; 18  8 (10-10,15-15)  guide-box-right\n#&gt; 19  9 (10-10, 3- 3)   guide-box-left\n#&gt; 20 10 (14-14, 7-11) guide-box-bottom\n#&gt; 21 11 ( 5- 5, 7-11)    guide-box-top\n#&gt; 22 12 (10-10, 7-11) guide-box-inside\n#&gt; 23 13 ( 4- 4, 7-11)         subtitle\n#&gt; 24 14 ( 3- 3, 7-11)            title\n#&gt; 25 15 (15-15, 7-11)          caption\n#&gt;                                             grob\n#&gt; 1                rect[plot.background..rect.717]\n#&gt; 2                       gTree[panel-1.gTree.594]\n#&gt; 3                       gTree[panel-2.gTree.609]\n#&gt; 4                                 zeroGrob[NULL]\n#&gt; 5                                 zeroGrob[NULL]\n#&gt; 6            absoluteGrob[GRID.absoluteGrob.613]\n#&gt; 7            absoluteGrob[GRID.absoluteGrob.613]\n#&gt; 8                                 zeroGrob[NULL]\n#&gt; 9            absoluteGrob[GRID.absoluteGrob.621]\n#&gt; 10                                zeroGrob[NULL]\n#&gt; 11                                zeroGrob[NULL]\n#&gt; 12                                 gtable[strip]\n#&gt; 13                                 gtable[strip]\n#&gt; 14                                zeroGrob[NULL]\n#&gt; 15 titleGrob[axis.title.x.bottom..titleGrob.676]\n#&gt; 16   titleGrob[axis.title.y.left..titleGrob.679]\n#&gt; 17                                zeroGrob[NULL]\n#&gt; 18                             gtable[guide-box]\n#&gt; 19                                zeroGrob[NULL]\n#&gt; 20                                zeroGrob[NULL]\n#&gt; 21                                zeroGrob[NULL]\n#&gt; 22                                zeroGrob[NULL]\n#&gt; 23         zeroGrob[plot.subtitle..zeroGrob.714]\n#&gt; 24          titleGrob[plot.title..titleGrob.713]\n#&gt; 25          zeroGrob[plot.caption..zeroGrob.715]\n\n\n\nCodegrid::grid.newpage()\n\n\n\nCodegrid::grid.newpage()\ngrid::grid.draw(p_gtable)\n\n\n\n\n\n\n\n\n\nCodeprototype()\n#&gt; An object of class \"classPrototypeDef\"\n#&gt; Slot \"object\":\n#&gt; &lt;S4 Type Object&gt;\n#&gt; \n#&gt; Slot \"slots\":\n#&gt; character(0)\n#&gt; \n#&gt; Slot \"dataPart\":\n#&gt; [1] FALSE\n\n\n参考 ggplot2-book.org/internals#sec-ggproto\n\nCode\n# 创建新类，子类继承\nNewObject &lt;- ggproto(\n  `_class` = NULL, # 类\n  `_inherits` = NULL # 继承\n)\nNewObject \n#&gt; &lt;ggproto object: Class gg&gt;\n#&gt;     _inherits: NULL\n\n\n\nCode# 新类\nNewClass &lt;- ggproto(\"NewClass\", NULL,\n                    # fields     默认值 \n                    geom=NA,\n                    # methods\n                    \n                    )\n\nNewClass\n#&gt; &lt;ggproto object: Class NewClass, gg&gt;\n#&gt;     geom: NA\n\n\n\nCode# 实例\ninstance &lt;- ggproto(NULL, NewClass,\n                    # 字段赋值\n                    geom=\"point\"\n                    )\ninstance\n#&gt; &lt;ggproto object: Class NewClass, gg&gt;\n#&gt;     geom: point\n#&gt;     super:  &lt;ggproto object: Class NewClass, gg&gt;\n\n\n\nCode# 继承\nNewSubClass &lt;- ggproto(\"NewSubClass\", NewClass)\nNewSubClass\n#&gt; &lt;ggproto object: Class NewSubClass, NewClass, gg&gt;\n#&gt;     geom: NA\n#&gt;     super:  &lt;ggproto object: Class NewClass, gg&gt;\n\n\n\n\nCodelibrary(ggplot2)\nlibrary(grid)\n\n# 自定义 GeomSignif 对象\nGeomSignif &lt;- ggproto(`_class` = \"GeomSignif\",\n                      `_inherits` = Geom,\n  required_aes = c(\"x\", \"y\"),\n  \n  default_aes = aes(\n    comparisons = NULL, step_increase = 0.1,\n    map_signif_level = TRUE, test = \"t.test\",\n    test.args = list(), y_position = NULL,\n    annotations = NULL, tip_length = 0.03\n  ),\n  \n  draw_group = function(data, panel_scales, coord, comparisons, step_increase,\n                        map_signif_level, test, test.args, y_position, annotations, tip_length) {\n    \n    # 提取比较组\n    if (is.null(comparisons)) {\n      stop(\"Comparisons must be provided.\")\n    }\n    \n    # 计算每组的 y 坐标位置\n    y_max &lt;- max(data$y, na.rm = TRUE)\n    if (is.null(y_position)) {\n      y_position &lt;- y_max + seq(step_increase, by = step_increase, length.out = length(comparisons))\n    }\n    \n    # 创建标记的绘图对象列表\n    grobs &lt;- list()\n    for (i in seq_along(comparisons)) {\n      comp &lt;- comparisons[[i]]\n      group1 &lt;- data[data$x == comp[1], \"y\"]\n      group2 &lt;- data[data$x == comp[2], \"y\"]\n      \n      # 进行显著性测试\n      test_result &lt;- do.call(test, c(list(group1, group2), test.args))\n      p_value &lt;- test_result$p.value\n      label &lt;- if (map_signif_level) {\n        if (p_value &lt; 0.001) \"***\"\n        else if (p_value &lt; 0.01) \"**\"\n        else if (p_value &lt; 0.05) \"*\"\n        else \"ns\"\n      } else {\n        format(p_value, digits = 2)\n      }\n      \n      # 绘制显著性标记线条和标签\n      grobs &lt;- c(grobs, list(\n        grid::linesGrob(\n          x = c(mean(comp[1]), mean(comp[2])),\n          y = rep(y_position[i], 2),\n          gp = grid::gpar(col = \"black\", lwd = 0.5)\n        ),\n        grid::textGrob(\n          label, x = mean(comp), y = y_position[i] + tip_length,\n          gp = grid::gpar(col = \"black\", fontsize = 10)\n        )\n      ))\n    }\n    \n    # 返回绘图对象列表\n    grid::grobTree(grobs = grobs)\n  }\n)\n\n# 创建自定义 geom_signif 函数\ngeom_signif &lt;- function(mapping = NULL, data = NULL, stat = \"identity\", position = \"identity\",\n                        na.rm = FALSE, show.legend = NA, inherit.aes = TRUE, ...) {\n  layer(\n    geom = GeomSignif, mapping = mapping, data = data, stat = stat,\n    position = position, show.legend = show.legend, inherit.aes = inherit.aes,\n    params = list(na.rm = na.rm, ...)\n  )\n}",
    "crumbs": [
      "ggplot2 图形",
      "`ggproto` 对象"
    ]
  },
  {
    "objectID": "ggproto.html#ggplot2-的内部结构",
    "href": "ggproto.html#ggplot2-的内部结构",
    "title": "\n1 ggproto 对象",
    "section": "",
    "text": "Codelibrary(tidyverse)\n#&gt; Warning: package 'purrr' was built under R version 4.5.2\n#&gt; Warning: package 'stringr' was built under R version 4.5.2\n#&gt; Warning: package 'forcats' was built under R version 4.5.2\n#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.6\n#&gt; ✔ forcats   1.0.1     ✔ stringr   1.6.0\n#&gt; ✔ ggplot2   4.0.1     ✔ tibble    3.3.0\n#&gt; ✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n#&gt; ✔ purrr     1.2.0     \n#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#&gt; ✖ dplyr::filter() masks stats::filter()\n#&gt; ✖ dplyr::lag()    masks stats::lag()\n#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\np &lt;- ggplot(mpg, aes(displ, hwy, color = drv)) + \n  geom_point(position = \"jitter\") +\n  geom_smooth(method = \"lm\", formula = y ~ x) + \n  facet_wrap(vars(year)) + \n  ggtitle(\"A plot for expository purposes\")\np\n\n\n\n\n\n\n\n\nCodeggprint &lt;- function(x) {\n  data &lt;- ggplot_build(x)\n  gtable &lt;- ggplot_gtable(data)\n  grid::grid.newpage()\n  grid::grid.draw(gtable)\n  return(invisible(x))\n}\nggprint(p)\n\n\n\n\n\n\n\n\nCodep_built &lt;- ggplot_build(p)\n\np_built $data %&gt;% map(head) %&gt;% map(as_tibble)\n#&gt; [[1]]\n#&gt; # A tibble: 6 × 10\n#&gt;       x     y colour  PANEL group shape fill   size alpha stroke\n#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;fct&gt; &lt;int&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;dbl&gt; &lt;lgl&gt;  &lt;dbl&gt;\n#&gt; 1  1.81  28.7 #00BA38 1         2    19 NA      1.5 NA       0.5\n#&gt; 2  1.83  28.7 #00BA38 1         2    19 NA      1.5 NA       0.5\n#&gt; 3  2.79  26.2 #00BA38 1         2    19 NA      1.5 NA       0.5\n#&gt; 4  2.82  25.9 #00BA38 1         2    19 NA      1.5 NA       0.5\n#&gt; 5  1.82  25.6 #F8766D 1         1    19 NA      1.5 NA       0.5\n#&gt; 6  1.79  25.4 #F8766D 1         1    19 NA      1.5 NA       0.5\n#&gt; \n#&gt; [[2]]\n#&gt; # A tibble: 6 × 14\n#&gt;       x     y  ymin  ymax    se flipped_aes colour  PANEL group fill   linewidth\n#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;       &lt;chr&gt;   &lt;fct&gt; &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;\n#&gt; 1  1.8   24.3  23.1  25.6 0.625 FALSE       #F8766D 1         1 #9999…         1\n#&gt; 2  1.86  24.2  22.9  25.4 0.612 FALSE       #F8766D 1         1 #9999…         1\n#&gt; 3  1.92  24.0  22.8  25.2 0.598 FALSE       #F8766D 1         1 #9999…         1\n#&gt; 4  1.98  23.9  22.7  25.0 0.585 FALSE       #F8766D 1         1 #9999…         1\n#&gt; 5  2.04  23.7  22.6  24.9 0.572 FALSE       #F8766D 1         1 #9999…         1\n#&gt; 6  2.10  23.5  22.4  24.7 0.559 FALSE       #F8766D 1         1 #9999…         1\n#&gt; # ℹ 3 more variables: linetype &lt;int&gt;, weight &lt;dbl&gt;, alpha &lt;dbl&gt;\np_built $layout\n#&gt; &lt;ggproto object: Class Layout, gg&gt;\n#&gt;     coord: &lt;ggproto object: Class CoordCartesian, Coord, gg&gt;\n#&gt;         aspect: function\n#&gt;         backtransform_range: function\n#&gt;         clip: on\n#&gt;         default: TRUE\n#&gt;         distance: function\n#&gt;         draw_panel: function\n#&gt;         expand: TRUE\n#&gt;         is_free: function\n#&gt;         is_linear: function\n#&gt;         labels: function\n#&gt;         limits: list\n#&gt;         modify_scales: function\n#&gt;         range: function\n#&gt;         ratio: NULL\n#&gt;         render_axis_h: function\n#&gt;         render_axis_v: function\n#&gt;         render_bg: function\n#&gt;         render_fg: function\n#&gt;         reverse: none\n#&gt;         setup_data: function\n#&gt;         setup_layout: function\n#&gt;         setup_panel_guides: function\n#&gt;         setup_panel_params: function\n#&gt;         setup_params: function\n#&gt;         train_panel_guides: function\n#&gt;         transform: function\n#&gt;         super:  &lt;ggproto object: Class CoordCartesian, Coord, gg&gt;\n#&gt;     coord_params: list\n#&gt;     facet: &lt;ggproto object: Class FacetWrap, Facet, gg&gt;\n#&gt;         attach_axes: function\n#&gt;         attach_strips: function\n#&gt;         compute_layout: function\n#&gt;         draw_back: function\n#&gt;         draw_front: function\n#&gt;         draw_labels: function\n#&gt;         draw_panel_content: function\n#&gt;         draw_panels: function\n#&gt;         finish_data: function\n#&gt;         format_strip_labels: function\n#&gt;         init_gtable: function\n#&gt;         init_scales: function\n#&gt;         map_data: function\n#&gt;         params: list\n#&gt;         set_panel_size: function\n#&gt;         setup_data: function\n#&gt;         setup_panel_params: function\n#&gt;         setup_params: function\n#&gt;         shrink: TRUE\n#&gt;         train_scales: function\n#&gt;         vars: function\n#&gt;         super:  &lt;ggproto object: Class FacetWrap, Facet, gg&gt;\n#&gt;     facet_params: list\n#&gt;     finish_data: function\n#&gt;     get_scales: function\n#&gt;     layout: data.frame\n#&gt;     map_position: function\n#&gt;     panel_params: list\n#&gt;     panel_scales_x: list\n#&gt;     panel_scales_y: list\n#&gt;     render: function\n#&gt;     render_labels: function\n#&gt;     reset_scales: function\n#&gt;     resolve_label: function\n#&gt;     setup: function\n#&gt;     setup_panel_guides: function\n#&gt;     setup_panel_params: function\n#&gt;     train_position: function\n#&gt;     super:  &lt;ggproto object: Class Layout, gg&gt;\np_built $plot\n\n\n\n\n\n\n\n\nCodep_gtable &lt;- ggplot_gtable(p_built)\np_gtable\n#&gt; TableGrob (17 x 17) \"layout\": 25 grobs\n#&gt;     z         cells             name\n#&gt; 1   0 ( 1-17, 1-17)       background\n#&gt; 2   1 (10-10, 7- 7)        panel-1-1\n#&gt; 3   1 (10-10,11-11)        panel-2-1\n#&gt; 4   3 ( 8- 8, 7- 7)       axis-t-1-1\n#&gt; 5   3 ( 8- 8,11-11)       axis-t-2-1\n#&gt; 6   3 (11-11, 7- 7)       axis-b-1-1\n#&gt; 7   3 (11-11,11-11)       axis-b-2-1\n#&gt; 8   3 (10-10,10-10)       axis-l-1-2\n#&gt; 9   3 (10-10, 6- 6)       axis-l-1-1\n#&gt; 10  3 (10-10,12-12)       axis-r-1-2\n#&gt; 11  3 (10-10, 8- 8)       axis-r-1-1\n#&gt; 12  2 ( 9- 9, 7- 7)      strip-t-1-1\n#&gt; 13  2 ( 9- 9,11-11)      strip-t-2-1\n#&gt; 14  4 ( 7- 7, 7-11)           xlab-t\n#&gt; 15  5 (12-12, 7-11)           xlab-b\n#&gt; 16  6 (10-10, 5- 5)           ylab-l\n#&gt; 17  7 (10-10,13-13)           ylab-r\n#&gt; 18  8 (10-10,15-15)  guide-box-right\n#&gt; 19  9 (10-10, 3- 3)   guide-box-left\n#&gt; 20 10 (14-14, 7-11) guide-box-bottom\n#&gt; 21 11 ( 5- 5, 7-11)    guide-box-top\n#&gt; 22 12 (10-10, 7-11) guide-box-inside\n#&gt; 23 13 ( 4- 4, 7-11)         subtitle\n#&gt; 24 14 ( 3- 3, 7-11)            title\n#&gt; 25 15 (15-15, 7-11)          caption\n#&gt;                                             grob\n#&gt; 1                rect[plot.background..rect.717]\n#&gt; 2                       gTree[panel-1.gTree.594]\n#&gt; 3                       gTree[panel-2.gTree.609]\n#&gt; 4                                 zeroGrob[NULL]\n#&gt; 5                                 zeroGrob[NULL]\n#&gt; 6            absoluteGrob[GRID.absoluteGrob.613]\n#&gt; 7            absoluteGrob[GRID.absoluteGrob.613]\n#&gt; 8                                 zeroGrob[NULL]\n#&gt; 9            absoluteGrob[GRID.absoluteGrob.621]\n#&gt; 10                                zeroGrob[NULL]\n#&gt; 11                                zeroGrob[NULL]\n#&gt; 12                                 gtable[strip]\n#&gt; 13                                 gtable[strip]\n#&gt; 14                                zeroGrob[NULL]\n#&gt; 15 titleGrob[axis.title.x.bottom..titleGrob.676]\n#&gt; 16   titleGrob[axis.title.y.left..titleGrob.679]\n#&gt; 17                                zeroGrob[NULL]\n#&gt; 18                             gtable[guide-box]\n#&gt; 19                                zeroGrob[NULL]\n#&gt; 20                                zeroGrob[NULL]\n#&gt; 21                                zeroGrob[NULL]\n#&gt; 22                                zeroGrob[NULL]\n#&gt; 23         zeroGrob[plot.subtitle..zeroGrob.714]\n#&gt; 24          titleGrob[plot.title..titleGrob.713]\n#&gt; 25          zeroGrob[plot.caption..zeroGrob.715]\n\n\n\nCodegrid::grid.newpage()\n\n\n\nCodegrid::grid.newpage()\ngrid::grid.draw(p_gtable)",
    "crumbs": [
      "ggplot2 图形",
      "`ggproto` 对象"
    ]
  },
  {
    "objectID": "ggproto.html#ggproto",
    "href": "ggproto.html#ggproto",
    "title": "\n1 ggproto 对象",
    "section": "",
    "text": "Codeprototype()\n#&gt; An object of class \"classPrototypeDef\"\n#&gt; Slot \"object\":\n#&gt; &lt;S4 Type Object&gt;\n#&gt; \n#&gt; Slot \"slots\":\n#&gt; character(0)\n#&gt; \n#&gt; Slot \"dataPart\":\n#&gt; [1] FALSE\n\n\n参考 ggplot2-book.org/internals#sec-ggproto\n\nCode\n# 创建新类，子类继承\nNewObject &lt;- ggproto(\n  `_class` = NULL, # 类\n  `_inherits` = NULL # 继承\n)\nNewObject \n#&gt; &lt;ggproto object: Class gg&gt;\n#&gt;     _inherits: NULL\n\n\n\nCode# 新类\nNewClass &lt;- ggproto(\"NewClass\", NULL,\n                    # fields     默认值 \n                    geom=NA,\n                    # methods\n                    \n                    )\n\nNewClass\n#&gt; &lt;ggproto object: Class NewClass, gg&gt;\n#&gt;     geom: NA\n\n\n\nCode# 实例\ninstance &lt;- ggproto(NULL, NewClass,\n                    # 字段赋值\n                    geom=\"point\"\n                    )\ninstance\n#&gt; &lt;ggproto object: Class NewClass, gg&gt;\n#&gt;     geom: point\n#&gt;     super:  &lt;ggproto object: Class NewClass, gg&gt;\n\n\n\nCode# 继承\nNewSubClass &lt;- ggproto(\"NewSubClass\", NewClass)\nNewSubClass\n#&gt; &lt;ggproto object: Class NewSubClass, NewClass, gg&gt;\n#&gt;     geom: NA\n#&gt;     super:  &lt;ggproto object: Class NewClass, gg&gt;",
    "crumbs": [
      "ggplot2 图形",
      "`ggproto` 对象"
    ]
  },
  {
    "objectID": "ggproto.html#自定义geom_signif",
    "href": "ggproto.html#自定义geom_signif",
    "title": "\n1 ggproto 对象",
    "section": "",
    "text": "Codelibrary(ggplot2)\nlibrary(grid)\n\n# 自定义 GeomSignif 对象\nGeomSignif &lt;- ggproto(`_class` = \"GeomSignif\",\n                      `_inherits` = Geom,\n  required_aes = c(\"x\", \"y\"),\n  \n  default_aes = aes(\n    comparisons = NULL, step_increase = 0.1,\n    map_signif_level = TRUE, test = \"t.test\",\n    test.args = list(), y_position = NULL,\n    annotations = NULL, tip_length = 0.03\n  ),\n  \n  draw_group = function(data, panel_scales, coord, comparisons, step_increase,\n                        map_signif_level, test, test.args, y_position, annotations, tip_length) {\n    \n    # 提取比较组\n    if (is.null(comparisons)) {\n      stop(\"Comparisons must be provided.\")\n    }\n    \n    # 计算每组的 y 坐标位置\n    y_max &lt;- max(data$y, na.rm = TRUE)\n    if (is.null(y_position)) {\n      y_position &lt;- y_max + seq(step_increase, by = step_increase, length.out = length(comparisons))\n    }\n    \n    # 创建标记的绘图对象列表\n    grobs &lt;- list()\n    for (i in seq_along(comparisons)) {\n      comp &lt;- comparisons[[i]]\n      group1 &lt;- data[data$x == comp[1], \"y\"]\n      group2 &lt;- data[data$x == comp[2], \"y\"]\n      \n      # 进行显著性测试\n      test_result &lt;- do.call(test, c(list(group1, group2), test.args))\n      p_value &lt;- test_result$p.value\n      label &lt;- if (map_signif_level) {\n        if (p_value &lt; 0.001) \"***\"\n        else if (p_value &lt; 0.01) \"**\"\n        else if (p_value &lt; 0.05) \"*\"\n        else \"ns\"\n      } else {\n        format(p_value, digits = 2)\n      }\n      \n      # 绘制显著性标记线条和标签\n      grobs &lt;- c(grobs, list(\n        grid::linesGrob(\n          x = c(mean(comp[1]), mean(comp[2])),\n          y = rep(y_position[i], 2),\n          gp = grid::gpar(col = \"black\", lwd = 0.5)\n        ),\n        grid::textGrob(\n          label, x = mean(comp), y = y_position[i] + tip_length,\n          gp = grid::gpar(col = \"black\", fontsize = 10)\n        )\n      ))\n    }\n    \n    # 返回绘图对象列表\n    grid::grobTree(grobs = grobs)\n  }\n)\n\n# 创建自定义 geom_signif 函数\ngeom_signif &lt;- function(mapping = NULL, data = NULL, stat = \"identity\", position = \"identity\",\n                        na.rm = FALSE, show.legend = NA, inherit.aes = TRUE, ...) {\n  layer(\n    geom = GeomSignif, mapping = mapping, data = data, stat = stat,\n    position = position, show.legend = show.legend, inherit.aes = inherit.aes,\n    params = list(na.rm = na.rm, ...)\n  )\n}",
    "crumbs": [
      "ggplot2 图形",
      "`ggproto` 对象"
    ]
  },
  {
    "objectID": "曼哈顿图.html",
    "href": "曼哈顿图.html",
    "title": "\n1 曼哈顿图",
    "section": "",
    "text": "https://r-graph-gallery.com/101_Manhattan_plot.html\n\n\nCode# Load the library\nlibrary(qqman)\n\ngwasResults %&gt;% head()\n\n# Make the Manhattan plot on the gwasResults dataset\nmanhattan(gwasResults, chr=\"CHR\", bp=\"BP\", snp=\"SNP\", p=\"P\" )\n\n\n\nCodesnpsOfInterest\nmanhattan(gwasResults, highlight = snpsOfInterest)\n\n# 注释\nmanhattan(gwasResults, annotatePval = 0.01)\n\n\n\nCodeqq(gwasResults$P)\n\n\n\n\nCodedon &lt;- gwasResults %&gt;% \n  \n  # Compute chromosome size\n  group_by(CHR) %&gt;% \n  summarise(chr_len=max(BP)) %&gt;% \n  \n  # Calculate cumulative position of each chromosome\n  mutate(tot=cumsum(chr_len)-chr_len) %&gt;%\n  select(-chr_len) %&gt;%\n  \n  # Add this info to the initial dataset\n  left_join(gwasResults, ., by=c(\"CHR\"=\"CHR\")) %&gt;%\n  \n  # Add a cumulative position of each SNP\n  arrange(CHR, BP) %&gt;%\n  mutate( BPcum=BP+tot)\n\naxisdf = don %&gt;%\n  group_by(CHR) %&gt;%\n  summarize(center=( max(BPcum) + min(BPcum) ) / 2 )\n\n\n\nCodeggplot(don, aes(x=BPcum, y=-log10(P))) +\n    \n    # Show all points\n    geom_point( aes(color=as.factor(CHR)), alpha=0.8, size=1.3) +\n    scale_color_manual(values = rep(c(\"grey\", \"skyblue\"), 22 )) +\n    \n    # custom X axis:\n    scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +\n    scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis\n  \n    # Custom the theme:\n    theme_bw() +\n    theme( \n      legend.position=\"none\",\n      panel.border = element_blank(),\n      panel.grid.major.x = element_blank(),\n      panel.grid.minor.x = element_blank()\n    )\n\n\n\nCode# List of SNPs to highlight are in the snpsOfInterest object\n# We will use ggrepel for the annotation\nlibrary(ggrepel)\n\n# Prepare the dataset\ndon &lt;- gwasResults %&gt;% \n  \n  # Compute chromosome size\n  group_by(CHR) %&gt;% \n  summarise(chr_len=max(BP)) %&gt;% \n  \n  # Calculate cumulative position of each chromosome\n  mutate(tot=cumsum(chr_len)-chr_len) %&gt;%\n  select(-chr_len) %&gt;%\n  \n  # Add this info to the initial dataset\n  left_join(gwasResults, ., by=c(\"CHR\"=\"CHR\")) %&gt;%\n  \n  # Add a cumulative position of each SNP\n  arrange(CHR, BP) %&gt;%\n  mutate( BPcum=BP+tot) %&gt;%\n\n  # Add highlight and annotation information\n  mutate( is_highlight=ifelse(SNP %in% snpsOfInterest, \"yes\", \"no\")) %&gt;%\n  mutate( is_annotate=ifelse(-log10(P)&gt;4, \"yes\", \"no\")) \n\n# Prepare X axis\naxisdf &lt;- don %&gt;% group_by(CHR) %&gt;% summarize(center=( max(BPcum) + min(BPcum) ) / 2 )\n\n# Make the plot\nggplot(don, aes(x=BPcum, y=-log10(P))) +\n    \n    # Show all points\n    geom_point( aes(color=as.factor(CHR)), alpha=0.8, size=1.3) +\n    scale_color_manual(values = rep(c(\"grey\", \"skyblue\"), 22 )) +\n    \n    # custom X axis:\n    scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +\n    scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis\n\n    # Add highlighted points\n    geom_point(data=subset(don, is_highlight==\"yes\"), color=\"orange\", size=2) +\n  \n    # Add label using ggrepel to avoid overlapping\n    geom_label_repel( data=subset(don, is_annotate==\"yes\"), aes(label=SNP), size=2) +\n\n    # Custom the theme:\n    theme_bw() +\n    theme( \n      legend.position=\"none\",\n      panel.border = element_blank(),\n      panel.grid.major.x = element_blank(),\n      panel.grid.minor.x = element_blank()\n    )\n\n\n\n\nCodegwasResults %&gt;% \n  filter(-log10(P)&gt;1) %&gt;% head()\n\n\n\nCodelibrary(plotly)\n\n# Prepare the dataset\ndon &lt;- gwasResults %&gt;% \n  \n  # Compute chromosome size\n  group_by(CHR) %&gt;% \n  summarise(chr_len=max(BP)) %&gt;% \n  \n  # Calculate cumulative position of each chromosome\n  mutate(tot=cumsum(chr_len)-chr_len) %&gt;%\n  select(-chr_len) %&gt;%\n  \n  # Add this info to the initial dataset\n  left_join(gwasResults, ., by=c(\"CHR\"=\"CHR\")) %&gt;%\n  \n  # Add a cumulative position of each SNP\n  arrange(CHR, BP) %&gt;%\n  mutate( BPcum=BP+tot) %&gt;%\n\n  # Add highlight and annotation information\n  mutate( is_highlight=ifelse(SNP %in% snpsOfInterest, \"yes\", \"no\")) %&gt;%\n\n  # Filter SNP to make the plot lighter\n  filter(-log10(P)&gt;0.5)\n  \n# Prepare X axis\naxisdf &lt;- don %&gt;% group_by(CHR) %&gt;% summarize(center=( max(BPcum) + min(BPcum) ) / 2 )\n\n# Prepare text description for each SNP:\ndon$text &lt;- paste(\"SNP: \", don$SNP, \"\\nPosition: \", don$BP, \"\\nChromosome: \", don$CHR, \"\\nLOD score:\", -log10(don$P) %&gt;% round(2), \"\\nWhat else do you wanna know\", sep=\"\")\n\n# Make the plot\np &lt;- ggplot(don, aes(x=BPcum, y=-log10(P), text=text)) +\n    \n    # Show all points\n    geom_point( aes(color=as.factor(CHR)), alpha=0.8, size=1.3) +\n    scale_color_manual(values = rep(c(\"grey\", \"skyblue\"), 22 )) +\n    \n    # custom X axis:\n    scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +\n    scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis\n    ylim(0,9) +\n\n    # Add highlighted points\n    geom_point(data=subset(don, is_highlight==\"yes\"), color=\"orange\", size=2) +\n  \n    # Custom the theme:\n    theme_bw() +\n    theme( \n      legend.position=\"none\",\n      panel.border = element_blank(),\n      panel.grid.major.x = element_blank(),\n      panel.grid.minor.x = element_blank()\n    )\np = ggplotly(p, tooltip=\"text\")\np\n\n\n\n\nCode# library(CMplot)"
  },
  {
    "objectID": "曼哈顿图.html#基本",
    "href": "曼哈顿图.html#基本",
    "title": "\n1 曼哈顿图",
    "section": "",
    "text": "Code# Load the library\nlibrary(qqman)\n\ngwasResults %&gt;% head()\n\n# Make the Manhattan plot on the gwasResults dataset\nmanhattan(gwasResults, chr=\"CHR\", bp=\"BP\", snp=\"SNP\", p=\"P\" )\n\n\n\nCodesnpsOfInterest\nmanhattan(gwasResults, highlight = snpsOfInterest)\n\n# 注释\nmanhattan(gwasResults, annotatePval = 0.01)\n\n\n\nCodeqq(gwasResults$P)"
  },
  {
    "objectID": "曼哈顿图.html#使用-ggplot2-高度可定制",
    "href": "曼哈顿图.html#使用-ggplot2-高度可定制",
    "title": "\n1 曼哈顿图",
    "section": "",
    "text": "Codedon &lt;- gwasResults %&gt;% \n  \n  # Compute chromosome size\n  group_by(CHR) %&gt;% \n  summarise(chr_len=max(BP)) %&gt;% \n  \n  # Calculate cumulative position of each chromosome\n  mutate(tot=cumsum(chr_len)-chr_len) %&gt;%\n  select(-chr_len) %&gt;%\n  \n  # Add this info to the initial dataset\n  left_join(gwasResults, ., by=c(\"CHR\"=\"CHR\")) %&gt;%\n  \n  # Add a cumulative position of each SNP\n  arrange(CHR, BP) %&gt;%\n  mutate( BPcum=BP+tot)\n\naxisdf = don %&gt;%\n  group_by(CHR) %&gt;%\n  summarize(center=( max(BPcum) + min(BPcum) ) / 2 )\n\n\n\nCodeggplot(don, aes(x=BPcum, y=-log10(P))) +\n    \n    # Show all points\n    geom_point( aes(color=as.factor(CHR)), alpha=0.8, size=1.3) +\n    scale_color_manual(values = rep(c(\"grey\", \"skyblue\"), 22 )) +\n    \n    # custom X axis:\n    scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +\n    scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis\n  \n    # Custom the theme:\n    theme_bw() +\n    theme( \n      legend.position=\"none\",\n      panel.border = element_blank(),\n      panel.grid.major.x = element_blank(),\n      panel.grid.minor.x = element_blank()\n    )\n\n\n\nCode# List of SNPs to highlight are in the snpsOfInterest object\n# We will use ggrepel for the annotation\nlibrary(ggrepel)\n\n# Prepare the dataset\ndon &lt;- gwasResults %&gt;% \n  \n  # Compute chromosome size\n  group_by(CHR) %&gt;% \n  summarise(chr_len=max(BP)) %&gt;% \n  \n  # Calculate cumulative position of each chromosome\n  mutate(tot=cumsum(chr_len)-chr_len) %&gt;%\n  select(-chr_len) %&gt;%\n  \n  # Add this info to the initial dataset\n  left_join(gwasResults, ., by=c(\"CHR\"=\"CHR\")) %&gt;%\n  \n  # Add a cumulative position of each SNP\n  arrange(CHR, BP) %&gt;%\n  mutate( BPcum=BP+tot) %&gt;%\n\n  # Add highlight and annotation information\n  mutate( is_highlight=ifelse(SNP %in% snpsOfInterest, \"yes\", \"no\")) %&gt;%\n  mutate( is_annotate=ifelse(-log10(P)&gt;4, \"yes\", \"no\")) \n\n# Prepare X axis\naxisdf &lt;- don %&gt;% group_by(CHR) %&gt;% summarize(center=( max(BPcum) + min(BPcum) ) / 2 )\n\n# Make the plot\nggplot(don, aes(x=BPcum, y=-log10(P))) +\n    \n    # Show all points\n    geom_point( aes(color=as.factor(CHR)), alpha=0.8, size=1.3) +\n    scale_color_manual(values = rep(c(\"grey\", \"skyblue\"), 22 )) +\n    \n    # custom X axis:\n    scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +\n    scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis\n\n    # Add highlighted points\n    geom_point(data=subset(don, is_highlight==\"yes\"), color=\"orange\", size=2) +\n  \n    # Add label using ggrepel to avoid overlapping\n    geom_label_repel( data=subset(don, is_annotate==\"yes\"), aes(label=SNP), size=2) +\n\n    # Custom the theme:\n    theme_bw() +\n    theme( \n      legend.position=\"none\",\n      panel.border = element_blank(),\n      panel.grid.major.x = element_blank(),\n      panel.grid.minor.x = element_blank()\n    )"
  },
  {
    "objectID": "曼哈顿图.html#切换到带有-plotly-的交互式版本",
    "href": "曼哈顿图.html#切换到带有-plotly-的交互式版本",
    "title": "\n1 曼哈顿图",
    "section": "",
    "text": "CodegwasResults %&gt;% \n  filter(-log10(P)&gt;1) %&gt;% head()\n\n\n\nCodelibrary(plotly)\n\n# Prepare the dataset\ndon &lt;- gwasResults %&gt;% \n  \n  # Compute chromosome size\n  group_by(CHR) %&gt;% \n  summarise(chr_len=max(BP)) %&gt;% \n  \n  # Calculate cumulative position of each chromosome\n  mutate(tot=cumsum(chr_len)-chr_len) %&gt;%\n  select(-chr_len) %&gt;%\n  \n  # Add this info to the initial dataset\n  left_join(gwasResults, ., by=c(\"CHR\"=\"CHR\")) %&gt;%\n  \n  # Add a cumulative position of each SNP\n  arrange(CHR, BP) %&gt;%\n  mutate( BPcum=BP+tot) %&gt;%\n\n  # Add highlight and annotation information\n  mutate( is_highlight=ifelse(SNP %in% snpsOfInterest, \"yes\", \"no\")) %&gt;%\n\n  # Filter SNP to make the plot lighter\n  filter(-log10(P)&gt;0.5)\n  \n# Prepare X axis\naxisdf &lt;- don %&gt;% group_by(CHR) %&gt;% summarize(center=( max(BPcum) + min(BPcum) ) / 2 )\n\n# Prepare text description for each SNP:\ndon$text &lt;- paste(\"SNP: \", don$SNP, \"\\nPosition: \", don$BP, \"\\nChromosome: \", don$CHR, \"\\nLOD score:\", -log10(don$P) %&gt;% round(2), \"\\nWhat else do you wanna know\", sep=\"\")\n\n# Make the plot\np &lt;- ggplot(don, aes(x=BPcum, y=-log10(P), text=text)) +\n    \n    # Show all points\n    geom_point( aes(color=as.factor(CHR)), alpha=0.8, size=1.3) +\n    scale_color_manual(values = rep(c(\"grey\", \"skyblue\"), 22 )) +\n    \n    # custom X axis:\n    scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +\n    scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis\n    ylim(0,9) +\n\n    # Add highlighted points\n    geom_point(data=subset(don, is_highlight==\"yes\"), color=\"orange\", size=2) +\n  \n    # Custom the theme:\n    theme_bw() +\n    theme( \n      legend.position=\"none\",\n      panel.border = element_blank(),\n      panel.grid.major.x = element_blank(),\n      panel.grid.minor.x = element_blank()\n    )\np = ggplotly(p, tooltip=\"text\")\np"
  },
  {
    "objectID": "曼哈顿图.html#环形曼哈顿图",
    "href": "曼哈顿图.html#环形曼哈顿图",
    "title": "\n1 曼哈顿图",
    "section": "",
    "text": "Code# library(CMplot)"
  },
  {
    "objectID": "gtsummary.html",
    "href": "gtsummary.html",
    "title": "\n1 gtsummary",
    "section": "",
    "text": "https://www.danieldsjoberg.com/gtsummary/index.html\n\nCodelibrary(tidyverse)\n#&gt; Warning: package 'purrr' was built under R version 4.5.2\n#&gt; Warning: package 'stringr' was built under R version 4.5.2\n#&gt; Warning: package 'forcats' was built under R version 4.5.2\n#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.6\n#&gt; ✔ forcats   1.0.1     ✔ stringr   1.6.0\n#&gt; ✔ ggplot2   4.0.1     ✔ tibble    3.3.0\n#&gt; ✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n#&gt; ✔ purrr     1.2.0     \n#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#&gt; ✖ dplyr::filter() masks stats::filter()\n#&gt; ✖ dplyr::lag()    masks stats::lag()\n#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\nlibrary(gtsummary)\n#&gt; Warning: package 'gtsummary' was built under R version 4.5.2\nhead(trial)\n#&gt; # A tibble: 6 × 8\n#&gt;   trt      age marker stage grade response death ttdeath\n#&gt;   &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;    &lt;int&gt; &lt;int&gt;   &lt;dbl&gt;\n#&gt; 1 Drug A    23  0.16  T1    II           0     0    24  \n#&gt; 2 Drug B     9  1.11  T2    I            1     0    24  \n#&gt; 3 Drug A    31  0.277 T1    II           0     0    24  \n#&gt; 4 Drug A    NA  2.07  T3    III          1     1    17.6\n#&gt; 5 Drug A    51  2.77  T4    III          1     1    16.4\n#&gt; 6 Drug B    39  0.613 T4    I            0     1    15.6\ndata(\"trial\")\n\n\n数据框中的每个变量都可以分配一个 \"label\" 属性\n\nCodeattr(trial$trt,\"label\") &lt;- '治疗'\nattr(trial$trt,\"label\")\n#&gt; [1] \"治疗\"\n\n\n\nLabel attributes from the data set are automatically printed.\nMissing values are listed as “Unknown” in the table.\n\n\n\nargument\n描述\n\n\n\nlabel=\n指定表格中打印的变量标签\n\n\ntype=\n指定变量类型（例如continuous, categorical等\n\n\nstatistic=\n更改显示的汇总统计数据\n\n\ndigits=\n汇总统计数据将四舍五入的位数\n\n\nmissing=\n是否显示包含缺失观测值数的行\n\n\nmissing_text=\n缺失数字行的文本标签\n\n\nsort=\n按频率更改分类级别的排序\n\n\npercent=\n打印列、行或单元格百分比\n\n\ninclude=\n要包含在汇总表中的变量列表\n\n\n\n\n\n\nCode\ntrial2 &lt;- trial %&gt;% select(-response,-death)\ntrial2 %&gt;%\n  tbl_summary(\n    by = trt,\n    statistic = list(\n      all_continuous() ~ c(\"{mean}± {sd} \"),  # {median} ({p25},{p75})\n      all_categorical() ~ \"{n} / {N} ({p}%)\"\n    ),\n   # digits = list(starts_with(\"age\") ~ 3,\n    #              grade ~ 2),\n    label = list(age ~ \"Patient age\",\n                 grade ~ \"Tumor Grade\"),\n    missing_text = \"(NA)\",\n  )\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nDrug A\nN = 981\n\n\nDrug B\nN = 1021\n\n\n\n\nPatient age\n47± 15\n47± 14\n\n\n    (NA)\n7\n4\n\n\nMarker Level (ng/mL)\n1.02± 0.89\n0.82± 0.83\n\n\n    (NA)\n6\n4\n\n\nT Stage\n\n\n\n\n    T1\n28 / 98 (29%)\n25 / 102 (25%)\n\n\n    T2\n25 / 98 (26%)\n29 / 102 (28%)\n\n\n    T3\n22 / 98 (22%)\n21 / 102 (21%)\n\n\n    T4\n23 / 98 (23%)\n27 / 102 (26%)\n\n\nTumor Grade\n\n\n\n\n    I\n35 / 98 (36%)\n33 / 102 (32%)\n\n\n    II\n32 / 98 (33%)\n36 / 102 (35%)\n\n\n    III\n31 / 98 (32%)\n33 / 102 (32%)\n\n\nMonths to Death/Censor\n20.2± 5.0\n19.0± 5.5\n\n\n\n\n1 Mean± SD ; n / N (%)\n\n\n\n\n\n\nCodetrial2 %&gt;%\n    tbl_summary(by = trt) %&gt;%\n    add_overall() |&gt;   # t添加总和\n    add_n() |&gt;\n    # 修改注释\n    modify_header(label ~ \"**变量**\") %&gt;%\n    modify_spanning_header(c(\"stat_1\", \"stat_2\") ~ \"**药物**\") %&gt;%\n    modify_footnote(all_stat_cols() ~ \"Median (25%, 75%) or Frequency (%)\") %&gt;%\n    modify_caption(\"**Table 1. Patient Characteristics**\") %&gt;%\n    bold_labels()\n\n\n\n\nTable 1. Patient Characteristics\n\n\n\n\n\n\n\n\n\n变量\nN\n\nOverall\nN = 2001\n\n\n药物\n\n\n\n\nDrug A\nN = 981\n\n\nDrug B\nN = 1021\n\n\n\n\n\nAge\n189\n47 (38, 57)\n46 (37, 60)\n48 (39, 56)\n\n\n    Unknown\n\n11\n7\n4\n\n\nMarker Level (ng/mL)\n190\n0.64 (0.22, 1.41)\n0.84 (0.23, 1.60)\n0.52 (0.18, 1.21)\n\n\n    Unknown\n\n10\n6\n4\n\n\nT Stage\n200\n\n\n\n\n\n    T1\n\n53 (27%)\n28 (29%)\n25 (25%)\n\n\n    T2\n\n54 (27%)\n25 (26%)\n29 (28%)\n\n\n    T3\n\n43 (22%)\n22 (22%)\n21 (21%)\n\n\n    T4\n\n50 (25%)\n23 (23%)\n27 (26%)\n\n\nGrade\n200\n\n\n\n\n\n    I\n\n68 (34%)\n35 (36%)\n33 (32%)\n\n\n    II\n\n68 (34%)\n32 (33%)\n36 (35%)\n\n\n    III\n\n64 (32%)\n31 (32%)\n33 (32%)\n\n\nMonths to Death/Censor\n200\n22.4 (15.9, 24.0)\n23.5 (17.4, 24.0)\n21.2 (14.5, 24.0)\n\n\n\n\n1 Median (25%, 75%) or Frequency (%)\n\n\n\n\n\n\n\n函数\n描述\n\n\n\nadd_p()\n将 p 值添加到输出中，比较各组的值\n\n\nadd_overall()\n添加包含总体汇总统计数据的列\n\n\nadd_n()\n为每个变量添加一个包含 N（或缺少 N）的列\n\n\nadd_difference()\n为两组之间的差值、置信区间和 p 值添加列\n\n\nadd_stat_label()\n为每行中显示的汇总统计数据添加标签\n\n\nadd_stat()\n泛型函数，用于添加具有用户定义值的列\n\n\nadd_q()\n添加一列 Q 值以控制多个比较\n\n\nmodify_header()\n更新列标题\n\n\nmodify_footnote()\n更新列脚注\n\n\nmodify_spanning_header()\n更新跨标头\n\n\nmodify_caption()\n更新表格标题/标题\n\n\nbold_labels()\n粗体变量标签\n\n\nbold_levels()\n粗体可变级别\n\n\nitalicize_labels()\n将变量标签斜体化\n\n\nitalicize_levels()\n斜体变量级别\n\n\nbold_p()\n粗体显著性 p 值\n\n\n\n\n\nCodetrial2 |&gt; \n    tbl_summary(by = trt) |&gt; \n    add_p(\n        \n        test=list(all_continuous() ~ \"t.test\", \n                  all_categorical() ~ \"chisq.test.no.correct\"),\n         pvalue_fun = label_style_pvalue(digits = 3),\n    ) \n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nDrug A\nN = 981\n\n\nDrug B\nN = 1021\n\n\np-value2\n\n\n\n\nAge\n46 (37, 60)\n48 (39, 56)\n0.834\n\n\n    Unknown\n7\n4\n\n\n\nMarker Level (ng/mL)\n0.84 (0.23, 1.60)\n0.52 (0.18, 1.21)\n0.116\n\n\n    Unknown\n6\n4\n\n\n\nT Stage\n\n\n0.866\n\n\n    T1\n28 (29%)\n25 (25%)\n\n\n\n    T2\n25 (26%)\n29 (28%)\n\n\n\n    T3\n22 (22%)\n21 (21%)\n\n\n\n    T4\n23 (23%)\n27 (26%)\n\n\n\nGrade\n\n\n0.871\n\n\n    I\n35 (36%)\n33 (32%)\n\n\n\n    II\n32 (33%)\n36 (35%)\n\n\n\n    III\n31 (32%)\n33 (32%)\n\n\n\nMonths to Death/Censor\n23.5 (17.4, 24.0)\n21.2 (14.5, 24.0)\n0.108\n\n\n\n\n\n1 Median (Q1, Q3); n (%)\n\n\n\n2 Welch Two Sample t-test; Pearson’s Chi-squared test\n\n\n\n\n\nCode# ?tests\n\n\n\nCodewilcox.test(age~trt,data = trial2)\n#&gt; \n#&gt;  Wilcoxon rank sum test with continuity correction\n#&gt; \n#&gt; data:  age by trt\n#&gt; W = 4323, p-value = 0.7183\n#&gt; alternative hypothesis: true location shift is not equal to 0\ntable(trial2$grade,trial2$trt)|&gt; chisq.test()\n#&gt; \n#&gt;  Pearson's Chi-squared test\n#&gt; \n#&gt; data:  table(trial2$grade, trial2$trt)\n#&gt; X-squared = 0.27673, df = 2, p-value = 0.8708\n\n\n\n\nCodemy_ttest3 &lt;- function(data, variable, by, ...) {\n  t.test(data[[variable]] ~ as.factor(data[[by]])) %&gt;%\n    broom::tidy() %&gt;%\n        mutate(\n            statistic = sprintf(\"%.3f\", statistic),\n            p.value = case_when(\n            p.value &gt;=0.05 ~ sprintf(\"%.3f (ns)\",p.value),\n            p.value &gt;=0.01 ~ sprintf(\"%.3f (*)\",p.value),\n            p.value &gt;=0.001 ~sprintf(\"%.3f (**)\",p.value),\n            p.value &lt;0.001 ~ sprintf(\"%.3f (***)\",p.value),\n            )\n        ) %&gt;% \n    select(statistic, p.value)\n}\n\ntrial |&gt;\n  tbl_summary(\n    by = trt,\n    include = c(trt, age, marker),\n    missing = \"ifany\"\n  ) |&gt;\n  add_stat(fns = everything() ~ my_ttest3) %&gt;% \n  modify_header(statistic = \"**t-statistic**\", p.value = \"**p-value**\") \n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nDrug A\nN = 981\n\n\nDrug B\nN = 1021\n\nt-statistic\np-value\n\n\n\nAge\n46 (37, 60)\n48 (39, 56)\n-0.209\n0.834 (ns)\n\n\n    Unknown\n7\n4\n\n\n\n\nMarker Level (ng/mL)\n0.84 (0.23, 1.60)\n0.52 (0.18, 1.21)\n1.578\n0.116 (ns)\n\n\n    Unknown\n6\n4\n\n\n\n\n\n\n1 Median (Q1, Q3)\n\n\n\n\n\n\n\nCodemean_ci &lt;- function(data, variable, ...) {\n  test &lt;- t.test(data[[variable]])\n  dplyr::tibble(\n    mean = test$estimate,\n    conf.low = test$conf.int[1],\n    conf.high = test$conf.int[2]\n  )\n}\n\ntrial |&gt;\n  tbl_custom_summary(\n    include = c(\"marker\", \"ttdeath\"),\n    by = \"trt\",\n    stat_fns = ~ mean_ci,\n    statistic = ~ \"{mean} [{conf.low}; {conf.high}]\"\n  ) |&gt;\n  add_overall(last = TRUE) |&gt;\n  modify_footnote(\n    all_stat_cols() ~ \"mean [95% CI]\"\n  )\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nDrug A\nN = 981\n\n\nDrug B\nN = 1021\n\n\nOverall\nN = 2001\n\n\n\n\nMarker Level (ng/mL)\n1.02 [0.83; 1.20]\n0.82 [0.65; 0.99]\n0.92 [0.79; 1.04]\n\n\n    Unknown\n6\n4\n10\n\n\nMonths to Death/Censor\n20.2 [19.2; 21.2]\n19.0 [18.0; 20.1]\n19.6 [18.9; 20.4]\n\n\n\n\n1 mean [95% CI]\n\n\n\n\n\n\n\nCodetheme_gtsummary_journal(journal = \"jama\")\n#&gt; Setting theme \"JAMA\"\n\ntrial %&gt;%\n  select(trt, age, grade) %&gt;%\n  tbl_summary(by = trt) %&gt;%\n  add_p()\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nDrug A\nN = 98\n\nDrug B\nN = 102\n\np-value1\n\n\n\n\nAge, Median (IQR)\n46 (37 – 60)\n48 (39 – 56)\n0.72\n\n\n    Unknown\n7\n4\n\n\n\nGrade, n (%)\n\n\n0.87\n\n\n    I\n35 (36)\n33 (32)\n\n\n\n    II\n32 (33)\n36 (35)\n\n\n\n    III\n31 (32)\n33 (32)\n\n\n\n\n\n1 Wilcoxon rank sum test; Pearson’s Chi-squared test\n\n\n\n\nCode\n\n#  清除所有先前设置的主题\nreset_gtsummary_theme()\n\n\n\n\nCodelibrary(gt)\n#&gt; Warning: package 'gt' was built under R version 4.5.2\ntab &lt;- mtcars |&gt;\n  rownames_to_column() |&gt;\n  arrange(factor(cyl), mpg) |&gt;\n  group_by(cyl) |&gt;\n  slice(1:3) |&gt;\n  gt()\ntab\n\n\n\n\n\n\nmpg\ndisp\nhp\ndrat\nwt\nqsec\nvs\nam\ngear\ncarb\n\n\n\n4\n\n\nVolvo 142E\n21.4\n121.0\n109\n4.11\n2.780\n18.60\n1\n1\n4\n2\n\n\nToyota Corona\n21.5\n120.1\n97\n3.70\n2.465\n20.01\n1\n0\n3\n1\n\n\nDatsun 710\n22.8\n108.0\n93\n3.85\n2.320\n18.61\n1\n1\n4\n1\n\n\n6\n\n\nMerc 280C\n17.8\n167.6\n123\n3.92\n3.440\n18.90\n1\n0\n4\n4\n\n\nValiant\n18.1\n225.0\n105\n2.76\n3.460\n20.22\n1\n0\n3\n1\n\n\nMerc 280\n19.2\n167.6\n123\n3.92\n3.440\n18.30\n1\n0\n4\n4\n\n\n8\n\n\nCadillac Fleetwood\n10.4\n472.0\n205\n2.93\n5.250\n17.98\n0\n0\n3\n4\n\n\nLincoln Continental\n10.4\n460.0\n215\n3.00\n5.424\n17.82\n0\n0\n3\n4\n\n\nCamaro Z28\n13.3\n350.0\n245\n3.73\n3.840\n15.41\n0\n0\n3\n4\n\n\n\n\n\n\n\nCodetab &lt;- tab |&gt;\n  tab_spanner(\n    label = \"Performance\",\n    columns = c(mpg, disp, hp, drat, wt, qsec)\n  )\n\ntab &lt;- tab |&gt;\n  tab_spanner(\n    label = \"Specs\",\n    columns = c(vs, am, gear, carb)\n  )\ntab \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPerformance\n\n\nSpecs\n\n\n\nmpg\ndisp\nhp\ndrat\nwt\nqsec\nvs\nam\ngear\ncarb\n\n\n\n\n4\n\n\nVolvo 142E\n21.4\n121.0\n109\n4.11\n2.780\n18.60\n1\n1\n4\n2\n\n\nToyota Corona\n21.5\n120.1\n97\n3.70\n2.465\n20.01\n1\n0\n3\n1\n\n\nDatsun 710\n22.8\n108.0\n93\n3.85\n2.320\n18.61\n1\n1\n4\n1\n\n\n6\n\n\nMerc 280C\n17.8\n167.6\n123\n3.92\n3.440\n18.90\n1\n0\n4\n4\n\n\nValiant\n18.1\n225.0\n105\n2.76\n3.460\n20.22\n1\n0\n3\n1\n\n\nMerc 280\n19.2\n167.6\n123\n3.92\n3.440\n18.30\n1\n0\n4\n4\n\n\n8\n\n\nCadillac Fleetwood\n10.4\n472.0\n205\n2.93\n5.250\n17.98\n0\n0\n3\n4\n\n\nLincoln Continental\n10.4\n460.0\n215\n3.00\n5.424\n17.82\n0\n0\n3\n4\n\n\nCamaro Z28\n13.3\n350.0\n245\n3.73\n3.840\n15.41\n0\n0\n3\n4\n\n\n\n\n\n\n\nCodetab &lt;- tab |&gt;\n  tab_header(\n    title = md(\"The Cars of **mtcars**\"),\n    subtitle = \"These are some fine automobiles\"\n  )\ntab\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe Cars of mtcars\n\n\n\nThese are some fine automobiles\n\n\n\n\nPerformance\n\n\nSpecs\n\n\n\nmpg\ndisp\nhp\ndrat\nwt\nqsec\nvs\nam\ngear\ncarb\n\n\n\n\n4\n\n\nVolvo 142E\n21.4\n121.0\n109\n4.11\n2.780\n18.60\n1\n1\n4\n2\n\n\nToyota Corona\n21.5\n120.1\n97\n3.70\n2.465\n20.01\n1\n0\n3\n1\n\n\nDatsun 710\n22.8\n108.0\n93\n3.85\n2.320\n18.61\n1\n1\n4\n1\n\n\n6\n\n\nMerc 280C\n17.8\n167.6\n123\n3.92\n3.440\n18.90\n1\n0\n4\n4\n\n\nValiant\n18.1\n225.0\n105\n2.76\n3.460\n20.22\n1\n0\n3\n1\n\n\nMerc 280\n19.2\n167.6\n123\n3.92\n3.440\n18.30\n1\n0\n4\n4\n\n\n8\n\n\nCadillac Fleetwood\n10.4\n472.0\n205\n2.93\n5.250\n17.98\n0\n0\n3\n4\n\n\nLincoln Continental\n10.4\n460.0\n215\n3.00\n5.424\n17.82\n0\n0\n3\n4\n\n\nCamaro Z28\n13.3\n350.0\n245\n3.73\n3.840\n15.41\n0\n0\n3\n4",
    "crumbs": [
      "表格",
      "gtsummary"
    ]
  },
  {
    "objectID": "gtsummary.html#基线特征表",
    "href": "gtsummary.html#基线特征表",
    "title": "\n1 gtsummary",
    "section": "",
    "text": "Code\ntrial2 &lt;- trial %&gt;% select(-response,-death)\ntrial2 %&gt;%\n  tbl_summary(\n    by = trt,\n    statistic = list(\n      all_continuous() ~ c(\"{mean}± {sd} \"),  # {median} ({p25},{p75})\n      all_categorical() ~ \"{n} / {N} ({p}%)\"\n    ),\n   # digits = list(starts_with(\"age\") ~ 3,\n    #              grade ~ 2),\n    label = list(age ~ \"Patient age\",\n                 grade ~ \"Tumor Grade\"),\n    missing_text = \"(NA)\",\n  )\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nDrug A\nN = 981\n\n\nDrug B\nN = 1021\n\n\n\n\nPatient age\n47± 15\n47± 14\n\n\n    (NA)\n7\n4\n\n\nMarker Level (ng/mL)\n1.02± 0.89\n0.82± 0.83\n\n\n    (NA)\n6\n4\n\n\nT Stage\n\n\n\n\n    T1\n28 / 98 (29%)\n25 / 102 (25%)\n\n\n    T2\n25 / 98 (26%)\n29 / 102 (28%)\n\n\n    T3\n22 / 98 (22%)\n21 / 102 (21%)\n\n\n    T4\n23 / 98 (23%)\n27 / 102 (26%)\n\n\nTumor Grade\n\n\n\n\n    I\n35 / 98 (36%)\n33 / 102 (32%)\n\n\n    II\n32 / 98 (33%)\n36 / 102 (35%)\n\n\n    III\n31 / 98 (32%)\n33 / 102 (32%)\n\n\nMonths to Death/Censor\n20.2± 5.0\n19.0± 5.5\n\n\n\n\n1 Mean± SD ; n / N (%)\n\n\n\n\n\n\nCodetrial2 %&gt;%\n    tbl_summary(by = trt) %&gt;%\n    add_overall() |&gt;   # t添加总和\n    add_n() |&gt;\n    # 修改注释\n    modify_header(label ~ \"**变量**\") %&gt;%\n    modify_spanning_header(c(\"stat_1\", \"stat_2\") ~ \"**药物**\") %&gt;%\n    modify_footnote(all_stat_cols() ~ \"Median (25%, 75%) or Frequency (%)\") %&gt;%\n    modify_caption(\"**Table 1. Patient Characteristics**\") %&gt;%\n    bold_labels()\n\n\n\n\nTable 1. Patient Characteristics\n\n\n\n\n\n\n\n\n\n变量\nN\n\nOverall\nN = 2001\n\n\n药物\n\n\n\n\nDrug A\nN = 981\n\n\nDrug B\nN = 1021\n\n\n\n\n\nAge\n189\n47 (38, 57)\n46 (37, 60)\n48 (39, 56)\n\n\n    Unknown\n\n11\n7\n4\n\n\nMarker Level (ng/mL)\n190\n0.64 (0.22, 1.41)\n0.84 (0.23, 1.60)\n0.52 (0.18, 1.21)\n\n\n    Unknown\n\n10\n6\n4\n\n\nT Stage\n200\n\n\n\n\n\n    T1\n\n53 (27%)\n28 (29%)\n25 (25%)\n\n\n    T2\n\n54 (27%)\n25 (26%)\n29 (28%)\n\n\n    T3\n\n43 (22%)\n22 (22%)\n21 (21%)\n\n\n    T4\n\n50 (25%)\n23 (23%)\n27 (26%)\n\n\nGrade\n200\n\n\n\n\n\n    I\n\n68 (34%)\n35 (36%)\n33 (32%)\n\n\n    II\n\n68 (34%)\n32 (33%)\n36 (35%)\n\n\n    III\n\n64 (32%)\n31 (32%)\n33 (32%)\n\n\nMonths to Death/Censor\n200\n22.4 (15.9, 24.0)\n23.5 (17.4, 24.0)\n21.2 (14.5, 24.0)\n\n\n\n\n1 Median (25%, 75%) or Frequency (%)\n\n\n\n\n\n\n\n函数\n描述\n\n\n\nadd_p()\n将 p 值添加到输出中，比较各组的值\n\n\nadd_overall()\n添加包含总体汇总统计数据的列\n\n\nadd_n()\n为每个变量添加一个包含 N（或缺少 N）的列\n\n\nadd_difference()\n为两组之间的差值、置信区间和 p 值添加列\n\n\nadd_stat_label()\n为每行中显示的汇总统计数据添加标签\n\n\nadd_stat()\n泛型函数，用于添加具有用户定义值的列\n\n\nadd_q()\n添加一列 Q 值以控制多个比较\n\n\nmodify_header()\n更新列标题\n\n\nmodify_footnote()\n更新列脚注\n\n\nmodify_spanning_header()\n更新跨标头\n\n\nmodify_caption()\n更新表格标题/标题\n\n\nbold_labels()\n粗体变量标签\n\n\nbold_levels()\n粗体可变级别\n\n\nitalicize_labels()\n将变量标签斜体化\n\n\nitalicize_levels()\n斜体变量级别\n\n\nbold_p()\n粗体显著性 p 值\n\n\n\n\n\nCodetrial2 |&gt; \n    tbl_summary(by = trt) |&gt; \n    add_p(\n        \n        test=list(all_continuous() ~ \"t.test\", \n                  all_categorical() ~ \"chisq.test.no.correct\"),\n         pvalue_fun = label_style_pvalue(digits = 3),\n    ) \n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nDrug A\nN = 981\n\n\nDrug B\nN = 1021\n\n\np-value2\n\n\n\n\nAge\n46 (37, 60)\n48 (39, 56)\n0.834\n\n\n    Unknown\n7\n4\n\n\n\nMarker Level (ng/mL)\n0.84 (0.23, 1.60)\n0.52 (0.18, 1.21)\n0.116\n\n\n    Unknown\n6\n4\n\n\n\nT Stage\n\n\n0.866\n\n\n    T1\n28 (29%)\n25 (25%)\n\n\n\n    T2\n25 (26%)\n29 (28%)\n\n\n\n    T3\n22 (22%)\n21 (21%)\n\n\n\n    T4\n23 (23%)\n27 (26%)\n\n\n\nGrade\n\n\n0.871\n\n\n    I\n35 (36%)\n33 (32%)\n\n\n\n    II\n32 (33%)\n36 (35%)\n\n\n\n    III\n31 (32%)\n33 (32%)\n\n\n\nMonths to Death/Censor\n23.5 (17.4, 24.0)\n21.2 (14.5, 24.0)\n0.108\n\n\n\n\n\n1 Median (Q1, Q3); n (%)\n\n\n\n2 Welch Two Sample t-test; Pearson’s Chi-squared test\n\n\n\n\n\nCode# ?tests\n\n\n\nCodewilcox.test(age~trt,data = trial2)\n#&gt; \n#&gt;  Wilcoxon rank sum test with continuity correction\n#&gt; \n#&gt; data:  age by trt\n#&gt; W = 4323, p-value = 0.7183\n#&gt; alternative hypothesis: true location shift is not equal to 0\ntable(trial2$grade,trial2$trt)|&gt; chisq.test()\n#&gt; \n#&gt;  Pearson's Chi-squared test\n#&gt; \n#&gt; data:  table(trial2$grade, trial2$trt)\n#&gt; X-squared = 0.27673, df = 2, p-value = 0.8708\n\n\n\n\nCodemy_ttest3 &lt;- function(data, variable, by, ...) {\n  t.test(data[[variable]] ~ as.factor(data[[by]])) %&gt;%\n    broom::tidy() %&gt;%\n        mutate(\n            statistic = sprintf(\"%.3f\", statistic),\n            p.value = case_when(\n            p.value &gt;=0.05 ~ sprintf(\"%.3f (ns)\",p.value),\n            p.value &gt;=0.01 ~ sprintf(\"%.3f (*)\",p.value),\n            p.value &gt;=0.001 ~sprintf(\"%.3f (**)\",p.value),\n            p.value &lt;0.001 ~ sprintf(\"%.3f (***)\",p.value),\n            )\n        ) %&gt;% \n    select(statistic, p.value)\n}\n\ntrial |&gt;\n  tbl_summary(\n    by = trt,\n    include = c(trt, age, marker),\n    missing = \"ifany\"\n  ) |&gt;\n  add_stat(fns = everything() ~ my_ttest3) %&gt;% \n  modify_header(statistic = \"**t-statistic**\", p.value = \"**p-value**\") \n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nDrug A\nN = 981\n\n\nDrug B\nN = 1021\n\nt-statistic\np-value\n\n\n\nAge\n46 (37, 60)\n48 (39, 56)\n-0.209\n0.834 (ns)\n\n\n    Unknown\n7\n4\n\n\n\n\nMarker Level (ng/mL)\n0.84 (0.23, 1.60)\n0.52 (0.18, 1.21)\n1.578\n0.116 (ns)\n\n\n    Unknown\n6\n4\n\n\n\n\n\n\n1 Median (Q1, Q3)\n\n\n\n\n\n\n\nCodemean_ci &lt;- function(data, variable, ...) {\n  test &lt;- t.test(data[[variable]])\n  dplyr::tibble(\n    mean = test$estimate,\n    conf.low = test$conf.int[1],\n    conf.high = test$conf.int[2]\n  )\n}\n\ntrial |&gt;\n  tbl_custom_summary(\n    include = c(\"marker\", \"ttdeath\"),\n    by = \"trt\",\n    stat_fns = ~ mean_ci,\n    statistic = ~ \"{mean} [{conf.low}; {conf.high}]\"\n  ) |&gt;\n  add_overall(last = TRUE) |&gt;\n  modify_footnote(\n    all_stat_cols() ~ \"mean [95% CI]\"\n  )\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nDrug A\nN = 981\n\n\nDrug B\nN = 1021\n\n\nOverall\nN = 2001\n\n\n\n\nMarker Level (ng/mL)\n1.02 [0.83; 1.20]\n0.82 [0.65; 0.99]\n0.92 [0.79; 1.04]\n\n\n    Unknown\n6\n4\n10\n\n\nMonths to Death/Censor\n20.2 [19.2; 21.2]\n19.0 [18.0; 20.1]\n19.6 [18.9; 20.4]\n\n\n\n\n1 mean [95% CI]",
    "crumbs": [
      "表格",
      "gtsummary"
    ]
  },
  {
    "objectID": "gtsummary.html#主题",
    "href": "gtsummary.html#主题",
    "title": "\n1 gtsummary",
    "section": "",
    "text": "Codetheme_gtsummary_journal(journal = \"jama\")\n#&gt; Setting theme \"JAMA\"\n\ntrial %&gt;%\n  select(trt, age, grade) %&gt;%\n  tbl_summary(by = trt) %&gt;%\n  add_p()\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nDrug A\nN = 98\n\nDrug B\nN = 102\n\np-value1\n\n\n\n\nAge, Median (IQR)\n46 (37 – 60)\n48 (39 – 56)\n0.72\n\n\n    Unknown\n7\n4\n\n\n\nGrade, n (%)\n\n\n0.87\n\n\n    I\n35 (36)\n33 (32)\n\n\n\n    II\n32 (33)\n36 (35)\n\n\n\n    III\n31 (32)\n33 (32)\n\n\n\n\n\n1 Wilcoxon rank sum test; Pearson’s Chi-squared test\n\n\n\n\nCode\n\n#  清除所有先前设置的主题\nreset_gtsummary_theme()",
    "crumbs": [
      "表格",
      "gtsummary"
    ]
  },
  {
    "objectID": "gtsummary.html#gt",
    "href": "gtsummary.html#gt",
    "title": "\n1 gtsummary",
    "section": "",
    "text": "Codelibrary(gt)\n#&gt; Warning: package 'gt' was built under R version 4.5.2\ntab &lt;- mtcars |&gt;\n  rownames_to_column() |&gt;\n  arrange(factor(cyl), mpg) |&gt;\n  group_by(cyl) |&gt;\n  slice(1:3) |&gt;\n  gt()\ntab\n\n\n\n\n\n\nmpg\ndisp\nhp\ndrat\nwt\nqsec\nvs\nam\ngear\ncarb\n\n\n\n4\n\n\nVolvo 142E\n21.4\n121.0\n109\n4.11\n2.780\n18.60\n1\n1\n4\n2\n\n\nToyota Corona\n21.5\n120.1\n97\n3.70\n2.465\n20.01\n1\n0\n3\n1\n\n\nDatsun 710\n22.8\n108.0\n93\n3.85\n2.320\n18.61\n1\n1\n4\n1\n\n\n6\n\n\nMerc 280C\n17.8\n167.6\n123\n3.92\n3.440\n18.90\n1\n0\n4\n4\n\n\nValiant\n18.1\n225.0\n105\n2.76\n3.460\n20.22\n1\n0\n3\n1\n\n\nMerc 280\n19.2\n167.6\n123\n3.92\n3.440\n18.30\n1\n0\n4\n4\n\n\n8\n\n\nCadillac Fleetwood\n10.4\n472.0\n205\n2.93\n5.250\n17.98\n0\n0\n3\n4\n\n\nLincoln Continental\n10.4\n460.0\n215\n3.00\n5.424\n17.82\n0\n0\n3\n4\n\n\nCamaro Z28\n13.3\n350.0\n245\n3.73\n3.840\n15.41\n0\n0\n3\n4\n\n\n\n\n\n\n\nCodetab &lt;- tab |&gt;\n  tab_spanner(\n    label = \"Performance\",\n    columns = c(mpg, disp, hp, drat, wt, qsec)\n  )\n\ntab &lt;- tab |&gt;\n  tab_spanner(\n    label = \"Specs\",\n    columns = c(vs, am, gear, carb)\n  )\ntab \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPerformance\n\n\nSpecs\n\n\n\nmpg\ndisp\nhp\ndrat\nwt\nqsec\nvs\nam\ngear\ncarb\n\n\n\n\n4\n\n\nVolvo 142E\n21.4\n121.0\n109\n4.11\n2.780\n18.60\n1\n1\n4\n2\n\n\nToyota Corona\n21.5\n120.1\n97\n3.70\n2.465\n20.01\n1\n0\n3\n1\n\n\nDatsun 710\n22.8\n108.0\n93\n3.85\n2.320\n18.61\n1\n1\n4\n1\n\n\n6\n\n\nMerc 280C\n17.8\n167.6\n123\n3.92\n3.440\n18.90\n1\n0\n4\n4\n\n\nValiant\n18.1\n225.0\n105\n2.76\n3.460\n20.22\n1\n0\n3\n1\n\n\nMerc 280\n19.2\n167.6\n123\n3.92\n3.440\n18.30\n1\n0\n4\n4\n\n\n8\n\n\nCadillac Fleetwood\n10.4\n472.0\n205\n2.93\n5.250\n17.98\n0\n0\n3\n4\n\n\nLincoln Continental\n10.4\n460.0\n215\n3.00\n5.424\n17.82\n0\n0\n3\n4\n\n\nCamaro Z28\n13.3\n350.0\n245\n3.73\n3.840\n15.41\n0\n0\n3\n4\n\n\n\n\n\n\n\nCodetab &lt;- tab |&gt;\n  tab_header(\n    title = md(\"The Cars of **mtcars**\"),\n    subtitle = \"These are some fine automobiles\"\n  )\ntab\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe Cars of mtcars\n\n\n\nThese are some fine automobiles\n\n\n\n\nPerformance\n\n\nSpecs\n\n\n\nmpg\ndisp\nhp\ndrat\nwt\nqsec\nvs\nam\ngear\ncarb\n\n\n\n\n4\n\n\nVolvo 142E\n21.4\n121.0\n109\n4.11\n2.780\n18.60\n1\n1\n4\n2\n\n\nToyota Corona\n21.5\n120.1\n97\n3.70\n2.465\n20.01\n1\n0\n3\n1\n\n\nDatsun 710\n22.8\n108.0\n93\n3.85\n2.320\n18.61\n1\n1\n4\n1\n\n\n6\n\n\nMerc 280C\n17.8\n167.6\n123\n3.92\n3.440\n18.90\n1\n0\n4\n4\n\n\nValiant\n18.1\n225.0\n105\n2.76\n3.460\n20.22\n1\n0\n3\n1\n\n\nMerc 280\n19.2\n167.6\n123\n3.92\n3.440\n18.30\n1\n0\n4\n4\n\n\n8\n\n\nCadillac Fleetwood\n10.4\n472.0\n205\n2.93\n5.250\n17.98\n0\n0\n3\n4\n\n\nLincoln Continental\n10.4\n460.0\n215\n3.00\n5.424\n17.82\n0\n0\n3\n4\n\n\nCamaro Z28\n13.3\n350.0\n245\n3.73\n3.840\n15.41\n0\n0\n3\n4",
    "crumbs": [
      "表格",
      "gtsummary"
    ]
  },
  {
    "objectID": "条形图.html",
    "href": "条形图.html",
    "title": "\n1 条形图",
    "section": "",
    "text": "Codelibrary(tidyverse)\n#&gt; Warning: package 'purrr' was built under R version 4.5.2\n#&gt; Warning: package 'stringr' was built under R version 4.5.2\n#&gt; Warning: package 'forcats' was built under R version 4.5.2\n#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.6\n#&gt; ✔ forcats   1.0.1     ✔ stringr   1.6.0\n#&gt; ✔ ggplot2   4.0.1     ✔ tibble    3.3.0\n#&gt; ✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n#&gt; ✔ purrr     1.2.0     \n#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#&gt; ✖ dplyr::filter() masks stats::filter()\n#&gt; ✖ dplyr::lag()    masks stats::lag()\n#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\nlibrary(ggpubr)\n#&gt; Warning: package 'ggpubr' was built under R version 4.5.2\nlibrary(ggthemes)\nlibrary(patchwork)\n#&gt; Warning: package 'patchwork' was built under R version 4.5.2\n\n\n\n\nCodedf &lt;- ToothGrowth |&gt; rownames_to_column(\"id\")\nggplot(df,aes(dose,len,color=factor(dose)))+\n    geom_col(fill=NA)\n\n\n\n\n\n\n\n\n\nCodeggplot(df,aes(id,len))+\n    geom_col()+\n   ggrepel::geom_text_repel(aes(y=len+3,label=len))\n\n\n\n\n\n\n\n\n\nCodedf &lt;- ToothGrowth |&gt; rownames_to_column(\"id\")\nggplot(df, aes(x=supp, y=len, fill = factor(dose)))+\n  stat_summary(fun=\"mean\", geom=\"bar\",position = position_dodge(1))+\n  stat_summary(fun.data=\"mean_sd\", geom=\"errorbar\", width=0.25,position = position_dodge(1))+\n  theme_tufte(base_size=16, base_family=\"sans\", ticks=FALSE)+\n  labs(x=\"Group\", y=\"Values\", caption=\"Error Bars Indicate Standard Error\")\n\n\n\n\n\n\n\n\n\nCodelibrary(ggsignif)\nggplot(data = PlantGrowth, aes(x = group, y = weight)) +\n  geom_boxplot(width = 0.25) +\n  geom_jitter(width = 0.15) +\n  geom_signif(comparisons = list(c(\"ctrl\", \"trt1\"), c(\"trt1\", \"trt2\")), \n              map_signif_level = function(p) sprintf(\"p = %.3g\", p), \n              textsize = 6, test = \"t.test\") +\n    ylim(c(NA,7))+\n  theme_classic() +\n  coord_cartesian(clip = \"off\")\n\n\n\n\n\n\n\n\n\nCodeggplot(mpg, aes(x = drv, y = hwy, fill = as.factor(cyl))) +  \n    geom_bar(stat = \"summary\",fun=mean, position = position_dodge(1)) +\n    stat_summary(fun.data = 'mean_sd',geom=\"errorbar\",position = position_dodge(1),\n                 width=.2,linewidth=1)+\n    geom_point(position = position_dodge(1), \n              size = 3,alpha=0.3\n             )  \n\n\n\n\n\n\n\n\nCodedf &lt;- ToothGrowth\nggplot(df, aes(x = supp, y = len)) +\n    geom_bar(\n        aes(fill = factor(dose)),\n        stat = \"summary\",\n        fun = mean,\n        position = position_dodge(width = 0.9)\n    ) +\n    geom_point(position = position_jitterdodge(jitter.width = 0.1),\n               aes(color = factor(dose)),\n               alpha = 0.7)+\n    scale_color_manual(values = c(\"red\",\"green\",\"blue\"))|\n    ggplot(df, aes(x = supp, y = len)) +\n    geom_bar(\n        aes(fill = factor(dose)),\n        stat = \"summary\",\n        fun = mean,\n        position = position_dodge(width = 0.9)\n    ) +\n    geom_dotplot(position = position_dodge(width = 0.9),\n               aes(fill = factor(dose)),dotsize = 0.8,\n               binaxis = \"y\", stackdir = \"center\",color=\"black\",\n               alpha = 0.7)+\n    scale_fill_manual(values = c(\"red\",\"green\",\"blue\"))\n#&gt; Bin width defaults to 1/30 of the range of the data. Pick better value with\n#&gt; `binwidth`.\n\n\n\n\n\n\n\n\n\nCodelibrary(tidyverse)\nlibrary(ggpubr)\nlibrary(ggsci)\n#&gt; Warning: package 'ggsci' was built under R version 4.5.2\nlibrary(readxl)\nc &lt;- read_excel(\"data/01source.xlsx\",sheet=1,range = \"A2:D16\") |&gt; \n  rename(\n    LR_DPVB=`LR-DPVB`\n  )  |&gt; \n  pivot_longer(\n    cols = CON:LR_DPVB,\n    names_to = \"treatment\",\n    values_to = \"changerate\"\n  ) |&gt; \n  mutate(\n    treatment=factor(treatment,levels=c('CON','LDRT','DPVB','LR_DPVB')),\n    changerate=if_else(changerate&gt;=1,100,changerate*100)\n  ) |&gt; \n  arrange(treatment)|&gt;\n  drop_na() |&gt; \n  mutate(\n    id=1:52\n    ) \n\n\n\nCode\nggplot( c ,aes(x=id,y=changerate,fill=treatment))+ \n  geom_bar(stat = \"identity\",position = \"dodge\",width =0.8)+\n    scale_fill_jco()+\n    scale_y_continuous(name = \"MRI tumor volume change from baseline (%)\",\n                       limits = c(-100,100),\n                       breaks = seq(-100,100,50),\n                       )+\n    theme_pubr()+\n    theme(\n        legend.position = c(0.8,0.8),\n        legend.title = element_blank(),\n        axis.title.x = element_blank(),\n        axis.text.x = element_blank(),\n        axis.ticks.x = element_blank(),\n        axis.line.x = element_blank(),\n        plot.title = element_text(hjust = 0.5),\n    )+\n    ggtitle(\"Hepa1-6 tumor\")+\n    geom_hline(yintercept = 0,color = \"black\",linetype =1,linewidth=0.8)+\n    geom_hline(yintercept=c(20,-30), colour=\"gray15\", linetype=3,linewidth=0.8)+                # 0 = blank, 1 = solid, 2 = dashed, 3 = dotted, \n            # 4 = dotdash, 5 = longdash, 6 = twodash\n    annotate(geom = \"text\",x=c(2,50),y=c(-30,20),\n             label = c(\"PR:-30%\",\"PD:20%\"),\n             vjust = -0.5,\n             )   \n\n\n\n\n\n\n\n\nCode\nlibrary(ggplot2)\nlibrary(rstatix)\n#&gt; Warning: package 'rstatix' was built under R version 4.5.2\n#&gt; \n#&gt; Attaching package: 'rstatix'\n#&gt; The following object is masked from 'package:stats':\n#&gt; \n#&gt;     filter\nlibrary(ggpubr)\n# sample data\nplot_df &lt;- ToothGrowth\n\n# Summarize the data\nsummary_df &lt;- plot_df %&gt;%\n  group_by(dose, supp) %&gt;%\n  summarise(\n    Mean = mean(len),\n    SD = sd(len),\n    SE = sd(len) / sqrt(n())  # Standard Error\n  )\n#&gt; `summarise()` has grouped output by 'dose'. You can override using the\n#&gt; `.groups` argument.\n\n# p values for supp between dose\np_sup &lt;- plot_df %&gt;%\n  group_by(supp) %&gt;%\n  t_test(len ~ dose, p.adjust.method = \"fdr\")\n\np_sup &lt;- p_sup %&gt;% \n  add_xy_position(x = \"dose\", group = \"supp\")\n\n# Group the data by dose and then compare the levels of the supps variable\np_dose &lt;- plot_df %&gt;%\n  group_by(dose) %&gt;%\n  t_test(len ~ supp) %&gt;%\n  adjust_pvalue(method = \"fdr\") %&gt;%\n  add_significance(\"p.adj\")\np_dose\n#&gt; # A tibble: 3 × 11\n#&gt;    dose .y.   group1 group2    n1    n2 statistic    df       p   p.adj\n#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n#&gt; 1   0.5 len   OJ     VC        10    10    3.17    15.0 0.00636 0.00954\n#&gt; 2   1   len   OJ     VC        10    10    4.03    15.4 0.00104 0.00312\n#&gt; 3   2   len   OJ     VC        10    10   -0.0461  14.0 0.964   0.964  \n#&gt; # ℹ 1 more variable: p.adj.signif &lt;chr&gt;\n\n# Add p-values onto the box plots\np_dose &lt;- p_dose %&gt;%\n  add_xy_position(x = \"dose\")\n\n# change dose to character\nsummary_df$dose &lt;- as.character(summary_df$dose)\n\n\n\n\nggplot(summary_df, aes(x = dose, y = Mean, fill = supp)) +\n  geom_bar(stat = \"identity\", color = \"black\", position = position_dodge()) +\n  geom_errorbar(aes(ymin = Mean - SE, ymax = Mean + SE), width = 0.2, position = position_dodge(.9)) +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#999999\", \"#E69F00\"),\n    aesthetics = c(\"color\", \"fill\")\n  ) +\n  labs(\n    title = \"ToothGrowth\",\n    x = \"dose\",\n    y = \"len ± SE\"\n  ) +\n  theme(\n    plot.title = element_text(hjust = 0.5)\n  ) +\n  stat_pvalue_manual(\n    p_sup,\n    tip.length = 0.01,\n    hide.ns = F,\n    color = \"supp\"\n  ) +\n  stat_pvalue_manual(\n    p_dose,\n    tip.length = 0.01,\n    hide.ns = F,\n    inherit.aes = FALSE\n  )\n\n\n\n\n\n\n\n\n\nggpubr\n\nCodeg&lt;-read_excel(\"data/01source.xlsx\",sheet=1,range=\"G2:Z3\") \n#&gt; New names:\n#&gt; • `` -&gt; `...2`\n#&gt; • `` -&gt; `...3`\n#&gt; • `` -&gt; `...4`\n#&gt; • `` -&gt; `...5`\n#&gt; • `` -&gt; `...7`\n#&gt; • `` -&gt; `...8`\n#&gt; • `` -&gt; `...9`\n#&gt; • `` -&gt; `...10`\n#&gt; • `` -&gt; `...12`\n#&gt; • `` -&gt; `...13`\n#&gt; • `` -&gt; `...14`\n#&gt; • `` -&gt; `...15`\n#&gt; • `` -&gt; `...17`\n#&gt; • `` -&gt; `...18`\n#&gt; • `` -&gt; `...19`\n#&gt; • `` -&gt; `...20`\ncolnames(g) &lt;- rep(c('CON','LDRT','DPVB','LR_DPVB'),each=5)\ng&lt;- g |&gt;  pivot_longer(\n  cols = everything(),\n  names_to = \"treatment\",\n  values_to = \"liverweight\"\n  )|&gt; \n  mutate(\n    treatment=factor(treatment,levels=c('CON','LDRT','DPVB','LR_DPVB'))\n  )\ng\n#&gt; # A tibble: 20 × 2\n#&gt;    treatment liverweight\n#&gt;    &lt;fct&gt;           &lt;dbl&gt;\n#&gt;  1 CON              1.75\n#&gt;  2 CON              1.8 \n#&gt;  3 CON              2.01\n#&gt;  4 CON              1.52\n#&gt;  5 CON              1.63\n#&gt;  6 LDRT             1.73\n#&gt;  7 LDRT             2.05\n#&gt;  8 LDRT             1.48\n#&gt;  9 LDRT             1.66\n#&gt; 10 LDRT             1.68\n#&gt; 11 DPVB             1.2 \n#&gt; 12 DPVB             1.38\n#&gt; 13 DPVB             1.52\n#&gt; 14 DPVB             1.62\n#&gt; 15 DPVB             1.39\n#&gt; 16 LR_DPVB          1.2 \n#&gt; 17 LR_DPVB          1.23\n#&gt; 18 LR_DPVB          1.13\n#&gt; 19 LR_DPVB          1.03\n#&gt; 20 LR_DPVB          0.89\n\n\n\nCodesource(\"function/calculate_t_tests.R\")\ncalculate_t_tests(g,\"treatment\",\"liverweight\")\n#&gt;                  CON         LDRT        DPVB LR_DPVB\n#&gt; CON               NA           NA          NA      NA\n#&gt; LDRT    0.8639404014           NA          NA      NA\n#&gt; DPVB    0.0193695457 0.0359059495          NA      NA\n#&gt; LR_DPVB 0.0003376202 0.0008265681 0.008820249      NA\n\n\n\n\n\n\n\n\nNote\n\n\n\n函数calculate_t_tests\n\nCode# 定义计算两两组之间t检验的函数\ncalculate_t_tests &lt;- function(data, group_by, value_column) {\n  # data: 数据框\n  # group_by: 组别的列名\n  # value_column: 要比较的数值的列名\n  \n  # 提取唯一的组别\n  groups &lt;- unique(data[[group_by]])\n  \n  # 初始化结果矩阵\n  result_matrix &lt;- matrix(NA, nrow = length(groups), ncol = length(groups),\n                          dimnames = list(groups, groups))\n  \n  # 循环遍历所有可能的组合\n  for (i in 1:(length(groups)-1)) {\n    for (j in (i+1):length(groups)) {\n      # 提取两组数据\n      group1_data &lt;- data[data[[group_by]] == groups[i], value_column]\n      group2_data &lt;- data[data[[group_by]] == groups[j], value_column]\n      \n      # 执行t检验\n      t_test_result &lt;- t.test(group1_data, group2_data)\n      \n      # 提取p值\n      p_value &lt;- t_test_result$p.value\n      \n      # 将p值存入结果矩阵\n      #result_matrix[groups[i], groups[j]] &lt;- p_value\n      result_matrix[groups[j], groups[i]] &lt;- p_value\n    }\n  }\n  \n  # 返回结果矩阵\n  return(result_matrix)\n}\n\n\n\n\n\n\nCodelibrary(ggpubr)\nggbarplot(data = g,\n          x=\"treatment\",y=\"liverweight\",\n          add = c(\"mean_sd\"),\n          fill = \"treatment\",\n          palette = \"jco\",\n          title = \"DEN+CCl4 tumor\",\n          xlab = \"\",\n          ylab='liver weight (g)',\n          legend='none',\n          )+\n  stat_compare_means(\n      #aes(label='p.format'),\n      comparisons = list(c('CON','LDRT'),c(\"DPVB\",'LR_DPVB'), c(\"CON\",\"LR_DPVB\")),\n      method = 't.test',\n      tip.length = c(0,0,0,0,0,0),\n      bracket.size = 1,linewidth=1)+\n\n  theme(plot.title = element_text(hjust = 0.5),\n        axis.text.x = element_text(angle = 45,vjust = 0.5))+\n  geom_dotplot(data = g,\n               mapping=aes(x=treatment,y=liverweight),\n               binaxis = 'y',stackdir = 'center',binwidth = 0.05)\n\n\n\n\n\n\n\n\n\nCodelibrary(ggsignif)\ng |&gt; \n  summarise(\n    n=n(),\n    mean=mean(liverweight),\n    sd=sd(liverweight),\n    .by=treatment\n  ) |&gt; \n    ggplot(aes(treatment,mean,fill=treatment))+\n    geom_bar(stat = \"identity\",width = .7,position = position_dodge())+#条形图\n    geom_errorbar(aes(ymin=mean-sd,ymax=mean+sd),\n                  width=.2,color=\"black\",linewidth=.8)+#误差棒\n    geom_signif(data = g,\n              mapping=aes(x=treatment,y=liverweight),\n              comparisons = list(c('CON','LDRT'),c(\"DPVB\",'LR_DPVB'),\n                                 c(\"CON\",\"LR_DPVB\")),\n              annotations = c(\"p=0.8639\",\"p=0.0088\",\"p=0.00034\"),\n              map_signif_level=F,\n              tip_length=c(0.0,0.0,0.0,0.0,0.0,0.0),\n              y_position=c(2.1,1.8,2.35),size = .8,\n              textsize = 5,\n              test = \"t.test\"\n              )+\n    theme_pubr()+\n    scale_fill_jco()+\n    scale_y_continuous(limits = c(0,2.5))+\n    labs(\n        x='',\n        y='liver weight (g)',\n        title=\"DEN+CCl4 tumor\"\n    )+\n    theme(\n        plot.title = element_text(hjust =0.5 ),\n        legend.position = 'none',\n        axis.text.x = element_text(angle = 45,vjust = .5)\n    )+  \n    geom_dotplot(data = g,\n                 mapping=aes(x=treatment,y=liverweight),\n                 binaxis = 'y',\n                 stackdir = 'center',#居中\n                 fill='black',\n                 binwidth = 0.05)\n#&gt; Warning in geom_signif(data = g, mapping = aes(x = treatment, y = liverweight),\n#&gt; : You have set data and mapping, are you sure that manual = FALSE is correct?\n\n\n\n\n\n\n\n\nhttps://www.datanovia.com/en/blog/tag/ggpubr/\nhttps://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/\n\nCodef2e &lt;- read_excel(\"data/01source.xlsx\", sheet = 3, range = \"A2:M4\")\n#&gt; New names:\n#&gt; • `` -&gt; `...3`\n#&gt; • `` -&gt; `...4`\n#&gt; • `` -&gt; `...6`\n#&gt; • `` -&gt; `...7`\n#&gt; • `` -&gt; `...9`\n#&gt; • `` -&gt; `...10`\n#&gt; • `` -&gt; `...12`\n#&gt; • `` -&gt; `...13`\ncolnames(f2e) &lt;-\n    c(\"type\", rep(c('CON', 'LDRT', 'DPVB', 'LR_DPVB'), each = 3))\n\nf2e |&gt; pivot_longer(cols = -1,\n                    names_to = \"trt\",\n                    values_to = \"pct\",\n) |&gt;\n    mutate(trt = factor(trt, levels = c('CON', 'LDRT', 'DPVB', 'LR_DPVB'))) -&gt; f2e\n\n\n\nCodelibrary(ggpubr)\nlibrary(rstatix)\nstat.test &lt;- f2e %&gt;%\n  group_by(type) %&gt;%\n  t_test(pct ~ trt) |&gt; \n  adjust_pvalue(method = \"bonferroni\") %&gt;%\n    add_significance(\"p.adj\") |&gt; \n    add_significance(\"p\") \n\n\nstat.test &lt;- stat.test %&gt;%\n  add_xy_position(fun = \"mean_sd\", x = \"type\", dodge = 1)|&gt; \n  dplyr::filter(group1==\"CON\"&group2==\"LR_DPVB\")\n\n\ne_left &lt;- ggbarplot(f2e, x = \"type\", y = \"pct\",\n                fill = \"trt\", palette = \"jco\",\n                add =c(\"mean_sd\"), add.params = list(group = \"trt\"),\n                position = position_dodge(1),\n                #legend=\"none\",\n          legend.title=\"\",\n          )+\n    scale_y_continuous(limits = c(0,80))+\n    stat_pvalue_manual(\n        data = stat.test,\n        label = \"p={p}({p.signif})\",\n        tip.length = 0.05,\n        y.position = c(40,75),\n        #bracket.nudge.y = -2,\n)+labs(\n        x='',\n        y='% in live CD45+ cell',\n        #title=\"Hepa1-6 tumor\"\n    )\n\ne_right &lt;- e_left\n\nlibrary(patchwork)\n(e_left + e_right)+\n    plot_annotation(\n        title = \"Hepa1-6 tumor\",\n    ) +\n    plot_layout(guides = \"collect\")& \n    theme(\n        plot.title = element_text(hjust = 0.5),\n        legend.position = \"top\",\n    )\n#&gt; Ignoring unknown labels:\n#&gt; • colour : \"\"\n#&gt; • linetype : \"\"\n#&gt; • shape : \"\"\n#&gt; Ignoring unknown labels:\n#&gt; • colour : \"\"\n#&gt; • linetype : \"\"\n#&gt; • shape : \"\"\n\n\n\n\n\n\n\n\nhttps://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/\n\nCodelibrary(ggpubr)\nlibrary(rstatix)\ndf &lt;- ToothGrowth\ndf$dose &lt;- as.factor(df$dose)\n\n\n\nbp &lt;- ggbarplot(\n    df,\n    x = \"dose\",\n    y = \"len\",\n    add = \"mean_sd\",\n    color = \"supp\",\n    palette = c(\"#00AFBB\", \"#E7B800\"),\n    position = position_dodge(0.8)\n)\n\n\n# 统计检验\nstat.test &lt;- df %&gt;%\n    group_by(dose) %&gt;%\n    t_test(len ~ supp) %&gt;%\n    adjust_pvalue(method = \"bonferroni\") %&gt;%\n    add_significance(\"p.adj\")\nstat.test &lt;- stat.test %&gt;%\n    add_xy_position(fun = \"mean_sd\", x = \"dose\", dodge = 0.8)\n\n\nstat.test2 &lt;- df %&gt;%\n    t_test(len ~ dose, p.adjust.method = \"bonferroni\")\nstat.test2 &lt;- stat.test2 %&gt;%\n    add_xy_position(x = \"dose\")\n\npwc &lt;- df %&gt;%\n    group_by(supp) %&gt;%\n    t_test(len ~ dose, p.adjust.method = \"bonferroni\")\npwc\n#&gt; # A tibble: 6 × 11\n#&gt;   supp  .y.   group1 group2    n1    n2 statistic    df            p      p.adj\n#&gt; * &lt;fct&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;\n#&gt; 1 OJ    len   0.5    1         10    10     -5.05  17.7 0.0000878    0.000263  \n#&gt; 2 OJ    len   0.5    2         10    10     -7.82  14.7 0.00000132   0.00000396\n#&gt; 3 OJ    len   1      2         10    10     -2.25  15.8 0.039        0.118     \n#&gt; 4 VC    len   0.5    1         10    10     -7.46  17.9 0.000000681  0.00000204\n#&gt; 5 VC    len   0.5    2         10    10    -10.4   14.3 0.0000000468 0.00000014\n#&gt; 6 VC    len   1      2         10    10     -5.47  13.6 0.0000916    0.000275  \n#&gt; # ℹ 1 more variable: p.adj.signif &lt;chr&gt;\npwc &lt;- pwc %&gt;%\n    add_xy_position(\n        x = \"dose\",\n        fun = \"mean_sd\",\n        group = \"supp\",\n        dodge = 0.8\n    )\n\n# 组间组内复合\n\n\nbp +\n     stat_pvalue_manual(stat.test,  label = \"p.adj.signif\", tip.length = 0.01) \n\n\n\n\n\n\nCode    # stat_pvalue_manual(\n    #     stat.test2,\n    #     label = \"p\",\n    #     tip.length = 0.02,\n    #     step.increase = 0.05,\n    # ) +\n    # scale_y_continuous(expand = expansion(mult = c(0.05, 0.1))) +\n    # stat_pvalue_manual(\n    #     pwc,\n    #     color = \"supp\",\n    #     step.group.by = \"supp\",\n    #     tip.length = 0,\n    #     step.increase = 0.1,\n    # )",
    "crumbs": [
      "ggplot2 图形",
      "Bin",
      "条形图"
    ]
  },
  {
    "objectID": "条形图.html#修改边框和填充颜色",
    "href": "条形图.html#修改边框和填充颜色",
    "title": "\n1 条形图",
    "section": "",
    "text": "Codedf &lt;- ToothGrowth |&gt; rownames_to_column(\"id\")\nggplot(df,aes(dose,len,color=factor(dose)))+\n    geom_col(fill=NA)",
    "crumbs": [
      "ggplot2 图形",
      "Bin",
      "条形图"
    ]
  },
  {
    "objectID": "条形图.html#添加标签",
    "href": "条形图.html#添加标签",
    "title": "\n1 条形图",
    "section": "",
    "text": "Codeggplot(df,aes(id,len))+\n    geom_col()+\n   ggrepel::geom_text_repel(aes(y=len+3,label=len))",
    "crumbs": [
      "ggplot2 图形",
      "Bin",
      "条形图"
    ]
  },
  {
    "objectID": "条形图.html#添加误差棒",
    "href": "条形图.html#添加误差棒",
    "title": "\n1 条形图",
    "section": "",
    "text": "Codedf &lt;- ToothGrowth |&gt; rownames_to_column(\"id\")\nggplot(df, aes(x=supp, y=len, fill = factor(dose)))+\n  stat_summary(fun=\"mean\", geom=\"bar\",position = position_dodge(1))+\n  stat_summary(fun.data=\"mean_sd\", geom=\"errorbar\", width=0.25,position = position_dodge(1))+\n  theme_tufte(base_size=16, base_family=\"sans\", ticks=FALSE)+\n  labs(x=\"Group\", y=\"Values\", caption=\"Error Bars Indicate Standard Error\")",
    "crumbs": [
      "ggplot2 图形",
      "Bin",
      "条形图"
    ]
  },
  {
    "objectID": "条形图.html#添加显著性",
    "href": "条形图.html#添加显著性",
    "title": "\n1 条形图",
    "section": "",
    "text": "Codelibrary(ggsignif)\nggplot(data = PlantGrowth, aes(x = group, y = weight)) +\n  geom_boxplot(width = 0.25) +\n  geom_jitter(width = 0.15) +\n  geom_signif(comparisons = list(c(\"ctrl\", \"trt1\"), c(\"trt1\", \"trt2\")), \n              map_signif_level = function(p) sprintf(\"p = %.3g\", p), \n              textsize = 6, test = \"t.test\") +\n    ylim(c(NA,7))+\n  theme_classic() +\n  coord_cartesian(clip = \"off\")",
    "crumbs": [
      "ggplot2 图形",
      "Bin",
      "条形图"
    ]
  },
  {
    "objectID": "条形图.html#添加散点抖动点",
    "href": "条形图.html#添加散点抖动点",
    "title": "\n1 条形图",
    "section": "",
    "text": "Codeggplot(mpg, aes(x = drv, y = hwy, fill = as.factor(cyl))) +  \n    geom_bar(stat = \"summary\",fun=mean, position = position_dodge(1)) +\n    stat_summary(fun.data = 'mean_sd',geom=\"errorbar\",position = position_dodge(1),\n                 width=.2,linewidth=1)+\n    geom_point(position = position_dodge(1), \n              size = 3,alpha=0.3\n             )  \n\n\n\n\n\n\n\n\nCodedf &lt;- ToothGrowth\nggplot(df, aes(x = supp, y = len)) +\n    geom_bar(\n        aes(fill = factor(dose)),\n        stat = \"summary\",\n        fun = mean,\n        position = position_dodge(width = 0.9)\n    ) +\n    geom_point(position = position_jitterdodge(jitter.width = 0.1),\n               aes(color = factor(dose)),\n               alpha = 0.7)+\n    scale_color_manual(values = c(\"red\",\"green\",\"blue\"))|\n    ggplot(df, aes(x = supp, y = len)) +\n    geom_bar(\n        aes(fill = factor(dose)),\n        stat = \"summary\",\n        fun = mean,\n        position = position_dodge(width = 0.9)\n    ) +\n    geom_dotplot(position = position_dodge(width = 0.9),\n               aes(fill = factor(dose)),dotsize = 0.8,\n               binaxis = \"y\", stackdir = \"center\",color=\"black\",\n               alpha = 0.7)+\n    scale_fill_manual(values = c(\"red\",\"green\",\"blue\"))\n#&gt; Bin width defaults to 1/30 of the range of the data. Pick better value with\n#&gt; `binwidth`.",
    "crumbs": [
      "ggplot2 图形",
      "Bin",
      "条形图"
    ]
  },
  {
    "objectID": "条形图.html#分组排序条图-waterfall-barplot",
    "href": "条形图.html#分组排序条图-waterfall-barplot",
    "title": "\n1 条形图",
    "section": "",
    "text": "Codelibrary(tidyverse)\nlibrary(ggpubr)\nlibrary(ggsci)\n#&gt; Warning: package 'ggsci' was built under R version 4.5.2\nlibrary(readxl)\nc &lt;- read_excel(\"data/01source.xlsx\",sheet=1,range = \"A2:D16\") |&gt; \n  rename(\n    LR_DPVB=`LR-DPVB`\n  )  |&gt; \n  pivot_longer(\n    cols = CON:LR_DPVB,\n    names_to = \"treatment\",\n    values_to = \"changerate\"\n  ) |&gt; \n  mutate(\n    treatment=factor(treatment,levels=c('CON','LDRT','DPVB','LR_DPVB')),\n    changerate=if_else(changerate&gt;=1,100,changerate*100)\n  ) |&gt; \n  arrange(treatment)|&gt;\n  drop_na() |&gt; \n  mutate(\n    id=1:52\n    ) \n\n\n\nCode\nggplot( c ,aes(x=id,y=changerate,fill=treatment))+ \n  geom_bar(stat = \"identity\",position = \"dodge\",width =0.8)+\n    scale_fill_jco()+\n    scale_y_continuous(name = \"MRI tumor volume change from baseline (%)\",\n                       limits = c(-100,100),\n                       breaks = seq(-100,100,50),\n                       )+\n    theme_pubr()+\n    theme(\n        legend.position = c(0.8,0.8),\n        legend.title = element_blank(),\n        axis.title.x = element_blank(),\n        axis.text.x = element_blank(),\n        axis.ticks.x = element_blank(),\n        axis.line.x = element_blank(),\n        plot.title = element_text(hjust = 0.5),\n    )+\n    ggtitle(\"Hepa1-6 tumor\")+\n    geom_hline(yintercept = 0,color = \"black\",linetype =1,linewidth=0.8)+\n    geom_hline(yintercept=c(20,-30), colour=\"gray15\", linetype=3,linewidth=0.8)+                # 0 = blank, 1 = solid, 2 = dashed, 3 = dotted, \n            # 4 = dotdash, 5 = longdash, 6 = twodash\n    annotate(geom = \"text\",x=c(2,50),y=c(-30,20),\n             label = c(\"PR:-30%\",\"PD:20%\"),\n             vjust = -0.5,\n             )   \n\n\n\n\n\n\n\n\nCode\nlibrary(ggplot2)\nlibrary(rstatix)\n#&gt; Warning: package 'rstatix' was built under R version 4.5.2\n#&gt; \n#&gt; Attaching package: 'rstatix'\n#&gt; The following object is masked from 'package:stats':\n#&gt; \n#&gt;     filter\nlibrary(ggpubr)\n# sample data\nplot_df &lt;- ToothGrowth\n\n# Summarize the data\nsummary_df &lt;- plot_df %&gt;%\n  group_by(dose, supp) %&gt;%\n  summarise(\n    Mean = mean(len),\n    SD = sd(len),\n    SE = sd(len) / sqrt(n())  # Standard Error\n  )\n#&gt; `summarise()` has grouped output by 'dose'. You can override using the\n#&gt; `.groups` argument.\n\n# p values for supp between dose\np_sup &lt;- plot_df %&gt;%\n  group_by(supp) %&gt;%\n  t_test(len ~ dose, p.adjust.method = \"fdr\")\n\np_sup &lt;- p_sup %&gt;% \n  add_xy_position(x = \"dose\", group = \"supp\")\n\n# Group the data by dose and then compare the levels of the supps variable\np_dose &lt;- plot_df %&gt;%\n  group_by(dose) %&gt;%\n  t_test(len ~ supp) %&gt;%\n  adjust_pvalue(method = \"fdr\") %&gt;%\n  add_significance(\"p.adj\")\np_dose\n#&gt; # A tibble: 3 × 11\n#&gt;    dose .y.   group1 group2    n1    n2 statistic    df       p   p.adj\n#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n#&gt; 1   0.5 len   OJ     VC        10    10    3.17    15.0 0.00636 0.00954\n#&gt; 2   1   len   OJ     VC        10    10    4.03    15.4 0.00104 0.00312\n#&gt; 3   2   len   OJ     VC        10    10   -0.0461  14.0 0.964   0.964  \n#&gt; # ℹ 1 more variable: p.adj.signif &lt;chr&gt;\n\n# Add p-values onto the box plots\np_dose &lt;- p_dose %&gt;%\n  add_xy_position(x = \"dose\")\n\n# change dose to character\nsummary_df$dose &lt;- as.character(summary_df$dose)\n\n\n\n\nggplot(summary_df, aes(x = dose, y = Mean, fill = supp)) +\n  geom_bar(stat = \"identity\", color = \"black\", position = position_dodge()) +\n  geom_errorbar(aes(ymin = Mean - SE, ymax = Mean + SE), width = 0.2, position = position_dodge(.9)) +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#999999\", \"#E69F00\"),\n    aesthetics = c(\"color\", \"fill\")\n  ) +\n  labs(\n    title = \"ToothGrowth\",\n    x = \"dose\",\n    y = \"len ± SE\"\n  ) +\n  theme(\n    plot.title = element_text(hjust = 0.5)\n  ) +\n  stat_pvalue_manual(\n    p_sup,\n    tip.length = 0.01,\n    hide.ns = F,\n    color = \"supp\"\n  ) +\n  stat_pvalue_manual(\n    p_dose,\n    tip.length = 0.01,\n    hide.ns = F,\n    inherit.aes = FALSE\n  )",
    "crumbs": [
      "ggplot2 图形",
      "Bin",
      "条形图"
    ]
  },
  {
    "objectID": "条形图.html#复杂条图",
    "href": "条形图.html#复杂条图",
    "title": "\n1 条形图",
    "section": "",
    "text": "ggpubr\n\nCodeg&lt;-read_excel(\"data/01source.xlsx\",sheet=1,range=\"G2:Z3\") \n#&gt; New names:\n#&gt; • `` -&gt; `...2`\n#&gt; • `` -&gt; `...3`\n#&gt; • `` -&gt; `...4`\n#&gt; • `` -&gt; `...5`\n#&gt; • `` -&gt; `...7`\n#&gt; • `` -&gt; `...8`\n#&gt; • `` -&gt; `...9`\n#&gt; • `` -&gt; `...10`\n#&gt; • `` -&gt; `...12`\n#&gt; • `` -&gt; `...13`\n#&gt; • `` -&gt; `...14`\n#&gt; • `` -&gt; `...15`\n#&gt; • `` -&gt; `...17`\n#&gt; • `` -&gt; `...18`\n#&gt; • `` -&gt; `...19`\n#&gt; • `` -&gt; `...20`\ncolnames(g) &lt;- rep(c('CON','LDRT','DPVB','LR_DPVB'),each=5)\ng&lt;- g |&gt;  pivot_longer(\n  cols = everything(),\n  names_to = \"treatment\",\n  values_to = \"liverweight\"\n  )|&gt; \n  mutate(\n    treatment=factor(treatment,levels=c('CON','LDRT','DPVB','LR_DPVB'))\n  )\ng\n#&gt; # A tibble: 20 × 2\n#&gt;    treatment liverweight\n#&gt;    &lt;fct&gt;           &lt;dbl&gt;\n#&gt;  1 CON              1.75\n#&gt;  2 CON              1.8 \n#&gt;  3 CON              2.01\n#&gt;  4 CON              1.52\n#&gt;  5 CON              1.63\n#&gt;  6 LDRT             1.73\n#&gt;  7 LDRT             2.05\n#&gt;  8 LDRT             1.48\n#&gt;  9 LDRT             1.66\n#&gt; 10 LDRT             1.68\n#&gt; 11 DPVB             1.2 \n#&gt; 12 DPVB             1.38\n#&gt; 13 DPVB             1.52\n#&gt; 14 DPVB             1.62\n#&gt; 15 DPVB             1.39\n#&gt; 16 LR_DPVB          1.2 \n#&gt; 17 LR_DPVB          1.23\n#&gt; 18 LR_DPVB          1.13\n#&gt; 19 LR_DPVB          1.03\n#&gt; 20 LR_DPVB          0.89\n\n\n\nCodesource(\"function/calculate_t_tests.R\")\ncalculate_t_tests(g,\"treatment\",\"liverweight\")\n#&gt;                  CON         LDRT        DPVB LR_DPVB\n#&gt; CON               NA           NA          NA      NA\n#&gt; LDRT    0.8639404014           NA          NA      NA\n#&gt; DPVB    0.0193695457 0.0359059495          NA      NA\n#&gt; LR_DPVB 0.0003376202 0.0008265681 0.008820249      NA\n\n\n\n\n\n\n\n\nNote\n\n\n\n函数calculate_t_tests\n\nCode# 定义计算两两组之间t检验的函数\ncalculate_t_tests &lt;- function(data, group_by, value_column) {\n  # data: 数据框\n  # group_by: 组别的列名\n  # value_column: 要比较的数值的列名\n  \n  # 提取唯一的组别\n  groups &lt;- unique(data[[group_by]])\n  \n  # 初始化结果矩阵\n  result_matrix &lt;- matrix(NA, nrow = length(groups), ncol = length(groups),\n                          dimnames = list(groups, groups))\n  \n  # 循环遍历所有可能的组合\n  for (i in 1:(length(groups)-1)) {\n    for (j in (i+1):length(groups)) {\n      # 提取两组数据\n      group1_data &lt;- data[data[[group_by]] == groups[i], value_column]\n      group2_data &lt;- data[data[[group_by]] == groups[j], value_column]\n      \n      # 执行t检验\n      t_test_result &lt;- t.test(group1_data, group2_data)\n      \n      # 提取p值\n      p_value &lt;- t_test_result$p.value\n      \n      # 将p值存入结果矩阵\n      #result_matrix[groups[i], groups[j]] &lt;- p_value\n      result_matrix[groups[j], groups[i]] &lt;- p_value\n    }\n  }\n  \n  # 返回结果矩阵\n  return(result_matrix)\n}\n\n\n\n\n\n\nCodelibrary(ggpubr)\nggbarplot(data = g,\n          x=\"treatment\",y=\"liverweight\",\n          add = c(\"mean_sd\"),\n          fill = \"treatment\",\n          palette = \"jco\",\n          title = \"DEN+CCl4 tumor\",\n          xlab = \"\",\n          ylab='liver weight (g)',\n          legend='none',\n          )+\n  stat_compare_means(\n      #aes(label='p.format'),\n      comparisons = list(c('CON','LDRT'),c(\"DPVB\",'LR_DPVB'), c(\"CON\",\"LR_DPVB\")),\n      method = 't.test',\n      tip.length = c(0,0,0,0,0,0),\n      bracket.size = 1,linewidth=1)+\n\n  theme(plot.title = element_text(hjust = 0.5),\n        axis.text.x = element_text(angle = 45,vjust = 0.5))+\n  geom_dotplot(data = g,\n               mapping=aes(x=treatment,y=liverweight),\n               binaxis = 'y',stackdir = 'center',binwidth = 0.05)\n\n\n\n\n\n\n\n\n\nCodelibrary(ggsignif)\ng |&gt; \n  summarise(\n    n=n(),\n    mean=mean(liverweight),\n    sd=sd(liverweight),\n    .by=treatment\n  ) |&gt; \n    ggplot(aes(treatment,mean,fill=treatment))+\n    geom_bar(stat = \"identity\",width = .7,position = position_dodge())+#条形图\n    geom_errorbar(aes(ymin=mean-sd,ymax=mean+sd),\n                  width=.2,color=\"black\",linewidth=.8)+#误差棒\n    geom_signif(data = g,\n              mapping=aes(x=treatment,y=liverweight),\n              comparisons = list(c('CON','LDRT'),c(\"DPVB\",'LR_DPVB'),\n                                 c(\"CON\",\"LR_DPVB\")),\n              annotations = c(\"p=0.8639\",\"p=0.0088\",\"p=0.00034\"),\n              map_signif_level=F,\n              tip_length=c(0.0,0.0,0.0,0.0,0.0,0.0),\n              y_position=c(2.1,1.8,2.35),size = .8,\n              textsize = 5,\n              test = \"t.test\"\n              )+\n    theme_pubr()+\n    scale_fill_jco()+\n    scale_y_continuous(limits = c(0,2.5))+\n    labs(\n        x='',\n        y='liver weight (g)',\n        title=\"DEN+CCl4 tumor\"\n    )+\n    theme(\n        plot.title = element_text(hjust =0.5 ),\n        legend.position = 'none',\n        axis.text.x = element_text(angle = 45,vjust = .5)\n    )+  \n    geom_dotplot(data = g,\n                 mapping=aes(x=treatment,y=liverweight),\n                 binaxis = 'y',\n                 stackdir = 'center',#居中\n                 fill='black',\n                 binwidth = 0.05)\n#&gt; Warning in geom_signif(data = g, mapping = aes(x = treatment, y = liverweight),\n#&gt; : You have set data and mapping, are you sure that manual = FALSE is correct?\n\n\n\n\n\n\n\n\nhttps://www.datanovia.com/en/blog/tag/ggpubr/\nhttps://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/\n\nCodef2e &lt;- read_excel(\"data/01source.xlsx\", sheet = 3, range = \"A2:M4\")\n#&gt; New names:\n#&gt; • `` -&gt; `...3`\n#&gt; • `` -&gt; `...4`\n#&gt; • `` -&gt; `...6`\n#&gt; • `` -&gt; `...7`\n#&gt; • `` -&gt; `...9`\n#&gt; • `` -&gt; `...10`\n#&gt; • `` -&gt; `...12`\n#&gt; • `` -&gt; `...13`\ncolnames(f2e) &lt;-\n    c(\"type\", rep(c('CON', 'LDRT', 'DPVB', 'LR_DPVB'), each = 3))\n\nf2e |&gt; pivot_longer(cols = -1,\n                    names_to = \"trt\",\n                    values_to = \"pct\",\n) |&gt;\n    mutate(trt = factor(trt, levels = c('CON', 'LDRT', 'DPVB', 'LR_DPVB'))) -&gt; f2e\n\n\n\nCodelibrary(ggpubr)\nlibrary(rstatix)\nstat.test &lt;- f2e %&gt;%\n  group_by(type) %&gt;%\n  t_test(pct ~ trt) |&gt; \n  adjust_pvalue(method = \"bonferroni\") %&gt;%\n    add_significance(\"p.adj\") |&gt; \n    add_significance(\"p\") \n\n\nstat.test &lt;- stat.test %&gt;%\n  add_xy_position(fun = \"mean_sd\", x = \"type\", dodge = 1)|&gt; \n  dplyr::filter(group1==\"CON\"&group2==\"LR_DPVB\")\n\n\ne_left &lt;- ggbarplot(f2e, x = \"type\", y = \"pct\",\n                fill = \"trt\", palette = \"jco\",\n                add =c(\"mean_sd\"), add.params = list(group = \"trt\"),\n                position = position_dodge(1),\n                #legend=\"none\",\n          legend.title=\"\",\n          )+\n    scale_y_continuous(limits = c(0,80))+\n    stat_pvalue_manual(\n        data = stat.test,\n        label = \"p={p}({p.signif})\",\n        tip.length = 0.05,\n        y.position = c(40,75),\n        #bracket.nudge.y = -2,\n)+labs(\n        x='',\n        y='% in live CD45+ cell',\n        #title=\"Hepa1-6 tumor\"\n    )\n\ne_right &lt;- e_left\n\nlibrary(patchwork)\n(e_left + e_right)+\n    plot_annotation(\n        title = \"Hepa1-6 tumor\",\n    ) +\n    plot_layout(guides = \"collect\")& \n    theme(\n        plot.title = element_text(hjust = 0.5),\n        legend.position = \"top\",\n    )\n#&gt; Ignoring unknown labels:\n#&gt; • colour : \"\"\n#&gt; • linetype : \"\"\n#&gt; • shape : \"\"\n#&gt; Ignoring unknown labels:\n#&gt; • colour : \"\"\n#&gt; • linetype : \"\"\n#&gt; • shape : \"\"\n\n\n\n\n\n\n\n\nhttps://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/\n\nCodelibrary(ggpubr)\nlibrary(rstatix)\ndf &lt;- ToothGrowth\ndf$dose &lt;- as.factor(df$dose)\n\n\n\nbp &lt;- ggbarplot(\n    df,\n    x = \"dose\",\n    y = \"len\",\n    add = \"mean_sd\",\n    color = \"supp\",\n    palette = c(\"#00AFBB\", \"#E7B800\"),\n    position = position_dodge(0.8)\n)\n\n\n# 统计检验\nstat.test &lt;- df %&gt;%\n    group_by(dose) %&gt;%\n    t_test(len ~ supp) %&gt;%\n    adjust_pvalue(method = \"bonferroni\") %&gt;%\n    add_significance(\"p.adj\")\nstat.test &lt;- stat.test %&gt;%\n    add_xy_position(fun = \"mean_sd\", x = \"dose\", dodge = 0.8)\n\n\nstat.test2 &lt;- df %&gt;%\n    t_test(len ~ dose, p.adjust.method = \"bonferroni\")\nstat.test2 &lt;- stat.test2 %&gt;%\n    add_xy_position(x = \"dose\")\n\npwc &lt;- df %&gt;%\n    group_by(supp) %&gt;%\n    t_test(len ~ dose, p.adjust.method = \"bonferroni\")\npwc\n#&gt; # A tibble: 6 × 11\n#&gt;   supp  .y.   group1 group2    n1    n2 statistic    df            p      p.adj\n#&gt; * &lt;fct&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;\n#&gt; 1 OJ    len   0.5    1         10    10     -5.05  17.7 0.0000878    0.000263  \n#&gt; 2 OJ    len   0.5    2         10    10     -7.82  14.7 0.00000132   0.00000396\n#&gt; 3 OJ    len   1      2         10    10     -2.25  15.8 0.039        0.118     \n#&gt; 4 VC    len   0.5    1         10    10     -7.46  17.9 0.000000681  0.00000204\n#&gt; 5 VC    len   0.5    2         10    10    -10.4   14.3 0.0000000468 0.00000014\n#&gt; 6 VC    len   1      2         10    10     -5.47  13.6 0.0000916    0.000275  \n#&gt; # ℹ 1 more variable: p.adj.signif &lt;chr&gt;\npwc &lt;- pwc %&gt;%\n    add_xy_position(\n        x = \"dose\",\n        fun = \"mean_sd\",\n        group = \"supp\",\n        dodge = 0.8\n    )\n\n# 组间组内复合\n\n\nbp +\n     stat_pvalue_manual(stat.test,  label = \"p.adj.signif\", tip.length = 0.01) \n\n\n\n\n\n\nCode    # stat_pvalue_manual(\n    #     stat.test2,\n    #     label = \"p\",\n    #     tip.length = 0.02,\n    #     step.increase = 0.05,\n    # ) +\n    # scale_y_continuous(expand = expansion(mult = c(0.05, 0.1))) +\n    # stat_pvalue_manual(\n    #     pwc,\n    #     color = \"supp\",\n    #     step.group.by = \"supp\",\n    #     tip.length = 0,\n    #     step.increase = 0.1,\n    # )",
    "crumbs": [
      "ggplot2 图形",
      "Bin",
      "条形图"
    ]
  },
  {
    "objectID": "点图.html",
    "href": "点图.html",
    "title": "\n1 点图",
    "section": "",
    "text": "Codelibrary(tidyverse)\n#&gt; Warning: package 'purrr' was built under R version 4.5.2\n#&gt; Warning: package 'stringr' was built under R version 4.5.2\n#&gt; Warning: package 'forcats' was built under R version 4.5.2\n#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.6\n#&gt; ✔ forcats   1.0.1     ✔ stringr   1.6.0\n#&gt; ✔ ggplot2   4.0.1     ✔ tibble    3.3.0\n#&gt; ✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n#&gt; ✔ purrr     1.2.0     \n#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#&gt; ✖ dplyr::filter() masks stats::filter()\n#&gt; ✖ dplyr::lag()    masks stats::lag()\n#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\nToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)\np &lt;- ggplot(data = ToothGrowth, aes(x=dose, y=len)) + \n    geom_point()\np\n\n\n\n\n\n\n\n\n\nCleveland 点图\nStrip Plot 带状点图\n\n\n\nCode\n# 点图\np1 &lt;- ggplot(ToothGrowth, aes(x=dose, y=len)) + \n  geom_dotplot(binaxis='y', binwidth = 0.4,stackdir='center',\n               stackratio=1.5, dotsize=1.2)\n\n\np2&lt;- p1 + stat_summary(fun=median, geom=\"point\", shape=18,\n                 size=3, color=\"red\")\n\nlibrary(patchwork)\n#&gt; Warning: package 'patchwork' was built under R version 4.5.2\np1+p2\n\n\n\n\n\n\n\n\n\nCodelibrary(ggpubr)\n#&gt; Warning: package 'ggpubr' was built under R version 4.5.2\nlibrary(readxl)\nf6d &lt;-\n    read_excel(\"data/01source.xlsx\", sheet = \"Fig.6\", range = \"D2:E18\")\nf6d |&gt; pivot_longer(\n    cols = everything(),\n    names_to = \"status\",\n    values_to = \"Ratio\",\n) |&gt; \n    tidyr::drop_na() -&gt;f6d\n\n\n\nCodeggdotplot(f6d,\n          x=\"status\",\n          y=\"Ratio\",\n          add =c(\"mean_sd\"),\n          color = \"status\",\n          fill = \"status\",\n          error.plot = \"errorbar\",\n          binwidth = 0.2\n)+\n    geom_signif(\n        comparisons = list(c(\"relapse\",\"non-relapse\")),\n    )+\n    \n    stat_summary(\n        fun.data = \"mean_sd\",geom = \"pointrange\",linewidth=.3\n    )+\n    ggplot2::annotate(\n        geom=\"segment\",\n        x=0.9,\n        xend=1.1,\n        y=2.42019873,#均值\n    )+\n    ggplot2::annotate(\n        geom=\"segment\",\n        x=1.9,\n        xend=2.1,\n        y=0.789463173,#均值\n    )\n\n\n\n\n\n\n\n\nBeeswarm plots\n\nCode# library(ggbeeswarm)"
  },
  {
    "objectID": "点图.html#散点图-scatterplot",
    "href": "点图.html#散点图-scatterplot",
    "title": "\n1 点图",
    "section": "",
    "text": "Codelibrary(tidyverse)\n#&gt; Warning: package 'purrr' was built under R version 4.5.2\n#&gt; Warning: package 'stringr' was built under R version 4.5.2\n#&gt; Warning: package 'forcats' was built under R version 4.5.2\n#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.6\n#&gt; ✔ forcats   1.0.1     ✔ stringr   1.6.0\n#&gt; ✔ ggplot2   4.0.1     ✔ tibble    3.3.0\n#&gt; ✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n#&gt; ✔ purrr     1.2.0     \n#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#&gt; ✖ dplyr::filter() masks stats::filter()\n#&gt; ✖ dplyr::lag()    masks stats::lag()\n#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\nToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)\np &lt;- ggplot(data = ToothGrowth, aes(x=dose, y=len)) + \n    geom_point()\np"
  },
  {
    "objectID": "点图.html#dotplot",
    "href": "点图.html#dotplot",
    "title": "\n1 点图",
    "section": "",
    "text": "Cleveland 点图\nStrip Plot 带状点图\n\n\n\nCode\n# 点图\np1 &lt;- ggplot(ToothGrowth, aes(x=dose, y=len)) + \n  geom_dotplot(binaxis='y', binwidth = 0.4,stackdir='center',\n               stackratio=1.5, dotsize=1.2)\n\n\np2&lt;- p1 + stat_summary(fun=median, geom=\"point\", shape=18,\n                 size=3, color=\"red\")\n\nlibrary(patchwork)\n#&gt; Warning: package 'patchwork' was built under R version 4.5.2\np1+p2\n\n\n\n\n\n\n\n\n\nCodelibrary(ggpubr)\n#&gt; Warning: package 'ggpubr' was built under R version 4.5.2\nlibrary(readxl)\nf6d &lt;-\n    read_excel(\"data/01source.xlsx\", sheet = \"Fig.6\", range = \"D2:E18\")\nf6d |&gt; pivot_longer(\n    cols = everything(),\n    names_to = \"status\",\n    values_to = \"Ratio\",\n) |&gt; \n    tidyr::drop_na() -&gt;f6d\n\n\n\nCodeggdotplot(f6d,\n          x=\"status\",\n          y=\"Ratio\",\n          add =c(\"mean_sd\"),\n          color = \"status\",\n          fill = \"status\",\n          error.plot = \"errorbar\",\n          binwidth = 0.2\n)+\n    geom_signif(\n        comparisons = list(c(\"relapse\",\"non-relapse\")),\n    )+\n    \n    stat_summary(\n        fun.data = \"mean_sd\",geom = \"pointrange\",linewidth=.3\n    )+\n    ggplot2::annotate(\n        geom=\"segment\",\n        x=0.9,\n        xend=1.1,\n        y=2.42019873,#均值\n    )+\n    ggplot2::annotate(\n        geom=\"segment\",\n        x=1.9,\n        xend=2.1,\n        y=0.789463173,#均值\n    )"
  },
  {
    "objectID": "点图.html#蜂群图",
    "href": "点图.html#蜂群图",
    "title": "\n1 点图",
    "section": "",
    "text": "Beeswarm plots\n\nCode# library(ggbeeswarm)"
  },
  {
    "objectID": "热图.html",
    "href": "热图.html",
    "title": "\n1 热图",
    "section": "",
    "text": "Codelibrary(pheatmap)\n\n\n\nCode# read test matrix\ntest &lt;- read.delim(\"data/heatmap/heatmap.txt\",header = T,row.names = 1,sep = \"\\t\")\ntest\n#&gt;             Sample1     Sample2      Sample3      Sample4     Sample5\n#&gt; Gene1   1.276788667  1.39970122  1.072416992  0.880483730  0.82856234\n#&gt; Gene2   0.019548561  0.02705895  0.014687243  0.044248741  0.05737813\n#&gt; Gene3   2.395132841  3.07937035  2.256007527  2.415867713  2.48658672\n#&gt; Gene4   0.083182670  0.14317924  0.156855571  0.083322439  0.17252389\n#&gt; Gene5   0.027406019  0.01016765  0.020571287  0.049950368  0.07319428\n#&gt; Gene6   0.015444824  0.01451434  0.013529512  0.008938481  0.02281410\n#&gt; Gene7   0.027244791  0.06197748  0.083861020  0.752735813  0.66726281\n#&gt; Gene8   0.502507993  0.42464105  0.470344575  0.533677126  0.32546274\n#&gt; Gene9   0.854770698  1.01076161  0.831606319  1.207970172  0.92257052\n#&gt; Gene10  2.366194466  2.13447866  1.956382548  0.962606527  1.31203300\n#&gt; Gene11  2.155082130  1.98799347  1.788864352  3.616962038  3.06590887\n#&gt; Gene12  0.129310440  0.09191911  0.104282037  0.243862580  0.24021022\n#&gt; Gene13  0.605845552  0.58849974  0.574435835  0.432609433  0.33815736\n#&gt; Gene14  2.281032962  1.72559272  2.367729880  1.788446640  1.90978813\n#&gt; Gene15  1.098679859  1.12561208  1.114335742  0.721540287  0.62703942\n#&gt; Gene16  3.768603241  3.83448142  3.487697474  3.731478791  3.29533360\n#&gt; Gene17  0.203230074  0.05219244  0.014276941  0.032323746  0.01202423\n#&gt; Gene18  2.152050491  1.85644729  3.813717676  0.640071180  0.54325715\n#&gt; Gene19  0.516357072  0.31591833  0.276653295  0.366272032  0.54603307\n#&gt; Gene20  2.280619557  2.36036186  2.589737224  4.425116212  4.39044996\n#&gt; Gene21  6.825873663  6.68907517  7.000483477  5.783822390  5.86881864\n#&gt; Gene22  0.444148936  0.52574211  0.603483647  0.382820066  0.48857265\n#&gt; Gene23  6.425283872  5.84820317  7.471677403  4.017770676  4.56303969\n#&gt; Gene24  7.981617242  5.09157053  8.114701616 11.528060240 13.19384251\n#&gt; Gene25  6.000165362  5.96854511  5.584680317  4.962957583  4.91216906\n#&gt; Gene26  3.106879065  4.39925858  2.880084674  1.836868100  1.81948848\n#&gt; Gene27  0.974603131  1.10357706  1.088201858  1.090548131  0.80487377\n#&gt; Gene28  0.090236743  0.04519600  0.045398476  0.109017286  0.06329643\n#&gt; Gene29  1.505897916  1.21549506  1.164930941  1.094930273  1.07443412\n#&gt; Gene30  0.418214640  0.48694221  0.696402671  2.029101298  1.40913530\n#&gt; Gene31 12.094173740  6.11129554  5.846019156  1.705766996  2.03015108\n#&gt; Gene32 14.755815240 14.35665477 14.220752920 13.041109820 13.04242876\n#&gt; Gene33  8.567688237  8.45699505  8.462020933  6.893400155  6.32240155\n#&gt; Gene34 28.143258740 29.04805378 27.188386100 21.545128800 20.25762280\n#&gt; Gene35 10.272571930 14.51711069 13.670634660 15.391971720 13.49886440\n#&gt; Gene36  1.230432146  1.33515921  1.281579532  0.975571373  0.85519141\n#&gt; Gene37  2.105335685  2.12880737  2.290242914  2.313335270  2.16477765\n#&gt; Gene38 79.213978610 81.18377735 77.198186310 81.823794310 79.83893089\n#&gt; Gene39  8.132510197  7.49287631  6.970690849  8.731115630  7.74492270\n#&gt; Gene40  0.753541506  0.83845132  1.001006155  0.997615243  0.60000439\n#&gt; Gene41  0.325474038  0.30016322  0.350076442  0.200246949  0.21014691\n#&gt; Gene42  0.797210892  1.09573409  0.763174744  0.803602557  0.35076420\n#&gt; Gene43  0.574330283  0.68311340  0.591644997  0.388098005  0.32650509\n#&gt; Gene44 14.185315840 14.51019448 14.120137460 10.248523150  9.98540723\n#&gt; Gene45  0.265364899  0.17134202  0.109452626  0.281498160  0.48228569\n#&gt; Gene46 10.906735750 11.40647910 11.379215720 10.631052680 10.69211442\n#&gt; Gene47  5.665169221  5.94489169  5.530583178  5.948818516  5.76601091\n#&gt; Gene48  2.109194135  2.17929565  2.348260137  2.454241720  2.34274366\n#&gt; Gene49  0.004976574  0.00442388  0.006059272  0.025406740  0.03158951\n#&gt; Gene50  0.578367876  0.88617313  0.713324361  0.222133450  0.18598655\n#&gt;            Sample6\n#&gt; Gene1   0.69472331\n#&gt; Gene2   0.05942839\n#&gt; Gene3   2.43571945\n#&gt; Gene4   0.06852347\n#&gt; Gene5   0.06896061\n#&gt; Gene6   0.01208279\n#&gt; Gene7   0.69213029\n#&gt; Gene8   0.48171690\n#&gt; Gene9   1.06054591\n#&gt; Gene10  1.32278532\n#&gt; Gene11  3.51641291\n#&gt; Gene12  0.30601099\n#&gt; Gene13  0.41972532\n#&gt; Gene14  1.63142375\n#&gt; Gene15  0.66917172\n#&gt; Gene16  3.27913994\n#&gt; Gene17  0.01399543\n#&gt; Gene18  0.86020629\n#&gt; Gene19  0.58455431\n#&gt; Gene20  4.81441537\n#&gt; Gene21  5.68732288\n#&gt; Gene22  0.47799947\n#&gt; Gene23  5.39830421\n#&gt; Gene24 11.26897438\n#&gt; Gene25  5.28402767\n#&gt; Gene26  2.04171782\n#&gt; Gene27  1.04176371\n#&gt; Gene28  0.03033377\n#&gt; Gene29  1.21975286\n#&gt; Gene30  2.41736177\n#&gt; Gene31  1.87294193\n#&gt; Gene32 13.67646890\n#&gt; Gene33  5.82982434\n#&gt; Gene34 20.53076632\n#&gt; Gene35 12.53599826\n#&gt; Gene36  0.86309763\n#&gt; Gene37  2.43503104\n#&gt; Gene38 76.55265785\n#&gt; Gene39  7.53249882\n#&gt; Gene40  0.95383044\n#&gt; Gene41  0.09595213\n#&gt; Gene42  0.81975056\n#&gt; Gene43  0.43375747\n#&gt; Gene44 10.42543915\n#&gt; Gene45  0.38292966\n#&gt; Gene46 10.73717544\n#&gt; Gene47  5.88971626\n#&gt; Gene48  2.41323130\n#&gt; Gene49  0.06582145\n#&gt; Gene50  0.27235908\n\nsample_group &lt;- read.delim(\"data/heatmap/sample.class.txt\",header = T,row.names = 1,sep = \"\\t\")\ngene_group &lt;- read.delim(\"data/heatmap/gene.class.txt\",header = T,row.names = 1,sep = \"\\t\")\n\n\n\nCodepheatmap(test,\n         annotation_legend = T,#legend_breaks = seq(-1,1,0.2), legend_labels = seq(-1,1,0.2),\n         show_rownames = T,show_colnames = T,\n         fontsize = 12,\n         color = colorRampPalette(c(\"#0000ff\",\"#ffffff\",\"#ff0000\"))(200),\n         border_color = NA,\n         scale = \"row\",       # 归一化\n         cluster_rows = T,cluster_cols = T,clustering_distance_rows = \"correlation\",\n         display_numbers = TRUE, #number_format = \"%.1e\",\n         \n         treeheight_row = 12,\n         treeheight_col = 12,\n         \n         annotation_row = gene_group,\n         annotation_col = sample_group,\n         )\n\n\n\n\n\n\n\n\n\nCoder &lt;- cor(test,method = \"pearson\",use = \"pairwise.complete.obs\")\n\nr\n#&gt;           Sample1   Sample2   Sample3   Sample4   Sample5   Sample6\n#&gt; Sample1 1.0000000 0.9952840 0.9957627 0.9830767 0.9830091 0.9851351\n#&gt; Sample2 0.9952840 1.0000000 0.9983278 0.9887180 0.9865182 0.9891590\n#&gt; Sample3 0.9957627 0.9983278 1.0000000 0.9902566 0.9893629 0.9915575\n#&gt; Sample4 0.9830767 0.9887180 0.9902566 1.0000000 0.9992817 0.9990420\n#&gt; Sample5 0.9830091 0.9865182 0.9893629 0.9992817 1.0000000 0.9993162\n#&gt; Sample6 0.9851351 0.9891590 0.9915575 0.9990420 0.9993162 1.0000000\n\npheatmap::pheatmap(r,fontsize = 12,\n         color = colorRampPalette(c(\"#0000ff\",\"#ffffff\",\"#ff0000\"))(200),)\n\n\n\n\n\n\n\n\n\nCode# 设置随机数种子以确保结果的可重复性  \nset.seed(10)  \nlibrary(tidyverse)\n#&gt; Warning: package 'purrr' was built under R version 4.5.2\n#&gt; Warning: package 'stringr' was built under R version 4.5.2\n#&gt; Warning: package 'forcats' was built under R version 4.5.2\n#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.6\n#&gt; ✔ forcats   1.0.1     ✔ stringr   1.6.0\n#&gt; ✔ ggplot2   4.0.1     ✔ tibble    3.3.0\n#&gt; ✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n#&gt; ✔ purrr     1.2.0     \n#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#&gt; ✖ dplyr::filter() masks stats::filter()\n#&gt; ✖ dplyr::lag()    masks stats::lag()\n#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n# 生成随机数据集  \nmydata &lt;- tibble(  \n  year = 2000:2024,  \n  lung = runif(25),  \n  liver = runif(25), \n  bone = runif(25),  \n  luk = runif(25),  \n  eso = runif(25),  \n  gas = runif(25),   \n  eye = runif(25),  \n  brain = runif(25),  \n  pan = runif(25),  \n  kidney = runif(25),  \n  breast= runif(25),  \n)  |&gt; pivot_longer(cols = -1,\n                   names_to = \"cancer\",\n                   values_to = \"morbidity\")\n\nggplot(mydata, aes(year, cancer)) +  \n  geom_tile(aes(fill =morbidity)) +  \n  scale_fill_gradient(low = \"white\", high = \"red\")\n\n\n\n\n\n\n\n\nhttps://jokergoo.github.io/ComplexHeatmap-reference/book/",
    "crumbs": [
      "ggplot2 图形",
      "Relationship",
      "热图"
    ]
  },
  {
    "objectID": "热图.html#pheatmap",
    "href": "热图.html#pheatmap",
    "title": "\n1 热图",
    "section": "",
    "text": "Codelibrary(pheatmap)\n\n\n\nCode# read test matrix\ntest &lt;- read.delim(\"data/heatmap/heatmap.txt\",header = T,row.names = 1,sep = \"\\t\")\ntest\n#&gt;             Sample1     Sample2      Sample3      Sample4     Sample5\n#&gt; Gene1   1.276788667  1.39970122  1.072416992  0.880483730  0.82856234\n#&gt; Gene2   0.019548561  0.02705895  0.014687243  0.044248741  0.05737813\n#&gt; Gene3   2.395132841  3.07937035  2.256007527  2.415867713  2.48658672\n#&gt; Gene4   0.083182670  0.14317924  0.156855571  0.083322439  0.17252389\n#&gt; Gene5   0.027406019  0.01016765  0.020571287  0.049950368  0.07319428\n#&gt; Gene6   0.015444824  0.01451434  0.013529512  0.008938481  0.02281410\n#&gt; Gene7   0.027244791  0.06197748  0.083861020  0.752735813  0.66726281\n#&gt; Gene8   0.502507993  0.42464105  0.470344575  0.533677126  0.32546274\n#&gt; Gene9   0.854770698  1.01076161  0.831606319  1.207970172  0.92257052\n#&gt; Gene10  2.366194466  2.13447866  1.956382548  0.962606527  1.31203300\n#&gt; Gene11  2.155082130  1.98799347  1.788864352  3.616962038  3.06590887\n#&gt; Gene12  0.129310440  0.09191911  0.104282037  0.243862580  0.24021022\n#&gt; Gene13  0.605845552  0.58849974  0.574435835  0.432609433  0.33815736\n#&gt; Gene14  2.281032962  1.72559272  2.367729880  1.788446640  1.90978813\n#&gt; Gene15  1.098679859  1.12561208  1.114335742  0.721540287  0.62703942\n#&gt; Gene16  3.768603241  3.83448142  3.487697474  3.731478791  3.29533360\n#&gt; Gene17  0.203230074  0.05219244  0.014276941  0.032323746  0.01202423\n#&gt; Gene18  2.152050491  1.85644729  3.813717676  0.640071180  0.54325715\n#&gt; Gene19  0.516357072  0.31591833  0.276653295  0.366272032  0.54603307\n#&gt; Gene20  2.280619557  2.36036186  2.589737224  4.425116212  4.39044996\n#&gt; Gene21  6.825873663  6.68907517  7.000483477  5.783822390  5.86881864\n#&gt; Gene22  0.444148936  0.52574211  0.603483647  0.382820066  0.48857265\n#&gt; Gene23  6.425283872  5.84820317  7.471677403  4.017770676  4.56303969\n#&gt; Gene24  7.981617242  5.09157053  8.114701616 11.528060240 13.19384251\n#&gt; Gene25  6.000165362  5.96854511  5.584680317  4.962957583  4.91216906\n#&gt; Gene26  3.106879065  4.39925858  2.880084674  1.836868100  1.81948848\n#&gt; Gene27  0.974603131  1.10357706  1.088201858  1.090548131  0.80487377\n#&gt; Gene28  0.090236743  0.04519600  0.045398476  0.109017286  0.06329643\n#&gt; Gene29  1.505897916  1.21549506  1.164930941  1.094930273  1.07443412\n#&gt; Gene30  0.418214640  0.48694221  0.696402671  2.029101298  1.40913530\n#&gt; Gene31 12.094173740  6.11129554  5.846019156  1.705766996  2.03015108\n#&gt; Gene32 14.755815240 14.35665477 14.220752920 13.041109820 13.04242876\n#&gt; Gene33  8.567688237  8.45699505  8.462020933  6.893400155  6.32240155\n#&gt; Gene34 28.143258740 29.04805378 27.188386100 21.545128800 20.25762280\n#&gt; Gene35 10.272571930 14.51711069 13.670634660 15.391971720 13.49886440\n#&gt; Gene36  1.230432146  1.33515921  1.281579532  0.975571373  0.85519141\n#&gt; Gene37  2.105335685  2.12880737  2.290242914  2.313335270  2.16477765\n#&gt; Gene38 79.213978610 81.18377735 77.198186310 81.823794310 79.83893089\n#&gt; Gene39  8.132510197  7.49287631  6.970690849  8.731115630  7.74492270\n#&gt; Gene40  0.753541506  0.83845132  1.001006155  0.997615243  0.60000439\n#&gt; Gene41  0.325474038  0.30016322  0.350076442  0.200246949  0.21014691\n#&gt; Gene42  0.797210892  1.09573409  0.763174744  0.803602557  0.35076420\n#&gt; Gene43  0.574330283  0.68311340  0.591644997  0.388098005  0.32650509\n#&gt; Gene44 14.185315840 14.51019448 14.120137460 10.248523150  9.98540723\n#&gt; Gene45  0.265364899  0.17134202  0.109452626  0.281498160  0.48228569\n#&gt; Gene46 10.906735750 11.40647910 11.379215720 10.631052680 10.69211442\n#&gt; Gene47  5.665169221  5.94489169  5.530583178  5.948818516  5.76601091\n#&gt; Gene48  2.109194135  2.17929565  2.348260137  2.454241720  2.34274366\n#&gt; Gene49  0.004976574  0.00442388  0.006059272  0.025406740  0.03158951\n#&gt; Gene50  0.578367876  0.88617313  0.713324361  0.222133450  0.18598655\n#&gt;            Sample6\n#&gt; Gene1   0.69472331\n#&gt; Gene2   0.05942839\n#&gt; Gene3   2.43571945\n#&gt; Gene4   0.06852347\n#&gt; Gene5   0.06896061\n#&gt; Gene6   0.01208279\n#&gt; Gene7   0.69213029\n#&gt; Gene8   0.48171690\n#&gt; Gene9   1.06054591\n#&gt; Gene10  1.32278532\n#&gt; Gene11  3.51641291\n#&gt; Gene12  0.30601099\n#&gt; Gene13  0.41972532\n#&gt; Gene14  1.63142375\n#&gt; Gene15  0.66917172\n#&gt; Gene16  3.27913994\n#&gt; Gene17  0.01399543\n#&gt; Gene18  0.86020629\n#&gt; Gene19  0.58455431\n#&gt; Gene20  4.81441537\n#&gt; Gene21  5.68732288\n#&gt; Gene22  0.47799947\n#&gt; Gene23  5.39830421\n#&gt; Gene24 11.26897438\n#&gt; Gene25  5.28402767\n#&gt; Gene26  2.04171782\n#&gt; Gene27  1.04176371\n#&gt; Gene28  0.03033377\n#&gt; Gene29  1.21975286\n#&gt; Gene30  2.41736177\n#&gt; Gene31  1.87294193\n#&gt; Gene32 13.67646890\n#&gt; Gene33  5.82982434\n#&gt; Gene34 20.53076632\n#&gt; Gene35 12.53599826\n#&gt; Gene36  0.86309763\n#&gt; Gene37  2.43503104\n#&gt; Gene38 76.55265785\n#&gt; Gene39  7.53249882\n#&gt; Gene40  0.95383044\n#&gt; Gene41  0.09595213\n#&gt; Gene42  0.81975056\n#&gt; Gene43  0.43375747\n#&gt; Gene44 10.42543915\n#&gt; Gene45  0.38292966\n#&gt; Gene46 10.73717544\n#&gt; Gene47  5.88971626\n#&gt; Gene48  2.41323130\n#&gt; Gene49  0.06582145\n#&gt; Gene50  0.27235908\n\nsample_group &lt;- read.delim(\"data/heatmap/sample.class.txt\",header = T,row.names = 1,sep = \"\\t\")\ngene_group &lt;- read.delim(\"data/heatmap/gene.class.txt\",header = T,row.names = 1,sep = \"\\t\")\n\n\n\nCodepheatmap(test,\n         annotation_legend = T,#legend_breaks = seq(-1,1,0.2), legend_labels = seq(-1,1,0.2),\n         show_rownames = T,show_colnames = T,\n         fontsize = 12,\n         color = colorRampPalette(c(\"#0000ff\",\"#ffffff\",\"#ff0000\"))(200),\n         border_color = NA,\n         scale = \"row\",       # 归一化\n         cluster_rows = T,cluster_cols = T,clustering_distance_rows = \"correlation\",\n         display_numbers = TRUE, #number_format = \"%.1e\",\n         \n         treeheight_row = 12,\n         treeheight_col = 12,\n         \n         annotation_row = gene_group,\n         annotation_col = sample_group,\n         )",
    "crumbs": [
      "ggplot2 图形",
      "Relationship",
      "热图"
    ]
  },
  {
    "objectID": "热图.html#相关性",
    "href": "热图.html#相关性",
    "title": "\n1 热图",
    "section": "",
    "text": "Coder &lt;- cor(test,method = \"pearson\",use = \"pairwise.complete.obs\")\n\nr\n#&gt;           Sample1   Sample2   Sample3   Sample4   Sample5   Sample6\n#&gt; Sample1 1.0000000 0.9952840 0.9957627 0.9830767 0.9830091 0.9851351\n#&gt; Sample2 0.9952840 1.0000000 0.9983278 0.9887180 0.9865182 0.9891590\n#&gt; Sample3 0.9957627 0.9983278 1.0000000 0.9902566 0.9893629 0.9915575\n#&gt; Sample4 0.9830767 0.9887180 0.9902566 1.0000000 0.9992817 0.9990420\n#&gt; Sample5 0.9830091 0.9865182 0.9893629 0.9992817 1.0000000 0.9993162\n#&gt; Sample6 0.9851351 0.9891590 0.9915575 0.9990420 0.9993162 1.0000000\n\npheatmap::pheatmap(r,fontsize = 12,\n         color = colorRampPalette(c(\"#0000ff\",\"#ffffff\",\"#ff0000\"))(200),)",
    "crumbs": [
      "ggplot2 图形",
      "Relationship",
      "热图"
    ]
  },
  {
    "objectID": "热图.html#geom_tile",
    "href": "热图.html#geom_tile",
    "title": "\n1 热图",
    "section": "",
    "text": "Code# 设置随机数种子以确保结果的可重复性  \nset.seed(10)  \nlibrary(tidyverse)\n#&gt; Warning: package 'purrr' was built under R version 4.5.2\n#&gt; Warning: package 'stringr' was built under R version 4.5.2\n#&gt; Warning: package 'forcats' was built under R version 4.5.2\n#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.6\n#&gt; ✔ forcats   1.0.1     ✔ stringr   1.6.0\n#&gt; ✔ ggplot2   4.0.1     ✔ tibble    3.3.0\n#&gt; ✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n#&gt; ✔ purrr     1.2.0     \n#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#&gt; ✖ dplyr::filter() masks stats::filter()\n#&gt; ✖ dplyr::lag()    masks stats::lag()\n#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n# 生成随机数据集  \nmydata &lt;- tibble(  \n  year = 2000:2024,  \n  lung = runif(25),  \n  liver = runif(25), \n  bone = runif(25),  \n  luk = runif(25),  \n  eso = runif(25),  \n  gas = runif(25),   \n  eye = runif(25),  \n  brain = runif(25),  \n  pan = runif(25),  \n  kidney = runif(25),  \n  breast= runif(25),  \n)  |&gt; pivot_longer(cols = -1,\n                   names_to = \"cancer\",\n                   values_to = \"morbidity\")\n\nggplot(mydata, aes(year, cancer)) +  \n  geom_tile(aes(fill =morbidity)) +  \n  scale_fill_gradient(low = \"white\", high = \"red\")",
    "crumbs": [
      "ggplot2 图形",
      "Relationship",
      "热图"
    ]
  },
  {
    "objectID": "热图.html#complexheatmap",
    "href": "热图.html#complexheatmap",
    "title": "\n1 热图",
    "section": "",
    "text": "https://jokergoo.github.io/ComplexHeatmap-reference/book/",
    "crumbs": [
      "ggplot2 图形",
      "Relationship",
      "热图"
    ]
  },
  {
    "objectID": "网络图.html",
    "href": "网络图.html",
    "title": "\n1 网络图",
    "section": "",
    "text": "https://igraph.org/\nhttps://r.igraph.org/\nhttps://ggraph.data-imaginist.com/\nhttps://tidygraph.data-imaginist.com/index.html\nhttps://yufree.cn/cn/2020/06/24/r-network-analysis/\nhttps://kateto.net/network-visualization\n\n\nCodelibrary(tidygraph)\nlibrary(ggraph)\nrstat_nodes &lt;- data.frame(name = c(\"Hadley\", \"David\", \"Romain\", \"Julia\"))\nrstat_edges &lt;- data.frame(from = c(1, 1, 1, 2, 3, 3, 4, 4, 4),\n                            to = c(2, 3, 4, 1, 1, 2, 1, 2, 3))\ntbl_graph(nodes = rstat_nodes, edges = rstat_edges)\n#&gt; # A tbl_graph: 4 nodes and 9 edges\n#&gt; #\n#&gt; # A directed simple graph with 1 component\n#&gt; #\n#&gt; # Node Data: 4 × 1 (active)\n#&gt;   name  \n#&gt;   &lt;chr&gt; \n#&gt; 1 Hadley\n#&gt; 2 David \n#&gt; 3 Romain\n#&gt; 4 Julia \n#&gt; #\n#&gt; # Edge Data: 9 × 2\n#&gt;    from    to\n#&gt;   &lt;int&gt; &lt;int&gt;\n#&gt; 1     1     2\n#&gt; 2     1     3\n#&gt; 3     1     4\n#&gt; # ℹ 6 more rows\n\n\n\n\nCode\nhighschool %&gt;% as_tibble()\n#&gt; # A tibble: 506 × 3\n#&gt;     from    to  year\n#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n#&gt;  1     1    14  1957\n#&gt;  2     1    15  1957\n#&gt;  3     1    21  1957\n#&gt;  4     1    54  1957\n#&gt;  5     1    55  1957\n#&gt;  6     2    21  1957\n#&gt;  7     2    22  1957\n#&gt;  8     3     9  1957\n#&gt;  9     3    15  1957\n#&gt; 10     4     5  1957\n#&gt; # ℹ 496 more rows\n\n\ngr &lt;- as_tbl_graph(highschool)\ngr\n#&gt; # A tbl_graph: 70 nodes and 506 edges\n#&gt; #\n#&gt; # A directed multigraph with 1 component\n#&gt; #\n#&gt; # Node Data: 70 × 0 (active)\n#&gt; #\n#&gt; # Edge Data: 506 × 3\n#&gt;    from    to  year\n#&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt;\n#&gt; 1     1    13  1957\n#&gt; 2     1    14  1957\n#&gt; 3     1    20  1957\n#&gt; # ℹ 503 more rows\n\ncreate_layout(gr,layout = \"kk\") %&gt;% \n    ggplot()+\n    theme(\n        axis.text = element_blank(),\n        axis.title = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid = element_blank(),\n    )+\n    geom_point(aes(x = x, y = y))\n\n\n\n\n\n\nCode\n\nggraph(gr, layout = \"kk\") + \n  geom_point(aes(x = x, y = y))\n\n\n\n\n\n\nCode\nggraph(gr, layout = 'kk') + \n  geom_node_point()\n\n\n\n\n\n\n\n\nCodegr2 &lt;- tbl_graph(flare$vertices, flare$edges)\ngr2\n#&gt; # A tbl_graph: 252 nodes and 251 edges\n#&gt; #\n#&gt; # A rooted tree\n#&gt; #\n#&gt; # Node Data: 252 × 3 (active)\n#&gt;    name                                            size shortName            \n#&gt;    &lt;chr&gt;                                          &lt;dbl&gt; &lt;chr&gt;                \n#&gt;  1 flare.analytics.cluster.AgglomerativeCluster    3938 AgglomerativeCluster \n#&gt;  2 flare.analytics.cluster.CommunityStructure      3812 CommunityStructure   \n#&gt;  3 flare.analytics.cluster.HierarchicalCluster     6714 HierarchicalCluster  \n#&gt;  4 flare.analytics.cluster.MergeEdge                743 MergeEdge            \n#&gt;  5 flare.analytics.graph.BetweennessCentrality     3534 BetweennessCentrality\n#&gt;  6 flare.analytics.graph.LinkDistance              5731 LinkDistance         \n#&gt;  7 flare.analytics.graph.MaxFlowMinCut             7840 MaxFlowMinCut        \n#&gt;  8 flare.analytics.graph.ShortestPaths             5914 ShortestPaths        \n#&gt;  9 flare.analytics.graph.SpanningTree              3416 SpanningTree         \n#&gt; 10 flare.analytics.optimization.AspectRatioBanker  7074 AspectRatioBanker    \n#&gt; # ℹ 242 more rows\n#&gt; #\n#&gt; # Edge Data: 251 × 2\n#&gt;    from    to\n#&gt;   &lt;int&gt; &lt;int&gt;\n#&gt; 1   221     1\n#&gt; 2   221     2\n#&gt; 3   221     3\n#&gt; # ℹ 248 more rows\n\n\ncreate_layout(gr2,layout = \"partition\") \n#&gt; # A tibble: 252 × 12\n#&gt;        x     y width height circular leaf  depth name           size shortName\n#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;    &lt;lgl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;    \n#&gt;  1 110     1.5   220      1 FALSE    FALSE     0 flare             0 flare    \n#&gt;  2  10     2.5    20      1 FALSE    FALSE     1 flare.animate     0 animate  \n#&gt;  3  25.5   2.5    11      1 FALSE    FALSE     1 flare.data        0 data     \n#&gt;  4  33     2.5     4      1 FALSE    FALSE     1 flare.display     0 display  \n#&gt;  5  35.5   2.5     1      1 FALSE    FALSE     1 flare.flex        0 flex     \n#&gt;  6  40     2.5     8      1 FALSE    FALSE     1 flare.physics     0 physics  \n#&gt;  7  74     2.5    60      1 FALSE    FALSE     1 flare.query       0 query    \n#&gt;  8 109     2.5    10      1 FALSE    FALSE     1 flare.scale       0 scale    \n#&gt;  9 126.    2.5    25      1 FALSE    FALSE     1 flare.util        0 util     \n#&gt; 10 174.    2.5    71      1 FALSE    FALSE     1 flare.vis         0 vis      \n#&gt; # ℹ 242 more rows\n#&gt; # ℹ 2 more variables: .ggraph.orig_index &lt;int&gt;, .ggraph.index &lt;int&gt;\n\ncreate_layout(gr2,layout = \"partition\") %&gt;% \n    ggplot()+\n    theme(\n        axis.text = element_blank(),\n        axis.title = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid = element_blank(),\n    )+\n    geom_tile(aes(x=x,y = -y, fill = depth))\n\n\n\n\n\n\nCode\nggraph(gr2, layout = 'partition') + \n  geom_node_tile(aes(y = -y, fill = depth))\n\n\n\n\n\n\n\n\n\nCodelibrary(ggraph)\nlibrary(tidygraph)\n\nhighschool$year &lt;- factor(highschool$year)\n\ngr &lt;- as_tbl_graph(highschool) %&gt;% \n    activate(edges)\n\ngr\n#&gt; # A tbl_graph: 70 nodes and 506 edges\n#&gt; #\n#&gt; # A directed multigraph with 1 component\n#&gt; #\n#&gt; # Edge Data: 506 × 3 (active)\n#&gt;     from    to year \n#&gt;    &lt;int&gt; &lt;int&gt; &lt;chr&gt;\n#&gt;  1     1    13 1957 \n#&gt;  2     1    14 1957 \n#&gt;  3     1    20 1957 \n#&gt;  4     1    52 1957 \n#&gt;  5     1    53 1957 \n#&gt;  6     2    20 1957 \n#&gt;  7     2    21 1957 \n#&gt;  8     3     9 1957 \n#&gt;  9     3    14 1957 \n#&gt; 10     4     5 1957 \n#&gt; # ℹ 496 more rows\n#&gt; #\n#&gt; # Node Data: 70 × 0\n\n# link\n\nggraph(gr, layout = 'kk') + \n  geom_edge_link(aes(colour = year))\n\n\n\n\n\n\nCode\n\n# fan\n\nggraph(gr, layout = 'kk') + \n  geom_edge_fan(aes(colour = year))\n\n\n\n\n\n\nCode\n# parallel\n\nggraph(gr, layout = 'kk') + \n  geom_edge_parallel(aes(colour = year))\n\n\n\n\n\n\nCode\n# loop  make some of the student love themselves\nloopy_gr&lt;- gr |&gt; \n  bind_edges(tibble::tibble(from = 1:5, to = 1:5, year = rep('1957', 5)))\nggraph(loopy_gr, layout = 'stress') + \n  geom_edge_link(aes(colour = year), alpha = 0.25) + \n  geom_edge_loop(aes(colour = year))\n\n\n\n\n\n\nCode\n\n\n# Force directed 力导向\n\nggraph(gr) + \n  geom_edge_bundle_force(n_cycle = 2, threshold = 0.4)\n#&gt; Using \"stress\" as default layout\n\n\n\n\n\n\nCode\n\n\n# arc\nggraph(gr, layout = 'linear') + \n  geom_edge_arc(aes(colour = year))\n\n\n\n\n\n\n\n\nCode# hive 蜂巢图\nhairball &lt;- as_tbl_graph(highschool) |&gt; \n  mutate(\n    year_pop = map_local(mode = 'in', .f = function(neighborhood, ...) {\n      neighborhood %E&gt;% pull(year) |&gt; table() |&gt; sort(decreasing = TRUE)\n    }),\n    pop_devel = map_chr(year_pop, function(pop) {\n      if (length(pop) == 0 || length(unique(pop)) == 1) return('unchanged')\n      switch(names(pop)[which.max(pop)],\n             '1957' = 'decreased',\n             '1958' = 'increased')\n    }),\n    popularity = map_dbl(year_pop, ~ .[1]) %/% 0\n  ) |&gt; \n  activate(edges) |&gt; \n  mutate(year = as.character(year))\n\n\nggraph(hairball, layout = 'hive', axis = pop_devel, sort.by = popularity) + \n  geom_edge_hive(aes(colour = year)) + \n  geom_axis_hive(label = FALSE) + \n  coord_fixed()\n\n\n\n\n\n\n\n\nCodehierarchy &lt;- as_tbl_graph(hclust(dist(iris[, 1:4]))) |&gt; \n  mutate(Class = map_bfs_back_chr(node_is_root(), .f = function(node, path, ...) {\n    if (leaf[node]) {\n      as.character(iris$Species[as.integer(label[node])])\n    } else {\n      species &lt;- unique(unlist(path$result))\n      if (length(species) == 1) {\n        species\n      } else {\n        NA_character_\n      }\n    }\n  }))\n\n#  elbow\nggraph(hierarchy, layout = 'dendrogram', height = height) + \n  geom_edge_elbow()\n\n\n\n\n\n\nCodeggraph(hierarchy, layout = 'dendrogram', height = height) + \n  geom_edge_elbow2(aes(colour = node.Class))\n\n\n\n\n\n\nCode\nggraph(hierarchy, layout = 'dendrogram', height = height) + \n  geom_edge_diagonal()\n\n\n\n\n\n\nCode\n\nggraph(hierarchy, layout = 'dendrogram', height = height) + \n  geom_edge_bend()\n\n\n\n\n\n\n\n\n\nCode# Random names - I swear\nsimple &lt;- create_notable('bull') |&gt; \n  mutate(name = c('Thomas', 'Bob', 'Hadley', 'Winston', 'Baptiste')) |&gt; \n  activate(edges) |&gt; \n  mutate(type = sample(c('friend', 'foe'), 5, TRUE))\n\n\nggraph(simple, layout = 'graphopt') + \n  geom_edge_link(arrow = arrow(length = unit(4, 'mm'))) + \n  geom_node_point(size = 5)\n\n\n\n\n\n\nCode\n\nggraph(simple, layout = 'graphopt') + \n  geom_edge_link(arrow = arrow(length = unit(4, 'mm')), \n                 end_cap = circle(3, 'mm')) + \n  geom_node_point(size = 5)\n\n\n\n\n\n\nCode\nggraph(simple, layout = 'graphopt') + \n  geom_edge_link(aes(start_cap = label_rect(node1.name),\n                     end_cap = label_rect(node2.name)), \n                 arrow = arrow(length = unit(4, 'mm'))) + \n  geom_node_text(aes(label = name))\n\n\n\n\n\n\n\n\n\nCodeggraph(simple, layout = 'graphopt') + \n  geom_edge_link(aes(label = type), \n                 arrow = arrow(length = unit(4, 'mm')), \n                 end_cap = circle(3, 'mm')) + \n  geom_node_point(size = 5)\n\n\n\n\n\n\nCode\nggraph(simple, layout = 'graphopt') + \n  geom_edge_link(aes(label = type), \n                 angle_calc = 'along',\n                 label_dodge = unit(2.5, 'mm'),\n                 arrow = arrow(length = unit(4, 'mm')), \n                 end_cap = circle(3, 'mm')) + \n  geom_node_point(size = 5)\n\n\n\n\n\n\n\n\n\nCodeflaregraph &lt;- tbl_graph(flare$vertices, flare$edges)\nfrom &lt;- match(flare$imports$from, flare$vertices$name)\nto &lt;- match(flare$imports$to, flare$vertices$name)\nggraph(flaregraph, layout = 'dendrogram', circular = TRUE) + \n  geom_conn_bundle(data = get_con(from = from, to = to), alpha = 0.1) + \n  coord_fixed()"
  },
  {
    "objectID": "网络图.html#tbl_graph",
    "href": "网络图.html#tbl_graph",
    "title": "\n1 网络图",
    "section": "",
    "text": "Codelibrary(tidygraph)\nlibrary(ggraph)\nrstat_nodes &lt;- data.frame(name = c(\"Hadley\", \"David\", \"Romain\", \"Julia\"))\nrstat_edges &lt;- data.frame(from = c(1, 1, 1, 2, 3, 3, 4, 4, 4),\n                            to = c(2, 3, 4, 1, 1, 2, 1, 2, 3))\ntbl_graph(nodes = rstat_nodes, edges = rstat_edges)\n#&gt; # A tbl_graph: 4 nodes and 9 edges\n#&gt; #\n#&gt; # A directed simple graph with 1 component\n#&gt; #\n#&gt; # Node Data: 4 × 1 (active)\n#&gt;   name  \n#&gt;   &lt;chr&gt; \n#&gt; 1 Hadley\n#&gt; 2 David \n#&gt; 3 Romain\n#&gt; 4 Julia \n#&gt; #\n#&gt; # Edge Data: 9 × 2\n#&gt;    from    to\n#&gt;   &lt;int&gt; &lt;int&gt;\n#&gt; 1     1     2\n#&gt; 2     1     3\n#&gt; 3     1     4\n#&gt; # ℹ 6 more rows"
  },
  {
    "objectID": "网络图.html#节点",
    "href": "网络图.html#节点",
    "title": "\n1 网络图",
    "section": "",
    "text": "Code\nhighschool %&gt;% as_tibble()\n#&gt; # A tibble: 506 × 3\n#&gt;     from    to  year\n#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n#&gt;  1     1    14  1957\n#&gt;  2     1    15  1957\n#&gt;  3     1    21  1957\n#&gt;  4     1    54  1957\n#&gt;  5     1    55  1957\n#&gt;  6     2    21  1957\n#&gt;  7     2    22  1957\n#&gt;  8     3     9  1957\n#&gt;  9     3    15  1957\n#&gt; 10     4     5  1957\n#&gt; # ℹ 496 more rows\n\n\ngr &lt;- as_tbl_graph(highschool)\ngr\n#&gt; # A tbl_graph: 70 nodes and 506 edges\n#&gt; #\n#&gt; # A directed multigraph with 1 component\n#&gt; #\n#&gt; # Node Data: 70 × 0 (active)\n#&gt; #\n#&gt; # Edge Data: 506 × 3\n#&gt;    from    to  year\n#&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt;\n#&gt; 1     1    13  1957\n#&gt; 2     1    14  1957\n#&gt; 3     1    20  1957\n#&gt; # ℹ 503 more rows\n\ncreate_layout(gr,layout = \"kk\") %&gt;% \n    ggplot()+\n    theme(\n        axis.text = element_blank(),\n        axis.title = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid = element_blank(),\n    )+\n    geom_point(aes(x = x, y = y))\n\n\n\n\n\n\nCode\n\nggraph(gr, layout = \"kk\") + \n  geom_point(aes(x = x, y = y))\n\n\n\n\n\n\nCode\nggraph(gr, layout = 'kk') + \n  geom_node_point()\n\n\n\n\n\n\n\n\nCodegr2 &lt;- tbl_graph(flare$vertices, flare$edges)\ngr2\n#&gt; # A tbl_graph: 252 nodes and 251 edges\n#&gt; #\n#&gt; # A rooted tree\n#&gt; #\n#&gt; # Node Data: 252 × 3 (active)\n#&gt;    name                                            size shortName            \n#&gt;    &lt;chr&gt;                                          &lt;dbl&gt; &lt;chr&gt;                \n#&gt;  1 flare.analytics.cluster.AgglomerativeCluster    3938 AgglomerativeCluster \n#&gt;  2 flare.analytics.cluster.CommunityStructure      3812 CommunityStructure   \n#&gt;  3 flare.analytics.cluster.HierarchicalCluster     6714 HierarchicalCluster  \n#&gt;  4 flare.analytics.cluster.MergeEdge                743 MergeEdge            \n#&gt;  5 flare.analytics.graph.BetweennessCentrality     3534 BetweennessCentrality\n#&gt;  6 flare.analytics.graph.LinkDistance              5731 LinkDistance         \n#&gt;  7 flare.analytics.graph.MaxFlowMinCut             7840 MaxFlowMinCut        \n#&gt;  8 flare.analytics.graph.ShortestPaths             5914 ShortestPaths        \n#&gt;  9 flare.analytics.graph.SpanningTree              3416 SpanningTree         \n#&gt; 10 flare.analytics.optimization.AspectRatioBanker  7074 AspectRatioBanker    \n#&gt; # ℹ 242 more rows\n#&gt; #\n#&gt; # Edge Data: 251 × 2\n#&gt;    from    to\n#&gt;   &lt;int&gt; &lt;int&gt;\n#&gt; 1   221     1\n#&gt; 2   221     2\n#&gt; 3   221     3\n#&gt; # ℹ 248 more rows\n\n\ncreate_layout(gr2,layout = \"partition\") \n#&gt; # A tibble: 252 × 12\n#&gt;        x     y width height circular leaf  depth name           size shortName\n#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;    &lt;lgl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;    \n#&gt;  1 110     1.5   220      1 FALSE    FALSE     0 flare             0 flare    \n#&gt;  2  10     2.5    20      1 FALSE    FALSE     1 flare.animate     0 animate  \n#&gt;  3  25.5   2.5    11      1 FALSE    FALSE     1 flare.data        0 data     \n#&gt;  4  33     2.5     4      1 FALSE    FALSE     1 flare.display     0 display  \n#&gt;  5  35.5   2.5     1      1 FALSE    FALSE     1 flare.flex        0 flex     \n#&gt;  6  40     2.5     8      1 FALSE    FALSE     1 flare.physics     0 physics  \n#&gt;  7  74     2.5    60      1 FALSE    FALSE     1 flare.query       0 query    \n#&gt;  8 109     2.5    10      1 FALSE    FALSE     1 flare.scale       0 scale    \n#&gt;  9 126.    2.5    25      1 FALSE    FALSE     1 flare.util        0 util     \n#&gt; 10 174.    2.5    71      1 FALSE    FALSE     1 flare.vis         0 vis      \n#&gt; # ℹ 242 more rows\n#&gt; # ℹ 2 more variables: .ggraph.orig_index &lt;int&gt;, .ggraph.index &lt;int&gt;\n\ncreate_layout(gr2,layout = \"partition\") %&gt;% \n    ggplot()+\n    theme(\n        axis.text = element_blank(),\n        axis.title = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid = element_blank(),\n    )+\n    geom_tile(aes(x=x,y = -y, fill = depth))\n\n\n\n\n\n\nCode\nggraph(gr2, layout = 'partition') + \n  geom_node_tile(aes(y = -y, fill = depth))"
  },
  {
    "objectID": "网络图.html#边",
    "href": "网络图.html#边",
    "title": "\n1 网络图",
    "section": "",
    "text": "Codelibrary(ggraph)\nlibrary(tidygraph)\n\nhighschool$year &lt;- factor(highschool$year)\n\ngr &lt;- as_tbl_graph(highschool) %&gt;% \n    activate(edges)\n\ngr\n#&gt; # A tbl_graph: 70 nodes and 506 edges\n#&gt; #\n#&gt; # A directed multigraph with 1 component\n#&gt; #\n#&gt; # Edge Data: 506 × 3 (active)\n#&gt;     from    to year \n#&gt;    &lt;int&gt; &lt;int&gt; &lt;chr&gt;\n#&gt;  1     1    13 1957 \n#&gt;  2     1    14 1957 \n#&gt;  3     1    20 1957 \n#&gt;  4     1    52 1957 \n#&gt;  5     1    53 1957 \n#&gt;  6     2    20 1957 \n#&gt;  7     2    21 1957 \n#&gt;  8     3     9 1957 \n#&gt;  9     3    14 1957 \n#&gt; 10     4     5 1957 \n#&gt; # ℹ 496 more rows\n#&gt; #\n#&gt; # Node Data: 70 × 0\n\n# link\n\nggraph(gr, layout = 'kk') + \n  geom_edge_link(aes(colour = year))\n\n\n\n\n\n\nCode\n\n# fan\n\nggraph(gr, layout = 'kk') + \n  geom_edge_fan(aes(colour = year))\n\n\n\n\n\n\nCode\n# parallel\n\nggraph(gr, layout = 'kk') + \n  geom_edge_parallel(aes(colour = year))\n\n\n\n\n\n\nCode\n# loop  make some of the student love themselves\nloopy_gr&lt;- gr |&gt; \n  bind_edges(tibble::tibble(from = 1:5, to = 1:5, year = rep('1957', 5)))\nggraph(loopy_gr, layout = 'stress') + \n  geom_edge_link(aes(colour = year), alpha = 0.25) + \n  geom_edge_loop(aes(colour = year))\n\n\n\n\n\n\nCode\n\n\n# Force directed 力导向\n\nggraph(gr) + \n  geom_edge_bundle_force(n_cycle = 2, threshold = 0.4)\n#&gt; Using \"stress\" as default layout\n\n\n\n\n\n\nCode\n\n\n# arc\nggraph(gr, layout = 'linear') + \n  geom_edge_arc(aes(colour = year))\n\n\n\n\n\n\n\n\nCode# hive 蜂巢图\nhairball &lt;- as_tbl_graph(highschool) |&gt; \n  mutate(\n    year_pop = map_local(mode = 'in', .f = function(neighborhood, ...) {\n      neighborhood %E&gt;% pull(year) |&gt; table() |&gt; sort(decreasing = TRUE)\n    }),\n    pop_devel = map_chr(year_pop, function(pop) {\n      if (length(pop) == 0 || length(unique(pop)) == 1) return('unchanged')\n      switch(names(pop)[which.max(pop)],\n             '1957' = 'decreased',\n             '1958' = 'increased')\n    }),\n    popularity = map_dbl(year_pop, ~ .[1]) %/% 0\n  ) |&gt; \n  activate(edges) |&gt; \n  mutate(year = as.character(year))\n\n\nggraph(hairball, layout = 'hive', axis = pop_devel, sort.by = popularity) + \n  geom_edge_hive(aes(colour = year)) + \n  geom_axis_hive(label = FALSE) + \n  coord_fixed()\n\n\n\n\n\n\n\n\nCodehierarchy &lt;- as_tbl_graph(hclust(dist(iris[, 1:4]))) |&gt; \n  mutate(Class = map_bfs_back_chr(node_is_root(), .f = function(node, path, ...) {\n    if (leaf[node]) {\n      as.character(iris$Species[as.integer(label[node])])\n    } else {\n      species &lt;- unique(unlist(path$result))\n      if (length(species) == 1) {\n        species\n      } else {\n        NA_character_\n      }\n    }\n  }))\n\n#  elbow\nggraph(hierarchy, layout = 'dendrogram', height = height) + \n  geom_edge_elbow()\n\n\n\n\n\n\nCodeggraph(hierarchy, layout = 'dendrogram', height = height) + \n  geom_edge_elbow2(aes(colour = node.Class))\n\n\n\n\n\n\nCode\nggraph(hierarchy, layout = 'dendrogram', height = height) + \n  geom_edge_diagonal()\n\n\n\n\n\n\nCode\n\nggraph(hierarchy, layout = 'dendrogram', height = height) + \n  geom_edge_bend()\n\n\n\n\n\n\n\n\n\nCode# Random names - I swear\nsimple &lt;- create_notable('bull') |&gt; \n  mutate(name = c('Thomas', 'Bob', 'Hadley', 'Winston', 'Baptiste')) |&gt; \n  activate(edges) |&gt; \n  mutate(type = sample(c('friend', 'foe'), 5, TRUE))\n\n\nggraph(simple, layout = 'graphopt') + \n  geom_edge_link(arrow = arrow(length = unit(4, 'mm'))) + \n  geom_node_point(size = 5)\n\n\n\n\n\n\nCode\n\nggraph(simple, layout = 'graphopt') + \n  geom_edge_link(arrow = arrow(length = unit(4, 'mm')), \n                 end_cap = circle(3, 'mm')) + \n  geom_node_point(size = 5)\n\n\n\n\n\n\nCode\nggraph(simple, layout = 'graphopt') + \n  geom_edge_link(aes(start_cap = label_rect(node1.name),\n                     end_cap = label_rect(node2.name)), \n                 arrow = arrow(length = unit(4, 'mm'))) + \n  geom_node_text(aes(label = name))\n\n\n\n\n\n\n\n\n\nCodeggraph(simple, layout = 'graphopt') + \n  geom_edge_link(aes(label = type), \n                 arrow = arrow(length = unit(4, 'mm')), \n                 end_cap = circle(3, 'mm')) + \n  geom_node_point(size = 5)\n\n\n\n\n\n\nCode\nggraph(simple, layout = 'graphopt') + \n  geom_edge_link(aes(label = type), \n                 angle_calc = 'along',\n                 label_dodge = unit(2.5, 'mm'),\n                 arrow = arrow(length = unit(4, 'mm')), \n                 end_cap = circle(3, 'mm')) + \n  geom_node_point(size = 5)\n\n\n\n\n\n\n\n\n\nCodeflaregraph &lt;- tbl_graph(flare$vertices, flare$edges)\nfrom &lt;- match(flare$imports$from, flare$vertices$name)\nto &lt;- match(flare$imports$to, flare$vertices$name)\nggraph(flaregraph, layout = 'dendrogram', circular = TRUE) + \n  geom_conn_bundle(data = get_con(from = from, to = to), alpha = 0.1) + \n  coord_fixed()"
  },
  {
    "objectID": "相关图.html",
    "href": "相关图.html",
    "title": "\n1 相关图",
    "section": "",
    "text": "1 相关图\n\nCodelibrary(tidyverse)\n#&gt; Warning: package 'purrr' was built under R version 4.5.2\n#&gt; Warning: package 'stringr' was built under R version 4.5.2\n#&gt; Warning: package 'forcats' was built under R version 4.5.2\n#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.6\n#&gt; ✔ forcats   1.0.1     ✔ stringr   1.6.0\n#&gt; ✔ ggplot2   4.0.1     ✔ tibble    3.3.0\n#&gt; ✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n#&gt; ✔ purrr     1.2.0     \n#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#&gt; ✖ dplyr::filter() masks stats::filter()\n#&gt; ✖ dplyr::lag()    masks stats::lag()\n#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\nlibrary(ggcorrplot)\n\n\n\nCodedata(\"iris\")\ncor&lt;-cor(iris[,1:4])\nggcorrplot(cor)\n#&gt; Warning: `aes_string()` was deprecated in ggplot2 3.0.0.\n#&gt; ℹ Please use tidy evaluation idioms with `aes()`.\n#&gt; ℹ See also `vignette(\"ggplot2-in-packages\")` for more information.\n#&gt; ℹ The deprecated feature was likely used in the ggcorrplot package.\n#&gt;   Please report the issue at &lt;https://github.com/kassambara/ggcorrplot/issues&gt;.\n\n\n\n\n\n\nCodep.mat &lt;- ggcorrplot::cor_pmat(cor)\nggcorrplot(cor,hc.order=TRUE,lab=TRUE)\n\n\n\n\n\n\nCode\nggcorrplot(cor, hc.order = TRUE, p.mat = p.mat) + \n    labs(title = \"鸢尾花数据集指标相关性\") +\n    theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\n\n\n\n\nCodelibrary(corrplot)\n#&gt; corrplot 0.95 loaded\n\ncorrplot(corr = p.mat)\n\n\n\n\n\n\n\n\n\n Back to top",
    "crumbs": [
      "ggplot2 图形",
      "Relationship",
      "相关图"
    ]
  },
  {
    "objectID": "生存曲线.html",
    "href": "生存曲线.html",
    "title": "\n1 生存曲线",
    "section": "",
    "text": "Codelibrary(tidyverse)\n#&gt; Warning: package 'purrr' was built under R version 4.5.2\n#&gt; Warning: package 'stringr' was built under R version 4.5.2\n#&gt; Warning: package 'forcats' was built under R version 4.5.2\n#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.6\n#&gt; ✔ forcats   1.0.1     ✔ stringr   1.6.0\n#&gt; ✔ ggplot2   4.0.1     ✔ tibble    3.3.0\n#&gt; ✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n#&gt; ✔ purrr     1.2.0     \n#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#&gt; ✖ dplyr::filter() masks stats::filter()\n#&gt; ✖ dplyr::lag()    masks stats::lag()\n#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\nlibrary(readxl)\nlibrary(survival)\nlibrary(ggsci)\n#&gt; Warning: package 'ggsci' was built under R version 4.5.2\nlibrary(survminer)\n#&gt; Warning: package 'survminer' was built under R version 4.5.2\n#&gt; Loading required package: ggpubr\n#&gt; Warning: package 'ggpubr' was built under R version 4.5.2\n#&gt; \n#&gt; Attaching package: 'survminer'\n#&gt; \n#&gt; The following object is masked from 'package:survival':\n#&gt; \n#&gt;     myeloma\nlibrary(ggsurvfit)\n#&gt; Warning: package 'ggsurvfit' was built under R version 4.5.2\n\n\n\nCode### 数据 三列 “group”分组列， “time”生存时间列，“status”事件状态列\nd&lt;-read_excel(\"data/01source.xlsx\",sheet=1,range = \"A19:E75\") |&gt; \n    rename(\n        LR_DPVB=`LR-DPVB`\n    )  |&gt; \n    pivot_longer(\n        cols = CON:LR_DPVB,\n        names_to = \"treatment\",\n        values_to = \"status\"\n    ) |&gt; drop_na() |&gt; \n    mutate(\n        treatment=factor(treatment,levels=c('CON','LDRT','DPVB','LR_DPVB'))\n    )\n# 加载包\nd\n#&gt; # A tibble: 56 × 3\n#&gt;     Days treatment status\n#&gt;    &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;\n#&gt;  1    11 CON            1\n#&gt;  2    13 CON            1\n#&gt;  3    14 CON            1\n#&gt;  4    14 CON            1\n#&gt;  5    15 CON            1\n#&gt;  6    17 CON            1\n#&gt;  7    17 CON            1\n#&gt;  8    17 CON            1\n#&gt;  9    20 CON            1\n#&gt; 10    20 CON            1\n#&gt; # ℹ 46 more rows\n# 使用 Kaplan-Meier 方法拟合生存曲线\nkm_fit&lt;-surv_fit(Surv(Days,status)~treatment,data=d)\nsummary(km_fit)\n#&gt; Call: survfit(formula = Surv(Days, status) ~ treatment, data = structure(list(\n#&gt;     Days = c(11, 13, 14, 14, 15, 17, 17, 17, 20, 20, 21, 21, \n#&gt;     25, 27, 13, 13, 15, 16, 18, 19, 19, 20, 20, 20, 24, 25, 27, \n#&gt;     30, 20, 23, 27, 28, 30, 32, 38, 39, 45, 50, 50, 50, 50, 50, \n#&gt;     30, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50), \n#&gt;     treatment = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n#&gt;     1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, \n#&gt;     2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, \n#&gt;     3L, 3L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, \n#&gt;     4L, 4L), levels = c(\"CON\", \"LDRT\", \"DPVB\", \"LR_DPVB\"), class = \"factor\"), \n#&gt;     status = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, \n#&gt;     1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, \n#&gt;     1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n#&gt;     0, 0)), row.names = c(NA, -56L), class = c(\"tbl_df\", \"tbl\", \n#&gt; \"data.frame\")))\n#&gt; \n#&gt;                 treatment=CON \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    11     14       1   0.9286  0.0688       0.8030        1.000\n#&gt;    13     13       1   0.8571  0.0935       0.6921        1.000\n#&gt;    14     12       2   0.7143  0.1207       0.5129        0.995\n#&gt;    15     10       1   0.6429  0.1281       0.4351        0.950\n#&gt;    17      9       3   0.4286  0.1323       0.2341        0.785\n#&gt;    20      6       2   0.2857  0.1207       0.1248        0.654\n#&gt;    21      4       2   0.1429  0.0935       0.0396        0.515\n#&gt;    25      2       1   0.0714  0.0688       0.0108        0.472\n#&gt;    27      1       1   0.0000     NaN           NA           NA\n#&gt; \n#&gt;                 treatment=LDRT \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    13     14       2   0.8571  0.0935       0.6921        1.000\n#&gt;    15     12       1   0.7857  0.1097       0.5977        1.000\n#&gt;    16     11       1   0.7143  0.1207       0.5129        0.995\n#&gt;    18     10       1   0.6429  0.1281       0.4351        0.950\n#&gt;    19      9       2   0.5000  0.1336       0.2961        0.844\n#&gt;    20      7       3   0.2857  0.1207       0.1248        0.654\n#&gt;    24      4       1   0.2143  0.1097       0.0786        0.584\n#&gt;    25      3       1   0.1429  0.0935       0.0396        0.515\n#&gt;    27      2       1   0.0714  0.0688       0.0108        0.472\n#&gt;    30      1       1   0.0000     NaN           NA           NA\n#&gt; \n#&gt;                 treatment=DPVB \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    20     14       1    0.929  0.0688        0.803        1.000\n#&gt;    23     13       1    0.857  0.0935        0.692        1.000\n#&gt;    27     12       1    0.786  0.1097        0.598        1.000\n#&gt;    28     11       1    0.714  0.1207        0.513        0.995\n#&gt;    30     10       1    0.643  0.1281        0.435        0.950\n#&gt;    32      9       1    0.571  0.1323        0.363        0.899\n#&gt;    38      8       1    0.500  0.1336        0.296        0.844\n#&gt;    39      7       1    0.429  0.1323        0.234        0.785\n#&gt;    45      6       1    0.357  0.1281        0.177        0.721\n#&gt; \n#&gt;                 treatment=LR_DPVB \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    30     14       1    0.929  0.0688        0.803            1\n#&gt;    40     13       1    0.857  0.0935        0.692            1\n\n\n\n\nCodeplot(km_fit,\n     lty = 1,\n     col = c(\"gray\",\"blue\",\"orange3\",\"darkred\"),\n     lwd = 2,\n)\n\n\n\n\n\n\n\n\n\nCode# 使用 ggplot2 和 survminer 绘制生存曲线图\n\np &lt;- ggsurvplot(\n    fit  = km_fit,\n    data = d,\n    fun = \"pct\",  #event',累计死亡比列，'cumhaz':cumulative hazard累计风险\n    \n    palette = \"jco\",\n    linetype = c(1,5,4,6),\n    surv.median.line = 'none',\n    \n    conf.int = F,\n\n    \n    pval = TRUE,# \"log rank p=0.0053\"\n    log.rank.weights='1',  \n    pval.method = TRUE,\n    pval.coord=c(40,75),\n    pval.method.coord=c(32,75),\n    \n    risk.table = \"abs_pct\", # \"nrisk_cumcensor\" and \"nrisk_cumevents\"\n    risk.table.col = \"treatment\",\n    risk.table.height=0.3,\n    tables.theme = theme_cleantable(),\n    ncensor.plot=F,\n  \n    \n    axes.offset=F,  #(0,0)pos\n    title = \"Hepa1-6 tumor\",\n    xlab=\"Days\",\n    ylab=\"Percent survival (%)\",\n    \n    legend.title = \"\",\n    legend = c(0.2,0.35),\n    legend.labs=c('CON','LDRT','DPVB','LR_DPVB'),\n    \n    ggtheme = theme_survminer(),\n)\n#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n#&gt; ℹ Please use `linewidth` instead.\n#&gt; ℹ The deprecated feature was likely used in the ggpubr package.\n#&gt;   Please report the issue at &lt;https://github.com/kassambara/ggpubr/issues&gt;.\np\n\n\n\n\n\n\n\n\nCodefit&lt;- survfit(Surv(time, status) ~ sex, data = lung)\n\n# Basic survival curves\nggsurvplot(fit, data = lung)\n\n\n\n\n\n\nCode\n# Customized survival curves\np &lt;- ggsurvplot(fit, data = lung,\n           surv.median.line = \"hv\", # Add medians survival\n           \n           # Change legends: title & labels\n           legend.title = \"Sex\",\n           legend.labs = c(\"Male\", \"Female\"),\n           # Add p-value and tervals\n           pval = TRUE,\n           \n           conf.int = TRUE,\n           # Add risk table\n           risk.table = TRUE,\n           tables.height = 0.2,\n           tables.theme = theme_cleantable(),\n           \n           # Color palettes. Use custom color: c(\"#E7B800\", \"#2E9FDF\"),\n           # or brewer color (e.g.: \"Dark2\"), or ggsci color (e.g.: \"jco\")\n           palette = c(\"#E7B800\", \"#2E9FDF\"),\n           ggtheme = theme_bw() # Change ggplot2 theme\n)\n\n\n\nCodep &lt;- ggsurvplot(fit, data = lung,\n                surv.median.line = \"hv\", # Add medians survival\n                \n                # Change legends: title & labels\n                legend.title = \"Sex\",\n                legend.labs = c(\"Male\", \"Female\"),\n                # Add p-value and tervals\n                pval = F,    ##不默认显示P\n                conf.int = TRUE,\n                # Add risk table\n                risk.table = TRUE,\n                tables.height = 0.2,\n                tables.theme = theme_cleantable(),\n                \n                # Color palettes. Use custom color: c(\"#E7B800\", \"#2E9FDF\"),\n                # or brewer color (e.g.: \"Dark2\"), or ggsci color (e.g.: \"jco\")\n                palette = c(\"#E7B800\", \"#2E9FDF\"),\n                ggtheme = theme_bw() # Change ggplot2 theme\n)\n##计算公式\ndata.survdiff &lt;- survdiff(Surv(time, status) ~ sex,data = lung)\np.val = 1 - pchisq(data.survdiff$chisq, length(data.survdiff$n) - 1)\nHR = (data.survdiff$obs[2]/data.survdiff$exp[2])/(data.survdiff$obs[1]/data.survdiff$exp[1])\nup95 = exp(log(HR) + qnorm(0.975)*sqrt(1/data.survdiff$exp[2]+1/data.survdiff$exp[1]))\nlow95 = exp(log(HR) - qnorm(0.975)*sqrt(1/data.survdiff$exp[2]+1/data.survdiff$exp[1]))\nci &lt;- paste0(sprintf(\"%.3f\",HR),\" [\",sprintf(\"%.3f\",low95),\", \",sprintf(\"%.3f\",up95),\"]\")\n\np$plot &lt;- p$plot + \n  annotate(\"text\", x = 0, y = 0.05, \n                            label = paste0(\"P value = \",sprintf(\"%.3f\",p.val),\"\\n HR (95% CI) = \",ci),   ###添加P和HR 95%CI\n                            size = 5, color = \"black\", hjust = 0)+\n  theme(text = element_text(size = 15))\np$plot\n\n\n\n\n\n\n\n\n\nCodekm_fit\n#&gt; Call: survfit(formula = Surv(Days, status) ~ treatment, data = structure(list(\n#&gt;     Days = c(11, 13, 14, 14, 15, 17, 17, 17, 20, 20, 21, 21, \n#&gt;     25, 27, 13, 13, 15, 16, 18, 19, 19, 20, 20, 20, 24, 25, 27, \n#&gt;     30, 20, 23, 27, 28, 30, 32, 38, 39, 45, 50, 50, 50, 50, 50, \n#&gt;     30, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50), \n#&gt;     treatment = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n#&gt;     1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, \n#&gt;     2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, \n#&gt;     3L, 3L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, \n#&gt;     4L, 4L), levels = c(\"CON\", \"LDRT\", \"DPVB\", \"LR_DPVB\"), class = \"factor\"), \n#&gt;     status = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, \n#&gt;     1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, \n#&gt;     1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n#&gt;     0, 0)), row.names = c(NA, -56L), class = c(\"tbl_df\", \"tbl\", \n#&gt; \"data.frame\")))\n#&gt; \n#&gt;                    n events median 0.95LCL 0.95UCL\n#&gt; treatment=CON     14     14   17.0      15      25\n#&gt; treatment=LDRT    14     14   19.5      18      27\n#&gt; treatment=DPVB    14      9   38.5      30      NA\n#&gt; treatment=LR_DPVB 14      2     NA      NA      NA\n\n\nkm_fit |&gt; tidy_survfit() |&gt; \n    ggplot(aes(time,estimate,min=conf.low,ymax=conf.low,\n               color=strata,fill=strata))+\n    scale_color_jco()+\n    geom_step()\n\n\n\n\n\n\nCode\nkm_fit |&gt; ggsurvfit()+\n    add_confidence_interval()+\n    # 添加删失点\n    add_censor_mark()  +\n    add_quantile()+\n    add_pvalue(\"annotation\",size=3,x=5,y=0.25)+\n    #add_pvalue(caption = \"Log-rank {p.value}\")+\n    add_risktable(size = 3,risktable_height = 0.3)+\n    add_legend_title(\"treatment\")\n#&gt; ! `add_pvalue()` works with objects created with `survfit2()` or\n#&gt;   `tidycmprsk::cuminc()`.\n#&gt; ℹ `add_pvalue()` has been ignored.",
    "crumbs": [
      "ggplot2 图形",
      "Line",
      "生存曲线"
    ]
  },
  {
    "objectID": "生存曲线.html#kaplan-meier-curve",
    "href": "生存曲线.html#kaplan-meier-curve",
    "title": "\n1 生存曲线",
    "section": "",
    "text": "Codelibrary(tidyverse)\n#&gt; Warning: package 'purrr' was built under R version 4.5.2\n#&gt; Warning: package 'stringr' was built under R version 4.5.2\n#&gt; Warning: package 'forcats' was built under R version 4.5.2\n#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.6\n#&gt; ✔ forcats   1.0.1     ✔ stringr   1.6.0\n#&gt; ✔ ggplot2   4.0.1     ✔ tibble    3.3.0\n#&gt; ✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n#&gt; ✔ purrr     1.2.0     \n#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#&gt; ✖ dplyr::filter() masks stats::filter()\n#&gt; ✖ dplyr::lag()    masks stats::lag()\n#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\nlibrary(readxl)\nlibrary(survival)\nlibrary(ggsci)\n#&gt; Warning: package 'ggsci' was built under R version 4.5.2\nlibrary(survminer)\n#&gt; Warning: package 'survminer' was built under R version 4.5.2\n#&gt; Loading required package: ggpubr\n#&gt; Warning: package 'ggpubr' was built under R version 4.5.2\n#&gt; \n#&gt; Attaching package: 'survminer'\n#&gt; \n#&gt; The following object is masked from 'package:survival':\n#&gt; \n#&gt;     myeloma\nlibrary(ggsurvfit)\n#&gt; Warning: package 'ggsurvfit' was built under R version 4.5.2\n\n\n\nCode### 数据 三列 “group”分组列， “time”生存时间列，“status”事件状态列\nd&lt;-read_excel(\"data/01source.xlsx\",sheet=1,range = \"A19:E75\") |&gt; \n    rename(\n        LR_DPVB=`LR-DPVB`\n    )  |&gt; \n    pivot_longer(\n        cols = CON:LR_DPVB,\n        names_to = \"treatment\",\n        values_to = \"status\"\n    ) |&gt; drop_na() |&gt; \n    mutate(\n        treatment=factor(treatment,levels=c('CON','LDRT','DPVB','LR_DPVB'))\n    )\n# 加载包\nd\n#&gt; # A tibble: 56 × 3\n#&gt;     Days treatment status\n#&gt;    &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;\n#&gt;  1    11 CON            1\n#&gt;  2    13 CON            1\n#&gt;  3    14 CON            1\n#&gt;  4    14 CON            1\n#&gt;  5    15 CON            1\n#&gt;  6    17 CON            1\n#&gt;  7    17 CON            1\n#&gt;  8    17 CON            1\n#&gt;  9    20 CON            1\n#&gt; 10    20 CON            1\n#&gt; # ℹ 46 more rows\n# 使用 Kaplan-Meier 方法拟合生存曲线\nkm_fit&lt;-surv_fit(Surv(Days,status)~treatment,data=d)\nsummary(km_fit)\n#&gt; Call: survfit(formula = Surv(Days, status) ~ treatment, data = structure(list(\n#&gt;     Days = c(11, 13, 14, 14, 15, 17, 17, 17, 20, 20, 21, 21, \n#&gt;     25, 27, 13, 13, 15, 16, 18, 19, 19, 20, 20, 20, 24, 25, 27, \n#&gt;     30, 20, 23, 27, 28, 30, 32, 38, 39, 45, 50, 50, 50, 50, 50, \n#&gt;     30, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50), \n#&gt;     treatment = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n#&gt;     1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, \n#&gt;     2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, \n#&gt;     3L, 3L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, \n#&gt;     4L, 4L), levels = c(\"CON\", \"LDRT\", \"DPVB\", \"LR_DPVB\"), class = \"factor\"), \n#&gt;     status = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, \n#&gt;     1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, \n#&gt;     1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n#&gt;     0, 0)), row.names = c(NA, -56L), class = c(\"tbl_df\", \"tbl\", \n#&gt; \"data.frame\")))\n#&gt; \n#&gt;                 treatment=CON \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    11     14       1   0.9286  0.0688       0.8030        1.000\n#&gt;    13     13       1   0.8571  0.0935       0.6921        1.000\n#&gt;    14     12       2   0.7143  0.1207       0.5129        0.995\n#&gt;    15     10       1   0.6429  0.1281       0.4351        0.950\n#&gt;    17      9       3   0.4286  0.1323       0.2341        0.785\n#&gt;    20      6       2   0.2857  0.1207       0.1248        0.654\n#&gt;    21      4       2   0.1429  0.0935       0.0396        0.515\n#&gt;    25      2       1   0.0714  0.0688       0.0108        0.472\n#&gt;    27      1       1   0.0000     NaN           NA           NA\n#&gt; \n#&gt;                 treatment=LDRT \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    13     14       2   0.8571  0.0935       0.6921        1.000\n#&gt;    15     12       1   0.7857  0.1097       0.5977        1.000\n#&gt;    16     11       1   0.7143  0.1207       0.5129        0.995\n#&gt;    18     10       1   0.6429  0.1281       0.4351        0.950\n#&gt;    19      9       2   0.5000  0.1336       0.2961        0.844\n#&gt;    20      7       3   0.2857  0.1207       0.1248        0.654\n#&gt;    24      4       1   0.2143  0.1097       0.0786        0.584\n#&gt;    25      3       1   0.1429  0.0935       0.0396        0.515\n#&gt;    27      2       1   0.0714  0.0688       0.0108        0.472\n#&gt;    30      1       1   0.0000     NaN           NA           NA\n#&gt; \n#&gt;                 treatment=DPVB \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    20     14       1    0.929  0.0688        0.803        1.000\n#&gt;    23     13       1    0.857  0.0935        0.692        1.000\n#&gt;    27     12       1    0.786  0.1097        0.598        1.000\n#&gt;    28     11       1    0.714  0.1207        0.513        0.995\n#&gt;    30     10       1    0.643  0.1281        0.435        0.950\n#&gt;    32      9       1    0.571  0.1323        0.363        0.899\n#&gt;    38      8       1    0.500  0.1336        0.296        0.844\n#&gt;    39      7       1    0.429  0.1323        0.234        0.785\n#&gt;    45      6       1    0.357  0.1281        0.177        0.721\n#&gt; \n#&gt;                 treatment=LR_DPVB \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    30     14       1    0.929  0.0688        0.803            1\n#&gt;    40     13       1    0.857  0.0935        0.692            1",
    "crumbs": [
      "ggplot2 图形",
      "Line",
      "生存曲线"
    ]
  },
  {
    "objectID": "生存曲线.html#plot",
    "href": "生存曲线.html#plot",
    "title": "\n1 生存曲线",
    "section": "",
    "text": "Codeplot(km_fit,\n     lty = 1,\n     col = c(\"gray\",\"blue\",\"orange3\",\"darkred\"),\n     lwd = 2,\n)",
    "crumbs": [
      "ggplot2 图形",
      "Line",
      "生存曲线"
    ]
  },
  {
    "objectID": "生存曲线.html#survminerggsurvplot",
    "href": "生存曲线.html#survminerggsurvplot",
    "title": "\n1 生存曲线",
    "section": "",
    "text": "Code# 使用 ggplot2 和 survminer 绘制生存曲线图\n\np &lt;- ggsurvplot(\n    fit  = km_fit,\n    data = d,\n    fun = \"pct\",  #event',累计死亡比列，'cumhaz':cumulative hazard累计风险\n    \n    palette = \"jco\",\n    linetype = c(1,5,4,6),\n    surv.median.line = 'none',\n    \n    conf.int = F,\n\n    \n    pval = TRUE,# \"log rank p=0.0053\"\n    log.rank.weights='1',  \n    pval.method = TRUE,\n    pval.coord=c(40,75),\n    pval.method.coord=c(32,75),\n    \n    risk.table = \"abs_pct\", # \"nrisk_cumcensor\" and \"nrisk_cumevents\"\n    risk.table.col = \"treatment\",\n    risk.table.height=0.3,\n    tables.theme = theme_cleantable(),\n    ncensor.plot=F,\n  \n    \n    axes.offset=F,  #(0,0)pos\n    title = \"Hepa1-6 tumor\",\n    xlab=\"Days\",\n    ylab=\"Percent survival (%)\",\n    \n    legend.title = \"\",\n    legend = c(0.2,0.35),\n    legend.labs=c('CON','LDRT','DPVB','LR_DPVB'),\n    \n    ggtheme = theme_survminer(),\n)\n#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n#&gt; ℹ Please use `linewidth` instead.\n#&gt; ℹ The deprecated feature was likely used in the ggpubr package.\n#&gt;   Please report the issue at &lt;https://github.com/kassambara/ggpubr/issues&gt;.\np\n\n\n\n\n\n\n\n\nCodefit&lt;- survfit(Surv(time, status) ~ sex, data = lung)\n\n# Basic survival curves\nggsurvplot(fit, data = lung)\n\n\n\n\n\n\nCode\n# Customized survival curves\np &lt;- ggsurvplot(fit, data = lung,\n           surv.median.line = \"hv\", # Add medians survival\n           \n           # Change legends: title & labels\n           legend.title = \"Sex\",\n           legend.labs = c(\"Male\", \"Female\"),\n           # Add p-value and tervals\n           pval = TRUE,\n           \n           conf.int = TRUE,\n           # Add risk table\n           risk.table = TRUE,\n           tables.height = 0.2,\n           tables.theme = theme_cleantable(),\n           \n           # Color palettes. Use custom color: c(\"#E7B800\", \"#2E9FDF\"),\n           # or brewer color (e.g.: \"Dark2\"), or ggsci color (e.g.: \"jco\")\n           palette = c(\"#E7B800\", \"#2E9FDF\"),\n           ggtheme = theme_bw() # Change ggplot2 theme\n)\n\n\n\nCodep &lt;- ggsurvplot(fit, data = lung,\n                surv.median.line = \"hv\", # Add medians survival\n                \n                # Change legends: title & labels\n                legend.title = \"Sex\",\n                legend.labs = c(\"Male\", \"Female\"),\n                # Add p-value and tervals\n                pval = F,    ##不默认显示P\n                conf.int = TRUE,\n                # Add risk table\n                risk.table = TRUE,\n                tables.height = 0.2,\n                tables.theme = theme_cleantable(),\n                \n                # Color palettes. Use custom color: c(\"#E7B800\", \"#2E9FDF\"),\n                # or brewer color (e.g.: \"Dark2\"), or ggsci color (e.g.: \"jco\")\n                palette = c(\"#E7B800\", \"#2E9FDF\"),\n                ggtheme = theme_bw() # Change ggplot2 theme\n)\n##计算公式\ndata.survdiff &lt;- survdiff(Surv(time, status) ~ sex,data = lung)\np.val = 1 - pchisq(data.survdiff$chisq, length(data.survdiff$n) - 1)\nHR = (data.survdiff$obs[2]/data.survdiff$exp[2])/(data.survdiff$obs[1]/data.survdiff$exp[1])\nup95 = exp(log(HR) + qnorm(0.975)*sqrt(1/data.survdiff$exp[2]+1/data.survdiff$exp[1]))\nlow95 = exp(log(HR) - qnorm(0.975)*sqrt(1/data.survdiff$exp[2]+1/data.survdiff$exp[1]))\nci &lt;- paste0(sprintf(\"%.3f\",HR),\" [\",sprintf(\"%.3f\",low95),\", \",sprintf(\"%.3f\",up95),\"]\")\n\np$plot &lt;- p$plot + \n  annotate(\"text\", x = 0, y = 0.05, \n                            label = paste0(\"P value = \",sprintf(\"%.3f\",p.val),\"\\n HR (95% CI) = \",ci),   ###添加P和HR 95%CI\n                            size = 5, color = \"black\", hjust = 0)+\n  theme(text = element_text(size = 15))\np$plot",
    "crumbs": [
      "ggplot2 图形",
      "Line",
      "生存曲线"
    ]
  },
  {
    "objectID": "生存曲线.html#ggsurvfit",
    "href": "生存曲线.html#ggsurvfit",
    "title": "\n1 生存曲线",
    "section": "",
    "text": "Codekm_fit\n#&gt; Call: survfit(formula = Surv(Days, status) ~ treatment, data = structure(list(\n#&gt;     Days = c(11, 13, 14, 14, 15, 17, 17, 17, 20, 20, 21, 21, \n#&gt;     25, 27, 13, 13, 15, 16, 18, 19, 19, 20, 20, 20, 24, 25, 27, \n#&gt;     30, 20, 23, 27, 28, 30, 32, 38, 39, 45, 50, 50, 50, 50, 50, \n#&gt;     30, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50), \n#&gt;     treatment = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n#&gt;     1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, \n#&gt;     2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, \n#&gt;     3L, 3L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, \n#&gt;     4L, 4L), levels = c(\"CON\", \"LDRT\", \"DPVB\", \"LR_DPVB\"), class = \"factor\"), \n#&gt;     status = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, \n#&gt;     1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, \n#&gt;     1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n#&gt;     0, 0)), row.names = c(NA, -56L), class = c(\"tbl_df\", \"tbl\", \n#&gt; \"data.frame\")))\n#&gt; \n#&gt;                    n events median 0.95LCL 0.95UCL\n#&gt; treatment=CON     14     14   17.0      15      25\n#&gt; treatment=LDRT    14     14   19.5      18      27\n#&gt; treatment=DPVB    14      9   38.5      30      NA\n#&gt; treatment=LR_DPVB 14      2     NA      NA      NA\n\n\nkm_fit |&gt; tidy_survfit() |&gt; \n    ggplot(aes(time,estimate,min=conf.low,ymax=conf.low,\n               color=strata,fill=strata))+\n    scale_color_jco()+\n    geom_step()\n\n\n\n\n\n\nCode\nkm_fit |&gt; ggsurvfit()+\n    add_confidence_interval()+\n    # 添加删失点\n    add_censor_mark()  +\n    add_quantile()+\n    add_pvalue(\"annotation\",size=3,x=5,y=0.25)+\n    #add_pvalue(caption = \"Log-rank {p.value}\")+\n    add_risktable(size = 3,risktable_height = 0.3)+\n    add_legend_title(\"treatment\")\n#&gt; ! `add_pvalue()` works with objects created with `survfit2()` or\n#&gt;   `tidycmprsk::cuminc()`.\n#&gt; ℹ `add_pvalue()` has been ignored.",
    "crumbs": [
      "ggplot2 图形",
      "Line",
      "生存曲线"
    ]
  },
  {
    "objectID": "箱线图.html",
    "href": "箱线图.html",
    "title": "\n1 箱线图",
    "section": "",
    "text": "1 箱线图\n\nCodelibrary(ggthemes)\n\nboxplot1.df&lt;-data.frame(rnorm(1000))\ncolnames(boxplot1.df)&lt;-\"data\"\nggplot(boxplot1.df, aes(y=data))+\n  geom_boxplot()+\n  theme_tufte(base_size=12, base_family=\"sans\", ticks=FALSE)+\n  labs(x=\"Dataset\", y=\"Values\")+\n  theme(axis.text.x=element_blank(), axis.title.x=element_blank())+\n  annotate(\"text\", x=1.75, y=0, label=\"median\", size=6)+\n  annotate(\"text\", x=c(-1.75, -1.75), y=c(-0.652, 0.667), label=c(\"25th\\npercentile\", \"75th\\npercentile\"), size=6)+\n  annotate(\"text\", x=c(0.8, 0.8), y=c(-2.508464,2.560529), label=c(\"25th percentile\\n- 1.5(IQR)\", \"75th percentile\\n+ 1.5(IQR)\"), size=6, hjust=0)+\n    annotate(\"text\", x=c(0.8, 0.8), y=c(-2.508464,2.560529), label=c(\"25th percentile\\n- 1.5(IQR)\", \"75th percentile\\n+ 1.5(IQR)\"), size=6, hjust=0)+\n  annotate(\"text\", x=c(-0.8, -0.8), y=c(2.973052, -3.03701), label=\"outliers\", size=6, hjust=1)+\n  geom_segment(x=1.2, xend=0.5, y=0, yend=0, arrow=arrow())+\n  geom_segment(x=-1.2, xend=-0.5, y=-0.652, yend=-0.652, arrow=arrow())+\n  geom_segment(x=-1.2, xend=-0.5, y=0.667, yend=0.6667, arrow=arrow())+\n  geom_segment(x=0.76, xend=0.05, y=2.560529, yend=2.560529, arrow=arrow())+\n  geom_segment(x=-0.76, xend=-0.05, y=2.973052, yend=2.973052, arrow=arrow())+\n  geom_segment(x=-0.76, xend=-0.05, y=-3.03701, yend=-3.03701, arrow=arrow())+\n  xlim(-2, 2)\n\n\n\n\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "base_graphics.html",
    "href": "base_graphics.html",
    "title": "\n1 base graphics",
    "section": "",
    "text": "https://r-charts.com/base-r/\n\n\n\n\n\n\nCode#par()     #返回当前设置，一个list\nopar&lt;-par(no.readonly = TRUE)\n\n\n\nCode# initialization\npar(mar=c(3,3,3,3))\nnum &lt;- 0 ; \nnum1 &lt;- 0\nplot(0,0 , xlim=c(0,21) , ylim=c(0.5,6.5), col=\"white\" , yaxt=\"n\" , ylab=\"\" , xlab=\"\")\n \n#fill the graph\nfor (i in seq(1,20)){\n  points(i,1 , pch=i , cex=3)\n  points(i,2 , col=i , pch=16 , cex=3)\n  points(i,3 , col=\"black\" , pch=16 , cex=i*0.25)\n  \n  #lty\n  if(i %in% c(seq(1,18,3))){\n        num=num+1\n    points(c(i,i+2), c(4,4) , col=\"black\" , lty=num , type=\"l\" , lwd=2)\n        text(i+1.1 , 4.15 , num)\n        }\n  \n  #type and lwd \n  if(i %in% c(seq(1,20,5))){\n    num1=num1+1\n    points(c(i,i+1,i+2,i+3), c(5,5,5,5) , col=\"black\"  , type=c(\"p\",\"l\",\"b\",\"o\")[num1] , lwd=2)\n    text(i+1.1 , 5.2 , c(\"p\",\"l\",\"b\",\"o\")[num1] )\n    points(c(i,i+1,i+2,i+3), c(6,6,6,6) , col=\"black\"  , type=\"l\",  lwd=num1)\n    text(i+1.1 , 6.2 , num1 )\n \n    }\n  }\n \n#add axis\naxis(2, at = c(1,2,3,4,5,6), labels = c(\"pch\" , \"col\" , \"cex\" , \"lty\", \"type\" , \"lwd\" ), \n     tick = TRUE, col = \"black\", las = 1, cex.axis = 0.8)\n\n\n\n\n\n\nCode\npar(opar) #恢复默认设置\n\n\n\n\nCodepar(pch=22) #空心=0、1、2、5、6,  黑色=15:20,  col边界色  bg= 21-25填充\npar(lty=1)  # 1=实线 2:6=虚线\npar(cex.main=2,font.main=4,col.main=\"black\")#font字体样式  4=粗斜体\npar(cex.sub=1.5,font.sub=3,col.sub=\"gray\")  # 3=斜体\npar(cex.lab=1.25,font.lab=2,col.lab=\"purple\")   # 2=粗体\npar(cex.axis=1,font.axis=1,col.axis=\"green4\") # 1=常规\npar(fg=\"black\")   #边框和刻度颜色\npar(bg=\"white\")  #背景色\npar(pin=c(4,3))        #宽×高 1英寸=1.7\npar(mar=c(5,4,4,2)+0.1)    #默认值，边距\n\n\n\nCode# Margins area\npar(oma=c(3,3,3,3)) # all sides have 3 lines of space\npar(mar=c(5,4,4,2) + 0.1)\n\n# Plot\nplot(0:10, 0:10, type=\"n\", xlab=\"X\", ylab=\"Y\") # type=\"n\" hides the points\n\n# Place text in the plot and color everything plot-related red\ntext(5,5, \"Plot\", col=\"red\", cex=2)\nbox(col=\"red\")\n\n# Place text in the margins and label the margins, all in forestgreen  \nmtext(\"Margins\", side=3, line=2, cex=2, col=\"forestgreen\")  \nmtext(\"par(mar=c(b,l,t,r))\", side=3, line=1, cex=1, col=\"forestgreen\")  \nmtext(\"Line 0\", side=3, line=0, adj=1.0, cex=1, col=\"forestgreen\")  \nmtext(\"Line 1\", side=3, line=1, adj=1.0, cex=1, col=\"forestgreen\")  \nmtext(\"Line 2\", side=3, line=2, adj=1.0, cex=1, col=\"forestgreen\")  \nmtext(\"Line 3\", side=3, line=3, adj=1.0, cex=1, col=\"forestgreen\")  \nbox(\"figure\", col=\"forestgreen\")  \n \n# Label the outer margin area and color it blue  \n# Note the 'outer=TRUE' command moves us from the figure margins to the outer margins.  \nmtext(\"Outer Margin Area\", side=1, line=1, cex=2, col=\"blue\", outer=TRUE)  \nmtext(\"par(oma=c(b,l,t,r))\", side=1, line=2, cex=1, col=\"blue\", outer=TRUE)  \nmtext(\"Line 0\", side=1, line=0, adj=0.0, cex=1, col=\"blue\", outer=TRUE)  \nmtext(\"Line 1\", side=1, line=1, adj=0.0, cex=1, col=\"blue\", outer=TRUE)  \nmtext(\"Line 2\", side=1, line=2, adj=0.0, cex=1, col=\"blue\", outer=TRUE)  \nbox(\"outer\", col=\"blue\")  \n\n\n\n\n\n\n\n\n\nCodecolors()\n#&gt;   [1] \"white\"                \"aliceblue\"            \"antiquewhite\"        \n#&gt;   [4] \"antiquewhite1\"        \"antiquewhite2\"        \"antiquewhite3\"       \n#&gt;   [7] \"antiquewhite4\"        \"aquamarine\"           \"aquamarine1\"         \n#&gt;  [10] \"aquamarine2\"          \"aquamarine3\"          \"aquamarine4\"         \n#&gt;  [13] \"azure\"                \"azure1\"               \"azure2\"              \n#&gt;  [16] \"azure3\"               \"azure4\"               \"beige\"               \n#&gt;  [19] \"bisque\"               \"bisque1\"              \"bisque2\"             \n#&gt;  [22] \"bisque3\"              \"bisque4\"              \"black\"               \n#&gt;  [25] \"blanchedalmond\"       \"blue\"                 \"blue1\"               \n#&gt;  [28] \"blue2\"                \"blue3\"                \"blue4\"               \n#&gt;  [31] \"blueviolet\"           \"brown\"                \"brown1\"              \n#&gt;  [34] \"brown2\"               \"brown3\"               \"brown4\"              \n#&gt;  [37] \"burlywood\"            \"burlywood1\"           \"burlywood2\"          \n#&gt;  [40] \"burlywood3\"           \"burlywood4\"           \"cadetblue\"           \n#&gt;  [43] \"cadetblue1\"           \"cadetblue2\"           \"cadetblue3\"          \n#&gt;  [46] \"cadetblue4\"           \"chartreuse\"           \"chartreuse1\"         \n#&gt;  [49] \"chartreuse2\"          \"chartreuse3\"          \"chartreuse4\"         \n#&gt;  [52] \"chocolate\"            \"chocolate1\"           \"chocolate2\"          \n#&gt;  [55] \"chocolate3\"           \"chocolate4\"           \"coral\"               \n#&gt;  [58] \"coral1\"               \"coral2\"               \"coral3\"              \n#&gt;  [61] \"coral4\"               \"cornflowerblue\"       \"cornsilk\"            \n#&gt;  [64] \"cornsilk1\"            \"cornsilk2\"            \"cornsilk3\"           \n#&gt;  [67] \"cornsilk4\"            \"cyan\"                 \"cyan1\"               \n#&gt;  [70] \"cyan2\"                \"cyan3\"                \"cyan4\"               \n#&gt;  [73] \"darkblue\"             \"darkcyan\"             \"darkgoldenrod\"       \n#&gt;  [76] \"darkgoldenrod1\"       \"darkgoldenrod2\"       \"darkgoldenrod3\"      \n#&gt;  [79] \"darkgoldenrod4\"       \"darkgray\"             \"darkgreen\"           \n#&gt;  [82] \"darkgrey\"             \"darkkhaki\"            \"darkmagenta\"         \n#&gt;  [85] \"darkolivegreen\"       \"darkolivegreen1\"      \"darkolivegreen2\"     \n#&gt;  [88] \"darkolivegreen3\"      \"darkolivegreen4\"      \"darkorange\"          \n#&gt;  [91] \"darkorange1\"          \"darkorange2\"          \"darkorange3\"         \n#&gt;  [94] \"darkorange4\"          \"darkorchid\"           \"darkorchid1\"         \n#&gt;  [97] \"darkorchid2\"          \"darkorchid3\"          \"darkorchid4\"         \n#&gt; [100] \"darkred\"              \"darksalmon\"           \"darkseagreen\"        \n#&gt; [103] \"darkseagreen1\"        \"darkseagreen2\"        \"darkseagreen3\"       \n#&gt; [106] \"darkseagreen4\"        \"darkslateblue\"        \"darkslategray\"       \n#&gt; [109] \"darkslategray1\"       \"darkslategray2\"       \"darkslategray3\"      \n#&gt; [112] \"darkslategray4\"       \"darkslategrey\"        \"darkturquoise\"       \n#&gt; [115] \"darkviolet\"           \"deeppink\"             \"deeppink1\"           \n#&gt; [118] \"deeppink2\"            \"deeppink3\"            \"deeppink4\"           \n#&gt; [121] \"deepskyblue\"          \"deepskyblue1\"         \"deepskyblue2\"        \n#&gt; [124] \"deepskyblue3\"         \"deepskyblue4\"         \"dimgray\"             \n#&gt; [127] \"dimgrey\"              \"dodgerblue\"           \"dodgerblue1\"         \n#&gt; [130] \"dodgerblue2\"          \"dodgerblue3\"          \"dodgerblue4\"         \n#&gt; [133] \"firebrick\"            \"firebrick1\"           \"firebrick2\"          \n#&gt; [136] \"firebrick3\"           \"firebrick4\"           \"floralwhite\"         \n#&gt; [139] \"forestgreen\"          \"gainsboro\"            \"ghostwhite\"          \n#&gt; [142] \"gold\"                 \"gold1\"                \"gold2\"               \n#&gt; [145] \"gold3\"                \"gold4\"                \"goldenrod\"           \n#&gt; [148] \"goldenrod1\"           \"goldenrod2\"           \"goldenrod3\"          \n#&gt; [151] \"goldenrod4\"           \"gray\"                 \"gray0\"               \n#&gt; [154] \"gray1\"                \"gray2\"                \"gray3\"               \n#&gt; [157] \"gray4\"                \"gray5\"                \"gray6\"               \n#&gt; [160] \"gray7\"                \"gray8\"                \"gray9\"               \n#&gt; [163] \"gray10\"               \"gray11\"               \"gray12\"              \n#&gt; [166] \"gray13\"               \"gray14\"               \"gray15\"              \n#&gt; [169] \"gray16\"               \"gray17\"               \"gray18\"              \n#&gt; [172] \"gray19\"               \"gray20\"               \"gray21\"              \n#&gt; [175] \"gray22\"               \"gray23\"               \"gray24\"              \n#&gt; [178] \"gray25\"               \"gray26\"               \"gray27\"              \n#&gt; [181] \"gray28\"               \"gray29\"               \"gray30\"              \n#&gt; [184] \"gray31\"               \"gray32\"               \"gray33\"              \n#&gt; [187] \"gray34\"               \"gray35\"               \"gray36\"              \n#&gt; [190] \"gray37\"               \"gray38\"               \"gray39\"              \n#&gt; [193] \"gray40\"               \"gray41\"               \"gray42\"              \n#&gt; [196] \"gray43\"               \"gray44\"               \"gray45\"              \n#&gt; [199] \"gray46\"               \"gray47\"               \"gray48\"              \n#&gt; [202] \"gray49\"               \"gray50\"               \"gray51\"              \n#&gt; [205] \"gray52\"               \"gray53\"               \"gray54\"              \n#&gt; [208] \"gray55\"               \"gray56\"               \"gray57\"              \n#&gt; [211] \"gray58\"               \"gray59\"               \"gray60\"              \n#&gt; [214] \"gray61\"               \"gray62\"               \"gray63\"              \n#&gt; [217] \"gray64\"               \"gray65\"               \"gray66\"              \n#&gt; [220] \"gray67\"               \"gray68\"               \"gray69\"              \n#&gt; [223] \"gray70\"               \"gray71\"               \"gray72\"              \n#&gt; [226] \"gray73\"               \"gray74\"               \"gray75\"              \n#&gt; [229] \"gray76\"               \"gray77\"               \"gray78\"              \n#&gt; [232] \"gray79\"               \"gray80\"               \"gray81\"              \n#&gt; [235] \"gray82\"               \"gray83\"               \"gray84\"              \n#&gt; [238] \"gray85\"               \"gray86\"               \"gray87\"              \n#&gt; [241] \"gray88\"               \"gray89\"               \"gray90\"              \n#&gt; [244] \"gray91\"               \"gray92\"               \"gray93\"              \n#&gt; [247] \"gray94\"               \"gray95\"               \"gray96\"              \n#&gt; [250] \"gray97\"               \"gray98\"               \"gray99\"              \n#&gt; [253] \"gray100\"              \"green\"                \"green1\"              \n#&gt; [256] \"green2\"               \"green3\"               \"green4\"              \n#&gt; [259] \"greenyellow\"          \"grey\"                 \"grey0\"               \n#&gt; [262] \"grey1\"                \"grey2\"                \"grey3\"               \n#&gt; [265] \"grey4\"                \"grey5\"                \"grey6\"               \n#&gt; [268] \"grey7\"                \"grey8\"                \"grey9\"               \n#&gt; [271] \"grey10\"               \"grey11\"               \"grey12\"              \n#&gt; [274] \"grey13\"               \"grey14\"               \"grey15\"              \n#&gt; [277] \"grey16\"               \"grey17\"               \"grey18\"              \n#&gt; [280] \"grey19\"               \"grey20\"               \"grey21\"              \n#&gt; [283] \"grey22\"               \"grey23\"               \"grey24\"              \n#&gt; [286] \"grey25\"               \"grey26\"               \"grey27\"              \n#&gt; [289] \"grey28\"               \"grey29\"               \"grey30\"              \n#&gt; [292] \"grey31\"               \"grey32\"               \"grey33\"              \n#&gt; [295] \"grey34\"               \"grey35\"               \"grey36\"              \n#&gt; [298] \"grey37\"               \"grey38\"               \"grey39\"              \n#&gt; [301] \"grey40\"               \"grey41\"               \"grey42\"              \n#&gt; [304] \"grey43\"               \"grey44\"               \"grey45\"              \n#&gt; [307] \"grey46\"               \"grey47\"               \"grey48\"              \n#&gt; [310] \"grey49\"               \"grey50\"               \"grey51\"              \n#&gt; [313] \"grey52\"               \"grey53\"               \"grey54\"              \n#&gt; [316] \"grey55\"               \"grey56\"               \"grey57\"              \n#&gt; [319] \"grey58\"               \"grey59\"               \"grey60\"              \n#&gt; [322] \"grey61\"               \"grey62\"               \"grey63\"              \n#&gt; [325] \"grey64\"               \"grey65\"               \"grey66\"              \n#&gt; [328] \"grey67\"               \"grey68\"               \"grey69\"              \n#&gt; [331] \"grey70\"               \"grey71\"               \"grey72\"              \n#&gt; [334] \"grey73\"               \"grey74\"               \"grey75\"              \n#&gt; [337] \"grey76\"               \"grey77\"               \"grey78\"              \n#&gt; [340] \"grey79\"               \"grey80\"               \"grey81\"              \n#&gt; [343] \"grey82\"               \"grey83\"               \"grey84\"              \n#&gt; [346] \"grey85\"               \"grey86\"               \"grey87\"              \n#&gt; [349] \"grey88\"               \"grey89\"               \"grey90\"              \n#&gt; [352] \"grey91\"               \"grey92\"               \"grey93\"              \n#&gt; [355] \"grey94\"               \"grey95\"               \"grey96\"              \n#&gt; [358] \"grey97\"               \"grey98\"               \"grey99\"              \n#&gt; [361] \"grey100\"              \"honeydew\"             \"honeydew1\"           \n#&gt; [364] \"honeydew2\"            \"honeydew3\"            \"honeydew4\"           \n#&gt; [367] \"hotpink\"              \"hotpink1\"             \"hotpink2\"            \n#&gt; [370] \"hotpink3\"             \"hotpink4\"             \"indianred\"           \n#&gt; [373] \"indianred1\"           \"indianred2\"           \"indianred3\"          \n#&gt; [376] \"indianred4\"           \"ivory\"                \"ivory1\"              \n#&gt; [379] \"ivory2\"               \"ivory3\"               \"ivory4\"              \n#&gt; [382] \"khaki\"                \"khaki1\"               \"khaki2\"              \n#&gt; [385] \"khaki3\"               \"khaki4\"               \"lavender\"            \n#&gt; [388] \"lavenderblush\"        \"lavenderblush1\"       \"lavenderblush2\"      \n#&gt; [391] \"lavenderblush3\"       \"lavenderblush4\"       \"lawngreen\"           \n#&gt; [394] \"lemonchiffon\"         \"lemonchiffon1\"        \"lemonchiffon2\"       \n#&gt; [397] \"lemonchiffon3\"        \"lemonchiffon4\"        \"lightblue\"           \n#&gt; [400] \"lightblue1\"           \"lightblue2\"           \"lightblue3\"          \n#&gt; [403] \"lightblue4\"           \"lightcoral\"           \"lightcyan\"           \n#&gt; [406] \"lightcyan1\"           \"lightcyan2\"           \"lightcyan3\"          \n#&gt; [409] \"lightcyan4\"           \"lightgoldenrod\"       \"lightgoldenrod1\"     \n#&gt; [412] \"lightgoldenrod2\"      \"lightgoldenrod3\"      \"lightgoldenrod4\"     \n#&gt; [415] \"lightgoldenrodyellow\" \"lightgray\"            \"lightgreen\"          \n#&gt; [418] \"lightgrey\"            \"lightpink\"            \"lightpink1\"          \n#&gt; [421] \"lightpink2\"           \"lightpink3\"           \"lightpink4\"          \n#&gt; [424] \"lightsalmon\"          \"lightsalmon1\"         \"lightsalmon2\"        \n#&gt; [427] \"lightsalmon3\"         \"lightsalmon4\"         \"lightseagreen\"       \n#&gt; [430] \"lightskyblue\"         \"lightskyblue1\"        \"lightskyblue2\"       \n#&gt; [433] \"lightskyblue3\"        \"lightskyblue4\"        \"lightslateblue\"      \n#&gt; [436] \"lightslategray\"       \"lightslategrey\"       \"lightsteelblue\"      \n#&gt; [439] \"lightsteelblue1\"      \"lightsteelblue2\"      \"lightsteelblue3\"     \n#&gt; [442] \"lightsteelblue4\"      \"lightyellow\"          \"lightyellow1\"        \n#&gt; [445] \"lightyellow2\"         \"lightyellow3\"         \"lightyellow4\"        \n#&gt; [448] \"limegreen\"            \"linen\"                \"magenta\"             \n#&gt; [451] \"magenta1\"             \"magenta2\"             \"magenta3\"            \n#&gt; [454] \"magenta4\"             \"maroon\"               \"maroon1\"             \n#&gt; [457] \"maroon2\"              \"maroon3\"              \"maroon4\"             \n#&gt; [460] \"mediumaquamarine\"     \"mediumblue\"           \"mediumorchid\"        \n#&gt; [463] \"mediumorchid1\"        \"mediumorchid2\"        \"mediumorchid3\"       \n#&gt; [466] \"mediumorchid4\"        \"mediumpurple\"         \"mediumpurple1\"       \n#&gt; [469] \"mediumpurple2\"        \"mediumpurple3\"        \"mediumpurple4\"       \n#&gt; [472] \"mediumseagreen\"       \"mediumslateblue\"      \"mediumspringgreen\"   \n#&gt; [475] \"mediumturquoise\"      \"mediumvioletred\"      \"midnightblue\"        \n#&gt; [478] \"mintcream\"            \"mistyrose\"            \"mistyrose1\"          \n#&gt; [481] \"mistyrose2\"           \"mistyrose3\"           \"mistyrose4\"          \n#&gt; [484] \"moccasin\"             \"navajowhite\"          \"navajowhite1\"        \n#&gt; [487] \"navajowhite2\"         \"navajowhite3\"         \"navajowhite4\"        \n#&gt; [490] \"navy\"                 \"navyblue\"             \"oldlace\"             \n#&gt; [493] \"olivedrab\"            \"olivedrab1\"           \"olivedrab2\"          \n#&gt; [496] \"olivedrab3\"           \"olivedrab4\"           \"orange\"              \n#&gt; [499] \"orange1\"              \"orange2\"              \"orange3\"             \n#&gt; [502] \"orange4\"              \"orangered\"            \"orangered1\"          \n#&gt; [505] \"orangered2\"           \"orangered3\"           \"orangered4\"          \n#&gt; [508] \"orchid\"               \"orchid1\"              \"orchid2\"             \n#&gt; [511] \"orchid3\"              \"orchid4\"              \"palegoldenrod\"       \n#&gt; [514] \"palegreen\"            \"palegreen1\"           \"palegreen2\"          \n#&gt; [517] \"palegreen3\"           \"palegreen4\"           \"paleturquoise\"       \n#&gt; [520] \"paleturquoise1\"       \"paleturquoise2\"       \"paleturquoise3\"      \n#&gt; [523] \"paleturquoise4\"       \"palevioletred\"        \"palevioletred1\"      \n#&gt; [526] \"palevioletred2\"       \"palevioletred3\"       \"palevioletred4\"      \n#&gt; [529] \"papayawhip\"           \"peachpuff\"            \"peachpuff1\"          \n#&gt; [532] \"peachpuff2\"           \"peachpuff3\"           \"peachpuff4\"          \n#&gt; [535] \"peru\"                 \"pink\"                 \"pink1\"               \n#&gt; [538] \"pink2\"                \"pink3\"                \"pink4\"               \n#&gt; [541] \"plum\"                 \"plum1\"                \"plum2\"               \n#&gt; [544] \"plum3\"                \"plum4\"                \"powderblue\"          \n#&gt; [547] \"purple\"               \"purple1\"              \"purple2\"             \n#&gt; [550] \"purple3\"              \"purple4\"              \"red\"                 \n#&gt; [553] \"red1\"                 \"red2\"                 \"red3\"                \n#&gt; [556] \"red4\"                 \"rosybrown\"            \"rosybrown1\"          \n#&gt; [559] \"rosybrown2\"           \"rosybrown3\"           \"rosybrown4\"          \n#&gt; [562] \"royalblue\"            \"royalblue1\"           \"royalblue2\"          \n#&gt; [565] \"royalblue3\"           \"royalblue4\"           \"saddlebrown\"         \n#&gt; [568] \"salmon\"               \"salmon1\"              \"salmon2\"             \n#&gt; [571] \"salmon3\"              \"salmon4\"              \"sandybrown\"          \n#&gt; [574] \"seagreen\"             \"seagreen1\"            \"seagreen2\"           \n#&gt; [577] \"seagreen3\"            \"seagreen4\"            \"seashell\"            \n#&gt; [580] \"seashell1\"            \"seashell2\"            \"seashell3\"           \n#&gt; [583] \"seashell4\"            \"sienna\"               \"sienna1\"             \n#&gt; [586] \"sienna2\"              \"sienna3\"              \"sienna4\"             \n#&gt; [589] \"skyblue\"              \"skyblue1\"             \"skyblue2\"            \n#&gt; [592] \"skyblue3\"             \"skyblue4\"             \"slateblue\"           \n#&gt; [595] \"slateblue1\"           \"slateblue2\"           \"slateblue3\"          \n#&gt; [598] \"slateblue4\"           \"slategray\"            \"slategray1\"          \n#&gt; [601] \"slategray2\"           \"slategray3\"           \"slategray4\"          \n#&gt; [604] \"slategrey\"            \"snow\"                 \"snow1\"               \n#&gt; [607] \"snow2\"                \"snow3\"                \"snow4\"               \n#&gt; [610] \"springgreen\"          \"springgreen1\"         \"springgreen2\"        \n#&gt; [613] \"springgreen3\"         \"springgreen4\"         \"steelblue\"           \n#&gt; [616] \"steelblue1\"           \"steelblue2\"           \"steelblue3\"          \n#&gt; [619] \"steelblue4\"           \"tan\"                  \"tan1\"                \n#&gt; [622] \"tan2\"                 \"tan3\"                 \"tan4\"                \n#&gt; [625] \"thistle\"              \"thistle1\"             \"thistle2\"            \n#&gt; [628] \"thistle3\"             \"thistle4\"             \"tomato\"              \n#&gt; [631] \"tomato1\"              \"tomato2\"              \"tomato3\"             \n#&gt; [634] \"tomato4\"              \"turquoise\"            \"turquoise1\"          \n#&gt; [637] \"turquoise2\"           \"turquoise3\"           \"turquoise4\"          \n#&gt; [640] \"violet\"               \"violetred\"            \"violetred1\"          \n#&gt; [643] \"violetred2\"           \"violetred3\"           \"violetred4\"          \n#&gt; [646] \"wheat\"                \"wheat1\"               \"wheat2\"              \n#&gt; [649] \"wheat3\"               \"wheat4\"               \"whitesmoke\"          \n#&gt; [652] \"yellow\"               \"yellow1\"              \"yellow2\"             \n#&gt; [655] \"yellow3\"              \"yellow4\"              \"yellowgreen\"\nrgb(red = 0,green = 1,blue = 1)\n#&gt; [1] \"#00FFFF\"\nhsv()\n#&gt; [1] \"#FF0000\"\nbarplot(1:10,col=c(1:10))\n\n\n\n\n\n\nCode\n### n种连续的彩虹色  十六进制\nrainbow(10)        \n#&gt;  [1] \"#FF0000\" \"#FF9900\" \"#CCFF00\" \"#33FF00\" \"#00FF66\" \"#00FFFF\" \"#0066FF\"\n#&gt;  [8] \"#3300FF\" \"#CC00FF\" \"#FF0099\"\nbarplot(rep(1:15),col=rainbow(10))\n\n\n\n\n\n\nCode\n### n阶灰度色 十六进制\ngray(0:15/15)      \n#&gt;  [1] \"#000000\" \"#111111\" \"#222222\" \"#333333\" \"#444444\" \"#555555\" \"#666666\"\n#&gt;  [8] \"#777777\" \"#888888\" \"#999999\" \"#AAAAAA\" \"#BBBBBB\" \"#CCCCCC\" \"#DDDDDD\"\n#&gt; [15] \"#EEEEEE\" \"#FFFFFF\"\nbarplot(rep(1,15),col=gray(0:15/15))\n\n\n\n\n\n\nCode\nlibrary(RColorBrewer)\nRColorBrewer::display.brewer.all()\n\n\n\n\n\n\nCodebarplot(rep(1,7),col=brewer.pal(7,\"Set3\"))\n\n\n\n\n\n\n\n\nCodedose&lt;-c(20,30,40,45,60)\nA&lt;-c(16,20,27,40,60)\nB&lt;-c(15,18,25,31,40)\nplot(dose,A,type=\"b\",           #type=\"b\" 线连接点\n     \n     col=\"red\",lty=1,pch=18,lwd=3,cex=2,    #点和线属性\n     \n     main=\"Clinical trials for Drug A\",     #主标题\n     sub=\"this is my data\",                  #副标题\n     xlab=\"Dosage\",ylab=\"Drug Response\",    #坐标轴标签\n     xlim=c(0,60),ylim = c(0,70)           #坐标轴范围\n)\n\n\n\n\n\n\n\n\n\nCodepar(mfrow=c(1,2))  \nhist(A)\nhist(A,ann=FALSE)    #ann=FALSE 移除默认标题\ntitle(main=\"main title\", col.main=\"purple\",       #主标题\n      sub=\"subtitle\", col.sub=\"pink\",            #副标题\n      xlab=\"Dosage\",ylab=\"Drug Response\",col.lab=\"red\" ,cex.lab=0.75\n      )\n\n\n\n\n\n\nCodepar(opar)\n\n\n\n\nCodex&lt;-c(1:10)\ny&lt;-x\n\npar(mar=c(5,4,4,4))\npar(mfrow=c(1,2))\nplot(x,y)\nplot(x,y,axes=FALSE)#禁用坐标轴框架、刻度\n\n\n\n\n\n\nCodeplot(x,y,axes=FALSE,frame.plot = TRUE)#禁用刻度\n\n\n\n\n\n\n\n\nCodez&lt;-10/x\nplot(x,y,type=\"b\",pch=21,col=\"red\",bg=\"black\",\n     xaxt=\"n\",yaxt=\"n\",lty=1  #xaxt、yaxt 禁用X、Y坐标轴刻度\n     )\nlines(x,z,type=\"b\",pch=22,col=\"blue\",lty=2,bg=\"green\")  #添加新图形\n#绘制自定义坐标轴\n#axis(side,at= ,labels = ,pos = ,las=,tck=,…)\n#side  1=下，2=左，3=上，4=右 \n#at   数值向量，绘制刻度线的位置\n#labels  字符序列，刻度线的文字标签\n#las    0=垂直于坐标轴，2=平行于坐标轴   \n#tck=-0.01    刻度线的长度   1=网格线 0=禁用刻度  负值在图形外侧，正值在图形内侧\naxis(side = 1,at=x,labels = x,las=0,tck=-0.1)\naxis(side=2,at=x,labels=x,col.axis=\"red\",las=2,tck=0.1)\naxis(side=4,at=z,labels=round(z,digits=3),col.axis=\"blue\",las=2,tck=-.05)\n\n#library(Hmisc)\n#minor.tick(nx=2,ny=2,tick.ratio = .5)#添加次要刻度线\n\n## 图例  legend(location, title, legend,...)\npar(lwd=2,cex=1,font.lab=2)\nlegend(\"top\",inset=0.05,title=\"函数\",c(\"Y=X\",\"Y=10/x\"),text.col = \"green\",\n       lty=c(3,2),pch=c(21,22),col=c(\"red\",\"blue\",bg=c(\"black\",\"green\")))\n\n# 文本\n\n#mtext(\"text\",side,line=,)\nmtext(\"Y=10/X\",side=4,line=3,cex.lab=1,las=2,col=\"blue\")  #边界文本\ntitle(main=\"my graphics\",\n      sub=\"subtitle\",\n      xlab=\"X values\",\n      ylab=\"Y=X\")\nabline(h=c(1,4),lty=2,col=\"red\")  ###添加水平辅助线 \nabline(v=c(8,10),lty=4,col=\"blue\")  ###添加垂直辅助线 \n\n\n# text(x,y,\"text\",pos=)  1=下，2=左，3=上，4=右\ntext(5,5,\"文本1\",pos=4,adj=0,cex=2,col=\"green\")\n\n\n\n\n\n\nCode\n#text(locator[1],\"文本\",pos=4,adj=0,cex=2,col=\"green\")#鼠标点击确定位置\n\n\n\n\nCode#标注点的信息\nA&lt;-c(1:5)\nB&lt;-c(15,23,26,17,21)\nplot(A,B,type=\"b\")\nABC&lt;-data.frame(A,B,row.names =c(\"afaf\",\"fa\",\"faae\",\"agg\",\"grgw\"))\nattach(ABC)\n#&gt; The following objects are masked _by_ .GlobalEnv:\n#&gt; \n#&gt;     A, B\ntext(A,B,row.names(ABC),cex=0.6,pos=4,col=\"blue\")\n\n\n\n\n\n\nCodedetach(ABC)\npar(opar)\n\n\n\n\nCode#layout(matrix,widths=,heights=)\nattach(mtcars)\nmat&lt;-matrix(c(1,1,2,3),2, 2, byrow = FALSE)\nlayout(mat,widths = c(1,0.5),heights = c(0.5,1))\nhist(wt)\nhist(mpg)\nhist(disp)\n\n\n\n\n\n\nCodedetach(mtcars)\n\n\n\n\nCode#参数fig=c(x1,x2,y1,y2)\nattach(mtcars)\npar(fig=c(0,0.8,0,0.8))\nplot(wt,mpg,xlab=\"Miles per Gallon\",ylab=\"Car Weight\")\npar(fig=c(0,0.8,0.55,1),new=TRUE)\nboxplot(wt,horizontal = TRUE,axes=FALSE)\npar(fig=c(0.65,1,0,0.8),new=TRUE)\nboxplot(mpg,axes=FALSE)\nmtext(\"boxplot of wt\",side=3,outer = TRUE,line=-3)\n\n\n\n\n\n\n\n\n\nCodedata(mpg,package=\"ggplot2\") \n\n\n\n\nCodebarplot(table(mpg$drv))\n\n\n\n\n\n\nCodebarplot(table(mpg$drv),horiz = TRUE)\n\n\n\n\n\n\nCode\nbarplot(table(mpg$drv,mpg$class),legend=row.names(table(mpg$drv,mpg$class)))\n\n\n\n\n\n\nCodebarplot(table(mpg$drv,mpg$class),beside = TRUE,\n        legend=row.names(table(mpg$drv,mpg$class)))\n\n\n\n\n\n\nCode\nspineplot(table(mpg$class,mpg$drv))\n\n\n\n\n\n\n\n\n\nCodex&lt;-c(10,12,4,16,8)\nlabs&lt;-c(\"US\",\"UK\",\"Australia\",\"Germany\",\"France\")\n\npie(x,labels=labs,main=\"简单饼图\")\n\n\n\n\n\n\nCodepct&lt;-round(x/sum(x)*100)\nlabs2&lt;-paste(labs,\" \",pct,\"%\",sep=\"\")\npie(x,labels=labs2,col=rainbow(length(labs2)),main=\"百分比饼图\")\n\n\n\n\n\n\n\n\n\nCodehist(mpg$hwy,breaks = 12,col=\"red\")\n\n\n\n\n\n\nCode\nhist(mpg$hwy,freq = FALSE,breaks = 12, col=\"lightgreen\")\nrug(mpg$hwy,col=\"brown\",lwd=2)\nlines(density(mpg$hwy),col=\"blue\",lwd=2)\n\n\n\n\n\n\nCode\nh &lt;- hist(mpg$hwy,breaks = 12,col=\"red\")\nx&lt;-seq(min(mpg$hwy),max(mpg$hwy),by=0.01)\ny&lt;-dnorm(x,mean=mean(mpg$hwy),sd=sd(mpg$hwy))   #概率密度曲线  f(X)=(fi/n)/ΔXi\ny&lt;-y*diff(h$mids[1:2])*length(mpg$hwy)  # y*组距*总样本量  正态分布\nlines(x,y,col=\"blue\",lwd=2)\n\n\n\n\n\n\nCode\nplot(x,y)\n\n\n\n\n\n\n\n\n\nCodeplot(density(mpg$hwy))\npolygon(density(mpg$hwy),col=\"lightblue\",border = \"red\") \nrug(mpg$hwy,col=\"brown\") \n\n\n\n\n\n\n\n\n\nCodeboxplot.stats(mpg$hwy)\n#&gt; $stats\n#&gt; [1] 12 18 24 27 37\n#&gt; \n#&gt; $n\n#&gt; [1] 234\n#&gt; \n#&gt; $conf\n#&gt; [1] 23.07041 24.92959\n#&gt; \n#&gt; $out\n#&gt; [1] 44 44 41\nboxplot(mpg$hwy)\n\n\n\n\n\n\nCode\nboxplot(hwy~drv,data=mpg,\n        notch=TRUE,\n        varwidth=TRUE)\n\n\n\n\n\n\nCode\nboxplot(hwy~drv*cyl,data=mpg)\n\n\n\n\n\n\n\n\n\nCodedotchart(mtcars[order(mtcars$mpg),]$mpg,labels = row.names(mtcars),groups = mtcars$cyl)\n\n\n\n\n\n\nCode\n\n#分组、排序、着色后的点图\nx&lt;-mtcars[order(mtcars$mpg),]\nx$cyl&lt;-factor(x$cyl)\nx$color[x$cyl==4]&lt;-\"red\"\nx$color[x$cyl==6]&lt;-\"yellow\"\nx$color[x$cyl==8]&lt;-\"blue\"\ndotchart(x$mpg,\n         labels = row.names(x),cex=.7,\n         groups = x$cyl,         #分组参数 因子\n         gcolor = \"black\",\n         color = x$color\n         )\n\n\n\n\n\n\n\n\n\nCodecar::scatterplot(mpg~wt|am,data=mtcars,\n            id=TRUE,\n            legend =TRUE,#图例\n            grid=TRUE,   #添加网格线\n            boxplots=\"xy\"  #添加边界箱线图\n)\n\n\n\n\n\n\n#&gt;          Fiat 128         Merc 240D     Maserati Bora Chrysler Imperial \n#&gt;                 4                 5                12                14\n\n\n\nCodecar::scatterplotMatrix(~mpg+disp+drat+wt,data=mtcars)\n\n\n\n\n\n\n\n\n\nCodesymbols(mtcars$wt,mtcars$mpg,\n        circle=sqrt(mtcars$disp/pi),\n        inches = .30, #比例\n        fg=\"white\",bg=\"lightblue\")\ntext(mtcars$wt,mtcars$mpg,row.names(mtcars),cex=.6)\n\n\n\n\n\n\n\n\n\nCodehead(Orange)\n#&gt;   Tree  age circumference\n#&gt; 1    1  118            30\n#&gt; 2    1  484            58\n#&gt; 3    1  664            87\n#&gt; 4    1 1004           115\n#&gt; 5    1 1231           120\n#&gt; 6    1 1372           142\nt1&lt;-subset(Orange,Tree==1)\nplot(t1$age,t1$circumference,type=\"p\")\n\n\n\n\n\n\nCodeplot(t1$age,t1$circumference,type=\"b\")\n\n\n\n\n\n\nCodeplot(t1$age,t1$circumference,type=\"c\")\n\n\n\n\n\n\n\n\ncorrgram()\n\nmosaic()",
    "crumbs": [
      "base 图形",
      "base graphics"
    ]
  },
  {
    "objectID": "base_graphics.html#图形参数",
    "href": "base_graphics.html#图形参数",
    "title": "\n1 base graphics",
    "section": "",
    "text": "Code#par()     #返回当前设置，一个list\nopar&lt;-par(no.readonly = TRUE)\n\n\n\nCode# initialization\npar(mar=c(3,3,3,3))\nnum &lt;- 0 ; \nnum1 &lt;- 0\nplot(0,0 , xlim=c(0,21) , ylim=c(0.5,6.5), col=\"white\" , yaxt=\"n\" , ylab=\"\" , xlab=\"\")\n \n#fill the graph\nfor (i in seq(1,20)){\n  points(i,1 , pch=i , cex=3)\n  points(i,2 , col=i , pch=16 , cex=3)\n  points(i,3 , col=\"black\" , pch=16 , cex=i*0.25)\n  \n  #lty\n  if(i %in% c(seq(1,18,3))){\n        num=num+1\n    points(c(i,i+2), c(4,4) , col=\"black\" , lty=num , type=\"l\" , lwd=2)\n        text(i+1.1 , 4.15 , num)\n        }\n  \n  #type and lwd \n  if(i %in% c(seq(1,20,5))){\n    num1=num1+1\n    points(c(i,i+1,i+2,i+3), c(5,5,5,5) , col=\"black\"  , type=c(\"p\",\"l\",\"b\",\"o\")[num1] , lwd=2)\n    text(i+1.1 , 5.2 , c(\"p\",\"l\",\"b\",\"o\")[num1] )\n    points(c(i,i+1,i+2,i+3), c(6,6,6,6) , col=\"black\"  , type=\"l\",  lwd=num1)\n    text(i+1.1 , 6.2 , num1 )\n \n    }\n  }\n \n#add axis\naxis(2, at = c(1,2,3,4,5,6), labels = c(\"pch\" , \"col\" , \"cex\" , \"lty\", \"type\" , \"lwd\" ), \n     tick = TRUE, col = \"black\", las = 1, cex.axis = 0.8)\n\n\n\n\n\n\nCode\npar(opar) #恢复默认设置\n\n\n\n\nCodepar(pch=22) #空心=0、1、2、5、6,  黑色=15:20,  col边界色  bg= 21-25填充\npar(lty=1)  # 1=实线 2:6=虚线\npar(cex.main=2,font.main=4,col.main=\"black\")#font字体样式  4=粗斜体\npar(cex.sub=1.5,font.sub=3,col.sub=\"gray\")  # 3=斜体\npar(cex.lab=1.25,font.lab=2,col.lab=\"purple\")   # 2=粗体\npar(cex.axis=1,font.axis=1,col.axis=\"green4\") # 1=常规\npar(fg=\"black\")   #边框和刻度颜色\npar(bg=\"white\")  #背景色\npar(pin=c(4,3))        #宽×高 1英寸=1.7\npar(mar=c(5,4,4,2)+0.1)    #默认值，边距\n\n\n\nCode# Margins area\npar(oma=c(3,3,3,3)) # all sides have 3 lines of space\npar(mar=c(5,4,4,2) + 0.1)\n\n# Plot\nplot(0:10, 0:10, type=\"n\", xlab=\"X\", ylab=\"Y\") # type=\"n\" hides the points\n\n# Place text in the plot and color everything plot-related red\ntext(5,5, \"Plot\", col=\"red\", cex=2)\nbox(col=\"red\")\n\n# Place text in the margins and label the margins, all in forestgreen  \nmtext(\"Margins\", side=3, line=2, cex=2, col=\"forestgreen\")  \nmtext(\"par(mar=c(b,l,t,r))\", side=3, line=1, cex=1, col=\"forestgreen\")  \nmtext(\"Line 0\", side=3, line=0, adj=1.0, cex=1, col=\"forestgreen\")  \nmtext(\"Line 1\", side=3, line=1, adj=1.0, cex=1, col=\"forestgreen\")  \nmtext(\"Line 2\", side=3, line=2, adj=1.0, cex=1, col=\"forestgreen\")  \nmtext(\"Line 3\", side=3, line=3, adj=1.0, cex=1, col=\"forestgreen\")  \nbox(\"figure\", col=\"forestgreen\")  \n \n# Label the outer margin area and color it blue  \n# Note the 'outer=TRUE' command moves us from the figure margins to the outer margins.  \nmtext(\"Outer Margin Area\", side=1, line=1, cex=2, col=\"blue\", outer=TRUE)  \nmtext(\"par(oma=c(b,l,t,r))\", side=1, line=2, cex=1, col=\"blue\", outer=TRUE)  \nmtext(\"Line 0\", side=1, line=0, adj=0.0, cex=1, col=\"blue\", outer=TRUE)  \nmtext(\"Line 1\", side=1, line=1, adj=0.0, cex=1, col=\"blue\", outer=TRUE)  \nmtext(\"Line 2\", side=1, line=2, adj=0.0, cex=1, col=\"blue\", outer=TRUE)  \nbox(\"outer\", col=\"blue\")  \n\n\n\n\n\n\n\n\n\nCodecolors()\n#&gt;   [1] \"white\"                \"aliceblue\"            \"antiquewhite\"        \n#&gt;   [4] \"antiquewhite1\"        \"antiquewhite2\"        \"antiquewhite3\"       \n#&gt;   [7] \"antiquewhite4\"        \"aquamarine\"           \"aquamarine1\"         \n#&gt;  [10] \"aquamarine2\"          \"aquamarine3\"          \"aquamarine4\"         \n#&gt;  [13] \"azure\"                \"azure1\"               \"azure2\"              \n#&gt;  [16] \"azure3\"               \"azure4\"               \"beige\"               \n#&gt;  [19] \"bisque\"               \"bisque1\"              \"bisque2\"             \n#&gt;  [22] \"bisque3\"              \"bisque4\"              \"black\"               \n#&gt;  [25] \"blanchedalmond\"       \"blue\"                 \"blue1\"               \n#&gt;  [28] \"blue2\"                \"blue3\"                \"blue4\"               \n#&gt;  [31] \"blueviolet\"           \"brown\"                \"brown1\"              \n#&gt;  [34] \"brown2\"               \"brown3\"               \"brown4\"              \n#&gt;  [37] \"burlywood\"            \"burlywood1\"           \"burlywood2\"          \n#&gt;  [40] \"burlywood3\"           \"burlywood4\"           \"cadetblue\"           \n#&gt;  [43] \"cadetblue1\"           \"cadetblue2\"           \"cadetblue3\"          \n#&gt;  [46] \"cadetblue4\"           \"chartreuse\"           \"chartreuse1\"         \n#&gt;  [49] \"chartreuse2\"          \"chartreuse3\"          \"chartreuse4\"         \n#&gt;  [52] \"chocolate\"            \"chocolate1\"           \"chocolate2\"          \n#&gt;  [55] \"chocolate3\"           \"chocolate4\"           \"coral\"               \n#&gt;  [58] \"coral1\"               \"coral2\"               \"coral3\"              \n#&gt;  [61] \"coral4\"               \"cornflowerblue\"       \"cornsilk\"            \n#&gt;  [64] \"cornsilk1\"            \"cornsilk2\"            \"cornsilk3\"           \n#&gt;  [67] \"cornsilk4\"            \"cyan\"                 \"cyan1\"               \n#&gt;  [70] \"cyan2\"                \"cyan3\"                \"cyan4\"               \n#&gt;  [73] \"darkblue\"             \"darkcyan\"             \"darkgoldenrod\"       \n#&gt;  [76] \"darkgoldenrod1\"       \"darkgoldenrod2\"       \"darkgoldenrod3\"      \n#&gt;  [79] \"darkgoldenrod4\"       \"darkgray\"             \"darkgreen\"           \n#&gt;  [82] \"darkgrey\"             \"darkkhaki\"            \"darkmagenta\"         \n#&gt;  [85] \"darkolivegreen\"       \"darkolivegreen1\"      \"darkolivegreen2\"     \n#&gt;  [88] \"darkolivegreen3\"      \"darkolivegreen4\"      \"darkorange\"          \n#&gt;  [91] \"darkorange1\"          \"darkorange2\"          \"darkorange3\"         \n#&gt;  [94] \"darkorange4\"          \"darkorchid\"           \"darkorchid1\"         \n#&gt;  [97] \"darkorchid2\"          \"darkorchid3\"          \"darkorchid4\"         \n#&gt; [100] \"darkred\"              \"darksalmon\"           \"darkseagreen\"        \n#&gt; [103] \"darkseagreen1\"        \"darkseagreen2\"        \"darkseagreen3\"       \n#&gt; [106] \"darkseagreen4\"        \"darkslateblue\"        \"darkslategray\"       \n#&gt; [109] \"darkslategray1\"       \"darkslategray2\"       \"darkslategray3\"      \n#&gt; [112] \"darkslategray4\"       \"darkslategrey\"        \"darkturquoise\"       \n#&gt; [115] \"darkviolet\"           \"deeppink\"             \"deeppink1\"           \n#&gt; [118] \"deeppink2\"            \"deeppink3\"            \"deeppink4\"           \n#&gt; [121] \"deepskyblue\"          \"deepskyblue1\"         \"deepskyblue2\"        \n#&gt; [124] \"deepskyblue3\"         \"deepskyblue4\"         \"dimgray\"             \n#&gt; [127] \"dimgrey\"              \"dodgerblue\"           \"dodgerblue1\"         \n#&gt; [130] \"dodgerblue2\"          \"dodgerblue3\"          \"dodgerblue4\"         \n#&gt; [133] \"firebrick\"            \"firebrick1\"           \"firebrick2\"          \n#&gt; [136] \"firebrick3\"           \"firebrick4\"           \"floralwhite\"         \n#&gt; [139] \"forestgreen\"          \"gainsboro\"            \"ghostwhite\"          \n#&gt; [142] \"gold\"                 \"gold1\"                \"gold2\"               \n#&gt; [145] \"gold3\"                \"gold4\"                \"goldenrod\"           \n#&gt; [148] \"goldenrod1\"           \"goldenrod2\"           \"goldenrod3\"          \n#&gt; [151] \"goldenrod4\"           \"gray\"                 \"gray0\"               \n#&gt; [154] \"gray1\"                \"gray2\"                \"gray3\"               \n#&gt; [157] \"gray4\"                \"gray5\"                \"gray6\"               \n#&gt; [160] \"gray7\"                \"gray8\"                \"gray9\"               \n#&gt; [163] \"gray10\"               \"gray11\"               \"gray12\"              \n#&gt; [166] \"gray13\"               \"gray14\"               \"gray15\"              \n#&gt; [169] \"gray16\"               \"gray17\"               \"gray18\"              \n#&gt; [172] \"gray19\"               \"gray20\"               \"gray21\"              \n#&gt; [175] \"gray22\"               \"gray23\"               \"gray24\"              \n#&gt; [178] \"gray25\"               \"gray26\"               \"gray27\"              \n#&gt; [181] \"gray28\"               \"gray29\"               \"gray30\"              \n#&gt; [184] \"gray31\"               \"gray32\"               \"gray33\"              \n#&gt; [187] \"gray34\"               \"gray35\"               \"gray36\"              \n#&gt; [190] \"gray37\"               \"gray38\"               \"gray39\"              \n#&gt; [193] \"gray40\"               \"gray41\"               \"gray42\"              \n#&gt; [196] \"gray43\"               \"gray44\"               \"gray45\"              \n#&gt; [199] \"gray46\"               \"gray47\"               \"gray48\"              \n#&gt; [202] \"gray49\"               \"gray50\"               \"gray51\"              \n#&gt; [205] \"gray52\"               \"gray53\"               \"gray54\"              \n#&gt; [208] \"gray55\"               \"gray56\"               \"gray57\"              \n#&gt; [211] \"gray58\"               \"gray59\"               \"gray60\"              \n#&gt; [214] \"gray61\"               \"gray62\"               \"gray63\"              \n#&gt; [217] \"gray64\"               \"gray65\"               \"gray66\"              \n#&gt; [220] \"gray67\"               \"gray68\"               \"gray69\"              \n#&gt; [223] \"gray70\"               \"gray71\"               \"gray72\"              \n#&gt; [226] \"gray73\"               \"gray74\"               \"gray75\"              \n#&gt; [229] \"gray76\"               \"gray77\"               \"gray78\"              \n#&gt; [232] \"gray79\"               \"gray80\"               \"gray81\"              \n#&gt; [235] \"gray82\"               \"gray83\"               \"gray84\"              \n#&gt; [238] \"gray85\"               \"gray86\"               \"gray87\"              \n#&gt; [241] \"gray88\"               \"gray89\"               \"gray90\"              \n#&gt; [244] \"gray91\"               \"gray92\"               \"gray93\"              \n#&gt; [247] \"gray94\"               \"gray95\"               \"gray96\"              \n#&gt; [250] \"gray97\"               \"gray98\"               \"gray99\"              \n#&gt; [253] \"gray100\"              \"green\"                \"green1\"              \n#&gt; [256] \"green2\"               \"green3\"               \"green4\"              \n#&gt; [259] \"greenyellow\"          \"grey\"                 \"grey0\"               \n#&gt; [262] \"grey1\"                \"grey2\"                \"grey3\"               \n#&gt; [265] \"grey4\"                \"grey5\"                \"grey6\"               \n#&gt; [268] \"grey7\"                \"grey8\"                \"grey9\"               \n#&gt; [271] \"grey10\"               \"grey11\"               \"grey12\"              \n#&gt; [274] \"grey13\"               \"grey14\"               \"grey15\"              \n#&gt; [277] \"grey16\"               \"grey17\"               \"grey18\"              \n#&gt; [280] \"grey19\"               \"grey20\"               \"grey21\"              \n#&gt; [283] \"grey22\"               \"grey23\"               \"grey24\"              \n#&gt; [286] \"grey25\"               \"grey26\"               \"grey27\"              \n#&gt; [289] \"grey28\"               \"grey29\"               \"grey30\"              \n#&gt; [292] \"grey31\"               \"grey32\"               \"grey33\"              \n#&gt; [295] \"grey34\"               \"grey35\"               \"grey36\"              \n#&gt; [298] \"grey37\"               \"grey38\"               \"grey39\"              \n#&gt; [301] \"grey40\"               \"grey41\"               \"grey42\"              \n#&gt; [304] \"grey43\"               \"grey44\"               \"grey45\"              \n#&gt; [307] \"grey46\"               \"grey47\"               \"grey48\"              \n#&gt; [310] \"grey49\"               \"grey50\"               \"grey51\"              \n#&gt; [313] \"grey52\"               \"grey53\"               \"grey54\"              \n#&gt; [316] \"grey55\"               \"grey56\"               \"grey57\"              \n#&gt; [319] \"grey58\"               \"grey59\"               \"grey60\"              \n#&gt; [322] \"grey61\"               \"grey62\"               \"grey63\"              \n#&gt; [325] \"grey64\"               \"grey65\"               \"grey66\"              \n#&gt; [328] \"grey67\"               \"grey68\"               \"grey69\"              \n#&gt; [331] \"grey70\"               \"grey71\"               \"grey72\"              \n#&gt; [334] \"grey73\"               \"grey74\"               \"grey75\"              \n#&gt; [337] \"grey76\"               \"grey77\"               \"grey78\"              \n#&gt; [340] \"grey79\"               \"grey80\"               \"grey81\"              \n#&gt; [343] \"grey82\"               \"grey83\"               \"grey84\"              \n#&gt; [346] \"grey85\"               \"grey86\"               \"grey87\"              \n#&gt; [349] \"grey88\"               \"grey89\"               \"grey90\"              \n#&gt; [352] \"grey91\"               \"grey92\"               \"grey93\"              \n#&gt; [355] \"grey94\"               \"grey95\"               \"grey96\"              \n#&gt; [358] \"grey97\"               \"grey98\"               \"grey99\"              \n#&gt; [361] \"grey100\"              \"honeydew\"             \"honeydew1\"           \n#&gt; [364] \"honeydew2\"            \"honeydew3\"            \"honeydew4\"           \n#&gt; [367] \"hotpink\"              \"hotpink1\"             \"hotpink2\"            \n#&gt; [370] \"hotpink3\"             \"hotpink4\"             \"indianred\"           \n#&gt; [373] \"indianred1\"           \"indianred2\"           \"indianred3\"          \n#&gt; [376] \"indianred4\"           \"ivory\"                \"ivory1\"              \n#&gt; [379] \"ivory2\"               \"ivory3\"               \"ivory4\"              \n#&gt; [382] \"khaki\"                \"khaki1\"               \"khaki2\"              \n#&gt; [385] \"khaki3\"               \"khaki4\"               \"lavender\"            \n#&gt; [388] \"lavenderblush\"        \"lavenderblush1\"       \"lavenderblush2\"      \n#&gt; [391] \"lavenderblush3\"       \"lavenderblush4\"       \"lawngreen\"           \n#&gt; [394] \"lemonchiffon\"         \"lemonchiffon1\"        \"lemonchiffon2\"       \n#&gt; [397] \"lemonchiffon3\"        \"lemonchiffon4\"        \"lightblue\"           \n#&gt; [400] \"lightblue1\"           \"lightblue2\"           \"lightblue3\"          \n#&gt; [403] \"lightblue4\"           \"lightcoral\"           \"lightcyan\"           \n#&gt; [406] \"lightcyan1\"           \"lightcyan2\"           \"lightcyan3\"          \n#&gt; [409] \"lightcyan4\"           \"lightgoldenrod\"       \"lightgoldenrod1\"     \n#&gt; [412] \"lightgoldenrod2\"      \"lightgoldenrod3\"      \"lightgoldenrod4\"     \n#&gt; [415] \"lightgoldenrodyellow\" \"lightgray\"            \"lightgreen\"          \n#&gt; [418] \"lightgrey\"            \"lightpink\"            \"lightpink1\"          \n#&gt; [421] \"lightpink2\"           \"lightpink3\"           \"lightpink4\"          \n#&gt; [424] \"lightsalmon\"          \"lightsalmon1\"         \"lightsalmon2\"        \n#&gt; [427] \"lightsalmon3\"         \"lightsalmon4\"         \"lightseagreen\"       \n#&gt; [430] \"lightskyblue\"         \"lightskyblue1\"        \"lightskyblue2\"       \n#&gt; [433] \"lightskyblue3\"        \"lightskyblue4\"        \"lightslateblue\"      \n#&gt; [436] \"lightslategray\"       \"lightslategrey\"       \"lightsteelblue\"      \n#&gt; [439] \"lightsteelblue1\"      \"lightsteelblue2\"      \"lightsteelblue3\"     \n#&gt; [442] \"lightsteelblue4\"      \"lightyellow\"          \"lightyellow1\"        \n#&gt; [445] \"lightyellow2\"         \"lightyellow3\"         \"lightyellow4\"        \n#&gt; [448] \"limegreen\"            \"linen\"                \"magenta\"             \n#&gt; [451] \"magenta1\"             \"magenta2\"             \"magenta3\"            \n#&gt; [454] \"magenta4\"             \"maroon\"               \"maroon1\"             \n#&gt; [457] \"maroon2\"              \"maroon3\"              \"maroon4\"             \n#&gt; [460] \"mediumaquamarine\"     \"mediumblue\"           \"mediumorchid\"        \n#&gt; [463] \"mediumorchid1\"        \"mediumorchid2\"        \"mediumorchid3\"       \n#&gt; [466] \"mediumorchid4\"        \"mediumpurple\"         \"mediumpurple1\"       \n#&gt; [469] \"mediumpurple2\"        \"mediumpurple3\"        \"mediumpurple4\"       \n#&gt; [472] \"mediumseagreen\"       \"mediumslateblue\"      \"mediumspringgreen\"   \n#&gt; [475] \"mediumturquoise\"      \"mediumvioletred\"      \"midnightblue\"        \n#&gt; [478] \"mintcream\"            \"mistyrose\"            \"mistyrose1\"          \n#&gt; [481] \"mistyrose2\"           \"mistyrose3\"           \"mistyrose4\"          \n#&gt; [484] \"moccasin\"             \"navajowhite\"          \"navajowhite1\"        \n#&gt; [487] \"navajowhite2\"         \"navajowhite3\"         \"navajowhite4\"        \n#&gt; [490] \"navy\"                 \"navyblue\"             \"oldlace\"             \n#&gt; [493] \"olivedrab\"            \"olivedrab1\"           \"olivedrab2\"          \n#&gt; [496] \"olivedrab3\"           \"olivedrab4\"           \"orange\"              \n#&gt; [499] \"orange1\"              \"orange2\"              \"orange3\"             \n#&gt; [502] \"orange4\"              \"orangered\"            \"orangered1\"          \n#&gt; [505] \"orangered2\"           \"orangered3\"           \"orangered4\"          \n#&gt; [508] \"orchid\"               \"orchid1\"              \"orchid2\"             \n#&gt; [511] \"orchid3\"              \"orchid4\"              \"palegoldenrod\"       \n#&gt; [514] \"palegreen\"            \"palegreen1\"           \"palegreen2\"          \n#&gt; [517] \"palegreen3\"           \"palegreen4\"           \"paleturquoise\"       \n#&gt; [520] \"paleturquoise1\"       \"paleturquoise2\"       \"paleturquoise3\"      \n#&gt; [523] \"paleturquoise4\"       \"palevioletred\"        \"palevioletred1\"      \n#&gt; [526] \"palevioletred2\"       \"palevioletred3\"       \"palevioletred4\"      \n#&gt; [529] \"papayawhip\"           \"peachpuff\"            \"peachpuff1\"          \n#&gt; [532] \"peachpuff2\"           \"peachpuff3\"           \"peachpuff4\"          \n#&gt; [535] \"peru\"                 \"pink\"                 \"pink1\"               \n#&gt; [538] \"pink2\"                \"pink3\"                \"pink4\"               \n#&gt; [541] \"plum\"                 \"plum1\"                \"plum2\"               \n#&gt; [544] \"plum3\"                \"plum4\"                \"powderblue\"          \n#&gt; [547] \"purple\"               \"purple1\"              \"purple2\"             \n#&gt; [550] \"purple3\"              \"purple4\"              \"red\"                 \n#&gt; [553] \"red1\"                 \"red2\"                 \"red3\"                \n#&gt; [556] \"red4\"                 \"rosybrown\"            \"rosybrown1\"          \n#&gt; [559] \"rosybrown2\"           \"rosybrown3\"           \"rosybrown4\"          \n#&gt; [562] \"royalblue\"            \"royalblue1\"           \"royalblue2\"          \n#&gt; [565] \"royalblue3\"           \"royalblue4\"           \"saddlebrown\"         \n#&gt; [568] \"salmon\"               \"salmon1\"              \"salmon2\"             \n#&gt; [571] \"salmon3\"              \"salmon4\"              \"sandybrown\"          \n#&gt; [574] \"seagreen\"             \"seagreen1\"            \"seagreen2\"           \n#&gt; [577] \"seagreen3\"            \"seagreen4\"            \"seashell\"            \n#&gt; [580] \"seashell1\"            \"seashell2\"            \"seashell3\"           \n#&gt; [583] \"seashell4\"            \"sienna\"               \"sienna1\"             \n#&gt; [586] \"sienna2\"              \"sienna3\"              \"sienna4\"             \n#&gt; [589] \"skyblue\"              \"skyblue1\"             \"skyblue2\"            \n#&gt; [592] \"skyblue3\"             \"skyblue4\"             \"slateblue\"           \n#&gt; [595] \"slateblue1\"           \"slateblue2\"           \"slateblue3\"          \n#&gt; [598] \"slateblue4\"           \"slategray\"            \"slategray1\"          \n#&gt; [601] \"slategray2\"           \"slategray3\"           \"slategray4\"          \n#&gt; [604] \"slategrey\"            \"snow\"                 \"snow1\"               \n#&gt; [607] \"snow2\"                \"snow3\"                \"snow4\"               \n#&gt; [610] \"springgreen\"          \"springgreen1\"         \"springgreen2\"        \n#&gt; [613] \"springgreen3\"         \"springgreen4\"         \"steelblue\"           \n#&gt; [616] \"steelblue1\"           \"steelblue2\"           \"steelblue3\"          \n#&gt; [619] \"steelblue4\"           \"tan\"                  \"tan1\"                \n#&gt; [622] \"tan2\"                 \"tan3\"                 \"tan4\"                \n#&gt; [625] \"thistle\"              \"thistle1\"             \"thistle2\"            \n#&gt; [628] \"thistle3\"             \"thistle4\"             \"tomato\"              \n#&gt; [631] \"tomato1\"              \"tomato2\"              \"tomato3\"             \n#&gt; [634] \"tomato4\"              \"turquoise\"            \"turquoise1\"          \n#&gt; [637] \"turquoise2\"           \"turquoise3\"           \"turquoise4\"          \n#&gt; [640] \"violet\"               \"violetred\"            \"violetred1\"          \n#&gt; [643] \"violetred2\"           \"violetred3\"           \"violetred4\"          \n#&gt; [646] \"wheat\"                \"wheat1\"               \"wheat2\"              \n#&gt; [649] \"wheat3\"               \"wheat4\"               \"whitesmoke\"          \n#&gt; [652] \"yellow\"               \"yellow1\"              \"yellow2\"             \n#&gt; [655] \"yellow3\"              \"yellow4\"              \"yellowgreen\"\nrgb(red = 0,green = 1,blue = 1)\n#&gt; [1] \"#00FFFF\"\nhsv()\n#&gt; [1] \"#FF0000\"\nbarplot(1:10,col=c(1:10))\n\n\n\n\n\n\nCode\n### n种连续的彩虹色  十六进制\nrainbow(10)        \n#&gt;  [1] \"#FF0000\" \"#FF9900\" \"#CCFF00\" \"#33FF00\" \"#00FF66\" \"#00FFFF\" \"#0066FF\"\n#&gt;  [8] \"#3300FF\" \"#CC00FF\" \"#FF0099\"\nbarplot(rep(1:15),col=rainbow(10))\n\n\n\n\n\n\nCode\n### n阶灰度色 十六进制\ngray(0:15/15)      \n#&gt;  [1] \"#000000\" \"#111111\" \"#222222\" \"#333333\" \"#444444\" \"#555555\" \"#666666\"\n#&gt;  [8] \"#777777\" \"#888888\" \"#999999\" \"#AAAAAA\" \"#BBBBBB\" \"#CCCCCC\" \"#DDDDDD\"\n#&gt; [15] \"#EEEEEE\" \"#FFFFFF\"\nbarplot(rep(1,15),col=gray(0:15/15))\n\n\n\n\n\n\nCode\nlibrary(RColorBrewer)\nRColorBrewer::display.brewer.all()\n\n\n\n\n\n\nCodebarplot(rep(1,7),col=brewer.pal(7,\"Set3\"))\n\n\n\n\n\n\n\n\nCodedose&lt;-c(20,30,40,45,60)\nA&lt;-c(16,20,27,40,60)\nB&lt;-c(15,18,25,31,40)\nplot(dose,A,type=\"b\",           #type=\"b\" 线连接点\n     \n     col=\"red\",lty=1,pch=18,lwd=3,cex=2,    #点和线属性\n     \n     main=\"Clinical trials for Drug A\",     #主标题\n     sub=\"this is my data\",                  #副标题\n     xlab=\"Dosage\",ylab=\"Drug Response\",    #坐标轴标签\n     xlim=c(0,60),ylim = c(0,70)           #坐标轴范围\n)",
    "crumbs": [
      "base 图形",
      "base graphics"
    ]
  },
  {
    "objectID": "base_graphics.html#自定义图形标题坐标轴标签",
    "href": "base_graphics.html#自定义图形标题坐标轴标签",
    "title": "\n1 base graphics",
    "section": "",
    "text": "Codepar(mfrow=c(1,2))  \nhist(A)\nhist(A,ann=FALSE)    #ann=FALSE 移除默认标题\ntitle(main=\"main title\", col.main=\"purple\",       #主标题\n      sub=\"subtitle\", col.sub=\"pink\",            #副标题\n      xlab=\"Dosage\",ylab=\"Drug Response\",col.lab=\"red\" ,cex.lab=0.75\n      )\n\n\n\n\n\n\nCodepar(opar)",
    "crumbs": [
      "base 图形",
      "base graphics"
    ]
  },
  {
    "objectID": "base_graphics.html#自定义坐标轴图例文本",
    "href": "base_graphics.html#自定义坐标轴图例文本",
    "title": "\n1 base graphics",
    "section": "",
    "text": "Codex&lt;-c(1:10)\ny&lt;-x\n\npar(mar=c(5,4,4,4))\npar(mfrow=c(1,2))\nplot(x,y)\nplot(x,y,axes=FALSE)#禁用坐标轴框架、刻度\n\n\n\n\n\n\nCodeplot(x,y,axes=FALSE,frame.plot = TRUE)#禁用刻度\n\n\n\n\n\n\n\n\nCodez&lt;-10/x\nplot(x,y,type=\"b\",pch=21,col=\"red\",bg=\"black\",\n     xaxt=\"n\",yaxt=\"n\",lty=1  #xaxt、yaxt 禁用X、Y坐标轴刻度\n     )\nlines(x,z,type=\"b\",pch=22,col=\"blue\",lty=2,bg=\"green\")  #添加新图形\n#绘制自定义坐标轴\n#axis(side,at= ,labels = ,pos = ,las=,tck=,…)\n#side  1=下，2=左，3=上，4=右 \n#at   数值向量，绘制刻度线的位置\n#labels  字符序列，刻度线的文字标签\n#las    0=垂直于坐标轴，2=平行于坐标轴   \n#tck=-0.01    刻度线的长度   1=网格线 0=禁用刻度  负值在图形外侧，正值在图形内侧\naxis(side = 1,at=x,labels = x,las=0,tck=-0.1)\naxis(side=2,at=x,labels=x,col.axis=\"red\",las=2,tck=0.1)\naxis(side=4,at=z,labels=round(z,digits=3),col.axis=\"blue\",las=2,tck=-.05)\n\n#library(Hmisc)\n#minor.tick(nx=2,ny=2,tick.ratio = .5)#添加次要刻度线\n\n## 图例  legend(location, title, legend,...)\npar(lwd=2,cex=1,font.lab=2)\nlegend(\"top\",inset=0.05,title=\"函数\",c(\"Y=X\",\"Y=10/x\"),text.col = \"green\",\n       lty=c(3,2),pch=c(21,22),col=c(\"red\",\"blue\",bg=c(\"black\",\"green\")))\n\n# 文本\n\n#mtext(\"text\",side,line=,)\nmtext(\"Y=10/X\",side=4,line=3,cex.lab=1,las=2,col=\"blue\")  #边界文本\ntitle(main=\"my graphics\",\n      sub=\"subtitle\",\n      xlab=\"X values\",\n      ylab=\"Y=X\")\nabline(h=c(1,4),lty=2,col=\"red\")  ###添加水平辅助线 \nabline(v=c(8,10),lty=4,col=\"blue\")  ###添加垂直辅助线 \n\n\n# text(x,y,\"text\",pos=)  1=下，2=左，3=上，4=右\ntext(5,5,\"文本1\",pos=4,adj=0,cex=2,col=\"green\")\n\n\n\n\n\n\nCode\n#text(locator[1],\"文本\",pos=4,adj=0,cex=2,col=\"green\")#鼠标点击确定位置",
    "crumbs": [
      "base 图形",
      "base graphics"
    ]
  },
  {
    "objectID": "base_graphics.html#添加文本",
    "href": "base_graphics.html#添加文本",
    "title": "\n1 base graphics",
    "section": "",
    "text": "Code#标注点的信息\nA&lt;-c(1:5)\nB&lt;-c(15,23,26,17,21)\nplot(A,B,type=\"b\")\nABC&lt;-data.frame(A,B,row.names =c(\"afaf\",\"fa\",\"faae\",\"agg\",\"grgw\"))\nattach(ABC)\n#&gt; The following objects are masked _by_ .GlobalEnv:\n#&gt; \n#&gt;     A, B\ntext(A,B,row.names(ABC),cex=0.6,pos=4,col=\"blue\")\n\n\n\n\n\n\nCodedetach(ABC)\npar(opar)",
    "crumbs": [
      "base 图形",
      "base graphics"
    ]
  },
  {
    "objectID": "base_graphics.html#图形组合",
    "href": "base_graphics.html#图形组合",
    "title": "\n1 base graphics",
    "section": "",
    "text": "Code#layout(matrix,widths=,heights=)\nattach(mtcars)\nmat&lt;-matrix(c(1,1,2,3),2, 2, byrow = FALSE)\nlayout(mat,widths = c(1,0.5),heights = c(0.5,1))\nhist(wt)\nhist(mpg)\nhist(disp)\n\n\n\n\n\n\nCodedetach(mtcars)",
    "crumbs": [
      "base 图形",
      "base graphics"
    ]
  },
  {
    "objectID": "base_graphics.html#图形的精细控制",
    "href": "base_graphics.html#图形的精细控制",
    "title": "\n1 base graphics",
    "section": "",
    "text": "Code#参数fig=c(x1,x2,y1,y2)\nattach(mtcars)\npar(fig=c(0,0.8,0,0.8))\nplot(wt,mpg,xlab=\"Miles per Gallon\",ylab=\"Car Weight\")\npar(fig=c(0,0.8,0.55,1),new=TRUE)\nboxplot(wt,horizontal = TRUE,axes=FALSE)\npar(fig=c(0.65,1,0,0.8),new=TRUE)\nboxplot(mpg,axes=FALSE)\nmtext(\"boxplot of wt\",side=3,outer = TRUE,line=-3)",
    "crumbs": [
      "base 图形",
      "base graphics"
    ]
  },
  {
    "objectID": "base_graphics.html#geometry",
    "href": "base_graphics.html#geometry",
    "title": "\n1 base graphics",
    "section": "",
    "text": "Codedata(mpg,package=\"ggplot2\") \n\n\n\n\nCodebarplot(table(mpg$drv))\n\n\n\n\n\n\nCodebarplot(table(mpg$drv),horiz = TRUE)\n\n\n\n\n\n\nCode\nbarplot(table(mpg$drv,mpg$class),legend=row.names(table(mpg$drv,mpg$class)))\n\n\n\n\n\n\nCodebarplot(table(mpg$drv,mpg$class),beside = TRUE,\n        legend=row.names(table(mpg$drv,mpg$class)))\n\n\n\n\n\n\nCode\nspineplot(table(mpg$class,mpg$drv))\n\n\n\n\n\n\n\n\n\nCodex&lt;-c(10,12,4,16,8)\nlabs&lt;-c(\"US\",\"UK\",\"Australia\",\"Germany\",\"France\")\n\npie(x,labels=labs,main=\"简单饼图\")\n\n\n\n\n\n\nCodepct&lt;-round(x/sum(x)*100)\nlabs2&lt;-paste(labs,\" \",pct,\"%\",sep=\"\")\npie(x,labels=labs2,col=rainbow(length(labs2)),main=\"百分比饼图\")\n\n\n\n\n\n\n\n\n\nCodehist(mpg$hwy,breaks = 12,col=\"red\")\n\n\n\n\n\n\nCode\nhist(mpg$hwy,freq = FALSE,breaks = 12, col=\"lightgreen\")\nrug(mpg$hwy,col=\"brown\",lwd=2)\nlines(density(mpg$hwy),col=\"blue\",lwd=2)\n\n\n\n\n\n\nCode\nh &lt;- hist(mpg$hwy,breaks = 12,col=\"red\")\nx&lt;-seq(min(mpg$hwy),max(mpg$hwy),by=0.01)\ny&lt;-dnorm(x,mean=mean(mpg$hwy),sd=sd(mpg$hwy))   #概率密度曲线  f(X)=(fi/n)/ΔXi\ny&lt;-y*diff(h$mids[1:2])*length(mpg$hwy)  # y*组距*总样本量  正态分布\nlines(x,y,col=\"blue\",lwd=2)\n\n\n\n\n\n\nCode\nplot(x,y)\n\n\n\n\n\n\n\n\n\nCodeplot(density(mpg$hwy))\npolygon(density(mpg$hwy),col=\"lightblue\",border = \"red\") \nrug(mpg$hwy,col=\"brown\") \n\n\n\n\n\n\n\n\n\nCodeboxplot.stats(mpg$hwy)\n#&gt; $stats\n#&gt; [1] 12 18 24 27 37\n#&gt; \n#&gt; $n\n#&gt; [1] 234\n#&gt; \n#&gt; $conf\n#&gt; [1] 23.07041 24.92959\n#&gt; \n#&gt; $out\n#&gt; [1] 44 44 41\nboxplot(mpg$hwy)\n\n\n\n\n\n\nCode\nboxplot(hwy~drv,data=mpg,\n        notch=TRUE,\n        varwidth=TRUE)\n\n\n\n\n\n\nCode\nboxplot(hwy~drv*cyl,data=mpg)\n\n\n\n\n\n\n\n\n\nCodedotchart(mtcars[order(mtcars$mpg),]$mpg,labels = row.names(mtcars),groups = mtcars$cyl)\n\n\n\n\n\n\nCode\n\n#分组、排序、着色后的点图\nx&lt;-mtcars[order(mtcars$mpg),]\nx$cyl&lt;-factor(x$cyl)\nx$color[x$cyl==4]&lt;-\"red\"\nx$color[x$cyl==6]&lt;-\"yellow\"\nx$color[x$cyl==8]&lt;-\"blue\"\ndotchart(x$mpg,\n         labels = row.names(x),cex=.7,\n         groups = x$cyl,         #分组参数 因子\n         gcolor = \"black\",\n         color = x$color\n         )\n\n\n\n\n\n\n\n\n\nCodecar::scatterplot(mpg~wt|am,data=mtcars,\n            id=TRUE,\n            legend =TRUE,#图例\n            grid=TRUE,   #添加网格线\n            boxplots=\"xy\"  #添加边界箱线图\n)\n\n\n\n\n\n\n#&gt;          Fiat 128         Merc 240D     Maserati Bora Chrysler Imperial \n#&gt;                 4                 5                12                14\n\n\n\nCodecar::scatterplotMatrix(~mpg+disp+drat+wt,data=mtcars)\n\n\n\n\n\n\n\n\n\nCodesymbols(mtcars$wt,mtcars$mpg,\n        circle=sqrt(mtcars$disp/pi),\n        inches = .30, #比例\n        fg=\"white\",bg=\"lightblue\")\ntext(mtcars$wt,mtcars$mpg,row.names(mtcars),cex=.6)\n\n\n\n\n\n\n\n\n\nCodehead(Orange)\n#&gt;   Tree  age circumference\n#&gt; 1    1  118            30\n#&gt; 2    1  484            58\n#&gt; 3    1  664            87\n#&gt; 4    1 1004           115\n#&gt; 5    1 1231           120\n#&gt; 6    1 1372           142\nt1&lt;-subset(Orange,Tree==1)\nplot(t1$age,t1$circumference,type=\"p\")\n\n\n\n\n\n\nCodeplot(t1$age,t1$circumference,type=\"b\")\n\n\n\n\n\n\nCodeplot(t1$age,t1$circumference,type=\"c\")\n\n\n\n\n\n\n\n\ncorrgram()\n\nmosaic()",
    "crumbs": [
      "base 图形",
      "base graphics"
    ]
  }
]