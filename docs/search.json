[
  {
    "objectID": "误差棒图.html",
    "href": "误差棒图.html",
    "title": "",
    "section": "",
    "text": "CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "误差棒图"
    ]
  },
  {
    "objectID": "误差棒图.html#errorbar",
    "href": "误差棒图.html#errorbar",
    "title": "",
    "section": "\n1.1 errorbar",
    "text": "1.1 errorbar\n\nCodecorr_res &lt;- map(mtcars %&gt;% select(-mpg), cor.test, y = mtcars$mpg)\nlibrary(broom)\n\ncorr_res %&gt;% \n    map_dfr(tidy, .id = \"predictor\") %&gt;% \n    ggplot(aes(x = fct_reorder(predictor, estimate))) + \n    geom_point(aes(y = estimate)) + \n    geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = .1) +\n    labs(x = NULL, y = \"Correlation with mpg\")",
    "crumbs": [
      "ggplot2 图形",
      "误差棒图"
    ]
  },
  {
    "objectID": "误差棒图.html#linerange",
    "href": "误差棒图.html#linerange",
    "title": "",
    "section": "\n1.2 linerange",
    "text": "1.2 linerange\n\nCodecorr_res %&gt;% \n    map_dfr(tidy, .id = \"predictor\") %&gt;% \n    ggplot(aes(x = fct_reorder(predictor, estimate))) + \n    geom_point(aes(y = estimate)) + \n    geom_linerange(aes(ymin = conf.low, ymax = conf.high)) +\n    labs(x = NULL, y = \"Correlation with mpg\")",
    "crumbs": [
      "ggplot2 图形",
      "误差棒图"
    ]
  },
  {
    "objectID": "误差棒图.html#pointrange",
    "href": "误差棒图.html#pointrange",
    "title": "",
    "section": "\n1.3 pointrange",
    "text": "1.3 pointrange\n\nCodecorr_res %&gt;% \n    map_dfr(tidy, .id = \"predictor\") %&gt;% \n    ggplot(aes(x = fct_reorder(predictor, estimate))) + \n    geom_pointrange(aes(y = estimate, ymin = conf.low, ymax = conf.high)) +\n    labs(x = NULL, y = \"Correlation with mpg\")",
    "crumbs": [
      "ggplot2 图形",
      "误差棒图"
    ]
  },
  {
    "objectID": "误差棒图.html#crossbar",
    "href": "误差棒图.html#crossbar",
    "title": "",
    "section": "\n1.4 crossbar",
    "text": "1.4 crossbar\n\nCodecorr_res %&gt;% \n    map_dfr(tidy, .id = \"predictor\") %&gt;% \n    ggplot(aes(x = fct_reorder(predictor, estimate))) + \n    geom_crossbar(aes(y = estimate, ymin = conf.low, ymax = conf.high)) +\n    labs(x = NULL, y = \"Correlation with mpg\")",
    "crumbs": [
      "ggplot2 图形",
      "误差棒图"
    ]
  },
  {
    "objectID": "误差棒图.html#section",
    "href": "误差棒图.html#section",
    "title": "",
    "section": "\n1.5 ",
    "text": "1.5",
    "crumbs": [
      "ggplot2 图形",
      "误差棒图"
    ]
  },
  {
    "objectID": "相关图.html",
    "href": "相关图.html",
    "title": "",
    "section": "",
    "text": "关系图相关图 CodeShow All CodeHide All CodeView Source\n1 相关图\n\nCodelibrary(tidyverse)\nlibrary(ggcorrplot)\n\n\n\nCodedata(\"iris\")\ncor&lt;-cor(iris[,1:4])\nggcorrplot(cor)\n\n\n\n\n\n\nCodep.mat &lt;- ggcorrplot::cor_pmat(cor)\nggcorrplot(cor,hc.order=TRUE,lab=TRUE)\n\n\n\n\n\n\nCode\nggcorrplot(cor, hc.order = TRUE, p.mat = p.mat) + \n    labs(title = \"鸢尾花数据集指标相关性\") +\n    theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\n\n\n\n\n\n\n\n Back to top",
    "crumbs": [
      "ggplot2 图形",
      "关系图",
      "相关图"
    ]
  },
  {
    "objectID": "热图.html",
    "href": "热图.html",
    "title": "",
    "section": "",
    "text": "关系图热图 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "关系图",
      "热图"
    ]
  },
  {
    "objectID": "热图.html#pheatmap",
    "href": "热图.html#pheatmap",
    "title": "",
    "section": "\n1.1 pheatmap\n",
    "text": "1.1 pheatmap\n\n\nCodelibrary(pheatmap)\n\n\n\nCode# read test matrix\ntest &lt;- read.delim(\"data/heatmap/heatmap.txt\",header = T,row.names = 1,sep = \"\\t\")\ntest\n#&gt;             Sample1     Sample2      Sample3      Sample4     Sample5\n#&gt; Gene1   1.276788667  1.39970122  1.072416992  0.880483730  0.82856234\n#&gt; Gene2   0.019548561  0.02705895  0.014687243  0.044248741  0.05737813\n#&gt; Gene3   2.395132841  3.07937035  2.256007527  2.415867713  2.48658672\n#&gt; Gene4   0.083182670  0.14317924  0.156855571  0.083322439  0.17252389\n#&gt; Gene5   0.027406019  0.01016765  0.020571287  0.049950368  0.07319428\n#&gt; Gene6   0.015444824  0.01451434  0.013529512  0.008938481  0.02281410\n#&gt; Gene7   0.027244791  0.06197748  0.083861020  0.752735813  0.66726281\n#&gt; Gene8   0.502507993  0.42464105  0.470344575  0.533677126  0.32546274\n#&gt; Gene9   0.854770698  1.01076161  0.831606319  1.207970172  0.92257052\n#&gt; Gene10  2.366194466  2.13447866  1.956382548  0.962606527  1.31203300\n#&gt; Gene11  2.155082130  1.98799347  1.788864352  3.616962038  3.06590887\n#&gt; Gene12  0.129310440  0.09191911  0.104282037  0.243862580  0.24021022\n#&gt; Gene13  0.605845552  0.58849974  0.574435835  0.432609433  0.33815736\n#&gt; Gene14  2.281032962  1.72559272  2.367729880  1.788446640  1.90978813\n#&gt; Gene15  1.098679859  1.12561208  1.114335742  0.721540287  0.62703942\n#&gt; Gene16  3.768603241  3.83448142  3.487697474  3.731478791  3.29533360\n#&gt; Gene17  0.203230074  0.05219244  0.014276941  0.032323746  0.01202423\n#&gt; Gene18  2.152050491  1.85644729  3.813717676  0.640071180  0.54325715\n#&gt; Gene19  0.516357072  0.31591833  0.276653295  0.366272032  0.54603307\n#&gt; Gene20  2.280619557  2.36036186  2.589737224  4.425116212  4.39044996\n#&gt; Gene21  6.825873663  6.68907517  7.000483477  5.783822390  5.86881864\n#&gt; Gene22  0.444148936  0.52574211  0.603483647  0.382820066  0.48857265\n#&gt; Gene23  6.425283872  5.84820317  7.471677403  4.017770676  4.56303969\n#&gt; Gene24  7.981617242  5.09157053  8.114701616 11.528060240 13.19384251\n#&gt; Gene25  6.000165362  5.96854511  5.584680317  4.962957583  4.91216906\n#&gt; Gene26  3.106879065  4.39925858  2.880084674  1.836868100  1.81948848\n#&gt; Gene27  0.974603131  1.10357706  1.088201858  1.090548131  0.80487377\n#&gt; Gene28  0.090236743  0.04519600  0.045398476  0.109017286  0.06329643\n#&gt; Gene29  1.505897916  1.21549506  1.164930941  1.094930273  1.07443412\n#&gt; Gene30  0.418214640  0.48694221  0.696402671  2.029101298  1.40913530\n#&gt; Gene31 12.094173740  6.11129554  5.846019156  1.705766996  2.03015108\n#&gt; Gene32 14.755815240 14.35665477 14.220752920 13.041109820 13.04242876\n#&gt; Gene33  8.567688237  8.45699505  8.462020933  6.893400155  6.32240155\n#&gt; Gene34 28.143258740 29.04805378 27.188386100 21.545128800 20.25762280\n#&gt; Gene35 10.272571930 14.51711069 13.670634660 15.391971720 13.49886440\n#&gt; Gene36  1.230432146  1.33515921  1.281579532  0.975571373  0.85519141\n#&gt; Gene37  2.105335685  2.12880737  2.290242914  2.313335270  2.16477765\n#&gt; Gene38 79.213978610 81.18377735 77.198186310 81.823794310 79.83893089\n#&gt; Gene39  8.132510197  7.49287631  6.970690849  8.731115630  7.74492270\n#&gt; Gene40  0.753541506  0.83845132  1.001006155  0.997615243  0.60000439\n#&gt; Gene41  0.325474038  0.30016322  0.350076442  0.200246949  0.21014691\n#&gt; Gene42  0.797210892  1.09573409  0.763174744  0.803602557  0.35076420\n#&gt; Gene43  0.574330283  0.68311340  0.591644997  0.388098005  0.32650509\n#&gt; Gene44 14.185315840 14.51019448 14.120137460 10.248523150  9.98540723\n#&gt; Gene45  0.265364899  0.17134202  0.109452626  0.281498160  0.48228569\n#&gt; Gene46 10.906735750 11.40647910 11.379215720 10.631052680 10.69211442\n#&gt; Gene47  5.665169221  5.94489169  5.530583178  5.948818516  5.76601091\n#&gt; Gene48  2.109194135  2.17929565  2.348260137  2.454241720  2.34274366\n#&gt; Gene49  0.004976574  0.00442388  0.006059272  0.025406740  0.03158951\n#&gt; Gene50  0.578367876  0.88617313  0.713324361  0.222133450  0.18598655\n#&gt;            Sample6\n#&gt; Gene1   0.69472331\n#&gt; Gene2   0.05942839\n#&gt; Gene3   2.43571945\n#&gt; Gene4   0.06852347\n#&gt; Gene5   0.06896061\n#&gt; Gene6   0.01208279\n#&gt; Gene7   0.69213029\n#&gt; Gene8   0.48171690\n#&gt; Gene9   1.06054591\n#&gt; Gene10  1.32278532\n#&gt; Gene11  3.51641291\n#&gt; Gene12  0.30601099\n#&gt; Gene13  0.41972532\n#&gt; Gene14  1.63142375\n#&gt; Gene15  0.66917172\n#&gt; Gene16  3.27913994\n#&gt; Gene17  0.01399543\n#&gt; Gene18  0.86020629\n#&gt; Gene19  0.58455431\n#&gt; Gene20  4.81441537\n#&gt; Gene21  5.68732288\n#&gt; Gene22  0.47799947\n#&gt; Gene23  5.39830421\n#&gt; Gene24 11.26897438\n#&gt; Gene25  5.28402767\n#&gt; Gene26  2.04171782\n#&gt; Gene27  1.04176371\n#&gt; Gene28  0.03033377\n#&gt; Gene29  1.21975286\n#&gt; Gene30  2.41736177\n#&gt; Gene31  1.87294193\n#&gt; Gene32 13.67646890\n#&gt; Gene33  5.82982434\n#&gt; Gene34 20.53076632\n#&gt; Gene35 12.53599826\n#&gt; Gene36  0.86309763\n#&gt; Gene37  2.43503104\n#&gt; Gene38 76.55265785\n#&gt; Gene39  7.53249882\n#&gt; Gene40  0.95383044\n#&gt; Gene41  0.09595213\n#&gt; Gene42  0.81975056\n#&gt; Gene43  0.43375747\n#&gt; Gene44 10.42543915\n#&gt; Gene45  0.38292966\n#&gt; Gene46 10.73717544\n#&gt; Gene47  5.88971626\n#&gt; Gene48  2.41323130\n#&gt; Gene49  0.06582145\n#&gt; Gene50  0.27235908\n\nsample_group &lt;- read.delim(\"data/heatmap/sample.class.txt\",header = T,row.names = 1,sep = \"\\t\")\ngene_group &lt;- read.delim(\"data/heatmap/gene.class.txt\",header = T,row.names = 1,sep = \"\\t\")\n\n\n\nCodepheatmap(test,\n         annotation_legend = T,#legend_breaks = seq(-1,1,0.2), legend_labels = seq(-1,1,0.2),\n         show_rownames = T,show_colnames = T,\n         fontsize = 12,\n         color = colorRampPalette(c(\"#0000ff\",\"#ffffff\",\"#ff0000\"))(200),\n         border_color = NA,\n         scale = \"row\",       # 归一化\n         cluster_rows = T,cluster_cols = T,clustering_distance_rows = \"correlation\",\n         display_numbers = TRUE, number_format = \"%.1e\",\n         \n \n         \n         treeheight_row = 12,\n         treeheight_col = 12,\n         \n         annotation_row = gene_group,annotation_col = sample_group,\n         )\n#&gt; Warning: The input is a data frame, convert it to the matrix.",
    "crumbs": [
      "ggplot2 图形",
      "关系图",
      "热图"
    ]
  },
  {
    "objectID": "热图.html#相关性热图",
    "href": "热图.html#相关性热图",
    "title": "",
    "section": "\n1.2 相关性热图",
    "text": "1.2 相关性热图\n\nCoder &lt;- cor(test,method = \"pearson\",use = \"pairwise.complete.obs\")\n\nr\n#&gt;           Sample1   Sample2   Sample3   Sample4   Sample5   Sample6\n#&gt; Sample1 1.0000000 0.9952840 0.9957627 0.9830767 0.9830091 0.9851351\n#&gt; Sample2 0.9952840 1.0000000 0.9983278 0.9887180 0.9865182 0.9891590\n#&gt; Sample3 0.9957627 0.9983278 1.0000000 0.9902566 0.9893629 0.9915575\n#&gt; Sample4 0.9830767 0.9887180 0.9902566 1.0000000 0.9992817 0.9990420\n#&gt; Sample5 0.9830091 0.9865182 0.9893629 0.9992817 1.0000000 0.9993162\n#&gt; Sample6 0.9851351 0.9891590 0.9915575 0.9990420 0.9993162 1.0000000\n\npheatmap(r,fontsize = 12,\n         color = colorRampPalette(c(\"#0000ff\",\"#ffffff\",\"#ff0000\"))(200),)\n\n\n\n\n\n\n\n\nCodepheatmap(test, kmeans_k = 2,\n                 cellwidth = 30,cellheight = 25,)\n#&gt; Warning: The input is a data frame, convert it to the matrix.\n#&gt; Warning: argument `kmeans_k` is not suggested to use in pheatmap -&gt; Heatmap\n#&gt; translation because it changes the input matrix. You might check\n#&gt; `row_km` and `column_km` arguments in Heatmap().\n\n\n\n\n\n\n\n\nCode# Show text within cells\npheatmap(test, display_numbers = TRUE)\n#&gt; Warning: The input is a data frame, convert it to the matrix.\n\n\n\n\n\n\nCodepheatmap(test, display_numbers = matrix(ifelse(test &gt; 5, \"*\", \"\"), nrow(test)))\n#&gt; Warning: The input is a data frame, convert it to the matrix.",
    "crumbs": [
      "ggplot2 图形",
      "关系图",
      "热图"
    ]
  },
  {
    "objectID": "热图.html#geom_tile",
    "href": "热图.html#geom_tile",
    "title": "",
    "section": "\n1.3 geom_tile()\n",
    "text": "1.3 geom_tile()\n\n\nCode# 设置随机数种子以确保结果的可重复性  \nset.seed(10)  \n  \n# 生成随机数据集  \nmydata &lt;- tibble(  \n  year = 2000:2024,  \n  lung = runif(25),  \n  liver = runif(25), \n  bone = runif(25),  \n  luk = runif(25),  \n  eso = runif(25),  \n  gas = runif(25),   \n  eye = runif(25),  \n  brain = runif(25),  \n  pan = runif(25),  \n  kidney = runif(25),  \n  breast= runif(25),  \n)  |&gt; pivot_longer(cols = -1,\n                   names_to = \"cancer\",\n                   values_to = \"morbidity\")\n\nggplot(mydata, aes(year, cancer)) +  \n  geom_tile(aes(fill =morbidity)) +  \n  scale_fill_gradient(low = \"white\", high = \"red\")",
    "crumbs": [
      "ggplot2 图形",
      "关系图",
      "热图"
    ]
  },
  {
    "objectID": "热图.html#complexheatmap",
    "href": "热图.html#complexheatmap",
    "title": "",
    "section": "\n1.4 ComplexHeatmap\n",
    "text": "1.4 ComplexHeatmap\n\nhttps://jokergoo.github.io/ComplexHeatmap-reference/book/\n\nCodeif(!require(ComplexHeatmap)) BiocManager::install(\"ComplexHeatmap\")\n\n\n\nCodeset.seed(123)\nnr1 = 4; nr2 = 8; nr3 = 6; nr = nr1 + nr2 + nr3\nnc1 = 6; nc2 = 8; nc3 = 10; nc = nc1 + nc2 + nc3\nmat = cbind(rbind(matrix(rnorm(nr1*nc1, mean = 1,   sd = 0.5), nrow  = nr1),\n          matrix(rnorm(nr2*nc1, mean = 0,   sd = 0.5), nrow = nr2),\n          matrix(rnorm(nr3*nc1, mean = 0,   sd = 0.5), nrow = nr3)),\n    rbind(matrix(rnorm(nr1*nc2, mean = 0,   sd = 0.5), nrow = nr1),\n          matrix(rnorm(nr2*nc2, mean = 1,   sd = 0.5), nrow = nr2),\n          matrix(rnorm(nr3*nc2, mean = 0,   sd = 0.5), nrow = nr3)),\n    rbind(matrix(rnorm(nr1*nc3, mean = 0.5, sd = 0.5), nrow = nr1),\n          matrix(rnorm(nr2*nc3, mean = 0.5, sd = 0.5), nrow = nr2),\n          matrix(rnorm(nr3*nc3, mean = 1,   sd = 0.5), nrow = nr3))\n   )\nmat = mat[sample(nr, nr), sample(nc, nc)] # random shuffle rows and columns\nrownames(mat) = paste0(\"row\", seq_len(nr))\ncolnames(mat) = paste0(\"column\", seq_len(nc))\n\n\n\nCodeHeatmap(mat)\n\n\n\n\n\n\n\n\nCodeset.seed(123)\nmat = matrix(rnorm(100), 10)\nrownames(mat) = paste0(\"R\", 1:10)\ncolnames(mat) = paste0(\"C\", 1:10)\ncolumn_ha = HeatmapAnnotation(foo1 = runif(10), bar1 = anno_barplot(runif(10)))\nrow_ha = rowAnnotation(foo2 = runif(10), bar2 = anno_barplot(runif(10)))\nHeatmap(mat, name = \"mat\", top_annotation = column_ha, right_annotation = row_ha)",
    "crumbs": [
      "ggplot2 图形",
      "关系图",
      "热图"
    ]
  },
  {
    "objectID": "条图.html",
    "href": "条图.html",
    "title": "",
    "section": "",
    "text": "条形图条图 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "条形图",
      "条图"
    ]
  },
  {
    "objectID": "条图.html#基础柱状图",
    "href": "条图.html#基础柱状图",
    "title": "",
    "section": "\n1.1 基础柱状图",
    "text": "1.1 基础柱状图\n\nCodeggplot(df,aes(supp,len))+\n    geom_col()\n\n\n\n\n\n\nCode\nggplot(df,aes(supp,len))+\n    geom_bar(stat = \"identity\")",
    "crumbs": [
      "ggplot2 图形",
      "条形图",
      "条图"
    ]
  },
  {
    "objectID": "条图.html#修改边框和填充颜色",
    "href": "条图.html#修改边框和填充颜色",
    "title": "",
    "section": "\n1.2 修改边框和填充颜色",
    "text": "1.2 修改边框和填充颜色\n\nCodeggplot(df,aes(dose,len,color=factor(dose)))+\n    geom_col(fill=NA)",
    "crumbs": [
      "ggplot2 图形",
      "条形图",
      "条图"
    ]
  },
  {
    "objectID": "条图.html#添加标签",
    "href": "条图.html#添加标签",
    "title": "",
    "section": "\n1.3 添加标签",
    "text": "1.3 添加标签\n\nCodeggplot(df,aes(id,len))+\n    geom_col()+\n   ggrepel::geom_text_repel(aes(y=len+3,label=len))",
    "crumbs": [
      "ggplot2 图形",
      "条形图",
      "条图"
    ]
  },
  {
    "objectID": "条图.html#添加散点抖动点",
    "href": "条图.html#添加散点抖动点",
    "title": "",
    "section": "\n1.4 添加散点、抖动点",
    "text": "1.4 添加散点、抖动点\n\nCodeggplot(mpg, aes(x = drv, y = hwy, fill = as.factor(cyl))) +  \n    geom_bar(stat = \"summary\",fun=mean, position = position_dodge(1)) +\n    stat_summary(fun.data = 'mean_sd',geom=\"errorbar\",position = position_dodge(1),\n                 width=.2,linewidth=1)+\n    geom_point(position = position_dodge(1), \n              size = 3,alpha=0.3\n             )  \n\n\n\n\n\n\n\n\nCodedf &lt;- ToothGrowth\nggplot(df, aes(x = supp, y = len)) +\n    geom_bar(\n        aes(fill = factor(dose)),\n        stat = \"summary\",\n        fun = mean,\n        position = position_dodge(width = 0.9)\n    ) +\n    geom_point(position = position_jitterdodge(jitter.width = 0.1),\n               aes(color = factor(dose)),\n               alpha = 0.7)+\n    scale_color_manual(values = c(\"red\",\"green\",\"blue\"))|\n    ggplot(df, aes(x = supp, y = len)) +\n    geom_bar(\n        aes(fill = factor(dose)),\n        stat = \"summary\",\n        fun = mean,\n        position = position_dodge(width = 0.9)\n    ) +\n    geom_dotplot(position = position_dodge(width = 0.9),\n               aes(fill = factor(dose)),dotsize = 0.8,\n               binaxis = \"y\", stackdir = \"center\",color=\"black\",\n               alpha = 0.7)+\n    scale_fill_manual(values = c(\"red\",\"green\",\"blue\"))\n#&gt; Bin width defaults to 1/30 of the range of the data. Pick better value with\n#&gt; `binwidth`.",
    "crumbs": [
      "ggplot2 图形",
      "条形图",
      "条图"
    ]
  },
  {
    "objectID": "条图.html#分组排序条图-waterfall-barplot",
    "href": "条图.html#分组排序条图-waterfall-barplot",
    "title": "",
    "section": "\n1.5 分组排序条图 waterfall barplot",
    "text": "1.5 分组排序条图 waterfall barplot\n\nCodelibrary(tidyverse)\nlibrary(ggpubr)\nlibrary(ggsci)\nlibrary(readxl)\nc &lt;- read_excel(\"data/01source.xlsx\",sheet=1,range = \"A2:D16\") |&gt; \n  rename(\n    LR_DPVB=`LR-DPVB`\n  )  |&gt; \n  pivot_longer(\n    cols = CON:LR_DPVB,\n    names_to = \"treatment\",\n    values_to = \"changerate\"\n  ) |&gt; \n  mutate(\n    treatment=factor(treatment,levels=c('CON','LDRT','DPVB','LR_DPVB')),\n    changerate=if_else(changerate&gt;=1,100,changerate*100)\n  ) |&gt; \n  arrange(treatment)|&gt;\n  drop_na() |&gt; \n  mutate(\n    id=1:52\n    ) \n\n\n\nCode\nggplot( c ,aes(x=id,y=changerate,fill=treatment))+ \n  geom_bar(stat = \"identity\",position = \"dodge\",width =0.8)+\n    scale_fill_jco()+\n    scale_y_continuous(name = \"MRI tumor volume change from baseline (%)\",\n                       limits = c(-100,100),\n                       breaks = seq(-100,100,50),\n                       )+\n    theme_pubr()+\n    theme(\n        legend.position = c(0.8,0.8),\n        legend.title = element_blank(),\n        axis.title.x = element_blank(),\n        axis.text.x = element_blank(),\n        axis.ticks.x = element_blank(),\n        axis.line.x = element_blank(),\n        plot.title = element_text(hjust = 0.5),\n    )+\n    ggtitle(\"Hepa1-6 tumor\")+\n    geom_hline(yintercept = 0,color = \"black\",linetype =1,linewidth=0.8)+\n    geom_hline(yintercept=c(20,-30), colour=\"gray15\", linetype=3,linewidth=0.8)+                # 0 = blank, 1 = solid, 2 = dashed, 3 = dotted, \n            # 4 = dotdash, 5 = longdash, 6 = twodash\n    annotate(geom = \"text\",x=c(2,50),y=c(-30,20),\n             label = c(\"PR:-30%\",\"PD:20%\"),\n             vjust = -0.5,\n             )   \n#&gt; Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2\n#&gt; 3.5.0.\n#&gt; ℹ Please use the `legend.position.inside` argument of `theme()` instead.",
    "crumbs": [
      "ggplot2 图形",
      "条形图",
      "条图"
    ]
  },
  {
    "objectID": "条图.html#复杂条图",
    "href": "条图.html#复杂条图",
    "title": "",
    "section": "\n1.6 复杂条图",
    "text": "1.6 复杂条图\n\n1.6.1 分组条形图添加 errorbar、significance 、dotplot\nggpubr\n\nCodeg&lt;-read_excel(\"data/01source.xlsx\",sheet=1,range=\"G2:Z3\") \n#&gt; New names:\n#&gt; • `` -&gt; `...2`\n#&gt; • `` -&gt; `...3`\n#&gt; • `` -&gt; `...4`\n#&gt; • `` -&gt; `...5`\n#&gt; • `` -&gt; `...7`\n#&gt; • `` -&gt; `...8`\n#&gt; • `` -&gt; `...9`\n#&gt; • `` -&gt; `...10`\n#&gt; • `` -&gt; `...12`\n#&gt; • `` -&gt; `...13`\n#&gt; • `` -&gt; `...14`\n#&gt; • `` -&gt; `...15`\n#&gt; • `` -&gt; `...17`\n#&gt; • `` -&gt; `...18`\n#&gt; • `` -&gt; `...19`\n#&gt; • `` -&gt; `...20`\ncolnames(g) &lt;- rep(c('CON','LDRT','DPVB','LR_DPVB'),each=5)\ng&lt;- g |&gt;  pivot_longer(\n  cols = everything(),\n  names_to = \"treatment\",\n  values_to = \"liverweight\"\n  )|&gt; \n  mutate(\n    treatment=factor(treatment,levels=c('CON','LDRT','DPVB','LR_DPVB'))\n  )\ng\n#&gt; # A tibble: 20 × 2\n#&gt;    treatment liverweight\n#&gt;    &lt;fct&gt;           &lt;dbl&gt;\n#&gt;  1 CON              1.75\n#&gt;  2 CON              1.8 \n#&gt;  3 CON              2.01\n#&gt;  4 CON              1.52\n#&gt;  5 CON              1.63\n#&gt;  6 LDRT             1.73\n#&gt;  7 LDRT             2.05\n#&gt;  8 LDRT             1.48\n#&gt;  9 LDRT             1.66\n#&gt; 10 LDRT             1.68\n#&gt; 11 DPVB             1.2 \n#&gt; 12 DPVB             1.38\n#&gt; 13 DPVB             1.52\n#&gt; 14 DPVB             1.62\n#&gt; 15 DPVB             1.39\n#&gt; 16 LR_DPVB          1.2 \n#&gt; 17 LR_DPVB          1.23\n#&gt; 18 LR_DPVB          1.13\n#&gt; 19 LR_DPVB          1.03\n#&gt; 20 LR_DPVB          0.89\n\n\n\nCodesource(\"function/calculate_t_tests.R\")\ncalculate_t_tests(g,\"treatment\",\"liverweight\")\n#&gt;                  CON         LDRT        DPVB LR_DPVB\n#&gt; CON               NA           NA          NA      NA\n#&gt; LDRT    0.8639404014           NA          NA      NA\n#&gt; DPVB    0.0193695457 0.0359059495          NA      NA\n#&gt; LR_DPVB 0.0003376202 0.0008265681 0.008820249      NA\n\n\n\n\n\n\n\n\nNote\n\n\n\n函数calculate_t_tests\n\nCode# 定义计算两两组之间t检验的函数\ncalculate_t_tests &lt;- function(data, group_by, value_column) {\n  # data: 数据框\n  # group_by: 组别的列名\n  # value_column: 要比较的数值的列名\n  \n  # 提取唯一的组别\n  groups &lt;- unique(data[[group_by]])\n  \n  # 初始化结果矩阵\n  result_matrix &lt;- matrix(NA, nrow = length(groups), ncol = length(groups),\n                          dimnames = list(groups, groups))\n  \n  # 循环遍历所有可能的组合\n  for (i in 1:(length(groups)-1)) {\n    for (j in (i+1):length(groups)) {\n      # 提取两组数据\n      group1_data &lt;- data[data[[group_by]] == groups[i], value_column]\n      group2_data &lt;- data[data[[group_by]] == groups[j], value_column]\n      \n      # 执行t检验\n      t_test_result &lt;- t.test(group1_data, group2_data)\n      \n      # 提取p值\n      p_value &lt;- t_test_result$p.value\n      \n      # 将p值存入结果矩阵\n      #result_matrix[groups[i], groups[j]] &lt;- p_value\n      result_matrix[groups[j], groups[i]] &lt;- p_value\n    }\n  }\n  \n  # 返回结果矩阵\n  return(result_matrix)\n}\n\n\n\n\n\n1.6.2 ggpubr\n\nCodelibrary(ggpubr)\nggbarplot(data = g,\n          x=\"treatment\",y=\"liverweight\",\n          add = c(\"mean_sd\"),\n          fill = \"treatment\",\n          palette = \"jco\",\n          title = \"DEN+CCl4 tumor\",\n          xlab = \"\",\n          ylab='liver weight (g)',\n          legend='none',\n          )+\n  stat_compare_means(\n      #aes(label='p.format'),\n      comparisons = list(c('CON','LDRT'),c(\"DPVB\",'LR_DPVB'), c(\"CON\",\"LR_DPVB\")),\n      method = 't.test',\n      tip.length = c(0,0,0,0,0,0),\n      bracket.size = 1,linewidth=1)+\n\n  theme(plot.title = element_text(hjust = 0.5),\n        axis.text.x = element_text(angle = 45,vjust = 0.5))+\n  geom_dotplot(data = g,\n               mapping=aes(x=treatment,y=liverweight),\n               binaxis = 'y',stackdir = 'center',binwidth = 0.05)\n\n\n\n\n\n\n\n\n1.6.3 ggplot2+ggsignif\n\nCodelibrary(ggsignif)\ng |&gt; \n  summarise(\n    n=n(),\n    mean=mean(liverweight),\n    sd=sd(liverweight),\n    .by=treatment\n  ) |&gt; \n    ggplot(aes(treatment,mean,fill=treatment))+\n    geom_bar(stat = \"identity\",width = .7,position = position_dodge())+#条形图\n    geom_errorbar(aes(ymin=mean-sd,ymax=mean+sd),\n                  width=.2,color=\"black\",linewidth=.8)+#误差棒\n    geom_signif(data = g,\n              mapping=aes(x=treatment,y=liverweight),\n              comparisons = list(c('CON','LDRT'),c(\"DPVB\",'LR_DPVB'),\n                                 c(\"CON\",\"LR_DPVB\")),\n              annotations = c(\"p=0.8639\",\"p=0.0088\",\"p=0.00034\"),\n              map_signif_level=F,\n              tip_length=c(0.0,0.0,0.0,0.0,0.0,0.0),\n              y_position=c(2.1,1.8,2.35),size = .8,\n              textsize = 5,\n              test = \"t.test\"\n              )+\n    theme_pubr()+\n    scale_fill_jco()+\n    scale_y_continuous(limits = c(0,2.5))+\n    labs(\n        x='',\n        y='liver weight (g)',\n        title=\"DEN+CCl4 tumor\"\n    )+\n    theme(\n        plot.title = element_text(hjust =0.5 ),\n        legend.position = 'none',\n        axis.text.x = element_text(angle = 45,vjust = .5)\n    )+  \n    geom_dotplot(data = g,\n                 mapping=aes(x=treatment,y=liverweight),\n                 binaxis = 'y',\n                 stackdir = 'center',#居中\n                 fill='black',\n                 binwidth = 0.05)\n#&gt; Warning in geom_signif(data = g, mapping = aes(x = treatment, y = liverweight),\n#&gt; : You have set data and mapping, are you sure that manual = FALSE is correct?\n\n\n\n\n\n\n\n\n1.6.4 分组并列，组内显著性p值\nhttps://www.datanovia.com/en/blog/tag/ggpubr/\nhttps://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/\n\nCodef2e &lt;- read_excel(\"data/01source.xlsx\", sheet = 3, range = \"A2:M4\")\n#&gt; New names:\n#&gt; • `` -&gt; `...3`\n#&gt; • `` -&gt; `...4`\n#&gt; • `` -&gt; `...6`\n#&gt; • `` -&gt; `...7`\n#&gt; • `` -&gt; `...9`\n#&gt; • `` -&gt; `...10`\n#&gt; • `` -&gt; `...12`\n#&gt; • `` -&gt; `...13`\ncolnames(f2e) &lt;-\n    c(\"type\", rep(c('CON', 'LDRT', 'DPVB', 'LR_DPVB'), each = 3))\n\nf2e |&gt; pivot_longer(cols = -1,\n                    names_to = \"trt\",\n                    values_to = \"pct\",\n) |&gt;\n    mutate(trt = factor(trt, levels = c('CON', 'LDRT', 'DPVB', 'LR_DPVB'))) -&gt; f2e\n\n\n\nCodelibrary(ggpubr)\nlibrary(rstatix)\n conflicts_prefer(rstatix::t_test)\n#&gt; [conflicted] Will prefer rstatix::t_test over any other package.\nstat.test &lt;- f2e %&gt;%\n  group_by(type) %&gt;%\n  t_test(pct ~ trt) |&gt; \n  adjust_pvalue(method = \"bonferroni\") %&gt;%\n    add_significance(\"p.adj\") |&gt; \n    add_significance(\"p\") \n\n\nstat.test &lt;- stat.test %&gt;%\n  add_xy_position(fun = \"mean_sd\", x = \"type\", dodge = 1)|&gt; \n  dplyr::filter(group1==\"CON\"&group2==\"LR_DPVB\")\n\n\ne_left &lt;- ggbarplot(f2e, x = \"type\", y = \"pct\",\n                fill = \"trt\", palette = \"jco\",\n                add =c(\"mean_sd\"), add.params = list(group = \"trt\"),\n                position = position_dodge(1),\n                #legend=\"none\",\n          legend.title=\"\",\n          )+\n    scale_y_continuous(limits = c(0,80))+\n    stat_pvalue_manual(\n        data = stat.test,\n        label = \"p={p}({p.signif})\",\n        tip.length = 0.05,\n        y.position = c(40,75),\n        #bracket.nudge.y = -2,\n)+labs(\n        x='',\n        y='% in live CD45+ cell',\n        #title=\"Hepa1-6 tumor\"\n    )\n\ne_right &lt;- e_left\n\nlibrary(patchwork)\n(e_left + e_right)+\n    plot_annotation(\n        title = \"Hepa1-6 tumor\",\n    ) +\n    plot_layout(guides = \"collect\")& \n    theme(\n        plot.title = element_text(hjust = 0.5),\n        legend.position = \"top\",\n    )\n\n\n\n\n\n\n\n\n1.6.5 分组并列，组内组间显著性p值\nhttps://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/\n\nCodelibrary(ggpubr)\nlibrary(rstatix)\ndf &lt;- ToothGrowth\ndf$dose &lt;- as.factor(df$dose)\n\n\n\nbp &lt;- ggbarplot(\n    df,\n    x = \"dose\",\n    y = \"len\",\n    add = \"mean_sd\",\n    color = \"supp\",\n    palette = c(\"#00AFBB\", \"#E7B800\"),\n    position = position_dodge(0.8)\n)\n\n\n# 统计检验\nstat.test &lt;- df %&gt;%\n    group_by(dose) %&gt;%\n    t_test(len ~ supp) %&gt;%\n    adjust_pvalue(method = \"bonferroni\") %&gt;%\n    add_significance(\"p.adj\")\nstat.test &lt;- stat.test %&gt;%\n    add_xy_position(fun = \"mean_sd\", x = \"dose\", dodge = 0.8)\n\n\nstat.test2 &lt;- df %&gt;%\n    t_test(len ~ dose, p.adjust.method = \"bonferroni\")\nstat.test2 &lt;- stat.test2 %&gt;%\n    add_xy_position(x = \"dose\")\n\npwc &lt;- df %&gt;%\n    group_by(supp) %&gt;%\n    t_test(len ~ dose, p.adjust.method = \"bonferroni\")\npwc\n#&gt; # A tibble: 6 × 11\n#&gt;   supp  .y.   group1 group2    n1    n2 statistic    df            p      p.adj\n#&gt; * &lt;fct&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;\n#&gt; 1 OJ    len   0.5    1         10    10     -5.05  17.7 0.0000878    0.000263  \n#&gt; 2 OJ    len   0.5    2         10    10     -7.82  14.7 0.00000132   0.00000396\n#&gt; 3 OJ    len   1      2         10    10     -2.25  15.8 0.039        0.118     \n#&gt; 4 VC    len   0.5    1         10    10     -7.46  17.9 0.000000681  0.00000204\n#&gt; 5 VC    len   0.5    2         10    10    -10.4   14.3 0.0000000468 0.00000014\n#&gt; 6 VC    len   1      2         10    10     -5.47  13.6 0.0000916    0.000275  \n#&gt; # ℹ 1 more variable: p.adj.signif &lt;chr&gt;\npwc &lt;- pwc %&gt;%\n    add_xy_position(\n        x = \"dose\",\n        fun = \"mean_sd\",\n        group = \"supp\",\n        dodge = 0.8\n    )\n\n# 组间组内复合\n\n\nbp +\n     stat_pvalue_manual(stat.test,  label = \"p.adj.signif\", tip.length = 0.01) \n\n\n\n\n\n\nCode    # stat_pvalue_manual(\n    #     stat.test2,\n    #     label = \"p\",\n    #     tip.length = 0.02,\n    #     step.increase = 0.05,\n    # ) +\n    # scale_y_continuous(expand = expansion(mult = c(0.05, 0.1))) +\n    # stat_pvalue_manual(\n    #     pwc,\n    #     color = \"supp\",\n    #     step.group.by = \"supp\",\n    #     tip.length = 0,\n    #     step.increase = 0.1,\n    # )",
    "crumbs": [
      "ggplot2 图形",
      "条形图",
      "条图"
    ]
  },
  {
    "objectID": "条图.html#填充图案-ggpatern",
    "href": "条图.html#填充图案-ggpatern",
    "title": "",
    "section": "\n1.7 填充图案 ggpatern\n",
    "text": "1.7 填充图案 ggpatern\n\n\nCodelibrary(ggpattern)\ndf &lt;- data.frame(\n    group = factor(c(\"Cool\", \"But\", \"Use\", \"Less\"), \n                   levels = c(\"Cool\", \"But\", \"Use\", \"Less\")),\n    value = c(25, 25, 25, 25)\n)\n\nggplot(df, aes(x=\"\", y = value, pattern = group, pattern_angle = group))+\n    geom_bar_pattern(\n        width                = 1, \n        stat                 = \"identity\", \n        fill                 = 'white', \n        colour               = 'black',\n        pattern_aspect_ratio = 1, \n        pattern_density      = 0.3\n    ) +\n    theme_void(14) + \n    theme(\n        legend.key.size = unit(.5, 'cm')\n    )\n\n\n\n\n\n\n\n\nCodedf &lt;- tibble(\n    name = c(\"CA\",\"CB\",\"CC\"),\n    细辛脂素_mean=c(0.776,0.803,0.684),\n    细辛脂素_sd=c(0.059,0.026,0.011),\n    芝麻脂素_mean=c(0.812,0.506,0.487),\n    芝麻脂素_sd =c(0.086,0.008,0.052),\n)\n\n\n\n\n# 合并两个数据集以便绘图\ndf_long &lt;- df %&gt;%\n    pivot_longer(cols = c(-name), names_to = c(\"compound\", \".value\"), names_sep = \"_\")\n\n\n# df_long$signif &lt;- c(\"a\",\"a\",\"a\",\"b\",\"a\",\"b\")\n\n# 创建条形图并设置填充图案\nggplot(df_long, aes(x = name, y = mean, pattern = compound)) +\n    geom_bar_pattern(\n        stat = \"identity\",\n        position = position_dodge(0.9),\n        width = 0.7,\n        #   aes(fill = compound),\n        fill            = 'white',\n        color          = 'black',\n        pattern_density = 0.1,\n        pattern_spacing = 0.02\n    ) +\n    geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd),\n                  width = 0.2,\n                  position = position_dodge(0.9)) +\n    labs(\n        title = \"不同基原细辛的细辛脂素与芝麻脂素含量\",\n        x = \"\",\n        y = \"含量\",\n        pattern = \"Compound\"\n    ) +\n    scale_pattern_manual(values = c(\"细辛脂素\" = \"stripe\", \"芝麻脂素\" = \"circle\"))+\n    scale_y_continuous(expand = c(0,0))+\n    ggpubr::theme_pubr()+\n    theme(\n        plot.title = element_text(hjust = .5),\n        legend.title = element_blank()\n    )",
    "crumbs": [
      "ggplot2 图形",
      "条形图",
      "条图"
    ]
  },
  {
    "objectID": "散点图.html",
    "href": "散点图.html",
    "title": "",
    "section": "",
    "text": "点线图散点图 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "点线图",
      "散点图"
    ]
  },
  {
    "objectID": "散点图.html#基础散点图",
    "href": "散点图.html#基础散点图",
    "title": "",
    "section": "\n1.1 基础散点图",
    "text": "1.1 基础散点图\n\nCodedf &lt;- data.frame(\n  x = 1:100,\n  y = rnorm(100) + 2 * (1:100)  # 生成具有线性关系的x和y数据\n)\n\np &lt;- ggplot(df, aes(x = x, y = y))+\n    geom_point(color='red')\np",
    "crumbs": [
      "ggplot2 图形",
      "点线图",
      "散点图"
    ]
  },
  {
    "objectID": "散点图.html#添加平滑曲线",
    "href": "散点图.html#添加平滑曲线",
    "title": "",
    "section": "\n1.2 添加平滑曲线",
    "text": "1.2 添加平滑曲线\nR2 ,p值：f6c\n\nCodep &lt;- p +\n    geom_smooth(method = \"lm\",formula = \"y~x\",color=\"black\",linewidth=.8)\np",
    "crumbs": [
      "ggplot2 图形",
      "点线图",
      "散点图"
    ]
  },
  {
    "objectID": "散点图.html#添加表达式",
    "href": "散点图.html#添加表达式",
    "title": "",
    "section": "\n1.3 添加表达式",
    "text": "1.3 添加表达式\n\nCodep + ggpmisc::stat_poly_eq(formula = y ~ x,\n                 ggpmisc::use_label(c(\"eq\", \"adj.R2\", \"P\")))\n#&gt; Registered S3 methods overwritten by 'ggpp':\n#&gt;   method                  from   \n#&gt;   heightDetails.titleGrob ggplot2\n#&gt;   widthDetails.titleGrob  ggplot2",
    "crumbs": [
      "ggplot2 图形",
      "点线图",
      "散点图"
    ]
  },
  {
    "objectID": "发散条图.html",
    "href": "发散条图.html",
    "title": "",
    "section": "",
    "text": "条形图发散条图 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "条形图",
      "发散条图"
    ]
  },
  {
    "objectID": "发散条图.html#geom_linerange",
    "href": "发散条图.html#geom_linerange",
    "title": "",
    "section": "\n1.1 geom_linerange",
    "text": "1.1 geom_linerange\n\nCodelibrary(data.table)\ndf &lt;- datasets::mtcars %&gt;% data.table() %&gt;% .[,cars:=rownames(mtcars)]\n\ndf[,mpg_z:=scale(mpg)]\ndf[mpg_z&gt;0,mpg_c:=\"g\"]\ndf[mpg_z&lt;0,mpg_c:=\"r\"]\n\n\n\nCodeggplot(df,aes(y=reorder(cars,mpg_z),colour = mpg_c))+\n    geom_linerange(aes(xmin = 0,\n                       xmax = mpg_z),\n                   linewidth=2,alpha=.5,show.legend = F)+\n    scale_color_manual(values = c(\"r\"=\"red\",\"g\"=\"green\"))+\n    scale_x_continuous(limits = c(-2,2.5),breaks = seq(-2,2.5,0.5),expand = c(0,0.02))+\n    scale_y_discrete(expand = c(0.03,0.03))+\n    labs(x=\"Mileage\",y=\"Model\",title = \"Diverging Bars of Car Mileage\")+\n    theme_bw()+\n    theme(\n        aspect.ratio = 1/1.3,\n        axis.ticks = element_blank(),\n        axis.title = element_text(face = \"italic\"),\n        axis.text.y = element_text(size = 8),\n        panel.grid.minor = element_blank(),\n        plot.title = element_text(hjust = .5)\n    )+\n    geom_text(\n        data = df[mpg_c==\"g\"],\n        mapping = aes(x=mpg_z,label = sprintf(\"%.2f\",mpg_z)),hjust = 0,colour = \"green4\",size = 2\n    )+\n    geom_text(\n        data = df[mpg_c==\"r\"],\n        mapping = aes(x=mpg_z,label = sprintf(\"%.2f\",mpg_z)),hjust = 1,colour = \"red4\",size = 2\n    )",
    "crumbs": [
      "ggplot2 图形",
      "条形图",
      "发散条图"
    ]
  },
  {
    "objectID": "发散条图.html#geom_segment",
    "href": "发散条图.html#geom_segment",
    "title": "",
    "section": "\n1.2 geom_segment",
    "text": "1.2 geom_segment\n\nCodeggplot(df)+\n    geom_segment(aes(x = 0,xend = mpg_z,\n                     y=reorder(cars,mpg_z),yend =reorder(cars,mpg_z),\n                     colour=mpg_c),\n                   linewidth=2,alpha=.5,show.legend = F)+\n    scale_color_manual(values = c(\"r\"=\"red\",\"g\"=\"green\"))+\n    scale_x_continuous(limits = c(-2,2.5),breaks = seq(-2,2.5,0.5),expand = c(0,0.02))+\n    scale_y_discrete(expand = c(0.03,0.03))+\n    labs(x=\"Mileage\",y=\"Model\",title = \"Diverging Bars of Car Mileage\")+\n    theme_bw()+\n    theme(\n        aspect.ratio = 1/1.3,\n        axis.ticks = element_blank(),\n        axis.title = element_text(face = \"italic\"),\n        axis.text.y = element_text(size = 8),\n        panel.grid.minor = element_blank(),\n        plot.title = element_text(hjust = .5)\n    )",
    "crumbs": [
      "ggplot2 图形",
      "条形图",
      "发散条图"
    ]
  },
  {
    "objectID": "发散条图.html#geom_bar",
    "href": "发散条图.html#geom_bar",
    "title": "",
    "section": "\n1.3 geom_bar",
    "text": "1.3 geom_bar\n\nCodeggplot(df,aes(x=reorder(cars,mpg_z),y=mpg_z,fill = mpg_c))+\n    geom_bar(stat = \"identity\",\n                   width=0.5,alpha=.5,show.legend = F)+\n    scale_fill_manual(values = c(\"r\"=\"red\",\"g\"=\"green\"))+\n    scale_y_continuous(limits = c(-2,2.5),breaks = seq(-2,2.5,0.5),expand = c(0,0.02))+\n    scale_x_discrete(expand = c(0.03,0.03))+\n    labs(x=\"Mileage\",y=\"Model\",title = \"Diverging Bars of Car Mileage\")+\n    theme_bw()+\n    theme(\n        aspect.ratio = 1/1.3,\n        axis.ticks = element_blank(),\n        axis.title = element_text(face = \"italic\"),\n        axis.text.y = element_text(size = 8),\n        panel.grid.minor = element_blank(),\n        plot.title = element_text(hjust = .5)\n    )+\n    coord_flip()",
    "crumbs": [
      "ggplot2 图形",
      "条形图",
      "发散条图"
    ]
  },
  {
    "objectID": "双y轴.html",
    "href": "双y轴.html",
    "title": "",
    "section": "",
    "text": "CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "双y轴"
    ]
  },
  {
    "objectID": "双y轴.html#ggplot",
    "href": "双y轴.html#ggplot",
    "title": "",
    "section": "\n1.1 ggplot",
    "text": "1.1 ggplot\n\nCodedf &lt;- ggplot2::economics\ny1 &lt;- df$psavert\ny2 &lt;- df$unemploy\n\ntarget.range &lt;- range(y1)\norigin.range &lt;- range(y2)\na &lt;- (target.range[2] - target.range[1]) / (origin.range[2] - origin.range[1])\nb &lt;- target.range[1] - a * origin.range[1]\n\nlibrary(data.table)\nplot.df &lt;- data.table(\n  date=as.POSIXct(df$date),\n  psavert=df$psavert,\n  unemploy=df$unemploy*a+b) %&gt;% \n  data.table::melt(id=\"date\")\nb_date &lt;- as.POSIXct(\"1967-07-01\", tz = \"UTC\")\ne_date &lt;- as.POSIXct(\"2015-04-01\", tz = \"UTC\")\ndat.color &lt;- c(\"#B03834\", \"#698DBD\")\n# 四周边框\ndat.bor &lt;- data.table(x1=c(rep(b_date-lubridate::years(1), 2), b_date-lubridate::years(1), e_date+lubridate::years(1)),\n                      x2=c(rep(e_date+lubridate::years(1), 2), b_date-lubridate::years(1), e_date+lubridate::years(1)),\n                      y1=c(18,0,0,0),\n                      y2=c(18,0,18,18))\n# 内部网格线\ndat.gri &lt;- data.table(x1=c(seq(b_date, e_date, \"5 year\"), rep(b_date-lubridate::years(1), 8)),\n                      x2=c(seq(b_date, e_date, \"5 year\"), rep(e_date+lubridate::years(1), 8)),\n                      y1=c(rep(0,10),  seq(2,16,2)),\n                      y2=c(rep(18,10), seq(2,16,2)))\n# y轴标签\ndat.y1.tex &lt;- data.table(x=rep(b_date-lubridate::years(1), 8), y=seq(2,16,2), lab=seq(2,16,2)) \ny2.lab &lt;- ((seq(2,16,2)-b)/a) %&gt;% round()\ndat.y2.tex &lt;- data.table(x=rep(e_date+lubridate::years(1), 8), y=seq(2,16,2), lab=y2.lab) \n# y轴标题\ndat.y1.tit &lt;- data.table(x=b_date-lubridate::years(6), y=9, lab=\"Personal Savings Rate\")\ndat.y2.tit &lt;- data.table(x=e_date+lubridate::years(7), y=9, lab=\"# Unemployed (1000's)\")\n\nggplot(plot.df, aes(date, value))+\n  geom_line(aes(color=variable),show.legend = F)+\n  geom_segment(data=dat.bor, aes(x=x1, xend=x2, y=y1, yend=y2))+ #border\n  geom_segment(data=dat.gri, aes(x=x1, xend=x2, y=y1, yend=y2), linewidth=0.2, color=\"gray\", alpha=0.4)+ #grid\n  geom_text(data=dat.y1.tex, aes(x,y,label=lab), color=dat.color[1], size=3, hjust=1.2)+\n  geom_text(data=dat.y2.tex, aes(x,y,label=lab), color=dat.color[2], size=3, hjust=-0.1)+\n  geom_text(data=dat.y1.tit, aes(x,y,label=lab), color=dat.color[1], size=5, vjust=1.5, angle=90)+\n  geom_text(data=dat.y2.tit, aes(x,y,label=lab), color=dat.color[2], size=5, vjust=1.5, angle=-90)+\n  scale_color_manual(values = dat.color)+\n  scale_x_datetime(date_labels = \"%Y-%m-%d\", breaks = seq(b_date, e_date, by = \"5 year\"), \n                   limits = c(b_date-lubridate::years(6), e_date+lubridate::years(7)), expand = c(0,0))+\n  scale_y_continuous(breaks = seq(2,16,2), limits = c(0,18), expand = c(0,0))+\n  labs(x= NULL, y=NULL,title = \"Personal Savings Rate vs Unemployed: Plotting in Secondary Y Axis\", color=NULL)+\n  theme_bw()+\n  theme(aspect.ratio = 1/1.8, \n        panel.border = element_blank(),\n        axis.text.y = element_blank(),\n        axis.text.x = element_text(size=6.2),\n        axis.ticks = element_blank(),\n        panel.grid = element_blank(), \n        plot.title = element_text(hjust = 0.5))",
    "crumbs": [
      "ggplot2 图形",
      "双y轴"
    ]
  },
  {
    "objectID": "双y轴.html#cowplot",
    "href": "双y轴.html#cowplot",
    "title": "",
    "section": "\n1.2 cowplot",
    "text": "1.2 cowplot\nhttps://wilkelab.org/cowplot/index.html\n\nCodelibrary(cowplot)\ncity_mpg &lt;- mpg %&gt;%\n  mutate(class = fct_lump(class, 4, other_level = \"other\")) %&gt;%\n  group_by(class) %&gt;%\n  summarize(\n    mean_mpg = mean(cty),\n    count = n()\n  ) %&gt;% mutate(\n    class = fct_reorder(class, count)\n  )\n\n\ncity_mpg &lt;- city_mpg %&gt;%\n  mutate(class = fct_reorder(class, -mean_mpg))\n\np1 &lt;- ggplot(city_mpg, aes(class, count)) +\n  geom_col(fill = \"#6297E770\") + \n  scale_y_continuous(\n    expand = expansion(mult = c(0, 0.05)),\n    position = \"right\"\n  ) +\n  theme_minimal_hgrid(11, rel_small = 1) +\n  theme(\n    panel.grid.major = element_line(color = \"#6297E770\"),\n    axis.line.x = element_blank(),\n    axis.text.x = element_blank(),\n    axis.title.x = element_blank(),\n    axis.ticks = element_blank(),\n    axis.ticks.length = grid::unit(0, \"pt\"),\n    axis.text.y = element_text(color = \"#6297E7\"),\n    axis.title.y = element_text(color = \"#6297E7\")\n  )\np1\n\n\n\n\n\n\n\n\nCodep2 &lt;- ggplot(city_mpg, aes(class, mean_mpg)) + \n  geom_point(size = 3, color = \"#D5442D\") + \n  scale_y_continuous(limits = c(10, 21)) +\n  theme_half_open(11, rel_small = 1) +\n  theme(\n    axis.ticks.y = element_line(color = \"#BB2D05\"),\n    axis.text.y = element_text(color = \"#BB2D05\"),\n    axis.title.y = element_text(color = \"#BB2D05\"),\n    axis.line.y = element_line(color = \"#BB2D05\")\n  )\np2\n\n\n\n\n\n\n\n\nCodealigned_plots &lt;- cowplot::align_plots(p1, p2, align=\"hv\", axis=\"tblr\")\nggdraw(aligned_plots[[1]]) + draw_plot(aligned_plots[[2]])",
    "crumbs": [
      "ggplot2 图形",
      "双y轴"
    ]
  },
  {
    "objectID": "双y轴.html#ggpubr",
    "href": "双y轴.html#ggpubr",
    "title": "",
    "section": "\n1.3 ggpubr",
    "text": "1.3 ggpubr\n\nCodelibrary(ggpubr)\nset.seed(1234)\nwdata = data.frame(\n  sex = factor(rep(c(\"F\", \"M\"), each=200)),\n  weight = c(rnorm(200, 55), rnorm(200, 58)))\nhead(wdata)\n#&gt;   sex   weight\n#&gt; 1   F 53.79293\n#&gt; 2   F 55.27743\n#&gt; 3   F 56.08444\n#&gt; 4   F 52.65430\n#&gt; 5   F 55.42912\n#&gt; 6   F 55.50606\n\ngghistogram(\n  wdata, x = \"weight\", \n  add = \"mean\", rug = TRUE,\n  fill = \"sex\", palette = c(\"#00AFBB\", \"#E7B800\")\n  )\n#&gt; Warning: Using `bins = 30` by default. Pick better value with the argument\n#&gt; `bins`.\n\n\n\n\n\n\n\n\nCode# 1. Create the histogram plot\nphist &lt;- gghistogram(\n  wdata, x = \"weight\", \n  add = \"mean\", rug = TRUE,\n  fill = \"sex\", palette = c(\"#00AFBB\", \"#E7B800\")\n)\n#&gt; Warning: Using `bins = 30` by default. Pick better value with the argument\n#&gt; `bins`.\n\n# 2. Create the density plot with y-axis on the right\n# Remove x axis elements\npdensity &lt;- ggdensity(\n  wdata, x = \"weight\", \n  color= \"sex\", palette = c(\"#00AFBB\", \"#E7B800\"),\n  alpha = 0\n) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.05)), position = \"right\")  +\n  theme_half_open(11, rel_small = 1) +\n  rremove(\"x.axis\")+\n  rremove(\"xlab\") +\n  rremove(\"x.text\") +\n  rremove(\"x.ticks\") +\n  rremove(\"legend\")\n\n# 3. Align the two plots and then overlay them.\naligned_plots &lt;- cowplot::align_plots(phist, pdensity, align=\"hv\", axis=\"tblr\")\nggdraw(aligned_plots[[1]]) + draw_plot(aligned_plots[[2]])\n\n\n\n\n\n\n\n\nCode\n\np1 &lt;- ggplot(mpg, aes(manufacturer, hwy)) + stat_summary(fun.y =\"median\", geom = \"bar\") +\n  theme_half_open() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust= 1))\n#&gt; Warning: The `fun.y` argument of `stat_summary()` is deprecated as of ggplot2 3.3.0.\n#&gt; ℹ Please use the `fun` argument instead.\n\np2 &lt;- ggplot(mpg, aes(manufacturer, displ)) + geom_point(color=\"red\") +\n  scale_y_continuous(position = \"right\") +\n  theme_half_open() + theme(axis.text.x = element_blank())\n\np1+p2\n\n\n\n\n\n\nCode# manually align and plot on top of each other\naligned_plots &lt;- cowplot::align_plots(p1, p2, align=\"hv\", axis=\"tblr\")\n\n# Note: In most cases two y-axes should not be used, but this example\n# illustrates how one could accomplish it.\nggdraw(aligned_plots[[1]]) + draw_plot(aligned_plots[[2]])",
    "crumbs": [
      "ggplot2 图形",
      "双y轴"
    ]
  },
  {
    "objectID": "双y轴.html#annotation_customggplotgrob",
    "href": "双y轴.html#annotation_customggplotgrob",
    "title": "",
    "section": "\n1.4 annotation_custom(ggplotGrob())\n",
    "text": "1.4 annotation_custom(ggplotGrob())\n\n\nCodeset.seed(1)\ndf1 &lt;- tibble(\n    width = round(rnorm(5,10,15),digits = 0) %&gt;% abs() %&gt;% sort(decreasing = T),\n    unit = rep(c(\"shear_stress\"),each=5),\n    value = round(runif(5,0.0001,0.1),8) %&gt;% abs() %&gt;% sort()\n)\ndf1\n#&gt; # A tibble: 5 × 3\n#&gt;   width unit          value\n#&gt;   &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;\n#&gt; 1    34 shear_stress 0.0177\n#&gt; 2    15 shear_stress 0.0207\n#&gt; 3    13 shear_stress 0.0385\n#&gt; 4     3 shear_stress 0.0687\n#&gt; 5     1 shear_stress 0.0770\n\n\nset.seed(100)\ndf2 &lt;- tibble(\n    width = round(runif(20,0,50),digits = 0) %&gt;% abs() %&gt;% sort(),\n    unit = rep(c(\"velocity\"),each=20),\n    value = round(runif(20,0.0001,1),8) %&gt;% abs() %&gt;% sort()\n)\ndf2\n#&gt; # A tibble: 20 × 3\n#&gt;    width unit     value\n#&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;\n#&gt;  1     3 velocity 0.130\n#&gt;  2     9 velocity 0.172\n#&gt;  3    10 velocity 0.180\n#&gt;  4    13 velocity 0.278\n#&gt;  5    14 velocity 0.349\n#&gt;  6    15 velocity 0.420\n#&gt;  7    18 velocity 0.488\n#&gt;  8    18 velocity 0.536\n#&gt;  9    19 velocity 0.538\n#&gt; 10    20 velocity 0.549\n#&gt; 11    23 velocity 0.629\n#&gt; 12    24 velocity 0.695\n#&gt; 13    27 velocity 0.711\n#&gt; 14    28 velocity 0.749\n#&gt; 15    31 velocity 0.770\n#&gt; 16    33 velocity 0.882\n#&gt; 17    35 velocity 0.889\n#&gt; 18    38 velocity 0.929\n#&gt; 19    41 velocity 0.954\n#&gt; 20    44 velocity 0.990\n\n\n\n1.4.1 左y\n\nCode\nleft &lt;- ggplot(df1,aes(x=width,value))+\n    geom_point(pch=21, size=3, fill=\"red\")+\n    geom_line()+\n    scale_x_continuous(expand = c(0,0),\n                       breaks = c(0,1,2,5,10,20,50),\n                       labels = c(0,1,2,5,10,20,50),\n                       limits = c(0,50),\n                       )+\n    scale_y_log10(expand = c(0,0),\n                  labels = scales::trans_format(\"log10\",scales::math_format()),\n                  breaks = c(0.001,0.01,0.1,1),\n                  limits = c(0.001,1)\n                  )+\n    annotation_logticks(sides = \"l\")+\n    theme_void()+ # 去掉主题\n    theme(\n        axis.line.y = element_line(colour = \"black\")\n    )+\n    ylab(\"shear stress (Pa)\")\n\nleft\n\n\n\n\n\n\n\n\n1.4.2 右y\n\nCodeggplot(df2,aes(width,value))+\n    geom_point(pch=25, size=3, fill=\"blue\")+\n    annotation_custom(ggplotGrob(left))+\n    scale_y_continuous(\n        name = \"velocity\",\n        expand = c(0,0),\n        breaks = seq(0,1,0.1),\n        limits = c(0,1),\n        position = \"right\",\n        sec.axis = sec_axis(\n            ~ .,\n            name = \"shear stress (Pa)\",\n            breaks = scales::rescale(c(-3, -2, -1, 0), c(0, 1)),\n            labels = c(expression(\"10\" ^ \"-3\", \"10\" ^\n                                      \"-2\", \"10\" ^ \"-1\", 1))\n        )\n    )+\n    scale_x_continuous(expand = c(0,0),\n                       breaks = c(0,1,2,5,10,20,50),\n                       labels = c(0,1,2,5,10,20,50),\n                       limits = c(0,50),\n                       )",
    "crumbs": [
      "ggplot2 图形",
      "双y轴"
    ]
  },
  {
    "objectID": "三线表.html",
    "href": "三线表.html",
    "title": "",
    "section": "",
    "text": "CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "表格",
      "三线表"
    ]
  },
  {
    "objectID": "三线表.html#tableone",
    "href": "三线表.html#tableone",
    "title": "",
    "section": "\n1.1 tableone",
    "text": "1.1 tableone\n\nCodeoptions(digits = 2)\nhead(mtcars)\n#&gt;                   mpg cyl disp  hp drat  wt qsec vs am gear carb\n#&gt; Mazda RX4          21   6  160 110  3.9 2.6   16  0  1    4    4\n#&gt; Mazda RX4 Wag      21   6  160 110  3.9 2.9   17  0  1    4    4\n#&gt; Datsun 710         23   4  108  93  3.8 2.3   19  1  1    4    1\n#&gt; Hornet 4 Drive     21   6  258 110  3.1 3.2   19  1  0    3    1\n#&gt; Hornet Sportabout  19   8  360 175  3.1 3.4   17  0  0    3    2\n#&gt; Valiant            18   6  225 105  2.8 3.5   20  1  0    3    1\n\ntbl1 &lt;- tableone::CreateTableOne(vars = colnames(mtcars),\n                                 data = mtcars,\n                                 factorVars = c(\"cyl\"), # 分类\n                                 strata = c(\"am\"),  #分层\n                                 )\ntbl1\n#&gt;                   Stratified by am\n#&gt;                    0               1              p      test\n#&gt;   n                    19              13                    \n#&gt;   mpg (mean (SD))   17.15 (3.83)    24.39 (6.17)  &lt;0.001     \n#&gt;   cyl (%)                                          0.013     \n#&gt;      4                  3 (15.8)        8 (61.5)             \n#&gt;      6                  4 (21.1)        3 (23.1)             \n#&gt;      8                 12 (63.2)        2 (15.4)             \n#&gt;   disp (mean (SD)) 290.38 (110.17) 143.53 (87.20) &lt;0.001     \n#&gt;   hp (mean (SD))   160.26 (53.91)  126.85 (84.06)  0.180     \n#&gt;   drat (mean (SD))   3.29 (0.39)     4.05 (0.36)  &lt;0.001     \n#&gt;   wt (mean (SD))     3.77 (0.78)     2.41 (0.62)  &lt;0.001     \n#&gt;   qsec (mean (SD))  18.18 (1.75)    17.36 (1.79)   0.206     \n#&gt;   vs (mean (SD))     0.37 (0.50)     0.54 (0.52)   0.357     \n#&gt;   am (mean (SD))     0.00 (0.00)     1.00 (0.00)  &lt;0.001     \n#&gt;   gear (mean (SD))   3.21 (0.42)     4.38 (0.51)  &lt;0.001     \n#&gt;   carb (mean (SD))   2.74 (1.15)     2.92 (2.18)   0.754",
    "crumbs": [
      "表格",
      "三线表"
    ]
  },
  {
    "objectID": "三线表.html#gtsummary",
    "href": "三线表.html#gtsummary",
    "title": "",
    "section": "\n1.2 gtsummary",
    "text": "1.2 gtsummary\nhttps://www.danieldsjoberg.com/gtsummary/index.html\n\nCodelibrary(gtsummary)\nlibrary(gt)\nhead(trial)\n#&gt; # A tibble: 6 × 8\n#&gt;   trt      age marker stage grade response death ttdeath\n#&gt;   &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;    &lt;int&gt; &lt;int&gt;   &lt;dbl&gt;\n#&gt; 1 Drug A    23  0.16  T1    II           0     0    24  \n#&gt; 2 Drug B     9  1.11  T2    I            1     0    24  \n#&gt; 3 Drug A    31  0.277 T1    II           0     0    24  \n#&gt; 4 Drug A    NA  2.07  T3    III          1     1    17.6\n#&gt; 5 Drug A    51  2.77  T4    III          1     1    16.4\n#&gt; 6 Drug B    39  0.613 T4    I            0     1    15.6\ndata(\"trial\")\n\n\n数据框中的每个变量都被分配了一个 \"label\" 属性\n\nCodeattr(trial$trt,\"label\")\n#&gt; [1] \"Chemotherapy Treatment\"\nattr(trial$age,\"label\")\n#&gt; [1] \"Age\"\n\n\n\nCodetrial2 &lt;- trial %&gt;% select(trt, age, grade)\nstr(trial2)\n#&gt; tibble [200 × 3] (S3: tbl_df/tbl/data.frame)\n#&gt;  $ trt  : chr [1:200] \"Drug A\" \"Drug B\" \"Drug A\" \"Drug A\" ...\n#&gt;   ..- attr(*, \"label\")= chr \"Chemotherapy Treatment\"\n#&gt;  $ age  : num [1:200] 23 9 31 NA 51 39 37 32 31 34 ...\n#&gt;   ..- attr(*, \"label\")= chr \"Age\"\n#&gt;  $ grade: Factor w/ 3 levels \"I\",\"II\",\"III\": 2 1 2 3 3 1 2 1 2 1 ...\n#&gt;   ..- attr(*, \"label\")= chr \"Grade\"\ntrial2 %&gt;% tbl_summary()\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nN = 2001\n\n\n\n\nChemotherapy Treatment\n\n\n\n    Drug A\n98 (49%)\n\n\n    Drug B\n102 (51%)\n\n\nAge\n47 (38, 57)\n\n\n    Unknown\n11\n\n\nGrade\n\n\n\n    I\n68 (34%)\n\n\n    II\n68 (34%)\n\n\n    III\n64 (32%)\n\n\n\n\n1 n (%); Median (IQR)\n\n\n\n\n\n\nLabel attributes from the data set are automatically printed.\nMissing values are listed as “Unknown” in the table.\n\n\n1.2.1 自定义输出\n\n\nargument\n描述\n\n\n\nlabel=\n指定表格中打印的变量标签\n\n\ntype=\n指定变量类型（例如continuous, categorical等\n\n\nstatistic=\n更改显示的汇总统计数据\n\n\ndigits=\n汇总统计数据将四舍五入的位数\n\n\nmissing=\n是否显示包含缺失观测值数的行\n\n\nmissing_text=\n缺失数字行的文本标签\n\n\nsort=\n按频率更改分类级别的排序\n\n\npercent=\n打印列、行或单元格百分比\n\n\ninclude=\n要包含在汇总表中的变量列表\n\n\n\n\nCodetrial2 %&gt;%\n  tbl_summary(\n    by = trt,\n    statistic = list(\n      all_continuous() ~ c(\"{median} ({p25},{p75})\"),\n      all_categorical() ~ \"{n} / {N} ({p}%)\"\n    ),\n    digits = list(starts_with(\"age\") ~ 0,\n                  grade ~ 2\n    ),\n    label = list(age ~ \"Patient age\",\n                 grade ~ \"Tumor Grade\"),\n    missing_text = \"(NA)\"\n  )\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nDrug A, N = 981\n\n\nDrug B, N = 1021\n\n\n\n\nPatient age\n46 (37,59)\n48 (39,56)\n\n\n    (NA)\n7\n4\n\n\nTumor Grade\n\n\n\n\n    I\n35.00 / 98.00 (35.71%)\n33.00 / 102.00 (32.35%)\n\n\n    II\n32.00 / 98.00 (32.65%)\n36.00 / 102.00 (35.29%)\n\n\n    III\n31.00 / 98.00 (31.63%)\n33.00 / 102.00 (32.35%)\n\n\n\n\n1 Median (25%,75%); n / N (%)\n\n\n\n\n\n\n\n函数\n描述\n\n\n\nadd_p()\n将 p 值添加到输出中，比较各组的值\n\n\nadd_overall()\n添加包含总体汇总统计数据的列\n\n\nadd_n()\n为每个变量添加一个包含 N（或缺少 N）的列\n\n\nadd_difference()\n为两组之间的差值、置信区间和 p 值添加列\n\n\nadd_stat_label()\n为每行中显示的汇总统计数据添加标签\n\n\nadd_stat()\n泛型函数，用于添加具有用户定义值的列\n\n\nadd_q()\n添加一列 Q 值以控制多个比较\n\n\nmodify_header()\n更新列标题\n\n\nmodify_footnote()\n更新列脚注\n\n\nmodify_spanning_header()\n更新跨标头\n\n\nmodify_caption()\n更新表格标题/标题\n\n\nbold_labels()\n粗体变量标签\n\n\nbold_levels()\n粗体可变级别\n\n\nitalicize_labels()\n将变量标签斜体化\n\n\nitalicize_levels()\n斜体变量级别\n\n\nbold_p()\n粗体显著性 p 值\n\n\n\n\nCodetrial2 |&gt; \n    tbl_summary(by = trt) |&gt; \n    add_p(\n        \n        test=list(all_continuous() ~ \"wilcox.test\", \n                  all_categorical() ~ \"chisq.test\"),\n        pvalue_fun = ~ style_pvalue(.x, digits = 3)\n        # pvalue_fun =purrr::partial(style_pvalue, digits = 3)\n    ) \n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nDrug A, N = 981\n\n\nDrug B, N = 1021\n\n\np-value2\n\n\n\n\nAge\n46 (37, 59)\n48 (39, 56)\n0.718\n\n\n    Unknown\n7\n4\n\n\n\nGrade\n\n\n0.871\n\n\n    I\n35 (36%)\n33 (32%)\n\n\n\n    II\n32 (33%)\n36 (35%)\n\n\n\n    III\n31 (32%)\n33 (32%)\n\n\n\n\n\n\n1 Median (IQR); n (%)\n\n\n\n2 Wilcoxon rank sum test; Pearson’s Chi-squared test\n\n\n\n\n\n\n\nCodewilcox.test(age~trt,data = trial2)\n#&gt; \n#&gt;  Wilcoxon rank sum test with continuity correction\n#&gt; \n#&gt; data:  age by trt\n#&gt; W = 4323, p-value = 0.7183\n#&gt; alternative hypothesis: true location shift is not equal to 0\ntable(trial2$grade,trial2$trt) |&gt; as.matrix() |&gt; chisq.test()\n#&gt; \n#&gt;  Pearson's Chi-squared test\n#&gt; \n#&gt; data:  as.matrix(table(trial2$grade, trial2$trt))\n#&gt; X-squared = 0.27673, df = 2, p-value = 0.8708\n\n\n\nCodex &lt;- \"333323222222323222222222223222222333344442323222344554554535444411111111111111111111122233434441534434433435456444533222233444444343331111222222222233333333333333344444444444444344444444444444\"\nstr_split_1(x,pattern = \"\") |&gt; parse_number() |&gt; sum()\n#&gt; [1] 560\n\n\n\nCodetrial2 %&gt;%\n    tbl_summary(by = trt) %&gt;%\n    add_overall() |&gt;   # t添加总和\n    add_n() |&gt;\n    # 修改注释\n    modify_header(label ~ \"**变量**\") %&gt;%\n    modify_spanning_header(c(\"stat_1\", \"stat_2\") ~ \"**药物**\") %&gt;%\n    modify_footnote(all_stat_cols() ~ \"Median (IQR) or Frequency (%)\") %&gt;%\n    modify_caption(\"**Table 1. Patient Characteristics**\") %&gt;%\n    bold_labels()\n\n\n\n\nTable 1. Patient Characteristics\n\n\n\n\n\n\n\n\n\n变量\nN\n\nOverall, N = 2001\n\n药物\n\n\n\nDrug A, N = 981\n\n\nDrug B, N = 1021\n\n\n\n\n\nAge\n189\n47 (38, 57)\n46 (37, 59)\n48 (39, 56)\n\n\n    Unknown\n\n11\n7\n4\n\n\nGrade\n200\n\n\n\n\n\n    I\n\n68 (34%)\n35 (36%)\n33 (32%)\n\n\n    II\n\n68 (34%)\n32 (33%)\n36 (35%)\n\n\n    III\n\n64 (32%)\n31 (32%)\n33 (32%)\n\n\n\n\n1 Median (IQR) or Frequency (%)\n\n\n\n\n\n\n1.2.2 主题\n\nCodelibrary(gtsummary)\nlibrary(gt)\nlibrary(dplyr)\n\ntrial %&gt;%\n  select(trt, age, grade) %&gt;%\n  tbl_summary(by = trt) %&gt;%\n  add_p()\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nDrug A, N = 981\n\n\nDrug B, N = 1021\n\n\np-value2\n\n\n\n\nAge\n46 (37, 59)\n48 (39, 56)\n0.7\n\n\n    Unknown\n7\n4\n\n\n\nGrade\n\n\n0.9\n\n\n    I\n35 (36%)\n33 (32%)\n\n\n\n    II\n32 (33%)\n36 (35%)\n\n\n\n    III\n31 (32%)\n33 (32%)\n\n\n\n\n\n\n1 Median (IQR); n (%)\n\n\n\n2 Wilcoxon rank sum test; Pearson’s Chi-squared test\n\n\n\n\n\nCodetheme_gtsummary_journal(journal = \"jama\")\n#&gt; Setting theme `JAMA`\ntheme_gtsummary_compact()\n#&gt; Setting theme `Compact`\n\n#  清除所有先前设置的主题\nreset_gtsummary_theme()\n\n\n\nCodemy_theme &lt;-\n  list(\n    # round large p-values to two places\n    \"pkgwide-fn:pvalue_fun\" = function(x) style_pvalue(x, digits = 2),\n    \"pkgwide-fn:prependpvalue_fun\" = function(x) style_pvalue(x, digits = 2, prepend_p = TRUE),\n    # report median (IQR) and n (percent) as default stats in `tbl_summary()`\n    \"tbl_summary-str:continuous_stat\" = \"{median} ({p25} - {p75})\",\n    \"tbl_summary-str:categorical_stat\" = \"{n} ({p})\"\n  )\n\ntrial %&gt;%\n  select(trt, age, grade) %&gt;%\n  tbl_summary(by = trt) %&gt;%\n  add_p()\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nDrug A, N = 981\n\n\nDrug B, N = 1021\n\n\np-value2\n\n\n\n\nAge\n46 (37, 59)\n48 (39, 56)\n0.7\n\n\n    Unknown\n7\n4\n\n\n\nGrade\n\n\n0.9\n\n\n    I\n35 (36%)\n33 (32%)\n\n\n\n    II\n32 (33%)\n36 (35%)\n\n\n\n    III\n31 (32%)\n33 (32%)\n\n\n\n\n\n\n1 Median (IQR); n (%)\n\n\n\n2 Wilcoxon rank sum test; Pearson’s Chi-squared test\n\n\n\n\n\nCodeset_gtsummary_theme(my_theme)",
    "crumbs": [
      "表格",
      "三线表"
    ]
  },
  {
    "objectID": "ROC.html",
    "href": "ROC.html",
    "title": "",
    "section": "",
    "text": "曲线图ROC CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "曲线图",
      "ROC"
    ]
  },
  {
    "objectID": "ROC.html#混淆矩阵",
    "href": "ROC.html#混淆矩阵",
    "title": "",
    "section": "\n1.1 混淆矩阵",
    "text": "1.1 混淆矩阵\n\nCodeconf_mat(two_class_example, truth = truth, estimate = predicted)\n#&gt;           Truth\n#&gt; Prediction Class1 Class2\n#&gt;     Class1    227     50\n#&gt;     Class2     31    192\n\nsensitivity(two_class_example,truth,predicted)\n#&gt; # A tibble: 1 × 3\n#&gt;   .metric     .estimator .estimate\n#&gt;   &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt;\n#&gt; 1 sensitivity binary         0.880",
    "crumbs": [
      "ggplot2 图形",
      "曲线图",
      "ROC"
    ]
  },
  {
    "objectID": "ROC.html#准确性",
    "href": "ROC.html#准确性",
    "title": "",
    "section": "\n1.2 准确性",
    "text": "1.2 准确性\n\nCodeaccuracy(two_class_example, truth, predicted)\n#&gt; # A tibble: 1 × 3\n#&gt;   .metric  .estimator .estimate\n#&gt;   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;\n#&gt; 1 accuracy binary         0.838",
    "crumbs": [
      "ggplot2 图形",
      "曲线图",
      "ROC"
    ]
  },
  {
    "objectID": "ROC.html#roc-1",
    "href": "ROC.html#roc-1",
    "title": "",
    "section": "\n1.3 ROC",
    "text": "1.3 ROC\n\nCodetwo_class_curve &lt;- roc_curve(two_class_example, truth, Class1)\ntwo_class_curve\n#&gt; # A tibble: 502 × 3\n#&gt;    .threshold specificity sensitivity\n#&gt;         &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;\n#&gt;  1 -Inf           0                 1\n#&gt;  2    1.79e-7     0                 1\n#&gt;  3    4.50e-6     0.00413           1\n#&gt;  4    5.81e-6     0.00826           1\n#&gt;  5    5.92e-6     0.0124            1\n#&gt;  6    1.22e-5     0.0165            1\n#&gt;  7    1.40e-5     0.0207            1\n#&gt;  8    1.43e-5     0.0248            1\n#&gt;  9    2.38e-5     0.0289            1\n#&gt; 10    3.30e-5     0.0331            1\n#&gt; # ℹ 492 more rows\n\n\nggplot(two_class_curve,aes(1-specificity,sensitivity))+\n    geom_path()+\n    geom_abline(lty=3)+\n    coord_equal()+\n    theme_bw()",
    "crumbs": [
      "ggplot2 图形",
      "曲线图",
      "ROC"
    ]
  },
  {
    "objectID": "ROC.html#auc",
    "href": "ROC.html#auc",
    "title": "",
    "section": "\n1.4 AUC",
    "text": "1.4 AUC\n\nCodeauc1 &lt;- roc_auc(two_class_example, truth, Class1,event_level = \"first\")\nauc2 &lt;- roc_auc(two_class_example, truth, Class1,event_level = \"second\")\n\nautoplot(two_class_curve)+\n    annotate(\"text\",x=0.5,y=0.25,label=str_glue(\"AUC={round(auc1$.estimate,3)}\"))",
    "crumbs": [
      "ggplot2 图形",
      "曲线图",
      "ROC"
    ]
  },
  {
    "objectID": "ROC.html#proc",
    "href": "ROC.html#proc",
    "title": "",
    "section": "\n1.5 pROC",
    "text": "1.5 pROC\n\nCodelibrary(pROC)\n\n\n\nCodeset.seed(10)\ndf &lt;- tibble(\n    group = sample(c(\"1\",\"0\"),size = 100,replace = T),\n    value = rnorm(100,10,3)\n)\n\nroc &lt;- roc(df$group,df$value, smooth = F,ci=T,auc=T)\n#&gt; Setting levels: control = 0, case = 1\n#&gt; Setting direction: controls &lt; cases\n\nroc\n#&gt; \n#&gt; Call:\n#&gt; roc.default(response = df$group, predictor = df$value, smooth = F,     auc = T, ci = T)\n#&gt; \n#&gt; Data: df$value in 47 controls (df$group 0) &lt; 53 cases (df$group 1).\n#&gt; Area under the curve: 0.5319\n#&gt; 95% CI: 0.4159-0.6479 (DeLong)\n\n# 计算最佳截断值\ncutoff &lt;- coords(roc,\"best\")\ncutoff\n#&gt;   threshold specificity sensitivity\n#&gt; 1  7.834545   0.3404255   0.8301887\n\ncutoff_text &lt;- paste0(round(cutoff$threshold,3),\"(\",round(cutoff$specificity,3),\",\",round(cutoff$sensitivity,3),\")\")\ncutoff_text\n#&gt; [1] \"7.835(0.34,0.83)\"\n\n\n# 计算AUC\n\nauc &lt;- auc(roc)[1]\nauc_low &lt;- ci(roc,of=\"auc\")[1]\nauc_up &lt;- ci(roc,of=\"auc\")[3]\n\n\n# 计算置信区间\n\nci &lt;- ci.se(roc,specificities=seq(0,1,0.01))\n\ndf_ci &lt;- ci[1:101,1:3]\ndf_ci &lt;-  as.data.frame(df_ci)\n\ndf_ci &lt;- tibble(\n    x=rownames(df_ci) |&gt; as.numeric(),\n    df_ci,\n)\n\n# 绘图\n\nggroc(roc,\n      color=\"red\",size=1,legacy.axes = T)+\n    theme_classic()+\n    scale_x_continuous(expand = expansion(mult = c(0,0)))+\n    scale_y_continuous(expand = expansion(mult = c(0,0)))+\n    # 对角线\n    geom_abline(slope = 1,linetype=3)+\n    # 置信区间\n    geom_ribbon(\n        mapping = aes(x=1-x,ymin=`2.5%`,ymax=`97.5%`),\n        data = df_ci,\n        fill=\"lightblue\",alpha=0.3,\n    )+\n    # 截断值\n    geom_point(\n        aes(x=1-specificity,y=sensitivity),\n        data = cutoff,\n        size=2)+\n    # 截断值文字注释\n    geom_text(\n        aes(x=1-specificity,y=sensitivity,label=cutoff_text),\n        data = cutoff,\n        vjust=-1,\n    )\n#&gt; Scale for x is already present.\n#&gt; Adding another scale for x, which will replace the existing scale.\n\n\n\n\n\n\n\n\nCode\ndf &lt;- two_class_example\nroc_obj &lt;- roc(response = df$truth, predictor = df$Class1,ci=TRUE,auc=TRUE)\n#&gt; Setting levels: control = Class1, case = Class2\n#&gt; Setting direction: controls &gt; cases\nroc_obj\n#&gt; \n#&gt; Call:\n#&gt; roc.default(response = df$truth, predictor = df$Class1, auc = TRUE,     ci = TRUE)\n#&gt; \n#&gt; Data: df$Class1 in 258 controls (df$truth Class1) &gt; 242 cases (df$truth Class2).\n#&gt; Area under the curve: 0.9393\n#&gt; 95% CI: 0.9203-0.9584 (DeLong)\n\n# roc_obj$specificities\n# roc_obj$sensitivities\n# roc_obj$thresholds\nci(roc_obj)\n#&gt; 95% CI: 0.9203-0.9584 (DeLong)\nauc(roc_obj)\n#&gt; Area under the curve: 0.9393\n\n\n# 最佳截断值（Youden's index）\nbest_cutoff &lt;- coords(roc_obj, x = \"best\",input=\"threshold\", \n                      ret=c(\"threshold\",\"specificity\",\"sensitivity\",\"ppv\",\"npv\"),\n                      best.method=\"youden\")\nbest_cutoff\n#&gt;           threshold specificity sensitivity       ppv       npv\n#&gt; threshold 0.7585932   0.8062016   0.9214876 0.8168498 0.9162996\n\n\ncoords(roc_obj, x = \"best\",input=\"threshold\", \n                      ret=\"all\",\n                      best.method=\"youden\")\n#&gt;           threshold specificity sensitivity accuracy  tn  tp fn fp       npv\n#&gt; threshold 0.7585932   0.8062016   0.9214876    0.862 208 223 19 50 0.9162996\n#&gt;                 ppv       fdr       fpr       tpr       tnr       fnr\n#&gt; threshold 0.8168498 0.1831502 0.1937984 0.9214876 0.8062016 0.0785124\n#&gt;           1-specificity 1-sensitivity 1-accuracy      1-npv     1-ppv precision\n#&gt; threshold     0.1937984     0.0785124      0.138 0.08370044 0.1831502 0.8168498\n#&gt;              recall   youden closest.topleft\n#&gt; threshold 0.9214876 1.727689      0.04372204\n\n\n\nCodeplot(roc_obj, print.thres = \"best\", \n     print.thres.pattern = \"Best cutoff: %.5f\", main = \"ROC Curve\")\n\n\n\n\n\n\n\n\nCodeplot(specificity + sensitivity ~ threshold,\n     coords(roc_obj, \"all\", transpose = FALSE),\n     type = \"l\", log=\"x\",\n     subset = is.finite(threshold))\n\n\n\n\n\n\n\n\nCodeplot(roc_obj, col = \"blue\",main = \"Multiple ROC Curves\", print.thres = \"best\", print.thres.pattern = \"Optimal threshold: %.5f\")\nlines(roc_obj, col = \"red\",lwd=2,lty=3)\nlegend(\"bottomright\", legend = c(\"Model 1\", \"Model 2\"), col = c(\"blue\", \"red\"), lwd = 2)",
    "crumbs": [
      "ggplot2 图形",
      "曲线图",
      "ROC"
    ]
  },
  {
    "objectID": "Q-Q图.html",
    "href": "Q-Q图.html",
    "title": "",
    "section": "",
    "text": "点线图Q-Q图 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "点线图",
      "Q-Q图"
    ]
  },
  {
    "objectID": "Q-Q图.html#正态qq图",
    "href": "Q-Q图.html#正态qq图",
    "title": "",
    "section": "\n1.1 正态qq图",
    "text": "1.1 正态qq图\n\nCodeggplot(iris,aes(sample = Sepal.Length))+\n    stat_qq(distribution = qnorm , \n            dparams = list(mean=mean(iris$Sepal.Length),\n                            sd=sd(iris$Sepal.Length)))+\n    stat_qq_line()",
    "crumbs": [
      "ggplot2 图形",
      "点线图",
      "Q-Q图"
    ]
  },
  {
    "objectID": "Q-Q图.html#泊松qq图",
    "href": "Q-Q图.html#泊松qq图",
    "title": "",
    "section": "\n1.2 泊松qq图",
    "text": "1.2 泊松qq图\n\nCodeggplot(iris,aes(sample = Sepal.Length))+\n    geom_qq(distribution = qpois , \n            dparams = list(lambda=mean(iris$Sepal.Length)) )+\n    geom_qq_line()",
    "crumbs": [
      "ggplot2 图形",
      "点线图",
      "Q-Q图"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "",
    "section": "",
    "text": "Code"
  },
  {
    "objectID": "index.html#推荐阅读",
    "href": "index.html#推荐阅读",
    "title": "",
    "section": "推荐阅读",
    "text": "推荐阅读\n\nggplot2：用于数据分析的优雅图形\nThe R Graph Gallery\nR Graphics Cookbook, 2nd edition\n现代统计图形（2）\nhttps://exts.ggplot2.tidyverse.org/gallery/\nhttps://rpkgs.datanovia.com/ggpubr/\nhttps://www.datanovia.com/en/blog/tag/ggpubr/\nhttps://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/\nhttps://plotly.com/ggplot2/"
  },
  {
    "objectID": "index.html#工具",
    "href": "index.html#工具",
    "title": "",
    "section": "工具",
    "text": "工具\n十六进制颜色\n图像颜色提取器"
  },
  {
    "objectID": "ggproto.html",
    "href": "ggproto.html",
    "title": "",
    "section": "",
    "text": "CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "`ggproto` 对象"
    ]
  },
  {
    "objectID": "ggproto.html#ggplot2-的内部结构",
    "href": "ggproto.html#ggplot2-的内部结构",
    "title": "",
    "section": "\n1.1 ggplot2 的内部结构",
    "text": "1.1 ggplot2 的内部结构\n\nCodep &lt;- ggplot(mpg, aes(displ, hwy, color = drv)) + \n  geom_point(position = \"jitter\") +\n  geom_smooth(method = \"lm\", formula = y ~ x) + \n  facet_wrap(vars(year)) + \n  ggtitle(\"A plot for expository purposes\")\np\n\n\n\n\n\n\n\n\nCodeggprint &lt;- function(x) {\n  data &lt;- ggplot_build(x)\n  gtable &lt;- ggplot_gtable(data)\n  grid::grid.newpage()\n  grid::grid.draw(gtable)\n  return(invisible(x))\n}\nggprint(p)\n\n\n\n\n\n\n\n\nCodep_built &lt;- ggplot_build(p)\n\np_built $data %&gt;% map(head) %&gt;% map(as_tibble)\n#&gt; [[1]]\n#&gt; # A tibble: 6 × 10\n#&gt;   colour      x     y PANEL group shape  size fill  alpha stroke\n#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt;  &lt;dbl&gt;\n#&gt; 1 #00BA38  1.76  28.8 1         2    19   1.5 NA    NA       0.5\n#&gt; 2 #00BA38  1.76  29.1 1         2    19   1.5 NA    NA       0.5\n#&gt; 3 #00BA38  2.01  30.7 2         2    19   1.5 NA    NA       0.5\n#&gt; 4 #00BA38  2.01  30.2 2         2    19   1.5 NA    NA       0.5\n#&gt; 5 #00BA38  2.80  26.1 1         2    19   1.5 NA    NA       0.5\n#&gt; 6 #00BA38  2.82  25.8 1         2    19   1.5 NA    NA       0.5\n#&gt; \n#&gt; [[2]]\n#&gt; # A tibble: 6 × 14\n#&gt;   colour      x     y  ymin  ymax    se flipped_aes PANEL group fill   linewidth\n#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;       &lt;fct&gt; &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;\n#&gt; 1 #F8766D  1.8   24.3  23.1  25.6 0.625 FALSE       1         1 grey60         1\n#&gt; 2 #F8766D  1.86  24.2  22.9  25.4 0.612 FALSE       1         1 grey60         1\n#&gt; 3 #F8766D  1.92  24.0  22.8  25.2 0.598 FALSE       1         1 grey60         1\n#&gt; 4 #F8766D  1.98  23.9  22.7  25.0 0.585 FALSE       1         1 grey60         1\n#&gt; 5 #F8766D  2.04  23.7  22.6  24.9 0.572 FALSE       1         1 grey60         1\n#&gt; 6 #F8766D  2.10  23.5  22.4  24.7 0.559 FALSE       1         1 grey60         1\n#&gt; # ℹ 3 more variables: linetype &lt;dbl&gt;, weight &lt;dbl&gt;, alpha &lt;dbl&gt;\np_built $layout\n#&gt; &lt;ggproto object: Class Layout, gg&gt;\n#&gt;     coord: &lt;ggproto object: Class CoordCartesian, Coord, gg&gt;\n#&gt;         aspect: function\n#&gt;         backtransform_range: function\n#&gt;         clip: on\n#&gt;         default: TRUE\n#&gt;         distance: function\n#&gt;         expand: TRUE\n#&gt;         is_free: function\n#&gt;         is_linear: function\n#&gt;         labels: function\n#&gt;         limits: list\n#&gt;         modify_scales: function\n#&gt;         range: function\n#&gt;         render_axis_h: function\n#&gt;         render_axis_v: function\n#&gt;         render_bg: function\n#&gt;         render_fg: function\n#&gt;         setup_data: function\n#&gt;         setup_layout: function\n#&gt;         setup_panel_guides: function\n#&gt;         setup_panel_params: function\n#&gt;         setup_params: function\n#&gt;         train_panel_guides: function\n#&gt;         transform: function\n#&gt;         super:  &lt;ggproto object: Class CoordCartesian, Coord, gg&gt;\n#&gt;     coord_params: list\n#&gt;     facet: &lt;ggproto object: Class FacetWrap, Facet, gg&gt;\n#&gt;         compute_layout: function\n#&gt;         draw_back: function\n#&gt;         draw_front: function\n#&gt;         draw_labels: function\n#&gt;         draw_panels: function\n#&gt;         finish_data: function\n#&gt;         init_scales: function\n#&gt;         map_data: function\n#&gt;         params: list\n#&gt;         setup_data: function\n#&gt;         setup_params: function\n#&gt;         shrink: TRUE\n#&gt;         train_scales: function\n#&gt;         vars: function\n#&gt;         super:  &lt;ggproto object: Class FacetWrap, Facet, gg&gt;\n#&gt;     facet_params: list\n#&gt;     finish_data: function\n#&gt;     get_scales: function\n#&gt;     layout: data.frame\n#&gt;     map_position: function\n#&gt;     panel_params: list\n#&gt;     panel_scales_x: list\n#&gt;     panel_scales_y: list\n#&gt;     render: function\n#&gt;     render_labels: function\n#&gt;     reset_scales: function\n#&gt;     resolve_label: function\n#&gt;     setup: function\n#&gt;     setup_panel_guides: function\n#&gt;     setup_panel_params: function\n#&gt;     train_position: function\n#&gt;     super:  &lt;ggproto object: Class Layout, gg&gt;\np_built $plot\n\n\n\n\n\n\n\n\nCodep_gtable &lt;- ggplot_gtable(p_built)\np_gtable\n#&gt; TableGrob (17 x 17) \"layout\": 25 grobs\n#&gt;     z         cells             name\n#&gt; 1   0 ( 1-17, 1-17)       background\n#&gt; 2   1 (10-10, 7- 7)        panel-1-1\n#&gt; 3   1 (10-10,11-11)        panel-2-1\n#&gt; 4   3 ( 8- 8, 7- 7)       axis-t-1-1\n#&gt; 5   3 ( 8- 8,11-11)       axis-t-2-1\n#&gt; 6   3 (11-11, 7- 7)       axis-b-1-1\n#&gt; 7   3 (11-11,11-11)       axis-b-2-1\n#&gt; 8   3 (10-10,10-10)       axis-l-1-2\n#&gt; 9   3 (10-10, 6- 6)       axis-l-1-1\n#&gt; 10  3 (10-10,12-12)       axis-r-1-2\n#&gt; 11  3 (10-10, 8- 8)       axis-r-1-1\n#&gt; 12  2 ( 9- 9, 7- 7)      strip-t-1-1\n#&gt; 13  2 ( 9- 9,11-11)      strip-t-2-1\n#&gt; 14  4 ( 7- 7, 7-11)           xlab-t\n#&gt; 15  5 (12-12, 7-11)           xlab-b\n#&gt; 16  6 (10-10, 5- 5)           ylab-l\n#&gt; 17  7 (10-10,13-13)           ylab-r\n#&gt; 18  8 (10-10,15-15)  guide-box-right\n#&gt; 19  9 (10-10, 3- 3)   guide-box-left\n#&gt; 20 10 (14-14, 7-11) guide-box-bottom\n#&gt; 21 11 ( 5- 5, 7-11)    guide-box-top\n#&gt; 22 12 (10-10, 7-11) guide-box-inside\n#&gt; 23 13 ( 4- 4, 7-11)         subtitle\n#&gt; 24 14 ( 3- 3, 7-11)            title\n#&gt; 25 15 (15-15, 7-11)          caption\n#&gt;                                             grob\n#&gt; 1                rect[plot.background..rect.705]\n#&gt; 2                       gTree[panel-1.gTree.585]\n#&gt; 3                       gTree[panel-2.gTree.600]\n#&gt; 4                                 zeroGrob[NULL]\n#&gt; 5                                 zeroGrob[NULL]\n#&gt; 6            absoluteGrob[GRID.absoluteGrob.604]\n#&gt; 7            absoluteGrob[GRID.absoluteGrob.604]\n#&gt; 8                                 zeroGrob[NULL]\n#&gt; 9            absoluteGrob[GRID.absoluteGrob.612]\n#&gt; 10                                zeroGrob[NULL]\n#&gt; 11                                zeroGrob[NULL]\n#&gt; 12                                 gtable[strip]\n#&gt; 13                                 gtable[strip]\n#&gt; 14                                zeroGrob[NULL]\n#&gt; 15 titleGrob[axis.title.x.bottom..titleGrob.667]\n#&gt; 16   titleGrob[axis.title.y.left..titleGrob.670]\n#&gt; 17                                zeroGrob[NULL]\n#&gt; 18                             gtable[guide-box]\n#&gt; 19                                zeroGrob[NULL]\n#&gt; 20                                zeroGrob[NULL]\n#&gt; 21                                zeroGrob[NULL]\n#&gt; 22                                zeroGrob[NULL]\n#&gt; 23         zeroGrob[plot.subtitle..zeroGrob.702]\n#&gt; 24          titleGrob[plot.title..titleGrob.701]\n#&gt; 25          zeroGrob[plot.caption..zeroGrob.703]\n\n\n\nCodegrid::grid.newpage()\n\n\n\n\n\n\n\n\nCodegrid::grid.newpage()\ngrid::grid.draw(p_gtable)",
    "crumbs": [
      "ggplot2 图形",
      "`ggproto` 对象"
    ]
  },
  {
    "objectID": "ggproto.html#ggproto",
    "href": "ggproto.html#ggproto",
    "title": "",
    "section": "\n1.2 ggproto\n",
    "text": "1.2 ggproto\n\n\nCodeprototype()\n#&gt; An object of class \"classPrototypeDef\"\n#&gt; Slot \"object\":\n#&gt; &lt;S4 Type Object&gt;\n#&gt; \n#&gt; Slot \"slots\":\n#&gt; character(0)\n#&gt; \n#&gt; Slot \"dataPart\":\n#&gt; [1] FALSE\n\n\n参考 ggplot2-book.org/internals#sec-ggproto\n\nCode\n# 创建新类，子类继承\nNewObject &lt;- ggproto(\n  `_class` = NULL, # 类\n  `_inherits` = NULL # 继承\n)\nNewObject \n#&gt; &lt;ggproto object: Class gg&gt;\n#&gt;     _inherits: NULL\n\n\n\nCode# 新类\nNewClass &lt;- ggproto(\"NewClass\", NULL,\n                    # fields     默认值 \n                    geom=NA,\n                    # methods\n                    \n                    )\n\nNewClass\n#&gt; &lt;ggproto object: Class NewClass, gg&gt;\n#&gt;     geom: NA\n\n\n\nCode# 实例\ninstance &lt;- ggproto(NULL, NewClass,\n                    # 字段赋值\n                    geom=\"point\"\n                    )\ninstance\n#&gt; &lt;ggproto object: Class NewClass, gg&gt;\n#&gt;     geom: point\n#&gt;     super:  &lt;ggproto object: Class NewClass, gg&gt;\n\n\n\nCode# 继承\nNewSubClass &lt;- ggproto(\"NewSubClass\", NewClass)\nNewSubClass\n#&gt; &lt;ggproto object: Class NewSubClass, NewClass, gg&gt;\n#&gt;     geom: NA\n#&gt;     super:  &lt;ggproto object: Class NewClass, gg&gt;",
    "crumbs": [
      "ggplot2 图形",
      "`ggproto` 对象"
    ]
  },
  {
    "objectID": "ggproto.html#自定义geom_signif",
    "href": "ggproto.html#自定义geom_signif",
    "title": "",
    "section": "\n1.3 自定义geom_signif",
    "text": "1.3 自定义geom_signif\n\nCodelibrary(ggplot2)\nlibrary(grid)\n\n# 自定义 GeomSignif 对象\nGeomSignif &lt;- ggproto(`_class` = \"GeomSignif\",\n                      `_inherits` = Geom,\n  required_aes = c(\"x\", \"y\"),\n  \n  default_aes = aes(\n    comparisons = NULL, step_increase = 0.1,\n    map_signif_level = TRUE, test = \"t.test\",\n    test.args = list(), y_position = NULL,\n    annotations = NULL, tip_length = 0.03\n  ),\n  \n  draw_group = function(data, panel_scales, coord, comparisons, step_increase,\n                        map_signif_level, test, test.args, y_position, annotations, tip_length) {\n    \n    # 提取比较组\n    if (is.null(comparisons)) {\n      stop(\"Comparisons must be provided.\")\n    }\n    \n    # 计算每组的 y 坐标位置\n    y_max &lt;- max(data$y, na.rm = TRUE)\n    if (is.null(y_position)) {\n      y_position &lt;- y_max + seq(step_increase, by = step_increase, length.out = length(comparisons))\n    }\n    \n    # 创建标记的绘图对象列表\n    grobs &lt;- list()\n    for (i in seq_along(comparisons)) {\n      comp &lt;- comparisons[[i]]\n      group1 &lt;- data[data$x == comp[1], \"y\"]\n      group2 &lt;- data[data$x == comp[2], \"y\"]\n      \n      # 进行显著性测试\n      test_result &lt;- do.call(test, c(list(group1, group2), test.args))\n      p_value &lt;- test_result$p.value\n      label &lt;- if (map_signif_level) {\n        if (p_value &lt; 0.001) \"***\"\n        else if (p_value &lt; 0.01) \"**\"\n        else if (p_value &lt; 0.05) \"*\"\n        else \"ns\"\n      } else {\n        format(p_value, digits = 2)\n      }\n      \n      # 绘制显著性标记线条和标签\n      grobs &lt;- c(grobs, list(\n        grid::linesGrob(\n          x = c(mean(comp[1]), mean(comp[2])),\n          y = rep(y_position[i], 2),\n          gp = grid::gpar(col = \"black\", lwd = 0.5)\n        ),\n        grid::textGrob(\n          label, x = mean(comp), y = y_position[i] + tip_length,\n          gp = grid::gpar(col = \"black\", fontsize = 10)\n        )\n      ))\n    }\n    \n    # 返回绘图对象列表\n    grid::grobTree(grobs = grobs)\n  }\n)\n\n# 创建自定义 geom_signif 函数\ngeom_signif &lt;- function(mapping = NULL, data = NULL, stat = \"identity\", position = \"identity\",\n                        na.rm = FALSE, show.legend = NA, inherit.aes = TRUE, ...) {\n  layer(\n    geom = GeomSignif, mapping = mapping, data = data, stat = stat,\n    position = position, show.legend = show.legend, inherit.aes = inherit.aes,\n    params = list(na.rm = na.rm, ...)\n  )\n}",
    "crumbs": [
      "ggplot2 图形",
      "`ggproto` 对象"
    ]
  },
  {
    "objectID": "ggplot2_graphics.html",
    "href": "ggplot2_graphics.html",
    "title": "",
    "section": "",
    "text": "CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 Graphics"
    ]
  },
  {
    "objectID": "ggplot2_graphics.html#ggplot",
    "href": "ggplot2_graphics.html#ggplot",
    "title": "",
    "section": "\n1.1 ggplot\n",
    "text": "1.1 ggplot\n\n\nCodedf &lt;- tibble(\n    index = 1:26,\n    pch = 0:25,\n    type = c( rep(\"hollow_color\",15),rep(\"soild_color\",6),rep(\"fill_color\",5)),\n    height = rep(c(1,2,3), times = c(15,6,5)),\n    \n)\n\n\nggplot(data =  ,mapping = aes(x,y,…))\n创建一个基础图形对象gg，空白图层 + 数据集 + 美学映射。\n\n1.1.1 aesthetics mapping\nmapping=aes(x,y,z,..,color,fill,shape,size,group,linewidth,linetype,alpha,...)\n\nCodeggplot(data = df,\n       mapping = aes(x = index, y = pch ))\n\n\n\n\n\n\n\n\n1.1.1.1 color\n\n1.1.1.2 fill\n\nCodelibrary(grid)\ncolours &lt;- scales::viridis_pal()(10)\npatterns &lt;- list(\n  linearGradient(colours, group = FALSE),\n  \"limegreen\",\n  radialGradient(colours, group = FALSE),\n  pattern(\n    rectGrob(x = c(0.25, 0.75), y = c(0.25, 0.75), width = 0.5, height = 0.5),\n    width = unit(5, \"mm\"), height = unit(5, \"mm\"), extend = \"repeat\",\n    gp = gpar(fill = \"limegreen\")\n  )\n)\nggplot(mpg, aes(factor(cyl), fill = factor(cyl))) +\n  geom_bar() +\n  scale_fill_manual(values = patterns)\n\n\n\n\n\n\n\n\n1.1.1.3 shape\n\nCodeggplot(data = df, mapping = aes(x = index, y = pch)) +\n    geom_point(shape = \".\") #像素\n\n\n\n\n\n\nCode\n\nggplot(data = df, aes(index, pch)) +\n  geom_point(aes(shape = factor(pch)), fill =\"red\",size = 4) +\n  scale_shape_manual(values = 0:25) +\n  labs(shape = \"点形状\" )\n\n\n\n\n\n\n\n\nCodeshape_names &lt;- c(\n  \"circle\", paste(\"circle\", c(\"open\", \"filled\", \"cross\", \"plus\", \"small\")), \"bullet\",\n  \"square\", paste(\"square\", c(\"open\", \"filled\", \"cross\", \"plus\", \"triangle\")),\n  \"diamond\", paste(\"diamond\", c(\"open\", \"filled\", \"plus\")),\n  \"triangle\", paste(\"triangle\", c(\"open\", \"filled\", \"square\")),\n  paste(\"triangle down\", c(\"open\", \"filled\")),\n  \"plus\", \"cross\", \"asterisk\"\n)\n\nshapes &lt;- data.frame(\n  shape_names = shape_names,\n  x = c(1:7, 1:6, 1:3, 5, 1:3, 6, 2:3, 1:3),\n  y = -rep(1:6, c(7, 6, 4, 4, 2, 3))\n)\n\nggplot(shapes, aes(x, y)) +\n  geom_point(aes(shape = shape_names), fill = \"red\", size = 5) +\n  geom_text(aes(label = shape_names), nudge_y = -0.3, size = 3.5) +\n  scale_shape_identity() +\n  theme_void()",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 Graphics"
    ]
  },
  {
    "objectID": "ggplot2_graphics.html#geometry",
    "href": "ggplot2_graphics.html#geometry",
    "title": "",
    "section": "\n1.2 Geometry",
    "text": "1.2 Geometry\n\n\n图形基元（Graphical primitives）:\n\ngeom_blank(): display nothing. Most useful for adjusting axes limits using data.\ngeom_point(): points.\ngeom_path(): paths.\ngeom_ribbon(): ribbons, a path with vertical thickness.\ngeom_segment(): a line segment, specified by start and end position.\ngeom_rect(): rectangles.\ngeom_polygon(): filled polygons.\ngeom_text(): text.\n\n\n\n\nCodedf &lt;- data.frame(\n  x = c(3, 1, 5), \n  y = c(2, 4, 6), \n  label = c(\"a\",\"b\",\"c\")\n)\n\np &lt;- ggplot(df, aes(x, y, label = label)) + \n  labs(x = NULL, y = NULL) + # Hide axis label\n  theme(plot.title = element_text(size = 12)) # Shrink plot title\n\n(p + geom_point() + ggtitle(\"point\") +\n        p + geom_text() + ggtitle(\"text\") +\n        p + geom_bar(stat = \"identity\") + ggtitle(\"bar\") )/\n(p + geom_tile() + ggtitle(\"tile\") +\n     p + geom_raster() + ggtitle(\"raster\")+\n     p + geom_line() + ggtitle(\"line\")) /\n(p + geom_area() + ggtitle(\"area\") +\n    p + geom_path() + ggtitle(\"path\") +\n    p + geom_polygon() + ggtitle(\"polygon\"))\n\n\n\n\n\n\n\n\n\nOne variable:\n\n\nDiscrete:\n\n\ngeom_bar(): display distribution of discrete variable.\n\n\n\nContinuous:\n\ngeom_histogram(): bin and count continuous variable, display with bars.\ngeom_density(): smoothed density estimate.\ngeom_dotplot(): stack individual points into a dot plot.\ngeom_freqpoly(): bin and count continuous variable, display with lines.\n\n\n\n\n\nTwo variables:\n\n\nBoth continuous:\n\ngeom_point(): scatterplot.\ngeom_quantile(): smoothed quantile regression.\ngeom_rug(): marginal rug plots.\ngeom_smooth(): smoothed line of best fit.\ngeom_text(): text labels.\n\n\n\nShow distribution:\n\ngeom_bin2d(): bin into rectangles and count.\ngeom_density2d(): smoothed 2d density estimate.\ngeom_hex(): bin into hexagons and count.\n\n\n\nAt least one discrete:\n\ngeom_count(): count number of point at distinct locations\ngeom_jitter(): randomly jitter overlapping points.\n\n\n\nOne continuous, one discrete:\n\ngeom_bar(stat = \"identity\"): a bar chart of precomputed summaries.\ngeom_boxplot(): boxplots.\ngeom_violin(): show density of values in each group.\n\n\n\nOne time, one continuous:\n\ngeom_area(): area plot.\ngeom_line(): line plot.\ngeom_step(): step plot.\n\n\n\nDisplay uncertainty:\n\ngeom_crossbar(): vertical bar with center.\ngeom_errorbar(): error bars.\ngeom_linerange(): vertical line.\ngeom_pointrange(): vertical line with center.\n\n\n\nSpatial:\n\n\ngeom_map(): fast version of for map data.\n\n\n\n\n\nThree variables:\n\ngeom_contour(): contours.\ngeom_tile(): tile the plane with rectangles.\ngeom_raster(): fast version of for equal sized tiles.\n\n\n\n\n1.2.1 X=连续型变量\n\n1.2.1.1 geom_point\n\nCodeggplot(data = mpg) + \n    geom_point(mapping = aes(x=displ,y=hwy),\n               stat = \"identity\",position = \"identity\")\n\n\n\n\n\n\n\n\nCodeggplot(mpg, aes(displ,hwy)) +\n    geom_point() |\n    \n    ggplot(mpg, aes(displ,hwy)) +\n    geom_point(aes(size = displ/10)) + \n    scale_size_area(name=\"displ/10\")\n\n\n\n\n\n\n\n\n1.2.1.2 geom_line\n\nCodeeconomics |&gt; head()\n#&gt; # A tibble: 6 × 6\n#&gt;   date         pce    pop psavert uempmed unemploy\n#&gt;   &lt;date&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;\n#&gt; 1 1967-07-01  507. 198712    12.6     4.5     2944\n#&gt; 2 1967-08-01  510. 198911    12.6     4.7     2945\n#&gt; 3 1967-09-01  516. 199113    11.9     4.6     2958\n#&gt; 4 1967-10-01  512. 199311    12.9     4.9     3143\n#&gt; 5 1967-11-01  517. 199498    12.8     4.7     3066\n#&gt; 6 1967-12-01  525. 199657    11.8     4.8     3018\n\nggplot(economics,aes(date,pop))+\n    geom_line()+\n    scale_x_date()\n\n\n\n\n\n\n\n\n1.2.1.3 geom_smooth\n\nCodeq &lt;- ggplot(mpg, aes(displ, hwy)) +\n    geom_point()\n\nq+geom_smooth(method = \"loess\",span = 0.2,se=T) # loess 平滑局部回归   small n\n#&gt; `geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode                                   #span 0非常摆动，1不那么摆动\n\nq+ geom_smooth(span = 1)  #不很摆动\n#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\n\n\n\n\nCode\nlibrary(MASS)\nq+geom_smooth(method = \"rlm\")   # robust linear model  稳健线性模型\n#&gt; `geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode\nlibrary(mgcv)\nq+ geom_smooth(method = \"gam\", formula = y ~ s(x)) # gam 广义相加模型   n&gt;1000\n\n\n\n\n\n\n\n\nCodebinomial_smooth &lt;- function(...) {\n  geom_smooth(method = \"glm\", method.args = list(family = \"binomial\"), ...)\n}\n\n\n\nggplot(rpart::kyphosis,aes(Age,as.numeric(Kyphosis)-1))+\n    geom_point()+\n    binomial_smooth()\n#&gt; `geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n1.2.1.4 geom_histogram\n\nCodeggplot(mpg, aes(hwy)) + geom_histogram(binwidth = 2.5)\n\n\n\n\n\n\nCode\n\nggplot(mpg, aes(hwy)) +\n  geom_histogram(binwidth = 1) |\nggplot(mpg, aes(hwy)) +\n  geom_histogram(aes(weight = displ), binwidth = 1) # 加权\n\n\n\n\n\n\nCode\nggplot(data = mpg) + \n    geom_histogram(aes(x=displ,y=after_stat(density)),\n                   stat = \"bin\",position = \"stack\",\n                   binwidth = 0.5\n                   ) +\n    scale_y_continuous(labels=scales::percent) +\n    geom_density(aes(x=displ,y=after_stat(density)),\n                 color=\"red\", linewidth=1)\n\n\n\n\n\n\n\n\n1.2.1.5 geom_bin2d()\n\nCodesmaller &lt;- diamonds |&gt; \n  dplyr::filter(carat &lt; 3)\nggplot(smaller, aes(x = carat, y = price)) +\n  geom_bin2d()\n\n\n\n\n\n\nCode\n# install.packages(\"hexbin\")\nggplot(smaller, aes(x = carat, y = price)) +\n  geom_hex()\n#&gt; Warning: Computation failed in `stat_binhex()`.\n#&gt; Caused by error in `compute_group()`:\n#&gt; ! The package \"hexbin\" is required for `stat_bin_hex()`.\n\n\n\n\n\n\n\n\n1.2.1.6 geom_freqpoly\n\nCodeggplot(mpg, aes(hwy)) + \n  geom_freqpoly(binwidth = 2.5)\n\n\n\n\n\n\n\n\n1.2.1.7 geom_density\n\nCode\np &lt;- ggplot(data = mpg)\np + geom_density(aes(displ,fill=drv),\n                 stat = \"density\",position = \"identity\",\n                 alpha=0.3\n                 )+\n    scale_y_continuous(labels = scales::percent)+\n    labs(fill=\"图例名\")+\n    theme(legend.position = \"top\")\n\n\n\n\n\n\n\n\n1.2.1.8 geom_rug\ny→sides=\"r\",\"l\"\nx→sides=\"b\",\"t\"\n\nCodep + geom_rug(aes(x=displ,y=hwy),\n           sides = \"br\",color=\"brown\")\n\n\n\n\n\n\n\n\n1.2.1.9 geom_jitter\n\nCodep + geom_jitter(mapping = aes(x=displ,y=hwy),\n               stat = \"identity\",position = \"jitter\")\n\n\n\n\n\n\n\n\n1.2.2 X=离散型变量\n\n1.2.2.1 geom_bar\n\nCodeggplot(data = mpg) + \n    geom_bar(mapping = aes(x=factor(cyl),fill=drv),\n             stat = \"count\",position = \"stack\") |\nggplot(data = mpg) + \n    geom_bar(mapping = aes(x=factor(cyl),fill=drv),\n             position = \"dodge\")\n\n\n\n\n\n\nCode\n\nggplot(data = mpg) + \n    geom_col(mapping = aes(x=factor(cyl),y=hwy,fill=drv),\n             position = \"stack\") |\n\nggplot(data = mpg) + \n    geom_col(mapping = aes(x=factor(cyl),y=hwy,fill=drv),\n             position = \"fill\")+\n    scale_y_continuous(labels = scales::label_percent())\n\n\n\n\n\n\n\n有序条形图\n\nCodeggplot(mpg, aes(x = fct_infreq(class))) +  #降序条形图\n  geom_bar()\n\n\n\n\n\n\n\n\n1.2.2.2 geom_errorbar\n\ngeom_errorbarh\ngeom_linerange\ngeom_crossbar\ngeom_pointrange\n\n\nCodey &lt;- c(18, 11, 16)\ndf &lt;- data.frame(x = 1:3, y = y, se = c(1.2, 0.5, 1.0))\n\nbase &lt;- ggplot(df, aes(x, y, ymin = y - se, ymax = y + se))\n(base + geom_errorbar()|\nbase + geom_linerange()|\nbase + geom_ribbon())/\n(base + geom_crossbar()|\nbase + geom_pointrange()|\nbase + geom_smooth(stat = \"identity\"))\n\n\n\n\n\n\n\n\nCoderead_csv(\"data/g.csv\") |&gt; \n    summarise(\n        mean=mean(liverweight),\n        sd=sd(liverweight),\n        .by=treatment\n  ) |&gt; \n    ggplot(aes(treatment,mean,fill=treatment))+\n    geom_bar(stat = \"identity\")+\n    geom_errorbar(aes(ymin=mean-sd,ymax=mean+sd),width=.2)\n#&gt; Rows: 20 Columns: 2\n#&gt; ── Column specification ────────────────────────────────────────────────────────\n#&gt; Delimiter: \",\"\n#&gt; chr (1): treatment\n#&gt; dbl (1): liverweight\n#&gt; \n#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.\n#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\n\n\n\n1.2.2.3 geom_dotplot\n\nCodeggplot(mpg)+geom_dotplot(mapping = aes(x=drv,y=hwy),\n                 position = \"identity\",\n                 stackdir = \"center\",binaxis = 'y',# stacking along y axis\n                 fill=\"red\",binwidth = 0.7)\n\n\n\n\n\n\n\n\n1.2.2.4 geom_boxplot\n\nCodeggplot(mpg) + geom_boxplot(mapping = aes(x=drv,y=hwy),\n             stat = \"boxplot\",position = \"dodge\",\n             notch=TRUE, varwidth=TRUE,\n             width=0.1,fill=\"green\"\n            )+\n    geom_violin(aes(x=drv,y=hwy),alpha=0.2)\n\n\n\n\n\n\n\n\n1.2.2.5 geom_violin\n\nCodeggplot(mpg) + geom_violin(mapping = aes(x=drv,y=hwy),\n             stat = \"ydensity\",position = \"dodge\")\n\n\n\n\n\n\n\n\n1.2.2.6 geom_tile\n\nCode# 设置随机数种子以确保结果的可重复性  \nset.seed(10)  \n  \n# 生成随机数据集  \nmydata &lt;- tibble(  \n  year = 2000:2024,  \n  lung = runif(25),  \n  liver = runif(25), \n  bone = runif(25),  \n  luk = runif(25),  \n  eso = runif(25),  \n  gas = runif(25),   \n  eye = runif(25),  \n  brain = runif(25),  \n  pan = runif(25),  \n  kidney = runif(25),  \n  breast= runif(25),  \n)  |&gt; pivot_longer(cols = -1,\n                   names_to = \"cancer\",\n                   values_to = \"morbidity\")\n\nggplot(mydata, aes(year, cancer)) +  \n  geom_tile(aes(fill =morbidity)) +  \n  scale_fill_gradient(low = \"white\", high = \"red\")",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 Graphics"
    ]
  },
  {
    "objectID": "ggplot2_graphics.html#坐标系-coordinate",
    "href": "ggplot2_graphics.html#坐标系-coordinate",
    "title": "",
    "section": "\n1.5 坐标系 coordinate",
    "text": "1.5 坐标系 coordinate\n默认坐标系是笛卡尔坐标系\n\nCodebar &lt;- ggplot(data = diamonds) + \n  geom_bar(\n    mapping = aes(x = clarity, fill = clarity), \n    show.legend = FALSE,\n    width = 1\n  ) + \n  theme(aspect.ratio = 1)\nbar\n\n\n\n\n\n\nCodebar + coord_cartesian() |#笛卡尔坐标\nbar + coord_flip()| #水平条形图\nbar + coord_polar()#极坐标",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 Graphics"
    ]
  },
  {
    "objectID": "ggplot2_graphics.html#坐标轴-axis",
    "href": "ggplot2_graphics.html#坐标轴-axis",
    "title": "",
    "section": "\n1.6 坐标轴 axis",
    "text": "1.6 坐标轴 axis\n\n1.6.1 变换\n\nCode\nggplot(mpg, aes(log10(cty),hwy)) +\n    geom_point()+\n    scale_x_log10()\n\n\n\n\n\n\n\n\n1.6.2 limits\n\nCodeggplot(mpg, aes(displ, hwy)) +\n    geom_point(na.rm = TRUE) | \nggplot(mpg, aes(displ, hwy)) +\n    geom_point(na.rm = TRUE) +\n    xlim(5, 6) +\n    ylim(10, 25)\n\n\n\n\n\n\nCode\nggplot(mpg, aes(drv, hwy)) +\n    geom_jitter(width = 0.25, na.rm = TRUE) +\n    xlim(\"f\", \"r\") +\n    ylim(25, NA)\n\n\n\n\n\n\n\n\nCode# filter\nmpg |&gt;\n  dplyr::filter(displ &gt;= 5 & displ &lt;= 6 & hwy &gt;= 10 & hwy &lt;= 25) |&gt;\n  ggplot(aes(x = displ, y = hwy)) +\n  geom_point(aes(color = drv)) +\n  geom_smooth(na.rm=TRUE)|\n# limits\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = drv)) +\n  geom_smooth(na.rm=TRUE) +\n  scale_x_continuous(limits = c(5, 6)) +    #取子集\n  scale_y_continuous(limits = c(10, 25))  \n#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n#&gt; Warning: Removed 202 rows containing missing values or values outside the scale range\n#&gt; (`geom_point()`).\n\n\n\n\n\n\n\n\n1.6.3 zooming\n调整绘制的数据,在每个刻度中设置coord_cartesian(xlim= ,ylim= )\n\nCodeggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = drv)) +\n  geom_smooth() |\n    ggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = drv)) +\n  geom_smooth()+\n  coord_cartesian(xlim = c(5, 6), ylim = c(10, 25))   #放大局部\n#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\n\n\n\n\n\n\n1.6.4 共享\nshared 坐标轴相同\n\nCodex_scale &lt;- scale_x_continuous(limits = range(mpg$displ))\ny_scale &lt;- scale_y_continuous(limits = range(mpg$hwy))\ncol_scale &lt;- scale_color_discrete(limits = unique(mpg$drv))\nggplot(mpg[mpg$class==\"suv\",], aes(x = displ, y = hwy, color = drv)) +\n  geom_point() +\n  x_scale +\n  y_scale +\n  col_scale|\nggplot(mpg[mpg$class==\"compact\",], aes(x = displ, y = hwy, color = drv)) +\n  geom_point() +\n  x_scale +\n  y_scale +\n  col_scale",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 Graphics"
    ]
  },
  {
    "objectID": "ggplot2_graphics.html#标题-labels",
    "href": "ggplot2_graphics.html#标题-labels",
    "title": "",
    "section": "\n1.7 标题 labels",
    "text": "1.7 标题 labels\n\nCodeggplot(mpg, aes(cty, hwy)) +\n    geom_point(alpha = 1 / 3) +\n    xlab(\"city driving (mpg)\") +\n    ylab(\"highway driving (mpg)\")+\n    ggtitle(\"主标题\")\n\n\n\n\n\n\nCode\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = class)) +\n  geom_smooth(se = FALSE) +\n  labs(\n    x = \"Engine displacement (L)\",\n    y = \"Highway fuel economy (mpg)\",\n    color = \"Car type\", # 图例 美学映射color\n    title = \"Fuel efficiency generally decreases with engine size\",\n    subtitle = \"Two seaters (sports cars) are an \n    exception because of their light weight\",\n    caption = \"Data from fueleconomy.gov\"\n  )\n#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 Graphics"
    ]
  },
  {
    "objectID": "ggplot2_graphics.html#注释-annotation",
    "href": "ggplot2_graphics.html#注释-annotation",
    "title": "",
    "section": "\n1.8 注释 annotation",
    "text": "1.8 注释 annotation\n\n1.8.1 文本 text\n\nCode# 字体\ndf &lt;- data.frame(x = 1, y = 3:1, family = c(\"sans\", \"serif\", \"mono\"))\nggplot(df, aes(x, y)) + \n  geom_text(aes(label = family, family = family))\n\n\n\n\n\n\nCode\n# 样式\ndf &lt;- data.frame(x = 1, y = 3:1, face = c(\"plain\", \"bold\", \"italic\"))\nggplot(df, aes(x, y)) + \n  geom_text(aes(label = face, fontface = face))\n\n\n\n\n\n\nCode\n# 位置\ndf &lt;- data.frame(\n  x = c(1, 1, 2, 2, 1.5),\n  y = c(1, 2, 1, 2, 1.5),\n  text = c(\n    \"bottom-left\", \"top-left\",  \n    \"bottom-right\", \"top-right\", \"center\"\n  )\n)\nggplot(df, aes(x, y)) +\n  geom_text(aes(label = text))|\nggplot(df, aes(x, y)) +\n  geom_text(aes(label = text), vjust = \"inward\", hjust = \"inward\")\n\n\n\n\n\n\nCode\n\n# 自定义\ndf &lt;- data.frame(\n  treatment = c(\"a\", \"b\", \"c\"), \n  response = c(1.2, 3.4, 2.5)\n)\nggplot(df, aes(treatment, response)) + \n  geom_point() + \n  geom_text(\n    mapping = aes(label = paste0(\"(\", response, \")\")), \n    nudge_x = -0.3,\n    nudge_y=.2\n  ) \n\n\n\n\n\n\n\n\nCodemtcars |&gt;\n    group_by(cyl,am) |&gt; \n    summarise(n=n()) |&gt; \n    mutate(pct = n / sum(n),\n         lbls = scales::percent(pct)\n         )|&gt; \n    ggplot(aes(factor(cyl),pct,fill=factor(am)))+\n    geom_bar(stat = \"identity\",position = \"fill\")+\n    geom_text(mapping = aes(label=lbls),\n              position = position_stack(vjust = 0.5),\n              size=3\n              )\n#&gt; `summarise()` has grouped output by 'cyl'. You can override using the `.groups`\n#&gt; argument.\n\n\n\n\n\n\n\n\nCodelabel_info &lt;- mpg |&gt;\n    group_by(drv) |&gt;\n    arrange(desc(displ)) |&gt;\n    slice_head(n = 1)|&gt;\n    mutate(\n        drive_type = case_when(       # vectorise multiple if_else () statements \n        drv == \"f\" ~ \"front-wheel drive\",\n        drv == \"r\" ~ \"rear-wheel drive\",\n        drv == \"4\" ~ \"4-wheel drive\")\n        )|&gt;\n    dplyr::select(displ, hwy, drv, drive_type)\n\np &lt;-ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +\n    geom_point(alpha = 0.3) +\n    geom_smooth(method=\"lm\",formula=\"y~x\",se = FALSE) +\n    theme(legend.position = \"none\")\n\np+  geom_text(#添加注释  geom_label 标签加背景框\n    data = label_info, \n    aes(x = displ, y = hwy, label = drive_type),#label映射\n    fontface = \"bold\", size = 5, nudge_y = 2\n    )\n\n\n\n\n\n\nCode\np + ggrepel::geom_label_repel(                   \n    data = label_info, \n    aes(x = displ, y = hwy, label = drive_type),\n    fontface = \"bold\", size = 5, nudge_y = 2\n  ) \n\n\n\n\n\n\nCode\n\npotential_outliers &lt;- mpg |&gt;\n  dplyr::filter(hwy &gt; 40 | (hwy &gt; 20 & displ &gt; 5))\n\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point() +\n  ggrepel::geom_text_repel(data = potential_outliers, aes(label = model)) +\n  geom_point(data = potential_outliers, color = \"red\") +\n  geom_point(\n    data = potential_outliers,\n    color = \"red\", size = 3, shape = \"circle open\"\n  )\n\n\n\n\n\n\n\n\n1.8.2 markdown\n\nCodedf &lt;- data.frame(x = 1:3, y = 1:3)\nbase &lt;- ggplot(df, aes(x, y)) + \n  geom_point() + \n  labs(x = \"Axis title with *italics* and **boldface**\")\nbase |\nbase + theme(axis.title.x = ggtext::element_markdown())  #ggtext::element_markdown\n\n\n\n\n\n\n\n\n1.8.3 数学表达式\n\nCodetibble(\n  x = 1:10,\n  y = cumsum(x^2)) %&gt;% \n  ggplot(aes(x, y)) +\n  geom_point() +\n  labs(\n    x = quote(x[i]),\n    y = quote(sum(x[i] ^ 2, i == 1, n)) #数学方程式\n  )\n\n\n\n\n\n\nCode\nvalues &lt;- seq(from = -2, to = 2, by = .01)\ndf &lt;- data.frame(x = values, y = values ^ 3)\nggplot(df, aes(x, y)) + \n  geom_path() + \n  labs(y = quote(f(x) == x^3))         #数学表达式   ？plotmath\n\n\n\n\n\n\n\n\n1.8.4 线段 直线 箭头\ngeom_hline()\ngeom_vline()\ngeom_abline\ngeom_segment() arrow\n\nCodetrend_text &lt;- \"Larger engine sizes tend to have lower fuel economy.\" |&gt;\n  str_wrap(width = 30)\ntrend_text\n#&gt; [1] \"Larger engine sizes tend to\\nhave lower fuel economy.\"\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point() +\n  annotate(\n    geom = \"label\", x = 3.5, y = 38,\n    label = trend_text,\n    hjust = \"left\", color = \"red\"\n  ) +\n  annotate(\n    geom = \"segment\",\n    x = 3, y = 35, xend = 5, yend = 25, color = \"red\",\n    arrow = arrow(type = \"closed\")\n  )\n\n\n\n\n\n\n\n\nCodep &lt;- ggplot(mpg, aes(displ, hwy)) +\n  geom_point(\n    data = dplyr::filter(mpg, manufacturer == \"subaru\"), \n    colour = \"orange\",\n    size = 3\n  ) +\n  geom_point() \np|p + \n  annotate(geom = \"point\", x = 5.5, y = 40, colour = \"orange\", size = 3) + \n  annotate(geom = \"point\", x = 5.5, y = 40) + \n  annotate(geom = \"text\", x = 5.6, y = 40, label = \"subaru\", hjust = \"left\")|\np + \n  annotate(\n    geom = \"curve\", x = 4, y = 35, xend = 2.65, yend = 27, \n    curvature = .3, arrow = arrow(length = unit(2, \"mm\"))\n  ) +\n  annotate(geom = \"text\", x = 4.1, y = 35, label = \"subaru\", hjust = \"left\")",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 Graphics"
    ]
  },
  {
    "objectID": "ggplot2_graphics.html#scale",
    "href": "ggplot2_graphics.html#scale",
    "title": "",
    "section": "\n1.9 scale",
    "text": "1.9 scale\n\n1.9.1 x/y_continuous\n\nCodeggplot(mtcars, aes(x = wt, y = mpg)) + \n  geom_point() +\n  scale_x_continuous(name = \"Weight (1000 lbs.)\",   \n                     n.breaks = 10,                 \n                     minor_breaks = NULL,           \n                     limits = c(1.5, 5.5)) +        \n  scale_y_continuous(name = \"Miles per gallon\",     \n                     breaks = seq(10, 35, 5),       \n                     minor_breaks = seq(10, 35, 1), \n                     limits = c(10, 35)) +          \n  labs(title = \"Fuel efficiency by car weight\")\n\n\n\n\n\n\n\n\nCodeggplot(diamonds, aes(x = price, y = cut)) +\n  geom_boxplot(alpha = 0.05) +\n  scale_x_continuous(labels = scales::label_dollar(scale = 1/1000, suffix = \"K\"))\n\n\n\n\n\n\nCode\nggplot(diamonds, aes(x = cut, fill = clarity)) +\n  geom_bar(position = \"fill\") +\n  scale_y_continuous(name = \"Percentage\", labels = scales::label_percent())\n\n\n\n\n\n\n\n\n1.9.2 x/y_discrete\n\nCodeggplot(mpg,aes(x=factor(drv),fill=class))+\n    geom_bar(position = \"fill\") -&gt;p\np | p + scale_x_discrete(name = \"drv\",                                  \n                   limits = c(\"f\", \"r\"),    \n                   labels = c('f'=\"drv='f'\",'r'= \"drv='r'\"),\n                   position = \"top\") \n#&gt; Warning: Removed 103 rows containing non-finite outside the scale range\n#&gt; (`stat_count()`).\n\n\n\n\n\n\n\n\n1.9.3 color\n\nCodeRColorBrewer::display.brewer.all()\n\n\n\n\n\n\nCodep &lt;- ggplot(mpg, aes(x=displ, y=hwy, color=drv)) +\n  geom_point(shape=19, size=3) \np + ggthemes::scale_color_colorblind()\n\n\n\n\n\n\n\n\nCodep &lt;- ggplot(mpg, aes(x=displ, y=hwy, color=cty)) +\n  geom_point() \np + ggtitle(\"A. Default color gradient\")|\np + scale_color_gradient(low=\"grey\", high=\"black\") +\n  ggtitle(\"B. Greyscale gradient\")|\np + scale_color_gradient(low=\"red\", high=\"blue\") +\n  ggtitle(\"C. Red-blue color gradient\")\n\n\n\n\n\n\nCode\np + scale_color_steps(low=\"red\", high=\"blue\") +\n  ggtitle(\"D. Red-blue binned color Gradient\")|\np + scale_color_steps2(low=\"red\", mid=\"white\", high=\"blue\",\n                       midpoint=median(mtcars$disp)) +\n  ggtitle(\"E. Red-white-blue binned gradient\")|\np + scale_color_viridis_c(direction = -1) +    # viridis_c,d,b\n  ggtitle(\"F. Viridis color gradient\")\n\n\n\n\n\n\n\n\nCodedf &lt;- tibble(\n  x = rnorm(10000),\n  y = rnorm(10000)\n)\n\nggplot(df, aes(x, y)) +\n  geom_hex() +\n  coord_fixed() +\n  labs(title = \"Default, continuous\", x = NULL, y = NULL)\n#&gt; Warning: Computation failed in `stat_binhex()`.\n#&gt; Caused by error in `compute_group()`:\n#&gt; ! The package \"hexbin\" is required for `stat_bin_hex()`.\n\n\n\n\n\n\nCode\nggplot(df, aes(x, y)) +\n  geom_hex() +\n  coord_fixed() +\n  scale_fill_viridis_c() +\n  labs(title = \"Viridis, continuous\", x = NULL, y = NULL)\n#&gt; Warning: Computation failed in `stat_binhex()`.\n#&gt; Caused by error in `compute_group()`:\n#&gt; ! The package \"hexbin\" is required for `stat_bin_hex()`.\n\n\n\n\n\n\nCode\nggplot(df, aes(x, y)) +\n  geom_hex() +\n  coord_fixed() +\n  scale_fill_viridis_b() +\n  labs(title = \"Viridis, binned\", x = NULL, y = NULL)\n#&gt; Warning: Computation failed in `stat_binhex()`.\n#&gt; Caused by error in `compute_group()`:\n#&gt; ! The package \"hexbin\" is required for `stat_bin_hex()`.\n\n\n\n\n\n\n\n\n1.9.4 fill\n\nCodep &lt;- ggplot(mpg,aes(drv,fill=class))+\n    geom_bar()\n\np + ggtitle(\"A. Default colors\")|\np + scale_fill_brewer(palette=\"Set2\") +\n  ggtitle(\"B. ColorBrewer Set2 palette\")\n\n\n\n\n\n\nCode\np + scale_fill_viridis_d() +\n  ggtitle(\"C. Viridis color scheme\")|\np + scale_fill_manual(values=c(\"gold4\", \"orange2\", \"deepskyblue3\", \"blue4\",\n                               \"brown2\", \"yellowgreen\",\"lightpink\")) +\n  ggtitle(\"D. Manual color selection\")",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 Graphics"
    ]
  },
  {
    "objectID": "ggplot2_graphics.html#分面",
    "href": "ggplot2_graphics.html#分面",
    "title": "",
    "section": "\n1.10 分面",
    "text": "1.10 分面\n\nCodeq &lt;- ggplot(mpg,aes(x=displ))+\n  geom_histogram(fill=\"lightblue\")\n\n# 一个分类变量\nq + facet_wrap(~drv,nrow = 3)\n#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\nCodeq + facet_wrap(~drv,ncol = 3)  #\n#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\nCode\n# 多个分类变量\nq + facet_grid(drv~class)\n#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\nCodeq + facet_grid(drv~.)\n#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\nCodeq + facet_grid(.~drv)   #\n#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\n\n\nCodeggplot(mpg, aes(x = displ, y = hwy)) + \n  geom_point() + \n  facet_grid(drv ~ cyl) |\nggplot(mpg, aes(x = displ, y = hwy)) + \n  geom_point() + \n  facet_grid(drv ~ cyl, scales = \"free_y\")",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 Graphics"
    ]
  },
  {
    "objectID": "ggplot2_graphics.html#主题",
    "href": "ggplot2_graphics.html#主题",
    "title": "",
    "section": "\n1.11 主题",
    "text": "1.11 主题\n\n1.11.1 内置主题\n\nCodep &lt;- ggplot(mpg,aes(displ,hwy))\np + theme_grey() + labs(title = \"theme_grey\")  |\np + theme_bw() + labs(title = \"theme_bw\")  \n\n\n\n\n\n\nCodep + theme_minimal() + labs(title = \"theme_minimal\")|  \np + theme_classic() + labs(title = \"theme_classic\")\n\n\n\n\n\n\n\n\n1.11.2 字体\n\nCodefindfont &lt;- function(x){\n  suppressMessages(require(showtext))\n  suppressMessages(require(dplyr))\n  dplyr::filter(font_files(), grepl(x, family, ignore.case=TRUE)) |&gt; \n    dplyr::select(path, file, family, face)\n}\n\nfindfont(\"comic\")\n#&gt;               path        file        family        face\n#&gt; 1 C:/Windows/Fonts   comic.ttf Comic Sans MS     Regular\n#&gt; 2 C:/Windows/Fonts comicbd.ttf Comic Sans MS        Bold\n#&gt; 3 C:/Windows/Fonts  comici.ttf Comic Sans MS      Italic\n#&gt; 4 C:/Windows/Fonts  comicz.ttf Comic Sans MS Bold Italic\nfont_add(family = \"Times New Roman\", regular = \"C:\\\\Windows\\\\Fonts\\\\Times New Roman\\\\times.ttf\",\n         bold = \"C:\\\\Windows\\\\Fonts\\\\Times New Roman\\\\timesbd.ttf\",\n         italic = \"C:\\\\Windows\\\\Fonts\\\\Times New Roman\\\\timesi.ttf\",\n         bolditalic = \"C:\\\\Windows\\\\Fonts\\\\Times New Roman\\\\timesbi.ttf\")\nfindfont(\"Times New Roman\")\n#&gt;               path        file          family        face\n#&gt; 1 C:/Windows/Fonts   times.ttf Times New Roman     Regular\n#&gt; 2 C:/Windows/Fonts timesbd.ttf Times New Roman        Bold\n#&gt; 3 C:/Windows/Fonts timesbi.ttf Times New Roman Bold Italic\n#&gt; 4 C:/Windows/Fonts  timesi.ttf Times New Roman      Italic\nfont_families()\n#&gt;  [1] \"sans\"                        \"serif\"                      \n#&gt;  [3] \"mono\"                        \"wqy-microhei\"               \n#&gt;  [5] \"Times New Roman Regular\"     \"Times New Roman Bold\"       \n#&gt;  [7] \"Times New Roman Bold Italic\" \"Times New Roman Italic\"     \n#&gt;  [9] \"黑体 常规\"                   \"楷体 常规\"                  \n#&gt; [11] \"Times New Roman\"\n\n\n\n1.11.3 自定义主题\n\nCodemytheme &lt;- theme(plot.title=element_text(face=\"bold.italic\",  size=\"14\", color=\"brown\"),\n                 axis.title=element_text(face=\"bold.italic\",  size=10, color=\"brown\"),\n                 axis.text=element_text(face=\"bold\", size=9,  color=\"darkblue\"), \n                 panel.background=element_rect(fill=\"white\",  color=\"darkblue\"),  \n                 panel.grid.major.y=element_line(color=\"grey\",  linetype=1),  \n                 panel.grid.minor.y=element_line(color=\"grey\",  linetype=2),  \n                 panel.grid.minor.x=element_blank(),  legend.position=\"top\") \nggplot(mpg, aes(x=drv, y=hwy, fill=drv)) +  \n  geom_boxplot() +  \n  mytheme \n\n\n\n\n\n\n\n\n1.11.4 图例\n\nCode# 位置和布局\nbase &lt;- ggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = class))\n\nbase + theme(legend.position = \"right\") # the default\n\n\n\n\n\n\nCodebase + theme(legend.position = \"left\")\n\n\n\n\n\n\nCodebase + \n  theme(legend.position = \"top\") +\n  guides(color = guide_legend(nrow = 3))\n\n\n\n\n\n\nCodebase + \n  theme(legend.position = \"bottom\") +\n  guides(color = guide_legend(nrow = 2, override.aes = list(size = 4)))\n\n\n\n\n\n\nCode\n# 文本\n\nggplot(mtcars, aes(wt, mpg, color = factor(cyl))) +\n  geom_point(size=3) +\n  scale_color_discrete(name=\"Cylinders\") +\n  labs(title = \"Fuel Efficiency for 32 Automobiles\",\n       x = \"Weight (1000 lbs)\",\n       y = \"Miles per gallon\") +\n  theme(legend.position = c(.95, .95),\n        legend.justification = c(1, 1),\n        legend.background = element_rect(fill = \"lightgrey\",\n                                         color = \"white\",\n                                         linewidth = 1),\n        legend.key = element_blank(),\n        legend.direction = \"horizontal\")\n#&gt; Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2\n#&gt; 3.5.0.\n#&gt; ℹ Please use the `legend.position.inside` argument of `theme()` instead.\n\n\n\n\n\n\n\n\nCodeggplot(mpg, aes(x = displ, y = hwy, color = drv)) +\n  geom_point() +\n  labs(\n    title = \"Larger engine sizes tend to have lower fuel economy\",\n    caption = \"Source: https://fueleconomy.gov.\"\n  ) +\n  theme(\n    legend.position = c(0.8, 0.9),\n    legend.direction = \"horizontal\",\n    legend.box.background = element_rect(color = \"blue\"),\n    plot.title = element_text(face = \"bold\",hjust = 0.5),\n    plot.title.position = \"plot\",\n    plot.caption.position = \"plot\",\n    plot.caption = element_text(hjust = 1)\n  )\n\n\n\n\n\n\n\n\n1.11.5 绘图区\n\nCodemtcars$am &lt;- factor(mtcars$am, labels = c(\"Automatic\", \"Manual\")) \nggplot(data=mtcars, aes(x = disp, y = mpg)) +                     \n  geom_point(aes(color=factor(cyl)), size=2) +                   \n  geom_smooth(method=\"lm\", formula = y ~ x + I(x^2),                             \n              linetype=\"dotted\", se=FALSE) +\n  scale_color_discrete(\"Number of cylinders\") +\n  facet_wrap(~am, ncol=2) +                                      \n  labs(title = \"Mileage, transmission type, and number of cylinders\",\n       x = \"Engine displacement (cu. in.)\",\n       y = \"Miles per gallon\") +\n  theme_bw() +                                                  \n  theme(strip.background = element_rect(fill = \"white\"),\n        panel.grid.major = element_line(color=\"lightgrey\"),\n        panel.grid.minor = element_line(color=\"lightgrey\",\n                                        linetype=\"dashed\"),\n        axis.ticks = element_blank(),\n        legend.position = \"bottom\",\n        legend.key = element_blank())\n\n\n\n\n\n\n\n\nCodelibrary(grid)\n\ngray_gradient &lt;- linearGradient(scales::pal_grey()(10))\n\nggplot(mpg, aes(displ, hwy)) +\n    geom_point() +\n    theme(panel.background = element_rect(fill = gray_gradient))",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 Graphics"
    ]
  },
  {
    "objectID": "base_graphics.html",
    "href": "base_graphics.html",
    "title": "",
    "section": "",
    "text": "CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "baseR 图形",
      "base graphics"
    ]
  },
  {
    "objectID": "base_graphics.html#图形参数",
    "href": "base_graphics.html#图形参数",
    "title": "",
    "section": "\n1.1 图形参数",
    "text": "1.1 图形参数\n\n\n\n\n\nCode#par()     #返回当前设置，一个list\nopar&lt;-par(no.readonly = TRUE)\n\n\n\nCode# initialization\npar(mar=c(3,3,3,3))\nnum &lt;- 0 ; \nnum1 &lt;- 0\nplot(0,0 , xlim=c(0,21) , ylim=c(0.5,6.5), col=\"white\" , yaxt=\"n\" , ylab=\"\" , xlab=\"\")\n \n#fill the graph\nfor (i in seq(1,20)){\n  points(i,1 , pch=i , cex=3)\n  points(i,2 , col=i , pch=16 , cex=3)\n  points(i,3 , col=\"black\" , pch=16 , cex=i*0.25)\n  \n  #lty\n  if(i %in% c(seq(1,18,3))){\n        num=num+1\n    points(c(i,i+2), c(4,4) , col=\"black\" , lty=num , type=\"l\" , lwd=2)\n        text(i+1.1 , 4.15 , num)\n        }\n  \n  #type and lwd \n  if(i %in% c(seq(1,20,5))){\n    num1=num1+1\n    points(c(i,i+1,i+2,i+3), c(5,5,5,5) , col=\"black\"  , type=c(\"p\",\"l\",\"b\",\"o\")[num1] , lwd=2)\n    text(i+1.1 , 5.2 , c(\"p\",\"l\",\"b\",\"o\")[num1] )\n    points(c(i,i+1,i+2,i+3), c(6,6,6,6) , col=\"black\"  , type=\"l\",  lwd=num1)\n    text(i+1.1 , 6.2 , num1 )\n \n    }\n  }\n \n#add axis\naxis(2, at = c(1,2,3,4,5,6), labels = c(\"pch\" , \"col\" , \"cex\" , \"lty\", \"type\" , \"lwd\" ), \n     tick = TRUE, col = \"black\", las = 1, cex.axis = 0.8)\n\n\n\n\n\n\nCode\npar(opar) #恢复默认设置\n\n\n\n1.1.1 par()\n\nCodepar(pch=22) #空心=0、1、2、5、6,  黑色=15:20,  col边界色  bg= 21-25填充\npar(lty=1)  # 1=实线 2:6=虚线\npar(cex.main=2,font.main=4,col.main=\"black\")#font字体样式  4=粗斜体\npar(cex.sub=1.5,font.sub=3,col.sub=\"gray\")  # 3=斜体\npar(cex.lab=1.25,font.lab=2,col.lab=\"purple\")   # 2=粗体\npar(cex.axis=1,font.axis=1,col.axis=\"green4\") # 1=常规\npar(fg=\"black\")   #边框和刻度颜色\npar(bg=\"white\")  #背景色\npar(pin=c(4,3))        #宽×高 1英寸=1.7\npar(mar=c(5,4,4,2)+0.1)    #默认值，边距\n\n\n\nCode# Margins area\npar(oma=c(3,3,3,3)) # all sides have 3 lines of space\npar(mar=c(5,4,4,2) + 0.1)\n\n# Plot\nplot(0:10, 0:10, type=\"n\", xlab=\"X\", ylab=\"Y\") # type=\"n\" hides the points\n\n# Place text in the plot and color everything plot-related red\ntext(5,5, \"Plot\", col=\"red\", cex=2)\nbox(col=\"red\")\n\n# Place text in the margins and label the margins, all in forestgreen  \nmtext(\"Margins\", side=3, line=2, cex=2, col=\"forestgreen\")  \nmtext(\"par(mar=c(b,l,t,r))\", side=3, line=1, cex=1, col=\"forestgreen\")  \nmtext(\"Line 0\", side=3, line=0, adj=1.0, cex=1, col=\"forestgreen\")  \nmtext(\"Line 1\", side=3, line=1, adj=1.0, cex=1, col=\"forestgreen\")  \nmtext(\"Line 2\", side=3, line=2, adj=1.0, cex=1, col=\"forestgreen\")  \nmtext(\"Line 3\", side=3, line=3, adj=1.0, cex=1, col=\"forestgreen\")  \nbox(\"figure\", col=\"forestgreen\")  \n \n# Label the outer margin area and color it blue  \n# Note the 'outer=TRUE' command moves us from the figure margins to the outer margins.  \nmtext(\"Outer Margin Area\", side=1, line=1, cex=2, col=\"blue\", outer=TRUE)  \nmtext(\"par(oma=c(b,l,t,r))\", side=1, line=2, cex=1, col=\"blue\", outer=TRUE)  \nmtext(\"Line 0\", side=1, line=0, adj=0.0, cex=1, col=\"blue\", outer=TRUE)  \nmtext(\"Line 1\", side=1, line=1, adj=0.0, cex=1, col=\"blue\", outer=TRUE)  \nmtext(\"Line 2\", side=1, line=2, adj=0.0, cex=1, col=\"blue\", outer=TRUE)  \nbox(\"outer\", col=\"blue\")  \n\n\n\n\n\n\n\n\n1.1.2 颜色\n\nCodecolors()\n#&gt;   [1] \"white\"                \"aliceblue\"            \"antiquewhite\"        \n#&gt;   [4] \"antiquewhite1\"        \"antiquewhite2\"        \"antiquewhite3\"       \n#&gt;   [7] \"antiquewhite4\"        \"aquamarine\"           \"aquamarine1\"         \n#&gt;  [10] \"aquamarine2\"          \"aquamarine3\"          \"aquamarine4\"         \n#&gt;  [13] \"azure\"                \"azure1\"               \"azure2\"              \n#&gt;  [16] \"azure3\"               \"azure4\"               \"beige\"               \n#&gt;  [19] \"bisque\"               \"bisque1\"              \"bisque2\"             \n#&gt;  [22] \"bisque3\"              \"bisque4\"              \"black\"               \n#&gt;  [25] \"blanchedalmond\"       \"blue\"                 \"blue1\"               \n#&gt;  [28] \"blue2\"                \"blue3\"                \"blue4\"               \n#&gt;  [31] \"blueviolet\"           \"brown\"                \"brown1\"              \n#&gt;  [34] \"brown2\"               \"brown3\"               \"brown4\"              \n#&gt;  [37] \"burlywood\"            \"burlywood1\"           \"burlywood2\"          \n#&gt;  [40] \"burlywood3\"           \"burlywood4\"           \"cadetblue\"           \n#&gt;  [43] \"cadetblue1\"           \"cadetblue2\"           \"cadetblue3\"          \n#&gt;  [46] \"cadetblue4\"           \"chartreuse\"           \"chartreuse1\"         \n#&gt;  [49] \"chartreuse2\"          \"chartreuse3\"          \"chartreuse4\"         \n#&gt;  [52] \"chocolate\"            \"chocolate1\"           \"chocolate2\"          \n#&gt;  [55] \"chocolate3\"           \"chocolate4\"           \"coral\"               \n#&gt;  [58] \"coral1\"               \"coral2\"               \"coral3\"              \n#&gt;  [61] \"coral4\"               \"cornflowerblue\"       \"cornsilk\"            \n#&gt;  [64] \"cornsilk1\"            \"cornsilk2\"            \"cornsilk3\"           \n#&gt;  [67] \"cornsilk4\"            \"cyan\"                 \"cyan1\"               \n#&gt;  [70] \"cyan2\"                \"cyan3\"                \"cyan4\"               \n#&gt;  [73] \"darkblue\"             \"darkcyan\"             \"darkgoldenrod\"       \n#&gt;  [76] \"darkgoldenrod1\"       \"darkgoldenrod2\"       \"darkgoldenrod3\"      \n#&gt;  [79] \"darkgoldenrod4\"       \"darkgray\"             \"darkgreen\"           \n#&gt;  [82] \"darkgrey\"             \"darkkhaki\"            \"darkmagenta\"         \n#&gt;  [85] \"darkolivegreen\"       \"darkolivegreen1\"      \"darkolivegreen2\"     \n#&gt;  [88] \"darkolivegreen3\"      \"darkolivegreen4\"      \"darkorange\"          \n#&gt;  [91] \"darkorange1\"          \"darkorange2\"          \"darkorange3\"         \n#&gt;  [94] \"darkorange4\"          \"darkorchid\"           \"darkorchid1\"         \n#&gt;  [97] \"darkorchid2\"          \"darkorchid3\"          \"darkorchid4\"         \n#&gt; [100] \"darkred\"              \"darksalmon\"           \"darkseagreen\"        \n#&gt; [103] \"darkseagreen1\"        \"darkseagreen2\"        \"darkseagreen3\"       \n#&gt; [106] \"darkseagreen4\"        \"darkslateblue\"        \"darkslategray\"       \n#&gt; [109] \"darkslategray1\"       \"darkslategray2\"       \"darkslategray3\"      \n#&gt; [112] \"darkslategray4\"       \"darkslategrey\"        \"darkturquoise\"       \n#&gt; [115] \"darkviolet\"           \"deeppink\"             \"deeppink1\"           \n#&gt; [118] \"deeppink2\"            \"deeppink3\"            \"deeppink4\"           \n#&gt; [121] \"deepskyblue\"          \"deepskyblue1\"         \"deepskyblue2\"        \n#&gt; [124] \"deepskyblue3\"         \"deepskyblue4\"         \"dimgray\"             \n#&gt; [127] \"dimgrey\"              \"dodgerblue\"           \"dodgerblue1\"         \n#&gt; [130] \"dodgerblue2\"          \"dodgerblue3\"          \"dodgerblue4\"         \n#&gt; [133] \"firebrick\"            \"firebrick1\"           \"firebrick2\"          \n#&gt; [136] \"firebrick3\"           \"firebrick4\"           \"floralwhite\"         \n#&gt; [139] \"forestgreen\"          \"gainsboro\"            \"ghostwhite\"          \n#&gt; [142] \"gold\"                 \"gold1\"                \"gold2\"               \n#&gt; [145] \"gold3\"                \"gold4\"                \"goldenrod\"           \n#&gt; [148] \"goldenrod1\"           \"goldenrod2\"           \"goldenrod3\"          \n#&gt; [151] \"goldenrod4\"           \"gray\"                 \"gray0\"               \n#&gt; [154] \"gray1\"                \"gray2\"                \"gray3\"               \n#&gt; [157] \"gray4\"                \"gray5\"                \"gray6\"               \n#&gt; [160] \"gray7\"                \"gray8\"                \"gray9\"               \n#&gt; [163] \"gray10\"               \"gray11\"               \"gray12\"              \n#&gt; [166] \"gray13\"               \"gray14\"               \"gray15\"              \n#&gt; [169] \"gray16\"               \"gray17\"               \"gray18\"              \n#&gt; [172] \"gray19\"               \"gray20\"               \"gray21\"              \n#&gt; [175] \"gray22\"               \"gray23\"               \"gray24\"              \n#&gt; [178] \"gray25\"               \"gray26\"               \"gray27\"              \n#&gt; [181] \"gray28\"               \"gray29\"               \"gray30\"              \n#&gt; [184] \"gray31\"               \"gray32\"               \"gray33\"              \n#&gt; [187] \"gray34\"               \"gray35\"               \"gray36\"              \n#&gt; [190] \"gray37\"               \"gray38\"               \"gray39\"              \n#&gt; [193] \"gray40\"               \"gray41\"               \"gray42\"              \n#&gt; [196] \"gray43\"               \"gray44\"               \"gray45\"              \n#&gt; [199] \"gray46\"               \"gray47\"               \"gray48\"              \n#&gt; [202] \"gray49\"               \"gray50\"               \"gray51\"              \n#&gt; [205] \"gray52\"               \"gray53\"               \"gray54\"              \n#&gt; [208] \"gray55\"               \"gray56\"               \"gray57\"              \n#&gt; [211] \"gray58\"               \"gray59\"               \"gray60\"              \n#&gt; [214] \"gray61\"               \"gray62\"               \"gray63\"              \n#&gt; [217] \"gray64\"               \"gray65\"               \"gray66\"              \n#&gt; [220] \"gray67\"               \"gray68\"               \"gray69\"              \n#&gt; [223] \"gray70\"               \"gray71\"               \"gray72\"              \n#&gt; [226] \"gray73\"               \"gray74\"               \"gray75\"              \n#&gt; [229] \"gray76\"               \"gray77\"               \"gray78\"              \n#&gt; [232] \"gray79\"               \"gray80\"               \"gray81\"              \n#&gt; [235] \"gray82\"               \"gray83\"               \"gray84\"              \n#&gt; [238] \"gray85\"               \"gray86\"               \"gray87\"              \n#&gt; [241] \"gray88\"               \"gray89\"               \"gray90\"              \n#&gt; [244] \"gray91\"               \"gray92\"               \"gray93\"              \n#&gt; [247] \"gray94\"               \"gray95\"               \"gray96\"              \n#&gt; [250] \"gray97\"               \"gray98\"               \"gray99\"              \n#&gt; [253] \"gray100\"              \"green\"                \"green1\"              \n#&gt; [256] \"green2\"               \"green3\"               \"green4\"              \n#&gt; [259] \"greenyellow\"          \"grey\"                 \"grey0\"               \n#&gt; [262] \"grey1\"                \"grey2\"                \"grey3\"               \n#&gt; [265] \"grey4\"                \"grey5\"                \"grey6\"               \n#&gt; [268] \"grey7\"                \"grey8\"                \"grey9\"               \n#&gt; [271] \"grey10\"               \"grey11\"               \"grey12\"              \n#&gt; [274] \"grey13\"               \"grey14\"               \"grey15\"              \n#&gt; [277] \"grey16\"               \"grey17\"               \"grey18\"              \n#&gt; [280] \"grey19\"               \"grey20\"               \"grey21\"              \n#&gt; [283] \"grey22\"               \"grey23\"               \"grey24\"              \n#&gt; [286] \"grey25\"               \"grey26\"               \"grey27\"              \n#&gt; [289] \"grey28\"               \"grey29\"               \"grey30\"              \n#&gt; [292] \"grey31\"               \"grey32\"               \"grey33\"              \n#&gt; [295] \"grey34\"               \"grey35\"               \"grey36\"              \n#&gt; [298] \"grey37\"               \"grey38\"               \"grey39\"              \n#&gt; [301] \"grey40\"               \"grey41\"               \"grey42\"              \n#&gt; [304] \"grey43\"               \"grey44\"               \"grey45\"              \n#&gt; [307] \"grey46\"               \"grey47\"               \"grey48\"              \n#&gt; [310] \"grey49\"               \"grey50\"               \"grey51\"              \n#&gt; [313] \"grey52\"               \"grey53\"               \"grey54\"              \n#&gt; [316] \"grey55\"               \"grey56\"               \"grey57\"              \n#&gt; [319] \"grey58\"               \"grey59\"               \"grey60\"              \n#&gt; [322] \"grey61\"               \"grey62\"               \"grey63\"              \n#&gt; [325] \"grey64\"               \"grey65\"               \"grey66\"              \n#&gt; [328] \"grey67\"               \"grey68\"               \"grey69\"              \n#&gt; [331] \"grey70\"               \"grey71\"               \"grey72\"              \n#&gt; [334] \"grey73\"               \"grey74\"               \"grey75\"              \n#&gt; [337] \"grey76\"               \"grey77\"               \"grey78\"              \n#&gt; [340] \"grey79\"               \"grey80\"               \"grey81\"              \n#&gt; [343] \"grey82\"               \"grey83\"               \"grey84\"              \n#&gt; [346] \"grey85\"               \"grey86\"               \"grey87\"              \n#&gt; [349] \"grey88\"               \"grey89\"               \"grey90\"              \n#&gt; [352] \"grey91\"               \"grey92\"               \"grey93\"              \n#&gt; [355] \"grey94\"               \"grey95\"               \"grey96\"              \n#&gt; [358] \"grey97\"               \"grey98\"               \"grey99\"              \n#&gt; [361] \"grey100\"              \"honeydew\"             \"honeydew1\"           \n#&gt; [364] \"honeydew2\"            \"honeydew3\"            \"honeydew4\"           \n#&gt; [367] \"hotpink\"              \"hotpink1\"             \"hotpink2\"            \n#&gt; [370] \"hotpink3\"             \"hotpink4\"             \"indianred\"           \n#&gt; [373] \"indianred1\"           \"indianred2\"           \"indianred3\"          \n#&gt; [376] \"indianred4\"           \"ivory\"                \"ivory1\"              \n#&gt; [379] \"ivory2\"               \"ivory3\"               \"ivory4\"              \n#&gt; [382] \"khaki\"                \"khaki1\"               \"khaki2\"              \n#&gt; [385] \"khaki3\"               \"khaki4\"               \"lavender\"            \n#&gt; [388] \"lavenderblush\"        \"lavenderblush1\"       \"lavenderblush2\"      \n#&gt; [391] \"lavenderblush3\"       \"lavenderblush4\"       \"lawngreen\"           \n#&gt; [394] \"lemonchiffon\"         \"lemonchiffon1\"        \"lemonchiffon2\"       \n#&gt; [397] \"lemonchiffon3\"        \"lemonchiffon4\"        \"lightblue\"           \n#&gt; [400] \"lightblue1\"           \"lightblue2\"           \"lightblue3\"          \n#&gt; [403] \"lightblue4\"           \"lightcoral\"           \"lightcyan\"           \n#&gt; [406] \"lightcyan1\"           \"lightcyan2\"           \"lightcyan3\"          \n#&gt; [409] \"lightcyan4\"           \"lightgoldenrod\"       \"lightgoldenrod1\"     \n#&gt; [412] \"lightgoldenrod2\"      \"lightgoldenrod3\"      \"lightgoldenrod4\"     \n#&gt; [415] \"lightgoldenrodyellow\" \"lightgray\"            \"lightgreen\"          \n#&gt; [418] \"lightgrey\"            \"lightpink\"            \"lightpink1\"          \n#&gt; [421] \"lightpink2\"           \"lightpink3\"           \"lightpink4\"          \n#&gt; [424] \"lightsalmon\"          \"lightsalmon1\"         \"lightsalmon2\"        \n#&gt; [427] \"lightsalmon3\"         \"lightsalmon4\"         \"lightseagreen\"       \n#&gt; [430] \"lightskyblue\"         \"lightskyblue1\"        \"lightskyblue2\"       \n#&gt; [433] \"lightskyblue3\"        \"lightskyblue4\"        \"lightslateblue\"      \n#&gt; [436] \"lightslategray\"       \"lightslategrey\"       \"lightsteelblue\"      \n#&gt; [439] \"lightsteelblue1\"      \"lightsteelblue2\"      \"lightsteelblue3\"     \n#&gt; [442] \"lightsteelblue4\"      \"lightyellow\"          \"lightyellow1\"        \n#&gt; [445] \"lightyellow2\"         \"lightyellow3\"         \"lightyellow4\"        \n#&gt; [448] \"limegreen\"            \"linen\"                \"magenta\"             \n#&gt; [451] \"magenta1\"             \"magenta2\"             \"magenta3\"            \n#&gt; [454] \"magenta4\"             \"maroon\"               \"maroon1\"             \n#&gt; [457] \"maroon2\"              \"maroon3\"              \"maroon4\"             \n#&gt; [460] \"mediumaquamarine\"     \"mediumblue\"           \"mediumorchid\"        \n#&gt; [463] \"mediumorchid1\"        \"mediumorchid2\"        \"mediumorchid3\"       \n#&gt; [466] \"mediumorchid4\"        \"mediumpurple\"         \"mediumpurple1\"       \n#&gt; [469] \"mediumpurple2\"        \"mediumpurple3\"        \"mediumpurple4\"       \n#&gt; [472] \"mediumseagreen\"       \"mediumslateblue\"      \"mediumspringgreen\"   \n#&gt; [475] \"mediumturquoise\"      \"mediumvioletred\"      \"midnightblue\"        \n#&gt; [478] \"mintcream\"            \"mistyrose\"            \"mistyrose1\"          \n#&gt; [481] \"mistyrose2\"           \"mistyrose3\"           \"mistyrose4\"          \n#&gt; [484] \"moccasin\"             \"navajowhite\"          \"navajowhite1\"        \n#&gt; [487] \"navajowhite2\"         \"navajowhite3\"         \"navajowhite4\"        \n#&gt; [490] \"navy\"                 \"navyblue\"             \"oldlace\"             \n#&gt; [493] \"olivedrab\"            \"olivedrab1\"           \"olivedrab2\"          \n#&gt; [496] \"olivedrab3\"           \"olivedrab4\"           \"orange\"              \n#&gt; [499] \"orange1\"              \"orange2\"              \"orange3\"             \n#&gt; [502] \"orange4\"              \"orangered\"            \"orangered1\"          \n#&gt; [505] \"orangered2\"           \"orangered3\"           \"orangered4\"          \n#&gt; [508] \"orchid\"               \"orchid1\"              \"orchid2\"             \n#&gt; [511] \"orchid3\"              \"orchid4\"              \"palegoldenrod\"       \n#&gt; [514] \"palegreen\"            \"palegreen1\"           \"palegreen2\"          \n#&gt; [517] \"palegreen3\"           \"palegreen4\"           \"paleturquoise\"       \n#&gt; [520] \"paleturquoise1\"       \"paleturquoise2\"       \"paleturquoise3\"      \n#&gt; [523] \"paleturquoise4\"       \"palevioletred\"        \"palevioletred1\"      \n#&gt; [526] \"palevioletred2\"       \"palevioletred3\"       \"palevioletred4\"      \n#&gt; [529] \"papayawhip\"           \"peachpuff\"            \"peachpuff1\"          \n#&gt; [532] \"peachpuff2\"           \"peachpuff3\"           \"peachpuff4\"          \n#&gt; [535] \"peru\"                 \"pink\"                 \"pink1\"               \n#&gt; [538] \"pink2\"                \"pink3\"                \"pink4\"               \n#&gt; [541] \"plum\"                 \"plum1\"                \"plum2\"               \n#&gt; [544] \"plum3\"                \"plum4\"                \"powderblue\"          \n#&gt; [547] \"purple\"               \"purple1\"              \"purple2\"             \n#&gt; [550] \"purple3\"              \"purple4\"              \"red\"                 \n#&gt; [553] \"red1\"                 \"red2\"                 \"red3\"                \n#&gt; [556] \"red4\"                 \"rosybrown\"            \"rosybrown1\"          \n#&gt; [559] \"rosybrown2\"           \"rosybrown3\"           \"rosybrown4\"          \n#&gt; [562] \"royalblue\"            \"royalblue1\"           \"royalblue2\"          \n#&gt; [565] \"royalblue3\"           \"royalblue4\"           \"saddlebrown\"         \n#&gt; [568] \"salmon\"               \"salmon1\"              \"salmon2\"             \n#&gt; [571] \"salmon3\"              \"salmon4\"              \"sandybrown\"          \n#&gt; [574] \"seagreen\"             \"seagreen1\"            \"seagreen2\"           \n#&gt; [577] \"seagreen3\"            \"seagreen4\"            \"seashell\"            \n#&gt; [580] \"seashell1\"            \"seashell2\"            \"seashell3\"           \n#&gt; [583] \"seashell4\"            \"sienna\"               \"sienna1\"             \n#&gt; [586] \"sienna2\"              \"sienna3\"              \"sienna4\"             \n#&gt; [589] \"skyblue\"              \"skyblue1\"             \"skyblue2\"            \n#&gt; [592] \"skyblue3\"             \"skyblue4\"             \"slateblue\"           \n#&gt; [595] \"slateblue1\"           \"slateblue2\"           \"slateblue3\"          \n#&gt; [598] \"slateblue4\"           \"slategray\"            \"slategray1\"          \n#&gt; [601] \"slategray2\"           \"slategray3\"           \"slategray4\"          \n#&gt; [604] \"slategrey\"            \"snow\"                 \"snow1\"               \n#&gt; [607] \"snow2\"                \"snow3\"                \"snow4\"               \n#&gt; [610] \"springgreen\"          \"springgreen1\"         \"springgreen2\"        \n#&gt; [613] \"springgreen3\"         \"springgreen4\"         \"steelblue\"           \n#&gt; [616] \"steelblue1\"           \"steelblue2\"           \"steelblue3\"          \n#&gt; [619] \"steelblue4\"           \"tan\"                  \"tan1\"                \n#&gt; [622] \"tan2\"                 \"tan3\"                 \"tan4\"                \n#&gt; [625] \"thistle\"              \"thistle1\"             \"thistle2\"            \n#&gt; [628] \"thistle3\"             \"thistle4\"             \"tomato\"              \n#&gt; [631] \"tomato1\"              \"tomato2\"              \"tomato3\"             \n#&gt; [634] \"tomato4\"              \"turquoise\"            \"turquoise1\"          \n#&gt; [637] \"turquoise2\"           \"turquoise3\"           \"turquoise4\"          \n#&gt; [640] \"violet\"               \"violetred\"            \"violetred1\"          \n#&gt; [643] \"violetred2\"           \"violetred3\"           \"violetred4\"          \n#&gt; [646] \"wheat\"                \"wheat1\"               \"wheat2\"              \n#&gt; [649] \"wheat3\"               \"wheat4\"               \"whitesmoke\"          \n#&gt; [652] \"yellow\"               \"yellow1\"              \"yellow2\"             \n#&gt; [655] \"yellow3\"              \"yellow4\"              \"yellowgreen\"\nrgb(red = 0,green = 1,blue = 1)\n#&gt; [1] \"#00FFFF\"\nhsv()\n#&gt; [1] \"#FF0000\"\nbarplot(1:10,col=c(1:10))\n\n\n\n\n\n\nCode\n### n种连续的彩虹色  十六进制\nrainbow(10)        \n#&gt;  [1] \"#FF0000\" \"#FF9900\" \"#CCFF00\" \"#33FF00\" \"#00FF66\" \"#00FFFF\" \"#0066FF\"\n#&gt;  [8] \"#3300FF\" \"#CC00FF\" \"#FF0099\"\nbarplot(rep(1:15),col=rainbow(10))\n\n\n\n\n\n\nCode\n### n阶灰度色 十六进制\ngray(0:15/15)      \n#&gt;  [1] \"#000000\" \"#111111\" \"#222222\" \"#333333\" \"#444444\" \"#555555\" \"#666666\"\n#&gt;  [8] \"#777777\" \"#888888\" \"#999999\" \"#AAAAAA\" \"#BBBBBB\" \"#CCCCCC\" \"#DDDDDD\"\n#&gt; [15] \"#EEEEEE\" \"#FFFFFF\"\nbarplot(rep(1,15),col=gray(0:15/15))\n\n\n\n\n\n\nCode\nlibrary(RColorBrewer)\nRColorBrewer::display.brewer.all()\n\n\n\n\n\n\nCodebarplot(rep(1,7),col=brewer.pal(7,\"Set3\"))\n\n\n\n\n\n\n\n\nCodedose&lt;-c(20,30,40,45,60)\nA&lt;-c(16,20,27,40,60)\nB&lt;-c(15,18,25,31,40)\nplot(dose,A,type=\"b\",           #type=\"b\" 线连接点\n     \n     col=\"red\",lty=1,pch=18,lwd=3,cex=2,    #点和线属性\n     \n     main=\"Clinical trials for Drug A\",     #主标题\n     sub=\"this is my data\",                  #副标题\n     xlab=\"Dosage\",ylab=\"Drug Response\",    #坐标轴标签\n     xlim=c(0,60),ylim = c(0,70)           #坐标轴范围\n)",
    "crumbs": [
      "baseR 图形",
      "base graphics"
    ]
  },
  {
    "objectID": "base_graphics.html#自定义图形标题坐标轴标签",
    "href": "base_graphics.html#自定义图形标题坐标轴标签",
    "title": "",
    "section": "\n1.2 自定义图形标题、坐标轴标签",
    "text": "1.2 自定义图形标题、坐标轴标签\n\nCodepar(mfrow=c(1,2))  \nhist(A)\nhist(A,ann=FALSE)    #ann=FALSE 移除默认标题\ntitle(main=\"main title\", col.main=\"purple\",       #主标题\n      sub=\"subtitle\", col.sub=\"pink\",            #副标题\n      xlab=\"Dosage\",ylab=\"Drug Response\",col.lab=\"red\" ,cex.lab=0.75\n      )\n\n\n\n\n\n\nCodepar(opar)",
    "crumbs": [
      "baseR 图形",
      "base graphics"
    ]
  },
  {
    "objectID": "base_graphics.html#自定义坐标轴图例文本",
    "href": "base_graphics.html#自定义坐标轴图例文本",
    "title": "",
    "section": "\n1.3 自定义坐标轴、图例、文本",
    "text": "1.3 自定义坐标轴、图例、文本\n\nCodex&lt;-c(1:10)\ny&lt;-x\n\npar(mar=c(5,4,4,4))\npar(mfrow=c(1,2))\nplot(x,y)\nplot(x,y,axes=FALSE)#禁用坐标轴框架、刻度\n\n\n\n\n\n\nCodeplot(x,y,axes=FALSE,frame.plot = TRUE)#禁用刻度\n\n\n\n\n\n\n\n\nCodez&lt;-10/x\nplot(x,y,type=\"b\",pch=21,col=\"red\",bg=\"black\",\n     xaxt=\"n\",yaxt=\"n\",lty=1  #xaxt、yaxt 禁用X、Y坐标轴刻度\n     )\nlines(x,z,type=\"b\",pch=22,col=\"blue\",lty=2,bg=\"green\")  #添加新图形\n#绘制自定义坐标轴\n#axis(side,at= ,labels = ,pos = ,las=,tck=,…)\n#side  1=下，2=左，3=上，4=右 \n#at   数值向量，绘制刻度线的位置\n#labels  字符序列，刻度线的文字标签\n#las    0=垂直于坐标轴，2=平行于坐标轴   \n#tck=-0.01    刻度线的长度   1=网格线 0=禁用刻度  负值在图形外侧，正值在图形内侧\naxis(side = 1,at=x,labels = x,las=0,tck=-0.1)\naxis(side=2,at=x,labels=x,col.axis=\"red\",las=2,tck=0.1)\naxis(side=4,at=z,labels=round(z,digits=3),col.axis=\"blue\",las=2,tck=-.05)\n\n#library(Hmisc)\n#minor.tick(nx=2,ny=2,tick.ratio = .5)#添加次要刻度线\n\n## 图例  legend(location, title, legend,...)\npar(lwd=2,cex=1,font.lab=2)\nlegend(\"top\",inset=0.05,title=\"函数\",c(\"Y=X\",\"Y=10/x\"),text.col = \"green\",\n       lty=c(3,2),pch=c(21,22),col=c(\"red\",\"blue\",bg=c(\"black\",\"green\")))\n\n# 文本\n\n#mtext(\"text\",side,line=,)\nmtext(\"Y=10/X\",side=4,line=3,cex.lab=1,las=2,col=\"blue\")  #边界文本\ntitle(main=\"my graphics\",\n      sub=\"subtitle\",\n      xlab=\"X values\",\n      ylab=\"Y=X\")\nabline(h=c(1,4),lty=2,col=\"red\")  ###添加水平辅助线 \nabline(v=c(8,10),lty=4,col=\"blue\")  ###添加垂直辅助线 \n\n\n# text(x,y,\"text\",pos=)  1=下，2=左，3=上，4=右\ntext(5,5,\"文本1\",pos=4,adj=0,cex=2,col=\"green\")\n\n\n\n\n\n\nCode\n#text(locator[1],\"文本\",pos=4,adj=0,cex=2,col=\"green\")#鼠标点击确定位置",
    "crumbs": [
      "baseR 图形",
      "base graphics"
    ]
  },
  {
    "objectID": "base_graphics.html#添加文本",
    "href": "base_graphics.html#添加文本",
    "title": "",
    "section": "\n1.4 添加文本",
    "text": "1.4 添加文本\n\nCode#标注点的信息\nA&lt;-c(1:5)\nB&lt;-c(15,23,26,17,21)\nplot(A,B,type=\"b\")\nABC&lt;-data.frame(A,B,row.names =c(\"afaf\",\"fa\",\"faae\",\"agg\",\"grgw\"))\nattach(ABC)\n#&gt; The following objects are masked _by_ .GlobalEnv:\n#&gt; \n#&gt;     A, B\ntext(A,B,row.names(ABC),cex=0.6,pos=4,col=\"blue\")\n\n\n\n\n\n\nCodedetach(ABC)\npar(opar)",
    "crumbs": [
      "baseR 图形",
      "base graphics"
    ]
  },
  {
    "objectID": "base_graphics.html#图形组合",
    "href": "base_graphics.html#图形组合",
    "title": "",
    "section": "\n1.5 图形组合",
    "text": "1.5 图形组合\n\nCode#layout(matrix,widths=,heights=)\nattach(mtcars)\n#&gt; The following object is masked from package:ggplot2:\n#&gt; \n#&gt;     mpg\nmat&lt;-matrix(c(1,1,2,3),2, 2, byrow = FALSE)\nlayout(mat,widths = c(1,0.5),heights = c(0.5,1))\nhist(wt)\nhist(mpg)\nhist(disp)\n\n\n\n\n\n\nCodedetach(mtcars)",
    "crumbs": [
      "baseR 图形",
      "base graphics"
    ]
  },
  {
    "objectID": "base_graphics.html#图形的精细控制",
    "href": "base_graphics.html#图形的精细控制",
    "title": "",
    "section": "\n1.6 图形的精细控制",
    "text": "1.6 图形的精细控制\n\nCode#参数fig=c(x1,x2,y1,y2)\nattach(mtcars)\n#&gt; The following object is masked from package:ggplot2:\n#&gt; \n#&gt;     mpg\npar(fig=c(0,0.8,0,0.8))\nplot(wt,mpg,xlab=\"Miles per Gallon\",ylab=\"Car Weight\")\npar(fig=c(0,0.8,0.55,1),new=TRUE)\nboxplot(wt,horizontal = TRUE,axes=FALSE)\npar(fig=c(0.65,1,0,0.8),new=TRUE)\nboxplot(mpg,axes=FALSE)\nmtext(\"boxplot of wt\",side=3,outer = TRUE,line=-3)",
    "crumbs": [
      "baseR 图形",
      "base graphics"
    ]
  },
  {
    "objectID": "base_graphics.html#geometry",
    "href": "base_graphics.html#geometry",
    "title": "",
    "section": "\n1.7 Geometry",
    "text": "1.7 Geometry\n\nCodedata(mpg,package=\"ggplot2\") \n\n\n\n1.7.1 条形图\n\nCodebarplot(table(mpg$drv))\n\n\n\n\n\n\nCodebarplot(table(mpg$drv),horiz = TRUE)\n\n\n\n\n\n\nCode\nbarplot(table(mpg$drv,mpg$class),legend=row.names(table(mpg$drv,mpg$class)))\n\n\n\n\n\n\nCodebarplot(table(mpg$drv,mpg$class),beside = TRUE,\n        legend=row.names(table(mpg$drv,mpg$class)))\n\n\n\n\n\n\nCode\nspineplot(table(mpg$class,mpg$drv))\n\n\n\n\n\n\n\n\n1.7.2 饼图\n\nCodex&lt;-c(10,12,4,16,8)\nlabs&lt;-c(\"US\",\"UK\",\"Australia\",\"Germany\",\"France\")\n\npie(x,labels=labs,main=\"简单饼图\")\n\n\n\n\n\n\nCodepct&lt;-round(x/sum(x)*100)\nlabs2&lt;-paste(labs,\" \",pct,\"%\",sep=\"\")\npie(x,labels=labs2,col=rainbow(length(labs2)),main=\"百分比饼图\")\n\n\n\n\n\n\n\n\n1.7.3 直方图\n\nCodehist(mpg$hwy,breaks = 12,col=\"red\")\n\n\n\n\n\n\nCode\nhist(mpg$hwy,freq = FALSE,breaks = 12, col=\"lightgreen\")\nrug(mpg$hwy,col=\"brown\",lwd=2)\nlines(density(mpg$hwy),col=\"blue\",lwd=2)\n\n\n\n\n\n\nCode\nh &lt;- hist(mpg$hwy,breaks = 12,col=\"red\")\nx&lt;-seq(min(mpg$hwy),max(mpg$hwy),by=0.01)\ny&lt;-dnorm(x,mean=mean(mpg$hwy),sd=sd(mpg$hwy))   #概率密度曲线  f(X)=(fi/n)/ΔXi\ny&lt;-y*diff(h$mids[1:2])*length(mpg$hwy)  # y*组距*总样本量  正态分布\nlines(x,y,col=\"blue\",lwd=2)\n\n\n\n\n\n\nCode\nplot(x,y)\n\n\n\n\n\n\n\n\n1.7.4 密度曲线\n\nCodeplot(density(mpg$hwy))\npolygon(density(mpg$hwy),col=\"lightblue\",border = \"red\") \nrug(mpg$hwy,col=\"brown\") \n\n\n\n\n\n\n\n\n1.7.5 箱线图\n\nCodeboxplot.stats(mpg$hwy)\n#&gt; $stats\n#&gt; [1] 12 18 24 27 37\n#&gt; \n#&gt; $n\n#&gt; [1] 234\n#&gt; \n#&gt; $conf\n#&gt; [1] 23.07041 24.92959\n#&gt; \n#&gt; $out\n#&gt; [1] 44 44 41\nboxplot(mpg$hwy)\n\n\n\n\n\n\nCode\nboxplot(hwy~drv,data=mpg,\n        notch=TRUE,\n        varwidth=TRUE)\n\n\n\n\n\n\nCode\nboxplot(hwy~drv*cyl,data=mpg)\n\n\n\n\n\n\n\n\n1.7.6 克利夫兰点图\n\nCodedotchart(mtcars[order(mtcars$mpg),]$mpg,labels = row.names(mtcars),groups = mtcars$cyl)\n\n\n\n\n\n\nCode\n\n#分组、排序、着色后的点图\nx&lt;-mtcars[order(mtcars$mpg),]\nx$cyl&lt;-factor(x$cyl)\nx$color[x$cyl==4]&lt;-\"red\"\nx$color[x$cyl==6]&lt;-\"yellow\"\nx$color[x$cyl==8]&lt;-\"blue\"\ndotchart(x$mpg,\n         labels = row.names(x),cex=.7,\n         groups = x$cyl,         #分组参数 因子\n         gcolor = \"black\",\n         color = x$color\n         )\n\n\n\n\n\n\n\n\n1.7.7 散点图\n\nCodecar::scatterplot(mpg~wt|am,data=mtcars,\n            id=TRUE,\n            legend =TRUE,#图例\n            grid=TRUE,   #添加网格线\n            boxplots=\"xy\"  #添加边界箱线图\n)\n\n\n\n\n\n\n#&gt;          Fiat 128         Merc 240D     Maserati Bora Chrysler Imperial \n#&gt;                 4                 5                12                14\n\n\n1.7.8 散点图矩阵\n\nCodecar::scatterplotMatrix(~mpg+disp+drat+wt,data=mtcars)\n\n\n\n\n\n\n\n\n1.7.9 气泡图\n\nCodesymbols(mtcars$wt,mtcars$mpg,\n        circle=sqrt(mtcars$disp/pi),\n        inches = .30, #比例\n        fg=\"white\",bg=\"lightblue\")\ntext(mtcars$wt,mtcars$mpg,row.names(mtcars),cex=.6)\n\n\n\n\n\n\n\n\n1.7.10 折线图\n\nCodehead(Orange)\n#&gt;   Tree  age circumference\n#&gt; 1    1  118            30\n#&gt; 2    1  484            58\n#&gt; 3    1  664            87\n#&gt; 4    1 1004           115\n#&gt; 5    1 1231           120\n#&gt; 6    1 1372           142\nt1&lt;-subset(Orange,Tree==1)\nplot(t1$age,t1$circumference,type=\"p\")\n\n\n\n\n\n\nCodeplot(t1$age,t1$circumference,type=\"b\")\n\n\n\n\n\n\nCodeplot(t1$age,t1$circumference,type=\"c\")\n\n\n\n\n\n\n\n\n1.7.11 相关图\ncorrgram()\n\n1.7.12 马赛克图\nmosaic()",
    "crumbs": [
      "baseR 图形",
      "base graphics"
    ]
  },
  {
    "objectID": "ggplot2_extensions.html",
    "href": "ggplot2_extensions.html",
    "title": "",
    "section": "",
    "text": "CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 extensions"
    ]
  },
  {
    "objectID": "ggplot2_extensions.html#ggpubr",
    "href": "ggplot2_extensions.html#ggpubr",
    "title": "",
    "section": "\n1.1 ggpubr",
    "text": "1.1 ggpubr\nggplot2 with Publication Ready Graphics in R\nhttps://rpkgs.datanovia.com/ggpubr/\nhttps://www.datanovia.com/en/blog/tag/ggpubr/\n\n1.1.1 ggboxplot\n\nCodelibrary(ggpubr)\ndata(\"ToothGrowth\")\ndf &lt;- ToothGrowth\np &lt;- ggboxplot(data = df,\n               x = \"dose\",\n               y = \"len\",\n               color = \"dose\",\n               palette = \"gsea\",\n               \n               add = \"jitter\",\n               shape =\"dose\",\n               bxp.errorbar = TRUE,\n               bxp.errorbar.width = 0.1,\n               )\np\n\n\n\n\n\n\nCodemy_compare &lt;- list(c(\"0.5\",\"1\"),c(\"1\",\"2\"),c(\"0.5\",\"2\"))\np+stat_compare_means(comparisons = my_compare,method = \"t.test\")+\n    stat_compare_means(label.y = 50)  # 总体p值\n\n\n\n\n\n\n\n\n1.1.2 ggviolin\n\nCodeggviolin(data = df,\n               x = \"dose\",\n               y = \"len\",\n               fill = \"dose\",\n               palette = \"gsea\",\n               \n               add = \"boxplot\",\n               add.params = list(fill=\"white\"),\n               )+\n    stat_compare_means(comparisons = my_compare,\n                       label = \"p.signif\",\n                       method = \"t.test\")+\n    stat_compare_means(label.y = 50)  # 总体p值\n\n\n\n\n\n\n\n\n1.1.3 ggbarplot\n\nCodeggbarplot(\n    data = df,\n    x = \"dose\",\n    y = \"len\",\n    fill = \"supp\",\n    color = \"black\",\n\n    palette = \"lancet\",\n    add = c(\"mean_se\"),\n    #  mean_sd, mean_ci\n    \n    error.plot = \"errorbar\",\n    # upper_errorbar,\"lower_errorbar\",pointrange,\"linerange\", \"crossbar\",\n  \n    label = TRUE,\n    lab.pos = \"in\",\n    position = position_dodge(),\n    orientation = \"vertical\",\n    order = c(\"0.5\", \"2\", \"1\"),\n)\n\n\n\n\n\n\n\n\n1.1.4 Grouped bar plots + significance\nhttps://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/\n\nCodeToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)\n# Comparisons against reference\nstat.test &lt;- compare_means(\n  len ~ dose, data = ToothGrowth, group.by = \"supp\",\n  method = \"t.test\", ref.group = \"0.5\"\n)\nstat.test\n#&gt; # A tibble: 4 × 9\n#&gt;   supp  .y.   group1 group2            p      p.adj p.format p.signif method\n#&gt;   &lt;fct&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt; \n#&gt; 1 VC    len   0.5    1      0.000000681  0.000002   6.8e-07  ****     T-test\n#&gt; 2 VC    len   0.5    2      0.0000000468 0.00000019 4.7e-08  ****     T-test\n#&gt; 3 OJ    len   0.5    1      0.0000878    0.000088   8.8e-05  ****     T-test\n#&gt; 4 OJ    len   0.5    2      0.00000132   0.0000026  1.3e-06  ****     T-test\nbp &lt;- ggbarplot(ToothGrowth, x = \"supp\", y = \"len\",\n                fill = \"dose\", palette = \"jco\",\n                add = \"mean_sd\", add.params = list(group = \"dose\"),\n                position = position_dodge(0.8))\nbp\n\n\n\n\n\n\nCodebp + stat_pvalue_manual(\n  stat.test, x = \"supp\", y.position = 33,\n  label = \"p={p.format}\",\n  position = position_dodge(0.8)\n)\n\n\n\n\n\n\n\n\n1.1.4.1 分组并列，组内组间显著性p值\n\nCodelibrary(ggpubr)\nlibrary(rstatix)\ndf &lt;- ToothGrowth\ndf$dose &lt;- as.factor(df$dose)\n\n\n\nbp &lt;- ggbarplot(\n    df,\n    x = \"dose\",\n    y = \"len\",\n    add = \"mean_sd\",\n    color = \"supp\",\n    palette = c(\"#00AFBB\", \"#E7B800\"),\n    position = position_dodge(0.8)\n)\n\n\n# 统计检验\nstat.test &lt;- df %&gt;%\n    group_by(dose) %&gt;%\n    t_test(len ~ supp) %&gt;%\n    adjust_pvalue(method = \"bonferroni\") %&gt;%\n    add_significance(\"p.adj\")\nstat.test &lt;- stat.test %&gt;%\n    add_xy_position(fun = \"mean_sd\", x = \"dose\", dodge = 0.8)\n\n\nstat.test2 &lt;- df %&gt;%\n    t_test(len ~ dose, p.adjust.method = \"bonferroni\")\nstat.test2 &lt;- stat.test2 %&gt;%\n    add_xy_position(x = \"dose\")\n\npwc &lt;- df %&gt;%\n    group_by(supp) %&gt;%\n    t_test(len ~ dose, p.adjust.method = \"bonferroni\")\npwc\n#&gt; # A tibble: 6 × 11\n#&gt;   supp  .y.   group1 group2    n1    n2 statistic    df            p      p.adj\n#&gt; * &lt;fct&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;\n#&gt; 1 OJ    len   0.5    1         10    10     -5.05  17.7 0.0000878    0.000263  \n#&gt; 2 OJ    len   0.5    2         10    10     -7.82  14.7 0.00000132   0.00000396\n#&gt; 3 OJ    len   1      2         10    10     -2.25  15.8 0.039        0.118     \n#&gt; 4 VC    len   0.5    1         10    10     -7.46  17.9 0.000000681  0.00000204\n#&gt; 5 VC    len   0.5    2         10    10    -10.4   14.3 0.0000000468 0.00000014\n#&gt; 6 VC    len   1      2         10    10     -5.47  13.6 0.0000916    0.000275  \n#&gt; # ℹ 1 more variable: p.adj.signif &lt;chr&gt;\npwc &lt;- pwc %&gt;%\n    add_xy_position(\n        x = \"dose\",\n        fun = \"mean_sd\",\n        group = \"supp\",\n        dodge = 0.8\n    )\n\n# 组间组内复合\n\n\nbp +\n    stat_pvalue_manual(stat.test,  label = \"p.adj.signif\", tip.length = 0.01) +\n    stat_pvalue_manual(\n        stat.test2,\n        label = \"p\",\n        tip.length = 0.02,\n        step.increase = 0.05\n    ) +\n    scale_y_continuous(expand = expansion(mult = c(0.05, 0.1))) +\n    stat_pvalue_manual(\n        pwc,\n        color = \"supp\",\n        step.group.by = \"supp\",\n        tip.length = 0,\n        step.increase = 0.1\n    )\n\n\n\n\n\n\n\n\n1.1.5 ggdotchart Cleveland’s Dot Plots\n\nCode# 滑珠图\nmtcars |&gt; rownames_to_column(var = \"name\") |&gt;\n    mutate(\n        cyl=factor(cyl)\n    ) |&gt; \n    ggdotchart(\n        x = \"name\",\n        y = \"mpg\",\n        color = \"cyl\",\n        palette = \"jco\",\n\n        sorting = \"ascending\",\n        add = \"segments\",\n        ggtheme = theme_pubr()\n    ) |\n#克利夫兰点图\nmtcars |&gt; rownames_to_column(var = \"name\") |&gt;\n    mutate(\n        cyl=factor(cyl)\n    ) |&gt; \n    ggdotchart(\n        x = \"name\",\n        y = \"mpg\",\n        color = \"cyl\",\n        palette = \"jco\",\n\n        sorting = \"descending\",\n        add = \"segments\",\n        \n        rotate = TRUE,\n        group = \"cyl\",\n        dot.size = 6,\n        label = round(mtcars$mpg),\n        font.label = list(color=\"white\",size=9,vjust=0.5),\n        ggtheme = theme_pubr()\n    )\n\n\n\n\n\n\n\n\n1.1.6 ggdotplot",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 extensions"
    ]
  },
  {
    "objectID": "ggplot2_extensions.html#ggrepel",
    "href": "ggplot2_extensions.html#ggrepel",
    "title": "",
    "section": "\n1.2 ggrepel",
    "text": "1.2 ggrepel\n\nCodelibrary(ggrepel)\nggplot(data = mtcars, aes(x= wt, y = mpg)) +\n  geom_point(color = \"steelblue\") +\n  geom_hline(yintercept = median(mtcars$mpg),                     \n             linetype = \"dashed\",\n             color = \"steelblue\") +\n  geom_label(x = 5.2, y = 20.5,                                      \n             label = \"median MPG\", \n             color = \"white\", \n             fill = \"steelblue\",\n             size = 3) +\n  geom_text_repel(label = row.names(mtcars), size = 3)\n\n\n\n\n\n\nCode\n# geom_label_repel 带白底外框",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 extensions"
    ]
  },
  {
    "objectID": "ggplot2_extensions.html#山脊图",
    "href": "ggplot2_extensions.html#山脊图",
    "title": "",
    "section": "\n1.3 山脊图",
    "text": "1.3 山脊图\n\nCodelibrary(ggridges)\nggplot(mpg, aes(x = hwy, y = drv, fill = drv, color = drv)) +\n  geom_density_ridges(alpha = 0.5, show.legend = FALSE)",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 extensions"
    ]
  },
  {
    "objectID": "ggplot2_extensions.html#交互式-plotly",
    "href": "ggplot2_extensions.html#交互式-plotly",
    "title": "",
    "section": "\n1.4 交互式 plotly",
    "text": "1.4 交互式 plotly\nhttps://github.com/plotly/plotly.R\nhttps://plotly-r.com/\nhttps://plotly.com/ggplot2/\nConverting a ggplot2 graph to an interactive plotly graph\n\nCodelibrary(plotly)\nmtcars$cyl &lt;- factor(mtcars$cyl)\nmtcars$name &lt;- row.names(mtcars)\n\np &lt;- ggplot(mtcars, aes(x = disp, y= mpg, color = cyl)) +\n  geom_point()\nggplotly(p)\n\n\n\nCode# Customizing the plotly tooltip\np &lt;- ggplot(mtcars,\n            aes(x = disp, y=mpg, color=cyl,\n                text = paste(name, \"\\n\",\n                             \"mpg:\", mpg, \"\\n\",\n                             \"disp:\", disp, \"\\n\",\n                             \"cyl:\", cyl, \"\\n\",\n                             \"gear:\", gear))) +\n  geom_point()",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 extensions"
    ]
  },
  {
    "objectID": "ggplot2_extensions.html#边际图-marginal-histogram-boxplot",
    "href": "ggplot2_extensions.html#边际图-marginal-histogram-boxplot",
    "title": "",
    "section": "\n1.5 边际图 Marginal Histogram / Boxplot",
    "text": "1.5 边际图 Marginal Histogram / Boxplot\n\nCodelibrary(ggExtra)",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 extensions"
    ]
  },
  {
    "objectID": "ggplot2_extensions.html#森林图",
    "href": "ggplot2_extensions.html#森林图",
    "title": "",
    "section": "\n1.6 森林图",
    "text": "1.6 森林图",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 extensions"
    ]
  },
  {
    "objectID": "ggprism.html",
    "href": "ggprism.html",
    "title": "",
    "section": "",
    "text": "条形图GraphPad Prism 风格 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "条形图",
      "GraphPad Prism 风格"
    ]
  },
  {
    "objectID": "ggprism.html#ggprism",
    "href": "ggprism.html#ggprism",
    "title": "",
    "section": "\n1.1 ggprism\n",
    "text": "1.1 ggprism\n\n\nCodelibrary(tidyverse)\nlibrary(ggprism)\ndf_p_val &lt;- rstatix::t_test(ToothGrowth, len ~ dose, ref.group = \"0.5\") %&gt;% \n  rstatix::add_xy_position()\n\np &lt;- ggplot(ToothGrowth, aes(x = factor(dose), y = len)) + \n  stat_summary(geom = \"col\", fun = mean) + \n  stat_summary(geom = \"errorbar\", \n               fun = mean,\n               fun.min = function(x) mean(x) - sd(x),\n               fun.max = function(x) mean(x) + sd(x),\n               width = 0.3) + \n  theme_prism() + \n  coord_cartesian(ylim = c(0, 40)) + \n  scale_y_continuous(breaks = seq(0, 40, 5), expand = c(0, 0))\n# with brackets\np1 &lt;- p + add_pvalue(df_p_val, label = \"p.adj.signif\",label.size = 8)\n# without brackets\np2 &lt;- p + add_pvalue(df_p_val, label = \"p.adj.signif\", remove.bracket = TRUE,label.size = 8)\np1 + p2",
    "crumbs": [
      "ggplot2 图形",
      "条形图",
      "GraphPad Prism 风格"
    ]
  },
  {
    "objectID": "gtsummary.html",
    "href": "gtsummary.html",
    "title": "",
    "section": "",
    "text": "CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "表格",
      "gtsummary"
    ]
  },
  {
    "objectID": "gtsummary.html#section",
    "href": "gtsummary.html#section",
    "title": "",
    "section": "\n1.1 ",
    "text": "1.1",
    "crumbs": [
      "表格",
      "gtsummary"
    ]
  },
  {
    "objectID": "gtsummary.html#回归模型结果",
    "href": "gtsummary.html#回归模型结果",
    "title": "",
    "section": "\n1.2 回归模型结果",
    "text": "1.2 回归模型结果\n\nCode# load dataset\ndata(Titanic)\ndf = as.data.frame(Titanic)\n\n# load library\nlibrary(gtsummary)\n\n# create the model\nmodel = glm(Survived ~ Age + Class + Sex + Freq, family=binomial, data=df)\n\n# generate table \nmodel %&gt;%\n  tbl_regression() %&gt;% # regression summary function\n  add_global_p() %&gt;% # add p-values\n  bold_labels() %&gt;% # make label in bold\n  italicize_levels() # make categories in label in italic\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\nlog(OR)\n1\n\n\n95% CI\n1\n\np-value\n\n\n\nAge\n\n\n0.5\n\n\n    Child\n—\n—\n\n\n\n    Adult\n0.62\n-1.0, 2.4\n\n\n\nClass\n\n\n&gt;0.9\n\n\n    1st\n—\n—\n\n\n\n    2nd\n-0.03\n-2.0, 2.0\n\n\n\n    3rd\n0.25\n-1.8, 2.4\n\n\n\n    Crew\n0.27\n-1.8, 2.4\n\n\n\nSex\n\n\n0.6\n\n\n    Male\n—\n—\n\n\n\n    Female\n-0.37\n-1.9, 1.1\n\n\n\nFreq\n-0.01\n-0.02, 0.00\n0.2\n\n\n\n\n1\nOR = Odds Ratio, CI = Confidence Interval\n\n\n\n\n\nCode\n\n\n# generate table \nmodel %&gt;%\n  tbl_regression(intercept=TRUE, conf.level=0.9) %&gt;%\n  add_glance_source_note() %&gt;%\n  add_global_p() %&gt;%\n  add_q() \n#&gt; add_q: Adjusting p-values with\n#&gt; `stats::p.adjust(x$table_body$p.value, method = \"fdr\")`\n\n\n\n\n\n\nCharacteristic\n\n      \n\nlog(OR)\n\n1\n\n      \n\n90% CI\n\n1\n\n      \np-value\n\n      \n\nq-value\n\n2\n\n    \n\n\n(Intercept)\n0.10\n-1.4, 1.6\n&gt;0.9\n&gt;0.9\n\n\nAge\n\n\n0.5\n&gt;0.9\n\n\n    Child\n—\n—\n\n\n\n\n    Adult\n0.62\n-0.78, 2.1\n\n\n\n\nClass\n\n\n&gt;0.9\n&gt;0.9\n\n\n    1st\n—\n—\n\n\n\n\n    2nd\n-0.03\n-1.7, 1.7\n\n\n\n\n    3rd\n0.25\n-1.5, 2.0\n\n\n\n\n    Crew\n0.27\n-1.5, 2.0\n\n\n\n\nSex\n\n\n0.6\n&gt;0.9\n\n\n    Male\n—\n—\n\n\n\n\n    Female\n-0.37\n-1.7, 0.89\n\n\n\n\nFreq\n-0.01\n-0.02, 0.00\n0.2\n0.9\n\n\n\n\nNull deviance = 44.4; Null df = 31.0; Log-likelihood = -21.3; AIC = 56.5; BIC = 66.8; Deviance = 42.5; Residual df = 25; No. Obs. = 32\n\n    \n\n\n\n1 \nOR = Odds Ratio, CI = Confidence Interval\n\n\n    \n\n\n2 \nFalse discovery rate correction for multiple testing",
    "crumbs": [
      "表格",
      "gtsummary"
    ]
  },
  {
    "objectID": "gtsummary.html#比较模型结果",
    "href": "gtsummary.html#比较模型结果",
    "title": "",
    "section": "\n1.3 比较模型结果",
    "text": "1.3 比较模型结果\n\nCodedata(trial)\nlibrary(survival)\n\nmodel_reglog = glm(response ~ trt + grade, data=trial, family = binomial) %&gt;% tbl_regression()\nmodel_cox = coxph(Surv(ttdeath, death) ~ trt + grade, data=trial) %&gt;% tbl_regression()\n\ntbl_merge(\n  list(model_reglog, model_cox),\n  tab_spanner = c(\"**Tumor Response**\", \"**Time to Death**\")\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n\n\nTumor Response\n\n\n\nTime to Death\n\n\n\n\nlog(OR)\n1\n\n\n95% CI\n1\n\np-value\n\nlog(HR)\n1\n\n\n95% CI\n1\n\np-value\n\n\n\n\nChemotherapy Treatment\n\n\n\n\n\n\n\n\n    Drug A\n—\n—\n\n—\n—\n\n\n\n    Drug B\n0.19\n-0.41, 0.81\n0.5\n0.22\n-0.15, 0.59\n0.2\n\n\nGrade\n\n\n\n\n\n\n\n\n    I\n—\n—\n\n—\n—\n\n\n\n    II\n-0.06\n-0.82, 0.68\n0.9\n0.25\n-0.22, 0.72\n0.3\n\n\n    III\n0.08\n-0.66, 0.82\n0.8\n0.52\n0.07, 0.98\n0.024\n\n\n\n\n1\nOR = Odds Ratio, CI = Confidence Interval, HR = Hazard Ratio",
    "crumbs": [
      "表格",
      "gtsummary"
    ]
  },
  {
    "objectID": "patchwork.html",
    "href": "patchwork.html",
    "title": "",
    "section": "",
    "text": "CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "图形布局"
    ]
  },
  {
    "objectID": "patchwork.html#布局方式",
    "href": "patchwork.html#布局方式",
    "title": "",
    "section": "\n1.1 布局方式",
    "text": "1.1 布局方式\n\nCodep1 &lt;- ggplot(mpg, aes(x = drv, y = cty, color = drv)) + \n    geom_boxplot(show.legend = FALSE) + \n    labs(title = \"Plot 1\")\n\np2 &lt;- ggplot(mpg, aes(x = drv, y = hwy, color = drv)) + \n    geom_boxplot(show.legend = FALSE) + \n    labs(title = \"Plot 2\")\n\np3 &lt;- ggplot(mpg, aes(x = cty, color = drv, fill = drv)) + \n    geom_density(alpha = 0.5) + \n    labs(title = \"Plot 3\")\n\np4 &lt;- ggplot(mpg, aes(x = hwy, color = drv, fill = drv)) + \n    geom_density(alpha = 0.5) + \n    labs(title = \"Plot 4\")\n\np5 &lt;- ggplot(mpg, aes(x = cty, y = hwy, color = drv)) + \n    geom_point(show.legend = FALSE) + \n    facet_wrap(~drv) +\n    labs(title = \"Plot 5\")\n\n\n\nCodep1 + p2\n\n\n\n\n\n\nCodep1 | p2\n\n\n\n\n\n\nCode\np1 / p2\n\n\n\n\n\n\n\n\nCodep1 + p2 / p3 + p4\n\n\n\n\n\n\n\n\nCodep1 + p2 + p3 + plot_layout(ncol = 2)\n\n\n\n\n\n\n\n\nCodep1 | (p2 / (p3 | p4))\n\n\n\n\n\n\n\n\nCodelayout &lt;- \"\nAAB\nC#B\nCDD\n\"\np1 + p2 + p3 + p4 + plot_layout(design = layout)\n\n\n\n\n\n\n\n\nCodep1 + p2 + p3 + plot_layout(ncol = 2, guides = \"collect\")",
    "crumbs": [
      "ggplot2 图形",
      "图形布局"
    ]
  },
  {
    "objectID": "patchwork.html#修改子图",
    "href": "patchwork.html#修改子图",
    "title": "",
    "section": "\n1.2 修改子图",
    "text": "1.2 修改子图\n\nCodep12 &lt;- p1 + p2\np12[[2]] &lt;- p12[[2]] + theme_light()\np12\n\n\n\n\n\n\nCodep1 + p4 & theme_minimal()\n\n\n\n\n\n\nCodep1 + p4 & scale_y_continuous(limits = c(NA, 45))",
    "crumbs": [
      "ggplot2 图形",
      "图形布局"
    ]
  },
  {
    "objectID": "patchwork.html#添加注释",
    "href": "patchwork.html#添加注释",
    "title": "",
    "section": "\n1.3 添加注释",
    "text": "1.3 添加注释\n\nCode(p1 | p2) / p3 +                                      \n    plot_annotation(title = '主标题',caption = \"脚注\",\n                    theme = theme_gray(base_family = \"mono\")) &theme_minimal()+\n    theme(axis.title = element_text(size=8),\n          axis.text = element_text(size=8)\n    )\n\n\n\n\n\n\nCode\n(guide_area() / (p1 + p2) / (p3 + p4) / p5) +\n    plot_annotation(\n        title = \"City and highway mileage for cars with different drive trains\",\n        caption = \"Source: https://fueleconomy.gov.\"\n    ) +\n    plot_layout(\n        guides = \"collect\",\n        heights = c(1, 3, 2, 4)\n    ) &\n    theme(legend.position = \"top\",\n          plot.title = element_text(hjust = 0.5))",
    "crumbs": [
      "ggplot2 图形",
      "图形布局"
    ]
  },
  {
    "objectID": "patchwork.html#图形编号",
    "href": "patchwork.html#图形编号",
    "title": "",
    "section": "\n1.4 图形编号",
    "text": "1.4 图形编号\n\nCodep123 &lt;- p1 | (p2 / p3)\np123 + plot_annotation(tag_levels = \"I\") # Uppercase roman numerics i\n\n\n\n\n\n\nCode\n\np123 + plot_annotation(tag_levels = \"a\") # lowercase letters A\n\n\n\n\n\n\nCodep123 + plot_annotation(tag_levels = \"1\") #  numbers\n\n\n\n\n\n\nCode\np123[[2]] \n\n\n\n\n\n\nCodep123[[2]] &lt;- p123[[2]] + plot_layout(tag_level = \"new\")\np123 + plot_annotation(tag_levels = c(\"I\",\"a\"))",
    "crumbs": [
      "ggplot2 图形",
      "图形布局"
    ]
  },
  {
    "objectID": "patchwork.html#图形插入",
    "href": "patchwork.html#图形插入",
    "title": "",
    "section": "\n1.5 图形插入",
    "text": "1.5 图形插入\n\nCodep1 + inset_element(p2, left = 0.6, bottom = 0.6, right = 1, top = 1)\n\n\n\n\n\n\nCodep24 &lt;- p2 / p4 + plot_layout(guides = \"collect\")\np1 + inset_element(p24, left = 0.5, bottom = 0.05, right = 0.95, top = 0.9)\n\n\n\n\n\n\nCodep12 &lt;- p1 + inset_element(p2, left = 0.5, bottom = 0.5, right = 0.9, top = 0.95)\np12 & theme_bw()\n\n\n\n\n\n\nCodep12 + plot_annotation(tag_levels = \"A\")",
    "crumbs": [
      "ggplot2 图形",
      "图形布局"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "参考文献",
    "section": "",
    "text": "https://www.nature.com/articles/s41467-023-43462-1\n\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "Table.html",
    "href": "Table.html",
    "title": "",
    "section": "",
    "text": "Code\n\n\n\n\n\n表格\n\ngt\nhttps://r-graph-gallery.com/package/gt.html\nhttps://r-graph-gallery.com/package/gtextras.html\ngtsummary\nhttps://r-graph-gallery.com/package/gtsummary.html\n\n\n\n\n\n\n\n Back to top",
    "crumbs": [
      "表格"
    ]
  },
  {
    "objectID": "列线图.html",
    "href": "列线图.html",
    "title": "",
    "section": "",
    "text": "CodeShow All CodeHide All CodeView Source"
  },
  {
    "objectID": "列线图.html#cox模型列线图",
    "href": "列线图.html#cox模型列线图",
    "title": "",
    "section": "\n1.1 Cox模型列线图",
    "text": "1.1 Cox模型列线图\n\nCode\nlibrary(survival)\nlibrary(rms)\n#&gt; Loading required package: Hmisc\n#&gt; \n#&gt; Attaching package: 'Hmisc'\n#&gt; The following objects are masked from 'package:dplyr':\n#&gt; \n#&gt;     src, summarize\n#&gt; The following objects are masked from 'package:base':\n#&gt; \n#&gt;     format.pval, units\n\n# 创建一个示例数据框\nset.seed(123)  # 为了结果可重复\nn &lt;- 100  # 样本大小\ndata &lt;- data.frame(\n    time = rexp(n, 0.1),  # 生存时间\n    status = sample(0:1, n, replace = TRUE),  # 生存状态（0=删失，1=事件）\n    age = sample(40:80, n, replace = TRUE),  # 年龄\n    sex = sample(c(\"male\", \"female\"), n, replace = TRUE)  # 性别\n)\n\n# 拟合Cox模型\ncox_model &lt;- coxph(Surv(time, status) ~ age + sex, data = data)\n\n# 创建一个rms包的数据对象\ndd &lt;- datadist(data)\noptions(datadist = \"dd\")\n\n# 拟合Cox模型（rms包）\ncox_model_rms &lt;- cph(Surv(time, status) ~ age + sex, data = data)\n\n# 绘制列线图\nnom &lt;- nomogram(cox_model_rms, fun=list(function(x) x), lp=FALSE)\nplot(nom)\n\n\n\n\n\n\n\n识别变量： 确定图中所有预测变量及其对应的分数刻度。每个预测变量的线段应有不同的刻度，表示不同的数值区间。\n获取分数： 对于每个预测变量，找到对应值的分数。例如，如果年龄为50岁，查看“年龄”线段上50岁的位置，对应的分数可能是30分。\n计算总分： 将所有预测变量的分数加起来。例如，如果年龄得30分，性别得20分，BMI得15分，则总分为65分。\n读取预测结果： 查找总分对应的结果预测区域。例如，如果总分为65分，则在结果预测区域中找到对应的概率或预期结果。如果总分65对应的概率是70%，这意味着根据模型预测，事件发生的概率是70%。"
  },
  {
    "objectID": "列线图.html#逻辑回归列线图",
    "href": "列线图.html#逻辑回归列线图",
    "title": "",
    "section": "\n1.2 逻辑回归列线图",
    "text": "1.2 逻辑回归列线图\n\nCode# 创建示例数据\nset.seed(123)  # 为了结果可重复\nn &lt;- 200  # 样本大小\ndata &lt;- data.frame(\n  outcome = sample(c(0, 1), n, replace = TRUE),  # 结果变量（0=失败，1=成功）\n  age = sample(20:70, n, replace = TRUE),  # 年龄\n  gender = sample(c(\"male\", \"female\"), n, replace = TRUE),  # 性别\n  bmi = rnorm(n, 25, 5)  # 体重指数\n)\n\n# 转换分类变量为因子\ndata$gender &lt;- as.factor(data$gender)\n\n# 创建数据分布对象\ndd &lt;- datadist(data)\noptions(datadist = \"dd\")\n\n# 拟合多元逻辑回归模型\nlogit_model &lt;- lrm(outcome ~ age + gender + bmi, data = data)\n\n# 创建列线图\nnom &lt;- nomogram(logit_model, fun=list(function(x) x), lp=FALSE)\nplot(nom)"
  },
  {
    "objectID": "列线图.html#风险评分模型",
    "href": "列线图.html#风险评分模型",
    "title": "",
    "section": "\n1.3 风险评分模型",
    "text": "1.3 风险评分模型\n\nCodelibrary(rms)\nlibrary(Hmisc)\n\n# 示例数据\nset.seed(123)\nn &lt;- 200\ndata &lt;- data.frame(\n  outcome = sample(c(0, 1), n, replace = TRUE),\n  age = rnorm(n, 50, 10),\n  gender = factor(sample(c(\"male\", \"female\"), n, replace = TRUE)),\n  bmi = rnorm(n, 25, 5)\n)\n\n# 创建数据分布对象\ndd &lt;- datadist(data)\noptions(datadist = \"dd\")\n\n# 拟合逻辑回归模型\nlogit_model &lt;- lrm(outcome ~ age + gender + bmi, data = data)\n\n# 计算风险评分\ndata$score &lt;- predict(logit_model, type = \"lp\")\n# 创建列线图\nnom &lt;- nomogram(logit_model, fun=list(function(x) x), lp=FALSE)\nplot(nom)\n\n\n\n\n\n\nCode\n# 显示模型系数\nsummary(logit_model)\n#&gt;              Effects              Response : outcome \n#&gt; \n#&gt;  Factor               Low    High   Diff.   Effect    S.E.    Lower 0.95\n#&gt;  age                  43.814 56.105 12.2900 -0.196870 0.18429 -0.55807  \n#&gt;   Odds Ratio          43.814 56.105 12.2900  0.821290      NA  0.57231  \n#&gt;  bmi                  22.212 28.405  6.1925  0.212520 0.18552 -0.15110  \n#&gt;   Odds Ratio          22.212 28.405  6.1925  1.236800      NA  0.85976  \n#&gt;  gender - male:female  1.000  2.000      NA  0.032107 0.28540 -0.52728  \n#&gt;   Odds Ratio           1.000  2.000      NA  1.032600      NA  0.59021  \n#&gt;  Upper 0.95\n#&gt;  0.16432   \n#&gt;  1.17860   \n#&gt;  0.57613   \n#&gt;  1.77910   \n#&gt;  0.59149   \n#&gt;  1.80670"
  },
  {
    "objectID": "双向条图.html",
    "href": "双向条图.html",
    "title": "",
    "section": "",
    "text": "条形图双向条图 CodeShow All CodeHide All CodeView Source\n1 双向条图\n\nCodeset.seed(10)\ndf &lt;- tibble(\n    id=paste0(\"Pathway\",rep(1:10,2)),\n    group = rep(c(\"Up\",\"Down\"),each=10),\n    y=round(rnorm(20,50,10)),\n)\n\n\n\nCodeggplot(df,\n       aes(x=factor(id,levels = unique(id)),\n           y=if_else(group==\"Up\",y,-y),\n           fill=group))+\n    geom_bar(stat = \"identity\")+\n    coord_flip()+\n    \n    geom_text(aes(label=y,hjust=if_else(group==\"Up\",-0.5,1),\n                  #vjust=if_else(group==\"Up\",-0.5,0.5)\n                  )\n              )+\n    scale_x_discrete(name = \"\")+\n    scale_y_continuous(name = \"expenssion\",expand = expansion(mult = c(0.1,0.1)))\n\n\n\n\n\n\n\n\n\n\n\n Back to top",
    "crumbs": [
      "ggplot2 图形",
      "条形图",
      "双向条图"
    ]
  },
  {
    "objectID": "折线图.html",
    "href": "折线图.html",
    "title": "",
    "section": "",
    "text": "曲线图折线图 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "曲线图",
      "折线图"
    ]
  },
  {
    "objectID": "折线图.html#折线图",
    "href": "折线图.html#折线图",
    "title": "",
    "section": "\n1 折线图",
    "text": "1 折线图\n\nCodelibrary(tidyverse)\nlibrary(readxl)\nlibrary(ggpubr)\nlibrary(rstatix)\n\n\n\nCodef4h &lt;-read_excel(\"data/01source.xlsx\", sheet = \"Fig.4\", range = \"A20:P23\")\n#&gt; New names:\n#&gt; • `` -&gt; `...3`\n#&gt; • `` -&gt; `...4`\n#&gt; • `` -&gt; `...5`\n#&gt; • `` -&gt; `...6`\n#&gt; • `` -&gt; `...8`\n#&gt; • `` -&gt; `...9`\n#&gt; • `` -&gt; `...10`\n#&gt; • `` -&gt; `...11`\n#&gt; • `` -&gt; `...13`\n#&gt; • `` -&gt; `...14`\n#&gt; • `` -&gt; `...15`\n#&gt; • `` -&gt; `...16`\ncolnames(f4h) &lt;-\n    c(\"Days\", rep(\n        c(\"PBS\", \"SLAMF6+ PD-1+ CD8+ cells\", \"SLAMF6- PD-1+ CD8+ cells\"),\n        each = 5\n    ))\n\nf4h |&gt; pivot_longer(cols = -1,\n                    names_to = \"method\",\n                    values_to = \"volume\",) |&gt;\n    dplyr::mutate(id=factor(rep(1:15,3)),\n                  Days = factor(Days, levels = c(\"-1\", \"7\", \"14\")),\n                  method = factor(\n                      method,\n                      levels = c(\"PBS\", \"SLAMF6+ PD-1+ CD8+ cells\",\n                                 \"SLAMF6- PD-1+ CD8+ cells\")\n                  )) -&gt; f4h\nf4h\n#&gt; # A tibble: 45 × 4\n#&gt;    Days  method                   volume id   \n#&gt;    &lt;fct&gt; &lt;fct&gt;                     &lt;dbl&gt; &lt;fct&gt;\n#&gt;  1 -1    PBS                        19.2 1    \n#&gt;  2 -1    PBS                        27.0 2    \n#&gt;  3 -1    PBS                        23.4 3    \n#&gt;  4 -1    PBS                        27.9 4    \n#&gt;  5 -1    PBS                        29.7 5    \n#&gt;  6 -1    SLAMF6+ PD-1+ CD8+ cells   31.9 6    \n#&gt;  7 -1    SLAMF6+ PD-1+ CD8+ cells   34.5 7    \n#&gt;  8 -1    SLAMF6+ PD-1+ CD8+ cells   44.4 8    \n#&gt;  9 -1    SLAMF6+ PD-1+ CD8+ cells   29.1 9    \n#&gt; 10 -1    SLAMF6+ PD-1+ CD8+ cells   41.4 10   \n#&gt; # ℹ 35 more rows\n\n\n统计p值\n\nCode# 重复测量方差设计\nlibrary(nlme)\nmodel &lt;- lme(volume ~ method*Days, random = ~1|id/Days, data = f4h)\nsummary(model)\n#&gt; Linear mixed-effects model fit by REML\n#&gt;   Data: f4h \n#&gt;        AIC      BIC    logLik\n#&gt;   305.8048 324.8071 -140.9024\n#&gt; \n#&gt; Random effects:\n#&gt;  Formula: ~1 | id\n#&gt;         (Intercept)\n#&gt; StdDev:    6.775335\n#&gt; \n#&gt;  Formula: ~1 | Days %in% id\n#&gt;         (Intercept) Residual\n#&gt; StdDev:    6.775335 2.540755\n#&gt; \n#&gt; Fixed effects:  volume ~ method * Days \n#&gt;                                           Value Std.Error DF   t-value p-value\n#&gt; (Intercept)                            25.43718  4.433188 36  5.737899  0.0000\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells         10.81993  6.269474 36  1.725812  0.0930\n#&gt; methodSLAMF6- PD-1+ CD8+ cells          4.63341  6.269474 36  0.739043  0.4647\n#&gt; Days7                                   9.55505  6.269474 36  1.524059  0.1362\n#&gt; Days14                                 22.41864  6.269474 36  3.575841  0.0010\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7  -37.58056  8.866375 36 -4.238549  0.0001\n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7   -8.90525  8.866375 36 -1.004384  0.3219\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14 -55.79891  8.866375 36 -6.293316  0.0000\n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14 -14.68420  8.866375 36 -1.656167  0.1064\n#&gt;  Correlation: \n#&gt;                                       (Intr) mtSLAMF6+PD-1+CD8+c\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells        -0.707                    \n#&gt; methodSLAMF6- PD-1+ CD8+ cells        -0.707  0.500             \n#&gt; Days7                                 -0.707  0.500             \n#&gt; Days14                                -0.707  0.500             \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7   0.500 -0.707             \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7   0.500 -0.354             \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14  0.500 -0.707             \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14  0.500 -0.354             \n#&gt;                                       mtSLAMF6-PD-1+CD8+c Days7  Days14\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells                                         \n#&gt; methodSLAMF6- PD-1+ CD8+ cells                                         \n#&gt; Days7                                  0.500                           \n#&gt; Days14                                 0.500               0.500       \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7  -0.354              -0.707 -0.354\n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7  -0.707              -0.707 -0.354\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14 -0.354              -0.354 -0.707\n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14 -0.707              -0.354 -0.707\n#&gt;                                       mSLAMF6+PD-1+CD8+c:D7\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells                             \n#&gt; methodSLAMF6- PD-1+ CD8+ cells                             \n#&gt; Days7                                                      \n#&gt; Days14                                                     \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7                       \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7   0.500               \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14  0.500               \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14  0.250               \n#&gt;                                       mSLAMF6-PD-1+CD8+c:D7\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells                             \n#&gt; methodSLAMF6- PD-1+ CD8+ cells                             \n#&gt; Days7                                                      \n#&gt; Days14                                                     \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7                       \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7                       \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14  0.250               \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14  0.500               \n#&gt;                                       mSLAMF6+PD-1+CD8+c:D1\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells                             \n#&gt; methodSLAMF6- PD-1+ CD8+ cells                             \n#&gt; Days7                                                      \n#&gt; Days14                                                     \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7                       \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7                       \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14                      \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14  0.500               \n#&gt; \n#&gt; Standardized Within-Group Residuals:\n#&gt;         Min          Q1         Med          Q3         Max \n#&gt; -0.54102103 -0.09310952 -0.02293325  0.11100673  0.62463379 \n#&gt; \n#&gt; Number of Observations: 45\n#&gt; Number of Groups: \n#&gt;           id Days %in% id \n#&gt;           45           45\ndf_aov &lt;- anova(model)\ndf_aov\n#&gt;             numDF denDF  F-value p-value\n#&gt; (Intercept)     1    36 365.4570  &lt;.0001\n#&gt; method          2    36  18.1753  &lt;.0001\n#&gt; Days            2    36   1.5292  0.2305\n#&gt; method:Days     4    36  11.1001  &lt;.0001\n\n#成对比较\nlibrary(emmeans)\n#&gt; Welcome to emmeans.\n#&gt; Caution: You lose important information if you filter this package's results.\n#&gt; See '? untidy'\nmethod_means &lt;- emmeans(model, ~method)  \n#&gt; NOTE: Results may be misleading due to involvement in interactions\nprint(method_means)  \n#&gt;  method                   emmean   SE df lower.CL upper.CL\n#&gt;  PBS                        36.1 2.56 36     30.9     41.3\n#&gt;  SLAMF6+ PD-1+ CD8+ cells   15.8 2.56 36     10.6     21.0\n#&gt;  SLAMF6- PD-1+ CD8+ cells   32.9 2.56 36     27.7     38.1\n#&gt; \n#&gt; Results are averaged over the levels of: Days \n#&gt; Degrees-of-freedom method: containment \n#&gt; Confidence level used: 0.95\nmethod_comparisons &lt;- pairs(method_means)  \nmethod_comparisons\n#&gt;  contrast                                                estimate   SE df\n#&gt;  PBS - (SLAMF6+ PD-1+ CD8+ cells)                           20.31 3.62 36\n#&gt;  PBS - (SLAMF6- PD-1+ CD8+ cells)                            3.23 3.62 36\n#&gt;  (SLAMF6+ PD-1+ CD8+ cells) - (SLAMF6- PD-1+ CD8+ cells)   -17.08 3.62 36\n#&gt;  t.ratio p.value\n#&gt;    5.610  &lt;.0001\n#&gt;    0.892  0.6486\n#&gt;   -4.718  0.0001\n#&gt; \n#&gt; Results are averaged over the levels of: Days \n#&gt; Degrees-of-freedom method: containment \n#&gt; P value adjustment: tukey method for comparing a family of 3 estimates",
    "crumbs": [
      "ggplot2 图形",
      "曲线图",
      "折线图"
    ]
  },
  {
    "objectID": "折线图.html#ggplot2",
    "href": "折线图.html#ggplot2",
    "title": "",
    "section": "\n2 ggplot2",
    "text": "2 ggplot2\n\nCodepvalue &lt;- method_comparisons |&gt; broom::tidy() |&gt; \n    dplyr::select(contrast, adj.p.value) |&gt; \n    dplyr::mutate(padj=round(adj.p.value,digits = 4),\n                  p_adj_sci=format(adj.p.value,scientific = T,digits = 4))\n\npvalue\n#&gt; # A tibble: 3 × 4\n#&gt;   contrast                                          adj.p.value   padj p_adj_sci\n#&gt;   &lt;chr&gt;                                                   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    \n#&gt; 1 PBS - (SLAMF6+ PD-1+ CD8+ cells)                   0.00000680 0      6.796e-06\n#&gt; 2 PBS - (SLAMF6- PD-1+ CD8+ cells)                   0.649      0.649  6.486e-01\n#&gt; 3 (SLAMF6+ PD-1+ CD8+ cells) - (SLAMF6- PD-1+ CD8+…  0.000103   0.0001 1.032e-04\n\np &lt;- f4h |&gt; summarise(\n    mean_volume = mean(volume),\n    sd = sd(volume),\n    .by = c(Days, method),) |&gt;\n    ggplot(aes(\n        x = Days,\n        y = mean_volume,\n        color = method,\n        group = method,)) +\n    geom_errorbar(\n        aes(ymin = mean_volume - sd, ymax = mean_volume + sd),\n        position = position_dodge(0),\n        width = .2,\n        linewidth = 0.5,\n    ) +\n    geom_line(position = position_dodge(0),\n              linewidth = 0.8) +\n    geom_point(\n        aes(shape = method),\n        position = position_dodge(0),\n        color = \"black\",\n        size = 2) +\n    theme_pubr() +\n    theme(legend.title = element_blank())\n\n# 使用ggplot_build()获取图层数据\nplot_data &lt;- ggplot_build(p)\n\n# 查看X轴的数值坐标\nplot_data$data\n#&gt; [[1]]\n#&gt;    colour       ymin      ymax x         y group PANEL flipped_aes      xmin\n#&gt; 1 #F8766D 21.2341315 29.640231 1 25.437181     1     1       FALSE 0.9666667\n#&gt; 2 #00BA38 29.8251093 42.689121 1 36.257115     2     1       FALSE 0.9666667\n#&gt; 3 #619CFF 23.2386460 36.902540 1 30.070593     3     1       FALSE 0.9666667\n#&gt; 4 #F8766D 20.3358912 49.648564 2 34.992228     1     1       FALSE 1.9666667\n#&gt; 5 #00BA38  4.8856152 11.577581 2  8.231598     2     1       FALSE 1.9666667\n#&gt; 6 #619CFF 22.3836755 39.057109 2 30.720392     3     1       FALSE 1.9666667\n#&gt; 7 #F8766D 28.7160676 66.995581 3 47.855824     1     1       FALSE 2.9666667\n#&gt; 8 #00BA38  0.5880804  5.165626 3  2.876853     2     1       FALSE 2.9666667\n#&gt; 9 #619CFF 27.2406302 48.369439 3 37.805035     3     1       FALSE 2.9666667\n#&gt;       xmax linewidth linetype width alpha\n#&gt; 1 1.033333       0.5        1   0.2    NA\n#&gt; 2 1.033333       0.5        1   0.2    NA\n#&gt; 3 1.033333       0.5        1   0.2    NA\n#&gt; 4 2.033333       0.5        1   0.2    NA\n#&gt; 5 2.033333       0.5        1   0.2    NA\n#&gt; 6 2.033333       0.5        1   0.2    NA\n#&gt; 7 3.033333       0.5        1   0.2    NA\n#&gt; 8 3.033333       0.5        1   0.2    NA\n#&gt; 9 3.033333       0.5        1   0.2    NA\n#&gt; \n#&gt; [[2]]\n#&gt;    colour x         y group PANEL flipped_aes xmin xmax      ymax linewidth\n#&gt; 1 #F8766D 1 25.437181     1     1       FALSE    1    1 25.437181       0.8\n#&gt; 2 #F8766D 2 34.992228     1     1       FALSE    2    2 34.992228       0.8\n#&gt; 3 #F8766D 3 47.855824     1     1       FALSE    3    3 47.855824       0.8\n#&gt; 4 #00BA38 1 36.257115     2     1       FALSE    1    1 36.257115       0.8\n#&gt; 5 #00BA38 2  8.231598     2     1       FALSE    2    2  8.231598       0.8\n#&gt; 6 #00BA38 3  2.876853     2     1       FALSE    3    3  2.876853       0.8\n#&gt; 7 #619CFF 1 30.070593     3     1       FALSE    1    1 30.070593       0.8\n#&gt; 8 #619CFF 2 30.720392     3     1       FALSE    2    2 30.720392       0.8\n#&gt; 9 #619CFF 3 37.805035     3     1       FALSE    3    3 37.805035       0.8\n#&gt;   linetype alpha\n#&gt; 1        1    NA\n#&gt; 2        1    NA\n#&gt; 3        1    NA\n#&gt; 4        1    NA\n#&gt; 5        1    NA\n#&gt; 6        1    NA\n#&gt; 7        1    NA\n#&gt; 8        1    NA\n#&gt; 9        1    NA\n#&gt; \n#&gt; [[3]]\n#&gt;   shape x         y group PANEL xmin xmax      ymax colour size fill alpha\n#&gt; 1    16 1 25.437181     1     1    1    1 25.437181  black    2   NA    NA\n#&gt; 2    17 1 36.257115     2     1    1    1 36.257115  black    2   NA    NA\n#&gt; 3    15 1 30.070593     3     1    1    1 30.070593  black    2   NA    NA\n#&gt; 4    16 2 34.992228     1     1    2    2 34.992228  black    2   NA    NA\n#&gt; 5    17 2  8.231598     2     1    2    2  8.231598  black    2   NA    NA\n#&gt; 6    15 2 30.720392     3     1    2    2 30.720392  black    2   NA    NA\n#&gt; 7    16 3 47.855824     1     1    3    3 47.855824  black    2   NA    NA\n#&gt; 8    17 3  2.876853     2     1    3    3  2.876853  black    2   NA    NA\n#&gt; 9    15 3 37.805035     3     1    3    3 37.805035  black    2   NA    NA\n#&gt;   stroke\n#&gt; 1    0.5\n#&gt; 2    0.5\n#&gt; 3    0.5\n#&gt; 4    0.5\n#&gt; 5    0.5\n#&gt; 6    0.5\n#&gt; 7    0.5\n#&gt; 8    0.5\n#&gt; 9    0.5\n\n\n\np  +  annotate(geom = \"segment\",\n               x = 3.4,\n               y = 47.855824,\n               yend = 2.876853,) + annotate(\n                   geom = \"text\",\n                   x = 3.45,\n                   y = (47.855824 + 2.876853) / 2,\n                   angle = 270,\n                   label = pvalue$padj[1],\n               ) +\n    annotate(geom = \"segment\",\n             x = 3.15,\n             y = 47.855824,\n             yend = 37.805035,) + annotate(\n                 geom = \"text\",\n                 x = 3.2,\n                 y = (47.855824 + 37.805035) / 2,\n                 angle = 270,\n                 label = pvalue$padj[2],\n             ) +\n    annotate(geom = \"segment\",\n             x = 3.3,\n             y = 2.876853,\n             yend = 37.805035,) + annotate(\n                 geom = \"text\",\n                 x = 3.35,\n                 y = (2.876853 + 37.805035) / 2,\n                 angle = 270,\n                 label = pvalue$padj[3],\n             )\n\n\n\n\n\n\nCode\n#y=c(47.855824,37.805035,2.876853,),\n#yend = c(2.876853,47.855824,37.805035,),\n\n\nhttps://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/",
    "crumbs": [
      "ggplot2 图形",
      "曲线图",
      "折线图"
    ]
  },
  {
    "objectID": "折线图.html#ggpubr",
    "href": "折线图.html#ggpubr",
    "title": "",
    "section": "\n3 ggpubr",
    "text": "3 ggpubr\n\nCodedf &lt;- ToothGrowth\ndf$dose &lt;- as.factor(df$dose)\n\nstat.test &lt;- df %&gt;%\n    group_by(dose) %&gt;%\n    t_test(len ~ supp) %&gt;%\n    adjust_pvalue(method = \"bonferroni\") %&gt;%\n    add_significance(\"p.adj\")\n\n\nlp &lt;- ggline(\n    df,\n    x = \"dose\",\n    y = \"len\",\n    add = \"mean_sd\",\n    color = \"supp\",\n    palette = c(\"#00AFBB\", \"#E7B800\")\n)\nlp\n\n\n\n\n\n\nCode# Add p-values onto the line plots\n# Remove brackets using linetype = \"blank\"\nstat.test &lt;- stat.test %&gt;%\n    add_xy_position(fun = \"mean_sd\", x = \"dose\")\nlp + stat_pvalue_manual(stat.test,\n                        label = \"p.adj.signif\",\n                        tip.length = 0,\n                        linetype  = \"blank\")",
    "crumbs": [
      "ggplot2 图形",
      "曲线图",
      "折线图"
    ]
  },
  {
    "objectID": "曼哈顿图.html",
    "href": "曼哈顿图.html",
    "title": "",
    "section": "",
    "text": "点线图曼哈顿图 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "点线图",
      "曼哈顿图"
    ]
  },
  {
    "objectID": "曼哈顿图.html#基本",
    "href": "曼哈顿图.html#基本",
    "title": "",
    "section": "\n1.1 基本",
    "text": "1.1 基本\n\nCode# Load the library\nlibrary(qqman)\n#&gt; \n#&gt; For example usage please run: vignette('qqman')\n#&gt; \n#&gt; Citation appreciated but not required:\n#&gt; Turner, (2018). qqman: an R package for visualizing GWAS results using Q-Q and manhattan plots. Journal of Open Source Software, 3(25), 731, https://doi.org/10.21105/joss.00731.\n#&gt; \n\ngwasResults %&gt;% head()\n#&gt;   SNP CHR BP         P\n#&gt; 1 rs1   1  1 0.9148060\n#&gt; 2 rs2   1  2 0.9370754\n#&gt; 3 rs3   1  3 0.2861395\n#&gt; 4 rs4   1  4 0.8304476\n#&gt; 5 rs5   1  5 0.6417455\n#&gt; 6 rs6   1  6 0.5190959\n\n# Make the Manhattan plot on the gwasResults dataset\nmanhattan(gwasResults, chr=\"CHR\", bp=\"BP\", snp=\"SNP\", p=\"P\" )\n\n\n\n\n\n\n\n\nCodesnpsOfInterest\n#&gt;   [1] \"rs3001\" \"rs3002\" \"rs3003\" \"rs3004\" \"rs3005\" \"rs3006\" \"rs3007\" \"rs3008\"\n#&gt;   [9] \"rs3009\" \"rs3010\" \"rs3011\" \"rs3012\" \"rs3013\" \"rs3014\" \"rs3015\" \"rs3016\"\n#&gt;  [17] \"rs3017\" \"rs3018\" \"rs3019\" \"rs3020\" \"rs3021\" \"rs3022\" \"rs3023\" \"rs3024\"\n#&gt;  [25] \"rs3025\" \"rs3026\" \"rs3027\" \"rs3028\" \"rs3029\" \"rs3030\" \"rs3031\" \"rs3032\"\n#&gt;  [33] \"rs3033\" \"rs3034\" \"rs3035\" \"rs3036\" \"rs3037\" \"rs3038\" \"rs3039\" \"rs3040\"\n#&gt;  [41] \"rs3041\" \"rs3042\" \"rs3043\" \"rs3044\" \"rs3045\" \"rs3046\" \"rs3047\" \"rs3048\"\n#&gt;  [49] \"rs3049\" \"rs3050\" \"rs3051\" \"rs3052\" \"rs3053\" \"rs3054\" \"rs3055\" \"rs3056\"\n#&gt;  [57] \"rs3057\" \"rs3058\" \"rs3059\" \"rs3060\" \"rs3061\" \"rs3062\" \"rs3063\" \"rs3064\"\n#&gt;  [65] \"rs3065\" \"rs3066\" \"rs3067\" \"rs3068\" \"rs3069\" \"rs3070\" \"rs3071\" \"rs3072\"\n#&gt;  [73] \"rs3073\" \"rs3074\" \"rs3075\" \"rs3076\" \"rs3077\" \"rs3078\" \"rs3079\" \"rs3080\"\n#&gt;  [81] \"rs3081\" \"rs3082\" \"rs3083\" \"rs3084\" \"rs3085\" \"rs3086\" \"rs3087\" \"rs3088\"\n#&gt;  [89] \"rs3089\" \"rs3090\" \"rs3091\" \"rs3092\" \"rs3093\" \"rs3094\" \"rs3095\" \"rs3096\"\n#&gt;  [97] \"rs3097\" \"rs3098\" \"rs3099\" \"rs3100\"\nmanhattan(gwasResults, highlight = snpsOfInterest)\n\n\n\n\n\n\nCode\n# 注释\nmanhattan(gwasResults, annotatePval = 0.01)\n\n\n\n\n\n\n\n\nCodeqq(gwasResults$P)",
    "crumbs": [
      "ggplot2 图形",
      "点线图",
      "曼哈顿图"
    ]
  },
  {
    "objectID": "曼哈顿图.html#使用-ggplot2-高度可定制",
    "href": "曼哈顿图.html#使用-ggplot2-高度可定制",
    "title": "",
    "section": "\n1.2 使用 ggplot2 高度可定制",
    "text": "1.2 使用 ggplot2 高度可定制\n\nCodedon &lt;- gwasResults %&gt;% \n  \n  # Compute chromosome size\n  group_by(CHR) %&gt;% \n  summarise(chr_len=max(BP)) %&gt;% \n  \n  # Calculate cumulative position of each chromosome\n  mutate(tot=cumsum(chr_len)-chr_len) %&gt;%\n  select(-chr_len) %&gt;%\n  \n  # Add this info to the initial dataset\n  left_join(gwasResults, ., by=c(\"CHR\"=\"CHR\")) %&gt;%\n  \n  # Add a cumulative position of each SNP\n  arrange(CHR, BP) %&gt;%\n  mutate( BPcum=BP+tot)\n\naxisdf = don %&gt;%\n  group_by(CHR) %&gt;%\n  summarize(center=( max(BPcum) + min(BPcum) ) / 2 )\n\n\n\nCodeggplot(don, aes(x=BPcum, y=-log10(P))) +\n    \n    # Show all points\n    geom_point( aes(color=as.factor(CHR)), alpha=0.8, size=1.3) +\n    scale_color_manual(values = rep(c(\"grey\", \"skyblue\"), 22 )) +\n    \n    # custom X axis:\n    scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +\n    scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis\n  \n    # Custom the theme:\n    theme_bw() +\n    theme( \n      legend.position=\"none\",\n      panel.border = element_blank(),\n      panel.grid.major.x = element_blank(),\n      panel.grid.minor.x = element_blank()\n    )\n\n\n\n\n\n\n\n\nCode# List of SNPs to highlight are in the snpsOfInterest object\n# We will use ggrepel for the annotation\nlibrary(ggrepel)\n\n# Prepare the dataset\ndon &lt;- gwasResults %&gt;% \n  \n  # Compute chromosome size\n  group_by(CHR) %&gt;% \n  summarise(chr_len=max(BP)) %&gt;% \n  \n  # Calculate cumulative position of each chromosome\n  mutate(tot=cumsum(chr_len)-chr_len) %&gt;%\n  select(-chr_len) %&gt;%\n  \n  # Add this info to the initial dataset\n  left_join(gwasResults, ., by=c(\"CHR\"=\"CHR\")) %&gt;%\n  \n  # Add a cumulative position of each SNP\n  arrange(CHR, BP) %&gt;%\n  mutate( BPcum=BP+tot) %&gt;%\n\n  # Add highlight and annotation information\n  mutate( is_highlight=ifelse(SNP %in% snpsOfInterest, \"yes\", \"no\")) %&gt;%\n  mutate( is_annotate=ifelse(-log10(P)&gt;4, \"yes\", \"no\")) \n\n# Prepare X axis\naxisdf &lt;- don %&gt;% group_by(CHR) %&gt;% summarize(center=( max(BPcum) + min(BPcum) ) / 2 )\n\n# Make the plot\nggplot(don, aes(x=BPcum, y=-log10(P))) +\n    \n    # Show all points\n    geom_point( aes(color=as.factor(CHR)), alpha=0.8, size=1.3) +\n    scale_color_manual(values = rep(c(\"grey\", \"skyblue\"), 22 )) +\n    \n    # custom X axis:\n    scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +\n    scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis\n\n    # Add highlighted points\n    geom_point(data=subset(don, is_highlight==\"yes\"), color=\"orange\", size=2) +\n  \n    # Add label using ggrepel to avoid overlapping\n    geom_label_repel( data=subset(don, is_annotate==\"yes\"), aes(label=SNP), size=2) +\n\n    # Custom the theme:\n    theme_bw() +\n    theme( \n      legend.position=\"none\",\n      panel.border = element_blank(),\n      panel.grid.major.x = element_blank(),\n      panel.grid.minor.x = element_blank()\n    )\n#&gt; Warning: ggrepel: 31 unlabeled data points (too many overlaps). Consider\n#&gt; increasing max.overlaps",
    "crumbs": [
      "ggplot2 图形",
      "点线图",
      "曼哈顿图"
    ]
  },
  {
    "objectID": "曼哈顿图.html#切换到带有-plotly-的交互式版本",
    "href": "曼哈顿图.html#切换到带有-plotly-的交互式版本",
    "title": "",
    "section": "\n1.3 切换到带有 plotly 的交互式版本",
    "text": "1.3 切换到带有 plotly 的交互式版本\n\nCodegwasResults %&gt;% \n  filter(-log10(P)&gt;1)\n#&gt;          SNP CHR   BP            P\n#&gt; 1       rs25   1   25 8.243756e-02\n#&gt; 2       rs35   1   35 3.948339e-03\n#&gt; 3       rs37   1   37 7.334147e-03\n#&gt; 4       rs43   1   43 3.743103e-02\n#&gt; 5       rs55   1   55 3.893649e-02\n#&gt; 6       rs71   1   71 4.298880e-02\n#&gt; 7       rs77   1   77 7.884739e-03\n#&gt; 8       rs80   1   80 1.570554e-03\n#&gt; 9       rs88   1   88 8.998052e-02\n#&gt; 10      rs89   1   89 8.561206e-02\n#&gt; 11      rs92   1   92 2.388966e-04\n#&gt; 12     rs110   1  110 2.272966e-03\n#&gt; 13     rs117   1  117 1.380844e-03\n#&gt; 14     rs142   1  142 8.026447e-02\n#&gt; 15     rs158   1  158 2.908582e-02\n#&gt; 16     rs195   1  195 7.225311e-02\n#&gt; 17     rs196   1  196 5.312948e-02\n#&gt; 18     rs214   1  214 6.094975e-02\n#&gt; 19     rs229   1  229 4.834678e-02\n#&gt; 20     rs234   1  234 1.754832e-02\n#&gt; 21     rs237   1  237 8.658060e-02\n#&gt; 22     rs241   1  241 6.763682e-02\n#&gt; 23     rs243   1  243 7.072189e-02\n#&gt; 24     rs255   1  255 2.145023e-02\n#&gt; 25     rs282   1  282 4.989215e-02\n#&gt; 26     rs288   1  288 1.868741e-02\n#&gt; 27     rs290   1  290 2.966338e-02\n#&gt; 28     rs296   1  296 8.977797e-02\n#&gt; 29     rs300   1  300 3.251748e-02\n#&gt; 30     rs303   1  303 6.038559e-02\n#&gt; 31     rs314   1  314 9.307467e-02\n#&gt; 32     rs332   1  332 2.378107e-03\n#&gt; 33     rs342   1  342 9.091831e-02\n#&gt; 34     rs345   1  345 4.048758e-02\n#&gt; 35     rs346   1  346 4.108634e-02\n#&gt; 36     rs353   1  353 7.366780e-02\n#&gt; 37     rs371   1  371 9.073596e-02\n#&gt; 38     rs379   1  379 5.540218e-02\n#&gt; 39     rs387   1  387 9.783228e-02\n#&gt; 40     rs390   1  390 8.608341e-02\n#&gt; 41     rs400   1  400 7.559910e-02\n#&gt; 42     rs401   1  401 2.270001e-02\n#&gt; 43     rs409   1  409 8.427752e-02\n#&gt; 44     rs420   1  420 6.004834e-02\n#&gt; 45     rs426   1  426 7.236709e-02\n#&gt; 46     rs434   1  434 8.388484e-02\n#&gt; 47     rs436   1  436 1.644819e-02\n#&gt; 48     rs439   1  439 9.964059e-02\n#&gt; 49     rs450   1  450 6.194098e-02\n#&gt; 50     rs462   1  462 7.905054e-02\n#&gt; 51     rs464   1  464 7.289182e-02\n#&gt; 52     rs472   1  472 1.433898e-03\n#&gt; 53     rs489   1  489 8.369529e-02\n#&gt; 54     rs490   1  490 4.864107e-02\n#&gt; 55     rs500   1  500 3.280914e-02\n#&gt; 56     rs527   1  527 3.204482e-02\n#&gt; 57     rs536   1  536 9.506827e-02\n#&gt; 58     rs537   1  537 3.467704e-03\n#&gt; 59     rs556   1  556 9.285940e-02\n#&gt; 60     rs563   1  563 4.819332e-02\n#&gt; 61     rs564   1  564 3.881593e-02\n#&gt; 62     rs574   1  574 4.050434e-04\n#&gt; 63     rs577   1  577 1.729183e-02\n#&gt; 64     rs578   1  578 2.673547e-02\n#&gt; 65     rs599   1  599 5.201560e-02\n#&gt; 66     rs673   1  673 8.271684e-02\n#&gt; 67     rs675   1  675 9.566141e-02\n#&gt; 68     rs695   1  695 4.623781e-02\n#&gt; 69     rs719   1  719 5.747115e-02\n#&gt; 70     rs735   1  735 8.287371e-02\n#&gt; 71     rs747   1  747 5.003075e-02\n#&gt; 72     rs752   1  752 8.763591e-02\n#&gt; 73     rs764   1  764 8.982624e-03\n#&gt; 74     rs772   1  772 9.764466e-02\n#&gt; 75     rs776   1  776 1.100904e-02\n#&gt; 76     rs784   1  784 6.560564e-02\n#&gt; 77     rs790   1  790 7.042566e-02\n#&gt; 78     rs794   1  794 2.119630e-02\n#&gt; 79     rs818   1  818 8.037847e-02\n#&gt; 80     rs819   1  819 2.812119e-02\n#&gt; 81     rs824   1  824 4.685369e-02\n#&gt; 82     rs825   1  825 4.814050e-02\n#&gt; 83     rs828   1  828 1.139357e-02\n#&gt; 84     rs830   1  830 5.593757e-02\n#&gt; 85     rs833   1  833 1.430444e-02\n#&gt; 86     rs840   1  840 3.591406e-03\n#&gt; 87     rs843   1  843 7.303838e-02\n#&gt; 88     rs856   1  856 3.692378e-02\n#&gt; 89     rs867   1  867 6.105991e-02\n#&gt; 90     rs873   1  873 1.916128e-02\n#&gt; 91     rs888   1  888 9.764267e-02\n#&gt; 92     rs898   1  898 7.029376e-02\n#&gt; 93     rs901   1  901 9.614729e-02\n#&gt; 94     rs902   1  902 3.690323e-02\n#&gt; 95     rs904   1  904 1.153723e-02\n#&gt; 96     rs936   1  936 9.221099e-02\n#&gt; 97     rs937   1  937 1.624343e-02\n#&gt; 98     rs943   1  943 7.240188e-02\n#&gt; 99     rs947   1  947 6.921040e-03\n#&gt; 100    rs950   1  950 7.008263e-02\n#&gt; 101    rs963   1  963 2.711778e-02\n#&gt; 102    rs965   1  965 7.504278e-02\n#&gt; 103    rs967   1  967 7.082723e-02\n#&gt; 104    rs975   1  975 5.950677e-02\n#&gt; 105    rs982   1  982 3.037704e-02\n#&gt; 106    rs992   1  992 9.769294e-02\n#&gt; 107    rs998   1  998 5.902965e-02\n#&gt; 108   rs1000   1 1000 7.417523e-03\n#&gt; 109   rs1002   1 1002 6.274633e-02\n#&gt; 110   rs1006   1 1006 2.222732e-02\n#&gt; 111   rs1022   1 1022 3.942325e-02\n#&gt; 112   rs1028   1 1028 4.660819e-02\n#&gt; 113   rs1033   1 1033 4.273437e-02\n#&gt; 114   rs1040   1 1040 8.589623e-02\n#&gt; 115   rs1050   1 1050 1.143825e-02\n#&gt; 116   rs1059   1 1059 2.865097e-02\n#&gt; 117   rs1061   1 1061 3.558353e-02\n#&gt; 118   rs1064   1 1064 5.144409e-02\n#&gt; 119   rs1072   1 1072 4.140157e-02\n#&gt; 120   rs1078   1 1078 4.558153e-02\n#&gt; 121   rs1086   1 1086 2.481460e-02\n#&gt; 122   rs1090   1 1090 4.525750e-02\n#&gt; 123   rs1092   1 1092 3.284422e-02\n#&gt; 124   rs1098   1 1098 8.687024e-02\n#&gt; 125   rs1101   1 1101 5.923053e-02\n#&gt; 126   rs1104   1 1104 7.285542e-02\n#&gt; 127   rs1115   1 1115 6.356799e-02\n#&gt; 128   rs1119   1 1119 5.710704e-02\n#&gt; 129   rs1129   1 1129 5.835895e-02\n#&gt; 130   rs1131   1 1131 2.233104e-02\n#&gt; 131   rs1134   1 1134 5.706670e-03\n#&gt; 132   rs1138   1 1138 5.521929e-02\n#&gt; 133   rs1147   1 1147 2.368318e-02\n#&gt; 134   rs1152   1 1152 9.059939e-03\n#&gt; 135   rs1165   1 1165 4.116736e-02\n#&gt; 136   rs1171   1 1171 7.219260e-02\n#&gt; 137   rs1175   1 1175 8.908186e-02\n#&gt; 138   rs1176   1 1176 1.303811e-02\n#&gt; 139   rs1194   1 1194 9.486411e-02\n#&gt; 140   rs1197   1 1197 1.499409e-02\n#&gt; 141   rs1213   1 1213 5.229727e-02\n#&gt; 142   rs1219   1 1219 2.759579e-02\n#&gt; 143   rs1221   1 1221 3.103370e-02\n#&gt; 144   rs1232   1 1232 2.819621e-02\n#&gt; 145   rs1254   1 1254 5.754862e-02\n#&gt; 146   rs1256   1 1256 4.157017e-02\n#&gt; 147   rs1285   1 1285 2.691978e-02\n#&gt; 148   rs1289   1 1289 5.451810e-02\n#&gt; 149   rs1291   1 1291 8.777247e-02\n#&gt; 150   rs1293   1 1293 1.272528e-03\n#&gt; 151   rs1304   1 1304 7.870148e-02\n#&gt; 152   rs1311   1 1311 6.677859e-02\n#&gt; 153   rs1317   1 1317 9.858031e-02\n#&gt; 154   rs1337   1 1337 6.530847e-02\n#&gt; 155   rs1356   1 1356 4.539116e-02\n#&gt; 156   rs1363   1 1363 9.205442e-02\n#&gt; 157   rs1368   1 1368 5.713459e-02\n#&gt; 158   rs1378   1 1378 6.915471e-02\n#&gt; 159   rs1389   1 1389 8.434011e-02\n#&gt; 160   rs1395   1 1395 1.416141e-02\n#&gt; 161   rs1398   1 1398 1.533849e-03\n#&gt; 162   rs1402   1 1402 5.021324e-02\n#&gt; 163   rs1418   1 1418 5.384916e-02\n#&gt; 164   rs1458   1 1458 2.224568e-02\n#&gt; 165   rs1487   1 1487 3.745326e-02\n#&gt; 166   rs1489   1 1489 1.212540e-02\n#&gt; 167   rs1501   2    1 5.391100e-02\n#&gt; 168   rs1503   2    3 2.560094e-02\n#&gt; 169   rs1509   2    9 1.136992e-02\n#&gt; 170   rs1512   2   12 4.755372e-03\n#&gt; 171   rs1580   2   80 6.923679e-02\n#&gt; 172   rs1593   2   93 1.092483e-02\n#&gt; 173   rs1598   2   98 2.092160e-02\n#&gt; 174   rs1609   2  109 8.601816e-02\n#&gt; 175   rs1624   2  124 8.785268e-02\n#&gt; 176   rs1629   2  129 1.367505e-02\n#&gt; 177   rs1634   2  134 8.029784e-03\n#&gt; 178   rs1641   2  141 5.327342e-03\n#&gt; 179   rs1644   2  144 2.291844e-02\n#&gt; 180   rs1652   2  152 1.431667e-02\n#&gt; 181   rs1655   2  155 1.863410e-02\n#&gt; 182   rs1666   2  166 5.451730e-02\n#&gt; 183   rs1669   2  169 2.217671e-02\n#&gt; 184   rs1678   2  178 3.642740e-03\n#&gt; 185   rs1698   2  198 2.691652e-02\n#&gt; 186   rs1702   2  202 9.869777e-02\n#&gt; 187   rs1708   2  208 8.064161e-02\n#&gt; 188   rs1716   2  216 9.587218e-02\n#&gt; 189   rs1730   2  230 8.203323e-02\n#&gt; 190   rs1734   2  234 4.802477e-02\n#&gt; 191   rs1736   2  236 8.764483e-02\n#&gt; 192   rs1740   2  240 8.204147e-02\n#&gt; 193   rs1742   2  242 4.272917e-02\n#&gt; 194   rs1746   2  246 6.568150e-02\n#&gt; 195   rs1769   2  269 9.640602e-02\n#&gt; 196   rs1782   2  282 7.704607e-02\n#&gt; 197   rs1796   2  296 2.046795e-02\n#&gt; 198   rs1800   2  300 6.462285e-02\n#&gt; 199   rs1811   2  311 1.544297e-03\n#&gt; 200   rs1818   2  318 6.269372e-02\n#&gt; 201   rs1819   2  319 5.963800e-02\n#&gt; 202   rs1826   2  326 6.885242e-02\n#&gt; 203   rs1828   2  328 5.469225e-02\n#&gt; 204   rs1845   2  345 5.323010e-02\n#&gt; 205   rs1857   2  357 9.201697e-02\n#&gt; 206   rs1871   2  371 2.816916e-02\n#&gt; 207   rs1879   2  379 1.633871e-02\n#&gt; 208   rs1881   2  381 6.390092e-02\n#&gt; 209   rs1884   2  384 9.022941e-02\n#&gt; 210   rs1893   2  393 1.451241e-02\n#&gt; 211   rs1900   2  400 2.779244e-02\n#&gt; 212   rs1935   2  435 2.704178e-02\n#&gt; 213   rs1943   2  443 5.330955e-02\n#&gt; 214   rs1948   2  448 6.045939e-02\n#&gt; 215   rs1959   2  459 3.734785e-04\n#&gt; 216   rs1960   2  460 8.383349e-02\n#&gt; 217   rs1966   2  466 6.907470e-02\n#&gt; 218   rs1969   2  469 5.106884e-02\n#&gt; 219   rs1997   2  497 8.583757e-02\n#&gt; 220   rs2015   2  515 1.703130e-03\n#&gt; 221   rs2031   2  531 7.746459e-02\n#&gt; 222   rs2035   2  535 4.705493e-02\n#&gt; 223   rs2036   2  536 6.087715e-02\n#&gt; 224   rs2038   2  538 9.829959e-02\n#&gt; 225   rs2042   2  542 9.629518e-03\n#&gt; 226   rs2077   2  577 9.366993e-02\n#&gt; 227   rs2087   2  587 4.321658e-03\n#&gt; 228   rs2090   2  590 2.849596e-02\n#&gt; 229   rs2129   2  629 5.327612e-03\n#&gt; 230   rs2135   2  635 4.112937e-02\n#&gt; 231   rs2155   2  655 2.100729e-02\n#&gt; 232   rs2157   2  657 9.685777e-02\n#&gt; 233   rs2158   2  658 8.420316e-02\n#&gt; 234   rs2172   2  672 5.769499e-02\n#&gt; 235   rs2176   2  676 5.896285e-03\n#&gt; 236   rs2177   2  677 8.252990e-02\n#&gt; 237   rs2181   2  681 9.383629e-02\n#&gt; 238   rs2196   2  696 8.301803e-02\n#&gt; 239   rs2208   2  708 1.938681e-02\n#&gt; 240   rs2241   2  741 7.797459e-02\n#&gt; 241   rs2242   2  742 6.755458e-02\n#&gt; 242   rs2248   2  748 3.852757e-02\n#&gt; 243   rs2252   2  752 2.302811e-02\n#&gt; 244   rs2268   2  768 3.378914e-02\n#&gt; 245   rs2274   2  774 2.192682e-02\n#&gt; 246   rs2281   2  781 7.898525e-02\n#&gt; 247   rs2291   2  791 3.274196e-02\n#&gt; 248   rs2317   2  817 7.227953e-02\n#&gt; 249   rs2319   2  819 1.296534e-02\n#&gt; 250   rs2333   2  833 2.714117e-02\n#&gt; 251   rs2350   2  850 3.688302e-02\n#&gt; 252   rs2363   2  863 6.113341e-02\n#&gt; 253   rs2364   2  864 3.341106e-02\n#&gt; 254   rs2371   2  871 6.203819e-02\n#&gt; 255   rs2379   2  879 1.964611e-02\n#&gt; 256   rs2380   2  880 2.951189e-02\n#&gt; 257   rs2413   2  913 7.574288e-03\n#&gt; 258   rs2435   2  935 2.087553e-02\n#&gt; 259   rs2449   2  949 7.058411e-03\n#&gt; 260   rs2450   2  950 8.157869e-02\n#&gt; 261   rs2456   2  956 4.647410e-02\n#&gt; 262   rs2461   2  961 6.571105e-02\n#&gt; 263   rs2483   2  983 8.918556e-02\n#&gt; 264   rs2496   2  996 1.999494e-02\n#&gt; 265   rs2501   2 1001 6.038098e-02\n#&gt; 266   rs2515   2 1015 5.728610e-02\n#&gt; 267   rs2522   2 1022 2.756194e-02\n#&gt; 268   rs2532   2 1032 6.159053e-02\n#&gt; 269   rs2540   2 1040 7.975502e-03\n#&gt; 270   rs2547   2 1047 9.748499e-02\n#&gt; 271   rs2549   2 1049 2.503727e-02\n#&gt; 272   rs2580   2 1080 8.212606e-02\n#&gt; 273   rs2594   2 1094 3.502029e-02\n#&gt; 274   rs2598   2 1098 3.758644e-02\n#&gt; 275   rs2604   2 1104 8.231374e-03\n#&gt; 276   rs2619   2 1119 4.988654e-02\n#&gt; 277   rs2620   2 1120 3.720249e-02\n#&gt; 278   rs2627   2 1127 2.836031e-02\n#&gt; 279   rs2632   2 1132 6.887357e-02\n#&gt; 280   rs2633   2 1133 8.435103e-02\n#&gt; 281   rs2645   2 1145 4.949112e-02\n#&gt; 282   rs2650   2 1150 4.332043e-02\n#&gt; 283   rs2652   2 1152 9.585968e-02\n#&gt; 284   rs2663   2 1163 5.033133e-02\n#&gt; 285   rs2668   2 1168 5.814911e-02\n#&gt; 286   rs2685   2 1185 6.173394e-02\n#&gt; 287   rs2692   3    1 8.648573e-02\n#&gt; 288   rs2693   3    2 5.621029e-03\n#&gt; 289   rs2696   3    5 5.802907e-02\n#&gt; 290   rs2721   3   30 6.574187e-02\n#&gt; 291   rs2739   3   48 3.038140e-02\n#&gt; 292   rs2745   3   54 5.473239e-02\n#&gt; 293   rs2760   3   69 4.121797e-02\n#&gt; 294   rs2779   3   88 3.744014e-02\n#&gt; 295   rs2799   3  108 4.148458e-02\n#&gt; 296   rs2803   3  112 3.808359e-02\n#&gt; 297   rs2810   3  119 8.168594e-02\n#&gt; 298   rs2819   3  128 6.966290e-02\n#&gt; 299   rs2842   3  151 4.743010e-02\n#&gt; 300   rs2848   3  157 6.331014e-03\n#&gt; 301   rs2876   3  185 6.541119e-02\n#&gt; 302   rs2879   3  188 8.084840e-02\n#&gt; 303   rs2886   3  195 2.164643e-02\n#&gt; 304   rs2891   3  200 4.739877e-03\n#&gt; 305   rs2921   3  230 6.032003e-02\n#&gt; 306   rs2927   3  236 4.312017e-02\n#&gt; 307   rs2948   3  257 2.486156e-02\n#&gt; 308   rs2954   3  263 3.987603e-02\n#&gt; 309   rs2960   3  269 8.179130e-02\n#&gt; 310   rs2963   3  272 3.748673e-02\n#&gt; 311   rs2967   3  276 1.093122e-02\n#&gt; 312   rs2968   3  277 8.530197e-02\n#&gt; 313   rs2975   3  284 9.983246e-02\n#&gt; 314   rs2992   3  301 8.304643e-03\n#&gt; 315   rs3019   3  328 1.749671e-02\n#&gt; 316   rs3026   3  335 1.050925e-02\n#&gt; 317   rs3027   3  336 3.202626e-03\n#&gt; 318   rs3028   3  337 5.787863e-04\n#&gt; 319   rs3029   3  338 7.079979e-05\n#&gt; 320   rs3030   3  339 1.798130e-05\n#&gt; 321   rs3031   3  340 2.976909e-05\n#&gt; 322   rs3032   3  341 1.593872e-05\n#&gt; 323   rs3033   3  342 1.320982e-05\n#&gt; 324   rs3034   3  343 6.093931e-06\n#&gt; 325   rs3035   3  344 5.743707e-07\n#&gt; 326   rs3036   3  345 3.702689e-06\n#&gt; 327   rs3037   3  346 2.537116e-06\n#&gt; 328   rs3038   3  347 1.084282e-06\n#&gt; 329   rs3039   3  348 1.291335e-07\n#&gt; 330   rs3040   3  349 2.672902e-08\n#&gt; 331   rs3041   3  350 2.946537e-07\n#&gt; 332   rs3042   3  351 5.475278e-07\n#&gt; 333   rs3043   3  352 5.927777e-07\n#&gt; 334   rs3044   3  353 2.182527e-07\n#&gt; 335   rs3045   3  354 2.715654e-07\n#&gt; 336   rs3046   3  355 3.035826e-07\n#&gt; 337   rs3047   3  356 1.237451e-07\n#&gt; 338   rs3048   3  357 1.578447e-07\n#&gt; 339   rs3049   3  358 1.575144e-07\n#&gt; 340   rs3050   3  359 7.803872e-09\n#&gt; 341   rs3051   3  360 6.459032e-08\n#&gt; 342   rs3052   3  361 1.018498e-07\n#&gt; 343   rs3053   3  362 1.637015e-07\n#&gt; 344   rs3054   3  363 3.892246e-08\n#&gt; 345   rs3055   3  364 1.173634e-07\n#&gt; 346   rs3056   3  365 7.807433e-09\n#&gt; 347   rs3057   3  366 4.438922e-09\n#&gt; 348   rs3058   3  367 4.739185e-07\n#&gt; 349   rs3059   3  368 5.101074e-07\n#&gt; 350   rs3060   3  369 2.488724e-08\n#&gt; 351   rs3061   3  370 3.759351e-07\n#&gt; 352   rs3062   3  371 1.542880e-06\n#&gt; 353   rs3063   3  372 6.195479e-07\n#&gt; 354   rs3064   3  373 1.081160e-06\n#&gt; 355   rs3065   3  374 2.140884e-06\n#&gt; 356   rs3066   3  375 1.658165e-06\n#&gt; 357   rs3067   3  376 8.671423e-06\n#&gt; 358   rs3068   3  377 2.755368e-06\n#&gt; 359   rs3069   3  378 1.603965e-05\n#&gt; 360   rs3070   3  379 2.310487e-06\n#&gt; 361   rs3071   3  380 8.000464e-05\n#&gt; 362   rs3072   3  381 1.615214e-04\n#&gt; 363   rs3073   3  382 5.673970e-04\n#&gt; 364   rs3074   3  383 1.699519e-04\n#&gt; 365   rs3075   3  384 3.377889e-02\n#&gt; 366   rs3085   3  394 1.136884e-02\n#&gt; 367   rs3086   3  395 1.999666e-02\n#&gt; 368   rs3088   3  397 6.831853e-02\n#&gt; 369   rs3099   3  408 4.479119e-03\n#&gt; 370   rs3109   3  418 4.580172e-02\n#&gt; 371   rs3117   3  426 7.796258e-02\n#&gt; 372   rs3134   3  443 9.617990e-02\n#&gt; 373   rs3163   3  472 8.816975e-02\n#&gt; 374   rs3180   3  489 7.302414e-02\n#&gt; 375   rs3190   3  499 2.081885e-02\n#&gt; 376   rs3195   3  504 8.415567e-02\n#&gt; 377   rs3199   3  508 4.459226e-02\n#&gt; 378   rs3202   3  511 5.096621e-02\n#&gt; 379   rs3212   3  521 4.801488e-02\n#&gt; 380   rs3228   3  537 8.676967e-02\n#&gt; 381   rs3234   3  543 3.508408e-02\n#&gt; 382   rs3237   3  546 8.009692e-02\n#&gt; 383   rs3245   3  554 4.686401e-02\n#&gt; 384   rs3260   3  569 7.698255e-03\n#&gt; 385   rs3278   3  587 2.751853e-02\n#&gt; 386   rs3303   3  612 5.943063e-02\n#&gt; 387   rs3310   3  619 6.330096e-02\n#&gt; 388   rs3337   3  646 2.668620e-02\n#&gt; 389   rs3338   3  647 4.603265e-02\n#&gt; 390   rs3343   3  652 1.792978e-02\n#&gt; 391   rs3357   3  666 8.877594e-02\n#&gt; 392   rs3365   3  674 6.670878e-02\n#&gt; 393   rs3405   3  714 5.777034e-02\n#&gt; 394   rs3414   3  723 7.964323e-02\n#&gt; 395   rs3424   3  733 2.286618e-02\n#&gt; 396   rs3426   3  735 4.740768e-03\n#&gt; 397   rs3434   3  743 8.715846e-02\n#&gt; 398   rs3437   3  746 6.707572e-02\n#&gt; 399   rs3461   3  770 1.550876e-02\n#&gt; 400   rs3464   3  773 4.851137e-02\n#&gt; 401   rs3467   3  776 1.491124e-02\n#&gt; 402   rs3481   3  790 6.922526e-02\n#&gt; 403   rs3482   3  791 7.399597e-02\n#&gt; 404   rs3506   3  815 4.706947e-02\n#&gt; 405   rs3544   3  853 2.781824e-02\n#&gt; 406   rs3545   3  854 1.263757e-02\n#&gt; 407   rs3548   3  857 3.234407e-02\n#&gt; 408   rs3558   3  867 1.531309e-02\n#&gt; 409   rs3566   3  875 6.776084e-02\n#&gt; 410   rs3593   3  902 2.839948e-02\n#&gt; 411   rs3596   3  905 8.727535e-02\n#&gt; 412   rs3609   3  918 1.063877e-02\n#&gt; 413   rs3638   3  947 6.061337e-02\n#&gt; 414   rs3656   3  965 7.941256e-02\n#&gt; 415   rs3660   3  969 9.792349e-02\n#&gt; 416   rs3671   3  980 3.387770e-02\n#&gt; 417   rs3731   3 1040 2.465138e-02\n#&gt; 418   rs3762   4   31 1.551681e-02\n#&gt; 419   rs3773   4   42 3.123036e-02\n#&gt; 420   rs3784   4   53 8.482709e-02\n#&gt; 421   rs3796   4   65 6.147007e-02\n#&gt; 422   rs3797   4   66 8.727595e-02\n#&gt; 423   rs3802   4   71 9.343478e-02\n#&gt; 424   rs3809   4   78 9.079135e-02\n#&gt; 425   rs3810   4   79 5.960222e-02\n#&gt; 426   rs3820   4   89 7.470407e-02\n#&gt; 427   rs3823   4   92 1.701001e-02\n#&gt; 428   rs3834   4  103 7.555641e-02\n#&gt; 429   rs3835   4  104 5.663841e-02\n#&gt; 430   rs3845   4  114 6.900981e-02\n#&gt; 431   rs3847   4  116 6.187765e-02\n#&gt; 432   rs3869   4  138 3.682914e-02\n#&gt; 433   rs3873   4  142 2.560617e-02\n#&gt; 434   rs3880   4  149 9.194085e-02\n#&gt; 435   rs3881   4  150 8.018339e-02\n#&gt; 436   rs3886   4  155 9.255225e-02\n#&gt; 437   rs3889   4  158 8.735200e-02\n#&gt; 438   rs3899   4  168 9.927718e-02\n#&gt; 439   rs3911   4  180 4.427630e-02\n#&gt; 440   rs3948   4  217 5.774488e-02\n#&gt; 441   rs3954   4  223 3.634267e-02\n#&gt; 442   rs3957   4  226 3.315729e-02\n#&gt; 443   rs3958   4  227 8.422463e-02\n#&gt; 444   rs3959   4  228 6.165461e-02\n#&gt; 445   rs3961   4  230 3.637604e-02\n#&gt; 446   rs3967   4  236 9.375227e-03\n#&gt; 447   rs4005   4  274 4.228755e-02\n#&gt; 448   rs4007   4  276 2.239055e-02\n#&gt; 449   rs4008   4  277 3.207135e-02\n#&gt; 450   rs4009   4  278 9.821176e-02\n#&gt; 451   rs4021   4  290 5.360719e-02\n#&gt; 452   rs4026   4  295 2.887763e-02\n#&gt; 453   rs4038   4  307 6.069786e-02\n#&gt; 454   rs4064   4  333 3.825743e-04\n#&gt; 455   rs4066   4  335 3.606595e-02\n#&gt; 456   rs4068   4  337 9.795363e-02\n#&gt; 457   rs4129   4  398 2.819396e-03\n#&gt; 458   rs4141   4  410 8.585181e-03\n#&gt; 459   rs4169   4  438 1.292043e-02\n#&gt; 460   rs4173   4  442 1.037076e-02\n#&gt; 461   rs4191   4  460 3.111446e-02\n#&gt; 462   rs4195   4  464 3.726171e-02\n#&gt; 463   rs4224   4  493 8.140686e-02\n#&gt; 464   rs4232   4  501 5.805919e-02\n#&gt; 465   rs4240   4  509 3.575525e-02\n#&gt; 466   rs4242   4  511 6.530246e-02\n#&gt; 467   rs4261   4  530 3.743438e-02\n#&gt; 468   rs4265   4  534 7.805227e-02\n#&gt; 469   rs4281   4  550 6.411641e-03\n#&gt; 470   rs4283   4  552 4.903103e-02\n#&gt; 471   rs4284   4  553 7.403374e-02\n#&gt; 472   rs4285   4  554 7.767941e-02\n#&gt; 473   rs4290   4  559 2.746889e-02\n#&gt; 474   rs4322   4  591 9.927862e-02\n#&gt; 475   rs4323   4  592 8.366804e-02\n#&gt; 476   rs4336   4  605 4.225987e-02\n#&gt; 477   rs4338   4  607 8.058896e-02\n#&gt; 478   rs4344   4  613 9.596967e-02\n#&gt; 479   rs4371   4  640 2.338519e-03\n#&gt; 480   rs4383   4  652 3.770632e-02\n#&gt; 481   rs4406   4  675 3.161953e-02\n#&gt; 482   rs4411   4  680 6.866080e-02\n#&gt; 483   rs4412   4  681 5.036072e-02\n#&gt; 484   rs4419   4  688 8.818308e-02\n#&gt; 485   rs4423   4  692 4.813745e-02\n#&gt; 486   rs4428   4  697 8.656898e-02\n#&gt; 487   rs4430   4  699 7.553526e-02\n#&gt; 488   rs4437   4  706 5.571649e-02\n#&gt; 489   rs4443   4  712 4.109662e-02\n#&gt; 490   rs4456   4  725 4.361042e-03\n#&gt; 491   rs4465   4  734 2.272717e-02\n#&gt; 492   rs4474   4  743 9.257606e-02\n#&gt; 493   rs4497   4  766 5.116160e-02\n#&gt; 494   rs4502   4  771 7.423252e-02\n#&gt; 495   rs4506   4  775 2.496750e-02\n#&gt; 496   rs4509   4  778 9.542676e-02\n#&gt; 497   rs4532   4  801 4.152159e-03\n#&gt; 498   rs4534   4  803 2.366976e-02\n#&gt; 499   rs4535   4  804 3.796083e-02\n#&gt; 500   rs4536   4  805 6.201498e-02\n#&gt; 501   rs4537   4  806 1.940783e-02\n#&gt; 502   rs4544   4  813 2.936795e-02\n#&gt; 503   rs4561   4  830 1.436512e-02\n#&gt; 504   rs4565   4  834 9.854505e-02\n#&gt; 505   rs4576   4  845 4.411598e-02\n#&gt; 506   rs4620   4  889 8.901793e-02\n#&gt; 507   rs4625   4  894 4.090868e-02\n#&gt; 508   rs4652   4  921 2.957505e-02\n#&gt; 509   rs4666   4  935 7.446842e-03\n#&gt; 510   rs4682   5    6 1.052211e-02\n#&gt; 511   rs4689   5   13 7.833919e-03\n#&gt; 512   rs4699   5   23 5.627156e-02\n#&gt; 513   rs4734   5   58 1.415634e-02\n#&gt; 514   rs4766   5   90 3.570631e-02\n#&gt; 515   rs4777   5  101 1.797153e-02\n#&gt; 516   rs4787   5  111 5.223937e-02\n#&gt; 517   rs4802   5  126 2.300359e-02\n#&gt; 518   rs4838   5  162 5.559910e-02\n#&gt; 519   rs4867   5  191 7.267536e-02\n#&gt; 520   rs4869   5  193 4.412972e-02\n#&gt; 521   rs4876   5  200 4.453083e-02\n#&gt; 522   rs4915   5  239 7.062039e-02\n#&gt; 523   rs4917   5  241 7.990277e-03\n#&gt; 524   rs4922   5  246 6.142574e-02\n#&gt; 525   rs4925   5  249 8.185304e-02\n#&gt; 526   rs4929   5  253 3.444672e-02\n#&gt; 527   rs4937   5  261 2.936966e-02\n#&gt; 528   rs4949   5  273 3.506546e-02\n#&gt; 529   rs4961   5  285 2.054624e-02\n#&gt; 530   rs4962   5  286 1.256448e-03\n#&gt; 531   rs4969   5  293 6.454433e-02\n#&gt; 532   rs4970   5  294 7.903908e-02\n#&gt; 533   rs4975   5  299 9.160740e-02\n#&gt; 534   rs5000   5  324 5.380104e-02\n#&gt; 535   rs5010   5  334 2.453274e-02\n#&gt; 536   rs5014   5  338 2.733550e-02\n#&gt; 537   rs5016   5  340 2.368932e-02\n#&gt; 538   rs5020   5  344 5.982493e-02\n#&gt; 539   rs5021   5  345 2.929786e-02\n#&gt; 540   rs5030   5  354 3.714340e-02\n#&gt; 541   rs5061   5  385 9.641242e-03\n#&gt; 542   rs5067   5  391 2.335115e-03\n#&gt; 543   rs5070   5  394 7.877340e-02\n#&gt; 544   rs5079   5  403 4.595656e-02\n#&gt; 545   rs5084   5  408 3.054011e-02\n#&gt; 546   rs5091   5  415 3.539522e-02\n#&gt; 547   rs5095   5  419 9.268418e-02\n#&gt; 548   rs5103   5  427 3.858910e-02\n#&gt; 549   rs5110   5  434 8.503105e-02\n#&gt; 550   rs5133   5  457 6.646297e-03\n#&gt; 551   rs5135   5  459 3.176662e-02\n#&gt; 552   rs5139   5  463 3.101805e-02\n#&gt; 553   rs5175   5  499 8.680798e-02\n#&gt; 554   rs5190   5  514 1.156091e-02\n#&gt; 555   rs5202   5  526 9.108286e-03\n#&gt; 556   rs5210   5  534 9.090787e-02\n#&gt; 557   rs5232   5  556 2.435819e-02\n#&gt; 558   rs5238   5  562 3.343039e-02\n#&gt; 559   rs5254   5  578 6.316993e-02\n#&gt; 560   rs5262   5  586 7.854280e-02\n#&gt; 561   rs5263   5  587 2.542121e-02\n#&gt; 562   rs5268   5  592 7.867619e-02\n#&gt; 563   rs5270   5  594 9.635738e-02\n#&gt; 564   rs5271   5  595 8.742381e-02\n#&gt; 565   rs5287   5  611 6.881878e-04\n#&gt; 566   rs5306   5  630 9.730111e-02\n#&gt; 567   rs5323   5  647 9.980008e-03\n#&gt; 568   rs5325   5  649 1.401827e-02\n#&gt; 569   rs5331   5  655 2.329950e-02\n#&gt; 570   rs5339   5  663 3.100943e-02\n#&gt; 571   rs5346   5  670 3.975047e-02\n#&gt; 572   rs5351   5  675 2.476631e-02\n#&gt; 573   rs5363   5  687 2.761713e-02\n#&gt; 574   rs5364   5  688 9.924205e-02\n#&gt; 575   rs5368   5  692 4.221438e-02\n#&gt; 576   rs5386   5  710 2.800816e-03\n#&gt; 577   rs5396   5  720 8.854964e-02\n#&gt; 578   rs5408   5  732 1.144990e-02\n#&gt; 579   rs5425   5  749 1.417397e-02\n#&gt; 580   rs5457   5  781 4.613897e-02\n#&gt; 581   rs5472   5  796 1.990569e-02\n#&gt; 582   rs5476   5  800 4.615225e-02\n#&gt; 583   rs5508   5  832 8.008622e-02\n#&gt; 584   rs5512   5  836 3.261616e-02\n#&gt; 585   rs5515   5  839 1.842748e-02\n#&gt; 586   rs5531   5  855 5.461192e-02\n#&gt; 587   rs5542   5  866 1.189777e-02\n#&gt; 588   rs5553   5  877 3.415338e-03\n#&gt; 589   rs5554   6    1 8.559862e-03\n#&gt; 590   rs5561   6    8 7.210554e-02\n#&gt; 591   rs5570   6   17 7.834349e-02\n#&gt; 592   rs5574   6   21 6.441142e-02\n#&gt; 593   rs5580   6   27 1.319166e-02\n#&gt; 594   rs5585   6   32 6.432676e-02\n#&gt; 595   rs5589   6   36 3.301558e-02\n#&gt; 596   rs5605   6   52 9.153905e-02\n#&gt; 597   rs5609   6   56 6.283026e-03\n#&gt; 598   rs5662   6  109 3.779233e-02\n#&gt; 599   rs5664   6  111 8.828801e-02\n#&gt; 600   rs5669   6  116 8.999489e-02\n#&gt; 601   rs5675   6  122 7.868639e-02\n#&gt; 602   rs5677   6  124 4.629115e-02\n#&gt; 603   rs5701   6  148 4.356033e-02\n#&gt; 604   rs5717   6  164 3.517502e-02\n#&gt; 605   rs5732   6  179 4.511091e-03\n#&gt; 606   rs5733   6  180 7.333607e-02\n#&gt; 607   rs5739   6  186 2.280999e-02\n#&gt; 608   rs5747   6  194 5.074783e-02\n#&gt; 609   rs5759   6  206 7.306797e-02\n#&gt; 610   rs5766   6  213 8.086271e-02\n#&gt; 611   rs5796   6  243 1.455507e-02\n#&gt; 612   rs5821   6  268 7.725293e-02\n#&gt; 613   rs5825   6  272 7.471282e-02\n#&gt; 614   rs5826   6  273 7.875033e-02\n#&gt; 615   rs5827   6  274 4.439974e-02\n#&gt; 616   rs5830   6  277 7.913873e-02\n#&gt; 617   rs5833   6  280 2.436577e-02\n#&gt; 618   rs5835   6  282 9.267459e-02\n#&gt; 619   rs5847   6  294 7.331292e-04\n#&gt; 620   rs5848   6  295 6.454367e-02\n#&gt; 621   rs5850   6  297 9.961318e-02\n#&gt; 622   rs5851   6  298 8.163293e-02\n#&gt; 623   rs5855   6  302 5.165218e-02\n#&gt; 624   rs5873   6  320 9.272414e-02\n#&gt; 625   rs5875   6  322 1.497587e-03\n#&gt; 626   rs5877   6  324 1.301653e-02\n#&gt; 627   rs5885   6  332 2.848772e-02\n#&gt; 628   rs5886   6  333 2.177905e-02\n#&gt; 629   rs5888   6  335 8.124162e-02\n#&gt; 630   rs5897   6  344 5.320186e-02\n#&gt; 631   rs5901   6  348 3.783417e-02\n#&gt; 632   rs5914   6  361 6.604854e-02\n#&gt; 633   rs5918   6  365 9.408901e-02\n#&gt; 634   rs5919   6  366 8.164367e-02\n#&gt; 635   rs5927   6  374 6.342128e-02\n#&gt; 636   rs5942   6  389 4.508015e-02\n#&gt; 637   rs5953   6  400 9.867075e-02\n#&gt; 638   rs5963   6  410 6.391809e-02\n#&gt; 639   rs5979   6  426 4.075010e-02\n#&gt; 640   rs5991   6  438 1.550431e-02\n#&gt; 641   rs6004   6  451 2.584904e-02\n#&gt; 642   rs6015   6  462 7.293473e-02\n#&gt; 643   rs6035   6  482 1.067486e-02\n#&gt; 644   rs6036   6  483 7.246383e-02\n#&gt; 645   rs6046   6  493 5.400606e-02\n#&gt; 646   rs6048   6  495 7.776010e-02\n#&gt; 647   rs6097   6  544 7.032265e-02\n#&gt; 648   rs6114   6  561 8.645862e-02\n#&gt; 649   rs6118   6  565 5.931738e-02\n#&gt; 650   rs6156   6  603 4.582886e-02\n#&gt; 651   rs6162   6  609 6.662316e-02\n#&gt; 652   rs6167   6  614 3.212063e-02\n#&gt; 653   rs6175   6  622 6.591776e-02\n#&gt; 654   rs6179   6  626 9.107104e-02\n#&gt; 655   rs6183   6  630 9.184283e-02\n#&gt; 656   rs6194   6  641 4.821786e-02\n#&gt; 657   rs6203   6  650 1.572807e-03\n#&gt; 658   rs6233   6  680 8.816026e-02\n#&gt; 659   rs6234   6  681 3.643850e-02\n#&gt; 660   rs6243   6  690 2.815965e-02\n#&gt; 661   rs6251   6  698 3.078282e-02\n#&gt; 662   rs6266   6  713 6.537706e-02\n#&gt; 663   rs6267   6  714 4.059103e-02\n#&gt; 664   rs6302   6  749 3.283920e-02\n#&gt; 665   rs6311   6  758 1.676613e-02\n#&gt; 666   rs6321   6  768 3.429465e-02\n#&gt; 667   rs6324   6  771 1.465488e-02\n#&gt; 668   rs6327   6  774 4.448153e-02\n#&gt; 669   rs6328   6  775 3.691667e-02\n#&gt; 670   rs6339   6  786 4.595722e-02\n#&gt; 671   rs6349   6  796 9.603843e-02\n#&gt; 672   rs6352   6  799 8.888872e-02\n#&gt; 673   rs6354   6  801 8.637976e-02\n#&gt; 674   rs6359   6  806 5.197893e-03\n#&gt; 675   rs6367   6  814 4.616977e-02\n#&gt; 676   rs6385   7    7 3.091830e-02\n#&gt; 677   rs6396   7   18 2.082346e-02\n#&gt; 678   rs6401   7   23 1.948394e-02\n#&gt; 679   rs6426   7   48 5.561155e-02\n#&gt; 680   rs6443   7   65 3.059716e-02\n#&gt; 681   rs6446   7   68 5.157752e-02\n#&gt; 682   rs6449   7   71 7.021797e-02\n#&gt; 683   rs6453   7   75 4.318489e-02\n#&gt; 684   rs6456   7   78 6.551042e-02\n#&gt; 685   rs6458   7   80 2.271925e-02\n#&gt; 686   rs6465   7   87 4.352738e-02\n#&gt; 687   rs6474   7   96 1.671333e-02\n#&gt; 688   rs6484   7  106 3.749182e-02\n#&gt; 689   rs6485   7  107 6.676630e-02\n#&gt; 690   rs6488   7  110 9.287180e-03\n#&gt; 691   rs6509   7  131 4.747119e-02\n#&gt; 692   rs6513   7  135 4.456975e-02\n#&gt; 693   rs6522   7  144 6.691504e-02\n#&gt; 694   rs6529   7  151 3.712363e-03\n#&gt; 695   rs6534   7  156 6.403006e-02\n#&gt; 696   rs6550   7  172 2.545167e-02\n#&gt; 697   rs6551   7  173 5.971455e-02\n#&gt; 698   rs6554   7  176 6.121432e-02\n#&gt; 699   rs6566   7  188 6.002481e-02\n#&gt; 700   rs6578   7  200 4.231033e-03\n#&gt; 701   rs6580   7  202 5.034046e-02\n#&gt; 702   rs6582   7  204 3.551067e-02\n#&gt; 703   rs6584   7  206 2.421627e-02\n#&gt; 704   rs6586   7  208 4.947521e-02\n#&gt; 705   rs6587   7  209 7.315281e-02\n#&gt; 706   rs6602   7  224 6.909116e-02\n#&gt; 707   rs6608   7  230 4.289859e-02\n#&gt; 708   rs6612   7  234 2.494821e-02\n#&gt; 709   rs6619   7  241 6.544565e-02\n#&gt; 710   rs6620   7  242 3.674338e-02\n#&gt; 711   rs6626   7  248 3.031194e-02\n#&gt; 712   rs6627   7  249 7.320380e-02\n#&gt; 713   rs6631   7  253 2.667508e-02\n#&gt; 714   rs6636   7  258 5.970318e-04\n#&gt; 715   rs6654   7  276 7.150101e-02\n#&gt; 716   rs6657   7  279 7.903738e-02\n#&gt; 717   rs6661   7  283 9.662957e-02\n#&gt; 718   rs6671   7  293 3.317728e-02\n#&gt; 719   rs6675   7  297 3.825028e-02\n#&gt; 720   rs6676   7  298 7.568929e-02\n#&gt; 721   rs6678   7  300 3.250692e-02\n#&gt; 722   rs6697   7  319 5.887747e-02\n#&gt; 723   rs6714   7  336 9.264516e-02\n#&gt; 724   rs6716   7  338 8.598060e-02\n#&gt; 725   rs6721   7  343 9.252241e-02\n#&gt; 726   rs6726   7  348 5.675997e-02\n#&gt; 727   rs6734   7  356 9.483411e-02\n#&gt; 728   rs6753   7  375 8.088818e-02\n#&gt; 729   rs6771   7  393 5.535595e-02\n#&gt; 730   rs6773   7  395 6.634794e-03\n#&gt; 731   rs6776   7  398 4.983990e-02\n#&gt; 732   rs6803   7  425 9.903207e-02\n#&gt; 733   rs6808   7  430 3.612168e-02\n#&gt; 734   rs6812   7  434 5.950501e-02\n#&gt; 735   rs6828   7  450 5.446424e-02\n#&gt; 736   rs6842   7  464 7.244531e-02\n#&gt; 737   rs6847   7  469 9.772446e-03\n#&gt; 738   rs6850   7  472 6.996120e-02\n#&gt; 739   rs6859   7  481 7.845372e-03\n#&gt; 740   rs6870   7  492 4.639999e-03\n#&gt; 741   rs6888   7  510 4.221268e-02\n#&gt; 742   rs6889   7  511 8.789433e-02\n#&gt; 743   rs6896   7  518 1.231863e-03\n#&gt; 744   rs6912   7  534 7.869035e-02\n#&gt; 745   rs6914   7  536 2.746510e-02\n#&gt; 746   rs6939   7  561 6.609539e-02\n#&gt; 747   rs6940   7  562 2.221726e-02\n#&gt; 748   rs6947   7  569 5.868920e-02\n#&gt; 749   rs6959   7  581 7.885663e-03\n#&gt; 750   rs6964   7  586 2.501885e-02\n#&gt; 751   rs6982   7  604 1.005813e-02\n#&gt; 752   rs6990   7  612 5.696127e-03\n#&gt; 753   rs6993   7  615 8.757786e-02\n#&gt; 754   rs6997   7  619 4.379472e-02\n#&gt; 755   rs7003   7  625 9.615188e-02\n#&gt; 756   rs7012   7  634 1.233942e-02\n#&gt; 757   rs7049   7  671 3.348696e-02\n#&gt; 758   rs7053   7  675 1.646573e-02\n#&gt; 759   rs7067   7  689 7.551896e-03\n#&gt; 760   rs7080   7  702 1.510724e-02\n#&gt; 761   rs7083   7  705 5.234407e-02\n#&gt; 762   rs7086   7  708 4.554378e-03\n#&gt; 763   rs7090   7  712 6.111230e-02\n#&gt; 764   rs7096   7  718 3.011358e-02\n#&gt; 765   rs7099   7  721 2.156135e-02\n#&gt; 766   rs7110   7  732 9.920246e-02\n#&gt; 767   rs7111   7  733 4.910690e-02\n#&gt; 768   rs7114   7  736 2.501863e-02\n#&gt; 769   rs7117   7  739 8.604176e-02\n#&gt; 770   rs7128   7  750 3.937200e-03\n#&gt; 771   rs7137   7  759 8.007166e-02\n#&gt; 772   rs7138   7  760 6.968437e-02\n#&gt; 773   rs7139   7  761 9.108265e-02\n#&gt; 774   rs7152   7  774 6.943067e-02\n#&gt; 775   rs7159   7  781 9.331085e-02\n#&gt; 776   rs7162   7  784 4.140367e-02\n#&gt; 777   rs7171   8    9 6.984990e-02\n#&gt; 778   rs7175   8   13 1.426904e-02\n#&gt; 779   rs7176   8   14 6.678366e-02\n#&gt; 780   rs7183   8   21 7.591723e-03\n#&gt; 781   rs7191   8   29 5.127136e-02\n#&gt; 782   rs7193   8   31 5.335822e-02\n#&gt; 783   rs7237   8   75 5.309595e-02\n#&gt; 784   rs7244   8   82 4.085735e-02\n#&gt; 785   rs7252   8   90 3.163189e-02\n#&gt; 786   rs7267   8  105 6.708723e-02\n#&gt; 787   rs7273   8  111 2.473288e-02\n#&gt; 788   rs7307   8  145 4.294204e-02\n#&gt; 789   rs7340   8  178 4.521262e-02\n#&gt; 790   rs7343   8  181 8.223744e-02\n#&gt; 791   rs7344   8  182 7.717136e-02\n#&gt; 792   rs7348   8  186 9.772425e-02\n#&gt; 793   rs7355   8  193 2.187434e-02\n#&gt; 794   rs7360   8  198 5.747376e-02\n#&gt; 795   rs7384   8  222 5.118155e-02\n#&gt; 796   rs7394   8  232 1.933567e-02\n#&gt; 797   rs7397   8  235 8.033870e-02\n#&gt; 798   rs7408   8  246 5.828218e-03\n#&gt; 799   rs7411   8  249 6.227735e-03\n#&gt; 800   rs7414   8  252 7.731053e-02\n#&gt; 801   rs7418   8  256 9.263682e-02\n#&gt; 802   rs7434   8  272 9.608878e-02\n#&gt; 803   rs7436   8  274 9.455395e-02\n#&gt; 804   rs7476   8  314 5.062205e-02\n#&gt; 805   rs7502   8  340 2.382676e-02\n#&gt; 806   rs7506   8  344 7.261852e-03\n#&gt; 807   rs7513   8  351 1.411681e-02\n#&gt; 808   rs7520   8  358 6.321557e-02\n#&gt; 809   rs7522   8  360 7.030402e-03\n#&gt; 810   rs7545   8  383 8.173051e-03\n#&gt; 811   rs7551   8  389 4.250327e-02\n#&gt; 812   rs7556   8  394 7.129023e-02\n#&gt; 813   rs7557   8  395 9.817376e-02\n#&gt; 814   rs7570   8  408 6.431079e-02\n#&gt; 815   rs7580   8  418 5.747615e-03\n#&gt; 816   rs7582   8  420 9.024660e-02\n#&gt; 817   rs7584   8  422 2.724557e-02\n#&gt; 818   rs7586   8  424 1.513268e-02\n#&gt; 819   rs7591   8  429 6.919786e-02\n#&gt; 820   rs7592   8  430 8.946207e-03\n#&gt; 821   rs7612   8  450 3.575114e-02\n#&gt; 822   rs7632   8  470 9.350744e-02\n#&gt; 823   rs7638   8  476 9.652488e-02\n#&gt; 824   rs7641   8  479 8.476523e-04\n#&gt; 825   rs7668   8  506 9.568930e-02\n#&gt; 826   rs7672   8  510 4.101078e-02\n#&gt; 827   rs7684   8  522 9.679680e-02\n#&gt; 828   rs7689   8  527 9.187186e-02\n#&gt; 829   rs7698   8  536 8.979898e-04\n#&gt; 830   rs7699   8  537 5.684582e-02\n#&gt; 831   rs7701   8  539 2.684716e-03\n#&gt; 832   rs7713   8  551 1.526432e-02\n#&gt; 833   rs7728   8  566 7.270449e-02\n#&gt; 834   rs7741   8  579 3.281524e-02\n#&gt; 835   rs7745   8  583 1.211629e-02\n#&gt; 836   rs7749   8  587 6.824202e-02\n#&gt; 837   rs7776   8  614 4.710627e-02\n#&gt; 838   rs7781   8  619 6.580505e-02\n#&gt; 839   rs7788   8  626 3.151218e-02\n#&gt; 840   rs7791   8  629 4.326730e-02\n#&gt; 841   rs7795   8  633 6.482802e-02\n#&gt; 842   rs7802   8  640 3.451791e-02\n#&gt; 843   rs7803   8  641 8.422091e-02\n#&gt; 844   rs7808   8  646 3.279517e-02\n#&gt; 845   rs7810   8  648 1.643271e-02\n#&gt; 846   rs7832   8  670 6.536106e-02\n#&gt; 847   rs7844   8  682 9.302733e-02\n#&gt; 848   rs7855   8  693 8.523965e-02\n#&gt; 849   rs7861   8  699 4.415545e-02\n#&gt; 850   rs7865   8  703 1.654278e-02\n#&gt; 851   rs7874   8  712 9.664962e-02\n#&gt; 852   rs7882   8  720 8.757429e-02\n#&gt; 853   rs7885   8  723 9.210642e-02\n#&gt; 854   rs7893   8  731 9.664784e-02\n#&gt; 855   rs7908   8  746 5.475744e-02\n#&gt; 856   rs7928   9   16 4.566372e-02\n#&gt; 857   rs7952   9   40 2.100479e-02\n#&gt; 858   rs7961   9   49 8.197790e-02\n#&gt; 859   rs7969   9   57 7.856853e-02\n#&gt; 860   rs7978   9   66 4.724579e-02\n#&gt; 861   rs7996   9   84 5.885327e-02\n#&gt; 862   rs8009   9   97 2.304952e-02\n#&gt; 863   rs8010   9   98 7.763903e-02\n#&gt; 864   rs8033   9  121 3.451402e-02\n#&gt; 865   rs8041   9  129 2.958674e-02\n#&gt; 866   rs8043   9  131 5.058998e-02\n#&gt; 867   rs8044   9  132 1.651521e-02\n#&gt; 868   rs8045   9  133 2.788556e-02\n#&gt; 869   rs8046   9  134 7.152072e-02\n#&gt; 870   rs8065   9  153 1.907183e-02\n#&gt; 871   rs8079   9  167 7.760999e-02\n#&gt; 872   rs8083   9  171 4.968961e-02\n#&gt; 873   rs8084   9  172 2.713317e-02\n#&gt; 874   rs8088   9  176 9.577762e-02\n#&gt; 875   rs8101   9  189 5.305506e-02\n#&gt; 876   rs8108   9  196 7.022564e-03\n#&gt; 877   rs8109   9  197 2.130228e-02\n#&gt; 878   rs8113   9  201 8.122223e-02\n#&gt; 879   rs8123   9  211 5.021158e-02\n#&gt; 880   rs8125   9  213 9.295445e-03\n#&gt; 881   rs8127   9  215 8.072904e-02\n#&gt; 882   rs8143   9  231 8.800705e-02\n#&gt; 883   rs8148   9  236 2.667921e-02\n#&gt; 884   rs8149   9  237 5.969393e-02\n#&gt; 885   rs8166   9  254 5.029139e-03\n#&gt; 886   rs8175   9  263 9.985258e-03\n#&gt; 887   rs8178   9  266 5.517784e-02\n#&gt; 888   rs8186   9  274 1.534842e-02\n#&gt; 889   rs8187   9  275 2.400674e-02\n#&gt; 890   rs8189   9  277 6.358000e-02\n#&gt; 891   rs8190   9  278 8.652009e-02\n#&gt; 892   rs8211   9  299 3.844014e-02\n#&gt; 893   rs8219   9  307 3.109833e-03\n#&gt; 894   rs8229   9  317 5.425186e-02\n#&gt; 895   rs8233   9  321 1.532994e-02\n#&gt; 896   rs8234   9  322 8.456055e-02\n#&gt; 897   rs8239   9  327 7.496689e-02\n#&gt; 898   rs8245   9  333 5.654661e-02\n#&gt; 899   rs8250   9  338 8.758636e-02\n#&gt; 900   rs8265   9  353 5.417455e-02\n#&gt; 901   rs8270   9  358 4.901376e-02\n#&gt; 902   rs8278   9  366 8.721311e-02\n#&gt; 903   rs8281   9  369 8.192732e-02\n#&gt; 904   rs8285   9  373 8.691276e-02\n#&gt; 905   rs8301   9  389 7.972731e-02\n#&gt; 906   rs8316   9  404 9.684210e-02\n#&gt; 907   rs8338   9  426 3.024837e-02\n#&gt; 908   rs8349   9  437 1.345361e-03\n#&gt; 909   rs8360   9  448 1.943634e-02\n#&gt; 910   rs8362   9  450 6.197565e-02\n#&gt; 911   rs8363   9  451 3.032881e-02\n#&gt; 912   rs8378   9  466 3.119783e-02\n#&gt; 913   rs8384   9  472 3.603474e-02\n#&gt; 914   rs8385   9  473 8.355430e-02\n#&gt; 915   rs8406   9  494 6.554409e-02\n#&gt; 916   rs8407   9  495 3.715364e-02\n#&gt; 917   rs8415   9  503 2.046262e-02\n#&gt; 918   rs8417   9  505 6.895409e-02\n#&gt; 919   rs8423   9  511 3.458382e-02\n#&gt; 920   rs8440   9  528 2.477829e-02\n#&gt; 921   rs8441   9  529 3.022116e-02\n#&gt; 922   rs8449   9  537 3.279057e-03\n#&gt; 923   rs8452   9  540 6.507996e-02\n#&gt; 924   rs8460   9  548 6.900636e-02\n#&gt; 925   rs8477   9  565 5.958860e-02\n#&gt; 926   rs8511   9  599 3.206128e-02\n#&gt; 927   rs8514   9  602 6.115876e-02\n#&gt; 928   rs8515   9  603 4.578862e-02\n#&gt; 929   rs8516   9  604 8.399682e-02\n#&gt; 930   rs8543   9  631 6.524927e-02\n#&gt; 931   rs8547   9  635 3.966644e-02\n#&gt; 932   rs8552   9  640 8.363861e-02\n#&gt; 933   rs8575   9  663 7.648659e-02\n#&gt; 934   rs8578   9  666 1.220301e-02\n#&gt; 935   rs8593   9  681 2.287953e-02\n#&gt; 936   rs8595   9  683 1.053015e-02\n#&gt; 937   rs8600   9  688 3.477600e-02\n#&gt; 938   rs8603   9  691 1.968819e-02\n#&gt; 939   rs8628   9  716 9.086367e-02\n#&gt; 940   rs8634  10    1 5.397798e-02\n#&gt; 941   rs8636  10    3 2.933006e-02\n#&gt; 942   rs8644  10   11 6.439829e-02\n#&gt; 943   rs8670  10   37 8.434293e-02\n#&gt; 944   rs8679  10   46 8.455582e-03\n#&gt; 945   rs8682  10   49 1.458429e-03\n#&gt; 946   rs8709  10   76 9.951495e-02\n#&gt; 947   rs8712  10   79 5.382989e-02\n#&gt; 948   rs8718  10   85 8.166074e-02\n#&gt; 949   rs8728  10   95 6.971694e-02\n#&gt; 950   rs8750  10  117 7.984675e-02\n#&gt; 951   rs8775  10  142 6.863258e-02\n#&gt; 952   rs8777  10  144 7.235138e-03\n#&gt; 953   rs8778  10  145 3.907236e-02\n#&gt; 954   rs8798  10  165 3.187832e-02\n#&gt; 955   rs8805  10  172 9.929410e-02\n#&gt; 956   rs8806  10  173 4.840041e-02\n#&gt; 957   rs8808  10  175 9.791335e-02\n#&gt; 958   rs8817  10  184 4.383462e-02\n#&gt; 959   rs8832  10  199 2.327694e-02\n#&gt; 960   rs8839  10  206 1.249032e-02\n#&gt; 961   rs8842  10  209 4.020280e-02\n#&gt; 962   rs8848  10  215 8.100757e-02\n#&gt; 963   rs8851  10  218 4.580315e-02\n#&gt; 964   rs8852  10  219 4.102371e-02\n#&gt; 965   rs8861  10  228 6.000759e-03\n#&gt; 966   rs8868  10  235 2.318204e-02\n#&gt; 967   rs8902  10  269 7.624529e-02\n#&gt; 968   rs8926  10  293 2.713167e-02\n#&gt; 969   rs8942  10  309 8.954941e-02\n#&gt; 970   rs8943  10  310 6.794101e-02\n#&gt; 971   rs8948  10  315 6.996104e-03\n#&gt; 972   rs8960  10  327 6.628477e-02\n#&gt; 973   rs8962  10  329 9.926373e-02\n#&gt; 974   rs8969  10  336 5.487330e-02\n#&gt; 975   rs8988  10  355 4.072143e-02\n#&gt; 976   rs8992  10  359 2.033447e-02\n#&gt; 977   rs9015  10  382 9.784509e-02\n#&gt; 978   rs9032  10  399 5.475446e-02\n#&gt; 979   rs9036  10  403 7.575411e-02\n#&gt; 980   rs9061  10  428 6.871945e-02\n#&gt; 981   rs9069  10  436 8.313354e-03\n#&gt; 982   rs9083  10  450 9.151353e-02\n#&gt; 983   rs9084  10  451 8.555729e-03\n#&gt; 984   rs9092  10  459 4.914579e-02\n#&gt; 985   rs9102  10  469 6.908869e-02\n#&gt; 986   rs9104  10  471 9.251321e-02\n#&gt; 987   rs9115  10  482 4.421746e-03\n#&gt; 988   rs9125  10  492 7.265578e-03\n#&gt; 989   rs9131  10  498 4.600199e-02\n#&gt; 990   rs9138  10  505 9.549801e-02\n#&gt; 991   rs9153  10  520 6.831693e-02\n#&gt; 992   rs9167  10  534 8.097318e-02\n#&gt; 993   rs9174  10  541 7.731027e-03\n#&gt; 994   rs9184  10  551 7.514782e-03\n#&gt; 995   rs9199  10  566 2.687852e-02\n#&gt; 996   rs9239  10  606 2.702826e-02\n#&gt; 997   rs9270  10  637 1.104434e-02\n#&gt; 998   rs9281  10  648 3.378349e-02\n#&gt; 999   rs9298  10  665 2.911935e-02\n#&gt; 1000  rs9299  10  666 8.703284e-02\n#&gt; 1001  rs9310  10  677 8.815038e-02\n#&gt; 1002  rs9327  10  694 3.129110e-02\n#&gt; 1003  rs9343  11   14 4.879167e-02\n#&gt; 1004  rs9349  11   20 3.671305e-03\n#&gt; 1005  rs9366  11   37 1.852540e-02\n#&gt; 1006  rs9418  11   89 1.343615e-02\n#&gt; 1007  rs9427  11   98 3.302472e-02\n#&gt; 1008  rs9435  11  106 3.263204e-02\n#&gt; 1009  rs9437  11  108 6.389493e-02\n#&gt; 1010  rs9451  11  122 1.920696e-02\n#&gt; 1011  rs9486  11  157 2.561032e-03\n#&gt; 1012  rs9496  11  167 7.299278e-02\n#&gt; 1013  rs9507  11  178 8.750952e-02\n#&gt; 1014  rs9510  11  181 6.810584e-02\n#&gt; 1015  rs9513  11  184 7.869096e-02\n#&gt; 1016  rs9519  11  190 4.332128e-02\n#&gt; 1017  rs9542  11  213 6.223278e-02\n#&gt; 1018  rs9549  11  220 2.720747e-02\n#&gt; 1019  rs9551  11  222 2.350005e-02\n#&gt; 1020  rs9563  11  234 9.643503e-02\n#&gt; 1021  rs9565  11  236 7.692595e-02\n#&gt; 1022  rs9566  11  237 8.862223e-02\n#&gt; 1023  rs9567  11  238 8.001621e-03\n#&gt; 1024  rs9576  11  247 4.703622e-02\n#&gt; 1025  rs9584  11  255 7.606001e-02\n#&gt; 1026  rs9586  11  257 2.480028e-02\n#&gt; 1027  rs9589  11  260 3.462046e-03\n#&gt; 1028  rs9610  11  281 4.988990e-03\n#&gt; 1029  rs9613  11  284 3.694313e-02\n#&gt; 1030  rs9620  11  291 3.969251e-02\n#&gt; 1031  rs9621  11  292 5.261781e-02\n#&gt; 1032  rs9634  11  305 8.351917e-02\n#&gt; 1033  rs9666  11  337 7.973191e-02\n#&gt; 1034  rs9668  11  339 5.472392e-02\n#&gt; 1035  rs9669  11  340 3.161822e-02\n#&gt; 1036  rs9683  11  354 4.182835e-02\n#&gt; 1037  rs9689  11  360 8.714854e-03\n#&gt; 1038  rs9704  11  375 9.725695e-02\n#&gt; 1039  rs9713  11  384 5.646365e-02\n#&gt; 1040  rs9714  11  385 4.671112e-02\n#&gt; 1041  rs9719  11  390 5.741001e-02\n#&gt; 1042  rs9720  11  391 5.615708e-02\n#&gt; 1043  rs9721  11  392 2.593867e-02\n#&gt; 1044  rs9727  11  398 6.415306e-02\n#&gt; 1045  rs9733  11  404 9.889357e-02\n#&gt; 1046  rs9738  11  409 8.801110e-02\n#&gt; 1047  rs9748  11  419 6.649646e-02\n#&gt; 1048  rs9756  11  427 9.114151e-02\n#&gt; 1049  rs9761  11  432 8.975283e-02\n#&gt; 1050  rs9772  11  443 3.579455e-02\n#&gt; 1051  rs9799  11  470 4.611604e-02\n#&gt; 1052  rs9811  11  482 7.710138e-02\n#&gt; 1053  rs9816  11  487 7.287865e-02\n#&gt; 1054  rs9820  11  491 4.848987e-04\n#&gt; 1055  rs9836  11  507 7.372875e-02\n#&gt; 1056  rs9841  11  512 5.737946e-02\n#&gt; 1057  rs9845  11  516 2.150282e-02\n#&gt; 1058  rs9860  11  531 8.571509e-02\n#&gt; 1059  rs9862  11  533 8.828459e-02\n#&gt; 1060  rs9869  11  540 6.814681e-02\n#&gt; 1061  rs9876  11  547 7.778903e-02\n#&gt; 1062  rs9901  11  572 4.330799e-04\n#&gt; 1063  rs9909  11  580 5.925373e-02\n#&gt; 1064  rs9926  11  597 5.569003e-02\n#&gt; 1065  rs9929  11  600 9.717090e-02\n#&gt; 1066  rs9932  11  603 5.808967e-02\n#&gt; 1067  rs9943  11  614 2.977149e-02\n#&gt; 1068  rs9986  11  657 1.217952e-02\n#&gt; 1069  rs9988  11  659 8.287564e-02\n#&gt; 1070  rs9994  11  665 8.905032e-02\n#&gt; 1071 rs10010  12    7 4.136530e-02\n#&gt; 1072 rs10021  12   18 1.083091e-02\n#&gt; 1073 rs10043  12   40 4.442815e-02\n#&gt; 1074 rs10050  12   47 5.789266e-02\n#&gt; 1075 rs10065  12   62 8.033787e-02\n#&gt; 1076 rs10071  12   68 4.738570e-02\n#&gt; 1077 rs10082  12   79 3.165138e-02\n#&gt; 1078 rs10085  12   82 9.124876e-02\n#&gt; 1079 rs10096  12   93 5.440738e-02\n#&gt; 1080 rs10105  12  102 8.585967e-03\n#&gt; 1081 rs10110  12  107 1.779030e-02\n#&gt; 1082 rs10112  12  109 7.229682e-02\n#&gt; 1083 rs10126  12  123 1.873032e-02\n#&gt; 1084 rs10129  12  126 7.249576e-02\n#&gt; 1085 rs10131  12  128 1.562949e-03\n#&gt; 1086 rs10159  12  156 7.587103e-02\n#&gt; 1087 rs10163  12  160 3.019371e-02\n#&gt; 1088 rs10173  12  170 1.984915e-02\n#&gt; 1089 rs10175  12  172 6.432191e-02\n#&gt; 1090 rs10178  12  175 3.430014e-02\n#&gt; 1091 rs10179  12  176 5.634523e-02\n#&gt; 1092 rs10191  12  188 7.072005e-02\n#&gt; 1093 rs10202  12  199 4.320400e-02\n#&gt; 1094 rs10205  12  202 5.262911e-02\n#&gt; 1095 rs10211  12  208 1.033935e-02\n#&gt; 1096 rs10212  12  209 7.167415e-02\n#&gt; 1097 rs10220  12  217 9.626370e-02\n#&gt; 1098 rs10223  12  220 8.267990e-02\n#&gt; 1099 rs10229  12  226 8.995099e-03\n#&gt; 1100 rs10241  12  238 3.401691e-02\n#&gt; 1101 rs10246  12  243 5.730710e-02\n#&gt; 1102 rs10252  12  249 2.224803e-02\n#&gt; 1103 rs10257  12  254 2.299767e-02\n#&gt; 1104 rs10258  12  255 2.845704e-02\n#&gt; 1105 rs10261  12  258 2.619451e-02\n#&gt; 1106 rs10262  12  259 9.432321e-02\n#&gt; 1107 rs10265  12  262 7.538115e-02\n#&gt; 1108 rs10277  12  274 8.530846e-02\n#&gt; 1109 rs10280  12  277 9.260661e-02\n#&gt; 1110 rs10301  12  298 4.759564e-02\n#&gt; 1111 rs10312  12  309 6.466057e-02\n#&gt; 1112 rs10334  12  331 6.314054e-02\n#&gt; 1113 rs10367  12  364 8.741728e-02\n#&gt; 1114 rs10371  12  368 5.327909e-02\n#&gt; 1115 rs10400  12  397 4.659664e-02\n#&gt; 1116 rs10412  12  409 7.352091e-02\n#&gt; 1117 rs10423  12  420 8.703583e-03\n#&gt; 1118 rs10467  12  464 8.185302e-02\n#&gt; 1119 rs10480  12  477 2.556460e-02\n#&gt; 1120 rs10484  12  481 8.066562e-02\n#&gt; 1121 rs10485  12  482 9.448362e-02\n#&gt; 1122 rs10501  12  498 3.498503e-03\n#&gt; 1123 rs10506  12  503 8.931485e-02\n#&gt; 1124 rs10520  12  517 5.013695e-02\n#&gt; 1125 rs10539  12  536 4.830683e-02\n#&gt; 1126 rs10551  12  548 9.602252e-02\n#&gt; 1127 rs10554  12  551 8.555726e-03\n#&gt; 1128 rs10557  12  554 7.867837e-03\n#&gt; 1129 rs10580  12  577 6.788112e-02\n#&gt; 1130 rs10590  12  587 1.834802e-02\n#&gt; 1131 rs10592  12  589 8.711643e-03\n#&gt; 1132 rs10596  12  593 3.518259e-02\n#&gt; 1133 rs10606  12  603 1.885627e-03\n#&gt; 1134 rs10628  12  625 1.529471e-03\n#&gt; 1135 rs10642  12  639 1.249701e-02\n#&gt; 1136 rs10643  12  640 2.287021e-02\n#&gt; 1137 rs10649  12  646 7.753271e-02\n#&gt; 1138 rs10658  12  655 4.082940e-02\n#&gt; 1139 rs10662  13    4 1.303544e-02\n#&gt; 1140 rs10673  13   15 6.104799e-02\n#&gt; 1141 rs10674  13   16 1.900489e-02\n#&gt; 1142 rs10693  13   35 1.071410e-02\n#&gt; 1143 rs10699  13   41 2.579266e-03\n#&gt; 1144 rs10701  13   43 1.738377e-02\n#&gt; 1145 rs10703  13   45 4.395836e-02\n#&gt; 1146 rs10711  13   53 7.781518e-02\n#&gt; 1147 rs10730  13   72 5.057753e-03\n#&gt; 1148 rs10732  13   74 7.490017e-02\n#&gt; 1149 rs10751  13   93 3.108833e-02\n#&gt; 1150 rs10768  13  110 3.322501e-03\n#&gt; 1151 rs10775  13  117 4.020279e-02\n#&gt; 1152 rs10800  13  142 8.698189e-02\n#&gt; 1153 rs10805  13  147 5.834921e-02\n#&gt; 1154 rs10812  13  154 1.581545e-02\n#&gt; 1155 rs10818  13  160 1.706292e-03\n#&gt; 1156 rs10821  13  163 2.578165e-02\n#&gt; 1157 rs10839  13  181 3.346920e-02\n#&gt; 1158 rs10841  13  183 5.984504e-02\n#&gt; 1159 rs10861  13  203 5.867545e-02\n#&gt; 1160 rs10862  13  204 7.687031e-02\n#&gt; 1161 rs10879  13  221 9.138966e-02\n#&gt; 1162 rs10881  13  223 7.038591e-02\n#&gt; 1163 rs10901  13  243 8.750876e-02\n#&gt; 1164 rs10906  13  248 4.894543e-02\n#&gt; 1165 rs10915  13  257 2.632114e-02\n#&gt; 1166 rs10920  13  262 2.041161e-02\n#&gt; 1167 rs10928  13  270 8.579342e-02\n#&gt; 1168 rs10930  13  272 3.715328e-02\n#&gt; 1169 rs10940  13  282 3.576043e-02\n#&gt; 1170 rs10950  13  292 6.898016e-02\n#&gt; 1171 rs10952  13  294 8.876768e-02\n#&gt; 1172 rs10960  13  302 5.471805e-02\n#&gt; 1173 rs10971  13  313 8.642185e-02\n#&gt; 1174 rs10979  13  321 9.790366e-02\n#&gt; 1175 rs10992  13  334 3.321693e-02\n#&gt; 1176 rs11015  13  357 5.171180e-02\n#&gt; 1177 rs11016  13  358 3.390364e-02\n#&gt; 1178 rs11024  13  366 1.466961e-02\n#&gt; 1179 rs11048  13  390 5.235629e-02\n#&gt; 1180 rs11049  13  391 7.820551e-02\n#&gt; 1181 rs11069  13  411 7.740766e-02\n#&gt; 1182 rs11082  13  424 7.577679e-02\n#&gt; 1183 rs11101  13  443 1.906800e-02\n#&gt; 1184 rs11102  13  444 6.353813e-02\n#&gt; 1185 rs11103  13  445 8.124867e-02\n#&gt; 1186 rs11106  13  448 8.190884e-02\n#&gt; 1187 rs11110  13  452 2.679336e-03\n#&gt; 1188 rs11124  13  466 9.115981e-02\n#&gt; 1189 rs11142  13  484 3.241911e-02\n#&gt; 1190 rs11148  13  490 3.472484e-03\n#&gt; 1191 rs11157  13  499 4.850992e-02\n#&gt; 1192 rs11166  13  508 5.634653e-03\n#&gt; 1193 rs11169  13  511 8.966785e-02\n#&gt; 1194 rs11171  13  513 5.527596e-02\n#&gt; 1195 rs11173  13  515 4.868534e-02\n#&gt; 1196 rs11180  13  522 3.275657e-02\n#&gt; 1197 rs11218  13  560 8.371385e-02\n#&gt; 1198 rs11222  13  564 6.188614e-02\n#&gt; 1199 rs11234  13  576 2.232639e-03\n#&gt; 1200 rs11247  13  589 8.527811e-02\n#&gt; 1201 rs11253  13  595 3.609499e-02\n#&gt; 1202 rs11266  13  608 8.495827e-02\n#&gt; 1203 rs11267  13  609 3.470666e-02\n#&gt; 1204 rs11285  13  627 5.219814e-02\n#&gt; 1205 rs11295  13  637 7.900884e-02\n#&gt; 1206 rs11312  14   16 9.396065e-03\n#&gt; 1207 rs11327  14   31 2.808920e-02\n#&gt; 1208 rs11337  14   41 7.251478e-03\n#&gt; 1209 rs11352  14   56 4.326569e-02\n#&gt; 1210 rs11361  14   65 7.145285e-02\n#&gt; 1211 rs11363  14   67 3.174181e-02\n#&gt; 1212 rs11387  14   91 3.112824e-02\n#&gt; 1213 rs11394  14   98 1.524199e-02\n#&gt; 1214 rs11397  14  101 4.024617e-02\n#&gt; 1215 rs11405  14  109 6.685551e-02\n#&gt; 1216 rs11439  14  143 2.551815e-02\n#&gt; 1217 rs11459  14  163 1.710093e-02\n#&gt; 1218 rs11464  14  168 4.255194e-03\n#&gt; 1219 rs11465  14  169 8.685978e-02\n#&gt; 1220 rs11483  14  187 5.437262e-02\n#&gt; 1221 rs11493  14  197 2.063727e-02\n#&gt; 1222 rs11512  14  216 2.007672e-02\n#&gt; 1223 rs11513  14  217 3.424736e-02\n#&gt; 1224 rs11515  14  219 4.359712e-02\n#&gt; 1225 rs11522  14  226 6.400204e-02\n#&gt; 1226 rs11526  14  230 7.268763e-03\n#&gt; 1227 rs11535  14  239 3.335203e-02\n#&gt; 1228 rs11542  14  246 5.787598e-02\n#&gt; 1229 rs11546  14  250 1.429985e-02\n#&gt; 1230 rs11547  14  251 9.035047e-02\n#&gt; 1231 rs11550  14  254 6.487444e-02\n#&gt; 1232 rs11557  14  261 1.205469e-02\n#&gt; 1233 rs11558  14  262 6.498212e-02\n#&gt; 1234 rs11563  14  267 9.621482e-02\n#&gt; 1235 rs11570  14  274 1.414620e-02\n#&gt; 1236 rs11584  14  288 7.708364e-02\n#&gt; 1237 rs11588  14  292 1.860527e-02\n#&gt; 1238 rs11590  14  294 6.899542e-02\n#&gt; 1239 rs11594  14  298 6.734286e-02\n#&gt; 1240 rs11608  14  312 8.217304e-02\n#&gt; 1241 rs11617  14  321 8.148882e-02\n#&gt; 1242 rs11622  14  326 8.034711e-02\n#&gt; 1243 rs11633  14  337 5.365766e-02\n#&gt; 1244 rs11645  14  349 2.073307e-02\n#&gt; 1245 rs11648  14  352 1.991079e-02\n#&gt; 1246 rs11651  14  355 2.801043e-02\n#&gt; 1247 rs11652  14  356 3.495249e-02\n#&gt; 1248 rs11660  14  364 5.134950e-02\n#&gt; 1249 rs11672  14  376 4.746238e-02\n#&gt; 1250 rs11677  14  381 1.517544e-02\n#&gt; 1251 rs11691  14  395 6.227392e-02\n#&gt; 1252 rs11700  14  404 6.484826e-02\n#&gt; 1253 rs11709  14  413 2.719559e-02\n#&gt; 1254 rs11715  14  419 4.465535e-02\n#&gt; 1255 rs11737  14  441 8.714120e-02\n#&gt; 1256 rs11738  14  442 9.777850e-02\n#&gt; 1257 rs11742  14  446 2.567733e-02\n#&gt; 1258 rs11751  14  455 4.658951e-02\n#&gt; 1259 rs11753  14  457 6.971775e-02\n#&gt; 1260 rs11762  14  466 2.164137e-02\n#&gt; 1261 rs11765  14  469 6.634399e-02\n#&gt; 1262 rs11768  14  472 5.747584e-02\n#&gt; 1263 rs11770  14  474 5.951427e-02\n#&gt; 1264 rs11771  14  475 8.984920e-02\n#&gt; 1265 rs11780  14  484 6.204778e-02\n#&gt; 1266 rs11782  14  486 8.338349e-02\n#&gt; 1267 rs11783  14  487 4.542726e-02\n#&gt; 1268 rs11790  14  494 5.265989e-02\n#&gt; 1269 rs11805  14  509 1.803514e-02\n#&gt; 1270 rs11814  14  518 3.894446e-02\n#&gt; 1271 rs11829  14  533 1.798451e-02\n#&gt; 1272 rs11831  14  535 3.081615e-02\n#&gt; 1273 rs11842  14  546 1.291214e-02\n#&gt; 1274 rs11846  14  550 4.936848e-05\n#&gt; 1275 rs11865  14  569 4.287131e-02\n#&gt; 1276 rs11878  14  582 1.351113e-02\n#&gt; 1277 rs11885  14  589 3.784845e-02\n#&gt; 1278 rs11893  14  597 8.307776e-02\n#&gt; 1279 rs11897  14  601 9.235466e-02\n#&gt; 1280 rs11898  14  602 7.576714e-02\n#&gt; 1281 rs11908  14  612 5.495228e-02\n#&gt; 1282 rs11922  15    4 4.097607e-02\n#&gt; 1283 rs11934  15   16 5.951544e-02\n#&gt; 1284 rs11936  15   18 3.761190e-02\n#&gt; 1285 rs11938  15   20 6.525389e-02\n#&gt; 1286 rs11939  15   21 7.654899e-02\n#&gt; 1287 rs11940  15   22 5.838694e-02\n#&gt; 1288 rs11985  15   67 1.454638e-02\n#&gt; 1289 rs11988  15   70 7.479642e-02\n#&gt; 1290 rs11993  15   75 2.015355e-02\n#&gt; 1291 rs11999  15   81 5.573957e-02\n#&gt; 1292 rs12014  15   96 9.470213e-02\n#&gt; 1293 rs12015  15   97 2.168458e-02\n#&gt; 1294 rs12019  15  101 8.378597e-03\n#&gt; 1295 rs12024  15  106 6.769956e-02\n#&gt; 1296 rs12029  15  111 1.643672e-02\n#&gt; 1297 rs12030  15  112 4.551364e-02\n#&gt; 1298 rs12036  15  118 7.340606e-02\n#&gt; 1299 rs12057  15  139 4.350659e-02\n#&gt; 1300 rs12063  15  145 2.190306e-02\n#&gt; 1301 rs12064  15  146 7.534797e-02\n#&gt; 1302 rs12078  15  160 8.369147e-02\n#&gt; 1303 rs12083  15  165 6.659790e-02\n#&gt; 1304 rs12119  15  201 4.651539e-02\n#&gt; 1305 rs12122  15  204 7.928768e-02\n#&gt; 1306 rs12129  15  211 5.443648e-02\n#&gt; 1307 rs12132  15  214 7.511697e-02\n#&gt; 1308 rs12139  15  221 2.857859e-02\n#&gt; 1309 rs12160  15  242 9.623779e-02\n#&gt; 1310 rs12161  15  243 1.390917e-02\n#&gt; 1311 rs12168  15  250 6.903867e-02\n#&gt; 1312 rs12180  15  262 1.399034e-03\n#&gt; 1313 rs12189  15  271 5.012483e-02\n#&gt; 1314 rs12241  15  323 8.241752e-02\n#&gt; 1315 rs12256  15  338 6.350469e-02\n#&gt; 1316 rs12267  15  349 1.438785e-02\n#&gt; 1317 rs12273  15  355 7.246114e-02\n#&gt; 1318 rs12294  15  376 6.323445e-02\n#&gt; 1319 rs12300  15  382 7.977353e-02\n#&gt; 1320 rs12307  15  389 3.424844e-02\n#&gt; 1321 rs12314  15  396 4.036637e-02\n#&gt; 1322 rs12336  15  418 6.957811e-02\n#&gt; 1323 rs12338  15  420 3.228126e-02\n#&gt; 1324 rs12369  15  451 3.203257e-02\n#&gt; 1325 rs12371  15  453 3.349241e-02\n#&gt; 1326 rs12376  15  458 7.502615e-02\n#&gt; 1327 rs12394  15  476 6.851761e-02\n#&gt; 1328 rs12396  15  478 1.407096e-02\n#&gt; 1329 rs12398  15  480 4.320683e-02\n#&gt; 1330 rs12440  15  522 9.918838e-02\n#&gt; 1331 rs12442  15  524 6.390306e-02\n#&gt; 1332 rs12445  15  527 1.355182e-02\n#&gt; 1333 rs12462  15  544 6.646058e-02\n#&gt; 1334 rs12463  15  545 1.640321e-03\n#&gt; 1335 rs12475  15  557 1.305396e-02\n#&gt; 1336 rs12482  15  564 9.597505e-02\n#&gt; 1337 rs12491  15  573 4.420276e-02\n#&gt; 1338 rs12493  15  575 2.287018e-02\n#&gt; 1339 rs12495  15  577 1.244065e-02\n#&gt; 1340 rs12499  15  581 1.551115e-02\n#&gt; 1341 rs12505  15  587 2.372436e-02\n#&gt; 1342 rs12513  15  595 9.695446e-02\n#&gt; 1343 rs12534  16    8 6.578939e-02\n#&gt; 1344 rs12539  16   13 4.551210e-02\n#&gt; 1345 rs12546  16   20 1.222587e-02\n#&gt; 1346 rs12553  16   27 4.824975e-02\n#&gt; 1347 rs12590  16   64 3.528929e-03\n#&gt; 1348 rs12596  16   70 8.829885e-03\n#&gt; 1349 rs12597  16   71 7.090567e-02\n#&gt; 1350 rs12615  16   89 1.547893e-02\n#&gt; 1351 rs12636  16  110 3.587242e-02\n#&gt; 1352 rs12643  16  117 5.217080e-02\n#&gt; 1353 rs12653  16  127 1.193328e-03\n#&gt; 1354 rs12661  16  135 8.146379e-02\n#&gt; 1355 rs12669  16  143 8.688974e-02\n#&gt; 1356 rs12696  16  170 1.144429e-02\n#&gt; 1357 rs12706  16  180 5.271475e-02\n#&gt; 1358 rs12782  16  256 3.546249e-02\n#&gt; 1359 rs12787  16  261 2.414168e-02\n#&gt; 1360 rs12797  16  271 8.346689e-02\n#&gt; 1361 rs12811  16  285 1.632434e-02\n#&gt; 1362 rs12813  16  287 5.516808e-02\n#&gt; 1363 rs12826  16  300 2.396776e-03\n#&gt; 1364 rs12834  16  308 4.407269e-02\n#&gt; 1365 rs12840  16  314 7.889732e-02\n#&gt; 1366 rs12842  16  316 8.873954e-02\n#&gt; 1367 rs12851  16  325 2.944156e-02\n#&gt; 1368 rs12856  16  330 5.436265e-02\n#&gt; 1369 rs12874  16  348 5.501668e-02\n#&gt; 1370 rs12893  16  367 9.764779e-02\n#&gt; 1371 rs12902  16  376 6.281925e-02\n#&gt; 1372 rs12918  16  392 8.254613e-02\n#&gt; 1373 rs12930  16  404 9.893967e-02\n#&gt; 1374 rs12954  16  428 2.959474e-02\n#&gt; 1375 rs12960  16  434 4.596073e-02\n#&gt; 1376 rs12962  16  436 9.907199e-02\n#&gt; 1377 rs12988  16  462 7.838007e-02\n#&gt; 1378 rs13010  16  484 4.988840e-02\n#&gt; 1379 rs13018  16  492 2.401345e-02\n#&gt; 1380 rs13032  16  506 2.904814e-02\n#&gt; 1381 rs13034  16  508 4.255322e-02\n#&gt; 1382 rs13048  16  522 9.669104e-02\n#&gt; 1383 rs13052  16  526 2.306191e-02\n#&gt; 1384 rs13053  16  527 7.805883e-02\n#&gt; 1385 rs13057  16  531 5.905610e-02\n#&gt; 1386 rs13062  16  536 6.814521e-02\n#&gt; 1387 rs13075  16  549 5.412655e-02\n#&gt; 1388 rs13076  16  550 6.893333e-02\n#&gt; 1389 rs13077  16  551 2.355907e-03\n#&gt; 1390 rs13081  16  555 4.369117e-02\n#&gt; 1391 rs13088  16  562 9.991800e-02\n#&gt; 1392 rs13090  16  564 3.693963e-02\n#&gt; 1393 rs13109  16  583 8.811492e-02\n#&gt; 1394 rs13127  17    6 8.030748e-02\n#&gt; 1395 rs13138  17   17 4.113772e-02\n#&gt; 1396 rs13151  17   30 2.542287e-02\n#&gt; 1397 rs13161  17   40 8.352235e-02\n#&gt; 1398 rs13164  17   43 1.009828e-02\n#&gt; 1399 rs13166  17   45 5.305094e-02\n#&gt; 1400 rs13183  17   62 9.985686e-02\n#&gt; 1401 rs13189  17   68 7.588720e-02\n#&gt; 1402 rs13197  17   76 1.614261e-02\n#&gt; 1403 rs13203  17   82 8.722878e-02\n#&gt; 1404 rs13208  17   87 4.332420e-02\n#&gt; 1405 rs13234  17  113 3.390840e-02\n#&gt; 1406 rs13236  17  115 1.603250e-02\n#&gt; 1407 rs13239  17  118 8.843168e-02\n#&gt; 1408 rs13251  17  130 9.195006e-02\n#&gt; 1409 rs13252  17  131 4.368308e-02\n#&gt; 1410 rs13253  17  132 3.980983e-02\n#&gt; 1411 rs13265  17  144 8.407290e-02\n#&gt; 1412 rs13283  17  162 8.562338e-02\n#&gt; 1413 rs13306  17  185 4.166537e-02\n#&gt; 1414 rs13309  17  188 6.103347e-02\n#&gt; 1415 rs13317  17  196 3.654182e-02\n#&gt; 1416 rs13335  17  214 3.671761e-02\n#&gt; 1417 rs13339  17  218 3.969033e-02\n#&gt; 1418 rs13358  17  237 7.083249e-02\n#&gt; 1419 rs13370  17  249 5.617397e-02\n#&gt; 1420 rs13376  17  255 8.692506e-02\n#&gt; 1421 rs13389  17  268 7.050811e-02\n#&gt; 1422 rs13390  17  269 3.609662e-02\n#&gt; 1423 rs13393  17  272 7.523139e-02\n#&gt; 1424 rs13394  17  273 5.826743e-02\n#&gt; 1425 rs13411  17  290 5.723080e-02\n#&gt; 1426 rs13415  17  294 7.328055e-02\n#&gt; 1427 rs13416  17  295 6.370699e-02\n#&gt; 1428 rs13437  17  316 9.582264e-02\n#&gt; 1429 rs13455  17  334 7.464839e-02\n#&gt; 1430 rs13457  17  336 1.096483e-02\n#&gt; 1431 rs13466  17  345 1.320774e-02\n#&gt; 1432 rs13471  17  350 7.229505e-02\n#&gt; 1433 rs13474  17  353 8.676582e-02\n#&gt; 1434 rs13497  17  376 6.807771e-02\n#&gt; 1435 rs13504  17  383 5.992027e-02\n#&gt; 1436 rs13509  17  388 3.062845e-02\n#&gt; 1437 rs13511  17  390 2.859595e-02\n#&gt; 1438 rs13559  17  438 6.146899e-02\n#&gt; 1439 rs13562  17  441 5.921057e-03\n#&gt; 1440 rs13566  17  445 6.294514e-02\n#&gt; 1441 rs13574  17  453 7.386705e-02\n#&gt; 1442 rs13584  17  463 5.181407e-03\n#&gt; 1443 rs13588  17  467 9.975806e-03\n#&gt; 1444 rs13594  17  473 1.699058e-02\n#&gt; 1445 rs13595  17  474 9.032215e-02\n#&gt; 1446 rs13600  17  479 9.467675e-02\n#&gt; 1447 rs13620  17  499 8.009523e-02\n#&gt; 1448 rs13624  17  503 7.772530e-02\n#&gt; 1449 rs13625  17  504 8.762206e-02\n#&gt; 1450 rs13640  17  519 9.769497e-03\n#&gt; 1451 rs13649  17  528 8.338629e-02\n#&gt; 1452 rs13658  17  537 8.107562e-03\n#&gt; 1453 rs13674  17  553 1.782238e-02\n#&gt; 1454 rs13675  17  554 6.982985e-02\n#&gt; 1455 rs13678  17  557 1.880987e-02\n#&gt; 1456 rs13704  17  583 6.657583e-02\n#&gt; 1457 rs13713  18    9 3.987945e-02\n#&gt; 1458 rs13727  18   23 5.928547e-02\n#&gt; 1459 rs13738  18   34 2.484522e-02\n#&gt; 1460 rs13741  18   37 3.784149e-02\n#&gt; 1461 rs13743  18   39 4.789521e-02\n#&gt; 1462 rs13755  18   51 8.607674e-02\n#&gt; 1463 rs13756  18   52 1.749129e-02\n#&gt; 1464 rs13799  18   95 2.958386e-02\n#&gt; 1465 rs13819  18  115 8.113249e-02\n#&gt; 1466 rs13851  18  147 4.611380e-02\n#&gt; 1467 rs13879  18  175 9.441020e-02\n#&gt; 1468 rs13883  18  179 6.501477e-02\n#&gt; 1469 rs13886  18  182 1.230507e-02\n#&gt; 1470 rs13889  18  185 1.856426e-02\n#&gt; 1471 rs13893  18  189 8.795726e-02\n#&gt; 1472 rs13895  18  191 2.635363e-05\n#&gt; 1473 rs13933  18  229 1.246628e-02\n#&gt; 1474 rs13970  18  266 9.499267e-02\n#&gt; 1475 rs13980  18  276 3.796261e-02\n#&gt; 1476 rs13994  18  290 2.583213e-02\n#&gt; 1477 rs14002  18  298 2.544768e-02\n#&gt; 1478 rs14004  18  300 8.098793e-02\n#&gt; 1479 rs14008  18  304 1.166095e-02\n#&gt; 1480 rs14017  18  313 1.363759e-02\n#&gt; 1481 rs14028  18  324 6.496016e-02\n#&gt; 1482 rs14030  18  326 4.941198e-02\n#&gt; 1483 rs14034  18  330 4.082824e-02\n#&gt; 1484 rs14060  18  356 9.210920e-02\n#&gt; 1485 rs14062  18  358 5.771835e-02\n#&gt; 1486 rs14074  18  370 2.723303e-02\n#&gt; 1487 rs14108  18  404 3.112729e-03\n#&gt; 1488 rs14112  18  408 3.309621e-02\n#&gt; 1489 rs14121  18  417 5.107271e-02\n#&gt; 1490 rs14122  18  418 1.912150e-02\n#&gt; 1491 rs14123  18  419 5.881144e-02\n#&gt; 1492 rs14125  18  421 9.922088e-02\n#&gt; 1493 rs14128  18  424 1.451298e-02\n#&gt; 1494 rs14134  18  430 1.083796e-02\n#&gt; 1495 rs14167  18  463 4.746614e-02\n#&gt; 1496 rs14170  18  466 6.164637e-02\n#&gt; 1497 rs14178  18  474 6.586615e-02\n#&gt; 1498 rs14183  18  479 5.990549e-02\n#&gt; 1499 rs14190  18  486 5.970606e-02\n#&gt; 1500 rs14194  18  490 1.879751e-02\n#&gt; 1501 rs14199  18  495 3.290143e-02\n#&gt; 1502 rs14206  18  502 5.727454e-02\n#&gt; 1503 rs14214  18  510 1.473096e-02\n#&gt; 1504 rs14224  18  520 3.604159e-02\n#&gt; 1505 rs14225  18  521 3.017225e-02\n#&gt; 1506 rs14230  18  526 2.284826e-02\n#&gt; 1507 rs14239  18  535 9.484229e-02\n#&gt; 1508 rs14250  18  546 7.187401e-02\n#&gt; 1509 rs14256  18  552 9.458564e-02\n#&gt; 1510 rs14294  19   18 1.319478e-02\n#&gt; 1511 rs14307  19   31 7.652525e-02\n#&gt; 1512 rs14329  19   53 3.158531e-02\n#&gt; 1513 rs14332  19   56 7.916879e-02\n#&gt; 1514 rs14339  19   63 8.813967e-02\n#&gt; 1515 rs14370  19   94 8.689296e-04\n#&gt; 1516 rs14381  19  105 2.111789e-02\n#&gt; 1517 rs14386  19  110 5.615152e-02\n#&gt; 1518 rs14390  19  114 2.779058e-02\n#&gt; 1519 rs14393  19  117 3.517738e-02\n#&gt; 1520 rs14394  19  118 6.697866e-03\n#&gt; 1521 rs14395  19  119 6.254848e-02\n#&gt; 1522 rs14397  19  121 3.173696e-03\n#&gt; 1523 rs14399  19  123 2.516706e-02\n#&gt; 1524 rs14404  19  128 6.103528e-02\n#&gt; 1525 rs14414  19  138 2.842787e-02\n#&gt; 1526 rs14421  19  145 7.619073e-02\n#&gt; 1527 rs14423  19  147 9.025703e-04\n#&gt; 1528 rs14424  19  148 9.951613e-02\n#&gt; 1529 rs14427  19  151 4.544287e-02\n#&gt; 1530 rs14436  19  160 5.933716e-02\n#&gt; 1531 rs14458  19  182 4.298347e-02\n#&gt; 1532 rs14463  19  187 2.042671e-02\n#&gt; 1533 rs14468  19  192 7.930906e-02\n#&gt; 1534 rs14481  19  205 9.263075e-02\n#&gt; 1535 rs14486  19  210 4.349619e-02\n#&gt; 1536 rs14503  19  227 6.225460e-03\n#&gt; 1537 rs14506  19  230 7.863530e-02\n#&gt; 1538 rs14508  19  232 8.362519e-02\n#&gt; 1539 rs14529  19  253 7.812913e-02\n#&gt; 1540 rs14532  19  256 4.883187e-02\n#&gt; 1541 rs14533  19  257 1.057508e-02\n#&gt; 1542 rs14542  19  266 1.360825e-02\n#&gt; 1543 rs14554  19  278 4.132919e-02\n#&gt; 1544 rs14566  19  290 4.829259e-02\n#&gt; 1545 rs14595  19  319 2.112547e-02\n#&gt; 1546 rs14611  19  335 7.112113e-02\n#&gt; 1547 rs14614  19  338 4.035994e-02\n#&gt; 1548 rs14650  19  374 6.026418e-02\n#&gt; 1549 rs14660  19  384 5.959760e-02\n#&gt; 1550 rs14670  19  394 4.738634e-02\n#&gt; 1551 rs14691  19  415 8.039503e-02\n#&gt; 1552 rs14693  19  417 8.632244e-02\n#&gt; 1553 rs14698  19  422 7.000041e-02\n#&gt; 1554 rs14707  19  431 4.369785e-03\n#&gt; 1555 rs14711  19  435 5.615490e-02\n#&gt; 1556 rs14717  19  441 2.628069e-02\n#&gt; 1557 rs14727  19  451 7.704854e-02\n#&gt; 1558 rs14740  19  464 5.401279e-02\n#&gt; 1559 rs14741  19  465 5.351566e-02\n#&gt; 1560 rs14745  19  469 5.611503e-02\n#&gt; 1561 rs14755  19  479 1.509131e-02\n#&gt; 1562 rs14766  19  490 1.342497e-02\n#&gt; 1563 rs14767  19  491 1.654801e-02\n#&gt; 1564 rs14783  19  507 3.499514e-02\n#&gt; 1565 rs14792  19  516 7.576240e-02\n#&gt; 1566 rs14793  19  517 5.542427e-02\n#&gt; 1567 rs14794  19  518 5.799759e-02\n#&gt; 1568 rs14795  19  519 9.625518e-02\n#&gt; 1569 rs14823  19  547 9.789560e-02\n#&gt; 1570 rs14837  19  561 7.343823e-02\n#&gt; 1571 rs14840  20    2 9.513726e-02\n#&gt; 1572 rs14900  20   62 7.981769e-02\n#&gt; 1573 rs14958  20  120 8.951194e-02\n#&gt; 1574 rs14959  20  121 1.013291e-02\n#&gt; 1575 rs14962  20  124 3.737797e-02\n#&gt; 1576 rs14967  20  129 9.721775e-02\n#&gt; 1577 rs14970  20  132 8.069855e-02\n#&gt; 1578 rs14971  20  133 2.632993e-02\n#&gt; 1579 rs14977  20  139 3.215510e-02\n#&gt; 1580 rs14978  20  140 5.139359e-02\n#&gt; 1581 rs14984  20  146 1.403179e-02\n#&gt; 1582 rs15005  20  167 1.461812e-02\n#&gt; 1583 rs15010  20  172 4.044127e-02\n#&gt; 1584 rs15018  20  180 9.537098e-02\n#&gt; 1585 rs15022  20  184 4.161909e-02\n#&gt; 1586 rs15023  20  185 3.872972e-02\n#&gt; 1587 rs15040  20  202 8.813349e-02\n#&gt; 1588 rs15041  20  203 3.239934e-02\n#&gt; 1589 rs15064  20  226 2.890567e-02\n#&gt; 1590 rs15082  20  244 7.078094e-02\n#&gt; 1591 rs15084  20  246 6.865745e-02\n#&gt; 1592 rs15090  20  252 2.188220e-02\n#&gt; 1593 rs15110  20  272 1.588284e-02\n#&gt; 1594 rs15112  20  274 4.142612e-03\n#&gt; 1595 rs15114  20  276 2.360979e-02\n#&gt; 1596 rs15120  20  282 9.639074e-02\n#&gt; 1597 rs15125  20  287 3.979717e-03\n#&gt; 1598 rs15129  20  291 6.985883e-02\n#&gt; 1599 rs15132  20  294 3.831572e-02\n#&gt; 1600 rs15137  20  299 4.966975e-02\n#&gt; 1601 rs15142  20  304 9.819743e-03\n#&gt; 1602 rs15146  20  308 7.041263e-02\n#&gt; 1603 rs15150  20  312 4.023905e-02\n#&gt; 1604 rs15151  20  313 8.357261e-03\n#&gt; 1605 rs15158  20  320 8.804814e-02\n#&gt; 1606 rs15167  20  329 8.706697e-02\n#&gt; 1607 rs15172  20  334 7.134224e-02\n#&gt; 1608 rs15197  20  359 8.756456e-02\n#&gt; 1609 rs15202  20  364 3.722129e-02\n#&gt; 1610 rs15216  20  378 3.901060e-03\n#&gt; 1611 rs15219  20  381 1.298772e-02\n#&gt; 1612 rs15234  20  396 7.607634e-04\n#&gt; 1613 rs15242  20  404 3.491891e-02\n#&gt; 1614 rs15243  20  405 1.066645e-02\n#&gt; 1615 rs15247  20  409 9.875242e-02\n#&gt; 1616 rs15262  20  424 7.101047e-02\n#&gt; 1617 rs15266  20  428 9.502499e-02\n#&gt; 1618 rs15267  20  429 3.379169e-02\n#&gt; 1619 rs15271  20  433 2.739344e-02\n#&gt; 1620 rs15274  20  436 2.125259e-02\n#&gt; 1621 rs15277  20  439 2.859145e-02\n#&gt; 1622 rs15279  20  441 8.483595e-02\n#&gt; 1623 rs15290  20  452 7.184976e-02\n#&gt; 1624 rs15294  20  456 2.487835e-02\n#&gt; 1625 rs15298  20  460 3.144799e-02\n#&gt; 1626 rs15300  20  462 3.783566e-02\n#&gt; 1627 rs15313  20  475 4.292859e-02\n#&gt; 1628 rs15321  20  483 6.265528e-02\n#&gt; 1629 rs15324  20  486 6.641153e-02\n#&gt; 1630 rs15331  20  493 3.921165e-02\n#&gt; 1631 rs15340  20  502 7.536729e-02\n#&gt; 1632 rs15345  20  507 4.461951e-02\n#&gt; 1633 rs15359  20  521 7.528153e-02\n#&gt; 1634 rs15361  20  523 3.029918e-02\n#&gt; 1635 rs15362  20  524 8.756973e-02\n#&gt; 1636 rs15364  20  526 7.738870e-02\n#&gt; 1637 rs15365  20  527 9.229441e-02\n#&gt; 1638 rs15385  20  547 9.035579e-02\n#&gt; 1639 rs15390  20  552 4.267381e-02\n#&gt; 1640 rs15393  21    2 5.623161e-02\n#&gt; 1641 rs15407  21   16 2.383579e-02\n#&gt; 1642 rs15416  21   25 1.125735e-02\n#&gt; 1643 rs15429  21   38 3.595454e-02\n#&gt; 1644 rs15446  21   55 1.863847e-02\n#&gt; 1645 rs15464  21   73 3.969467e-02\n#&gt; 1646 rs15467  21   76 8.883276e-02\n#&gt; 1647 rs15478  21   87 6.556727e-02\n#&gt; 1648 rs15488  21   97 3.649836e-02\n#&gt; 1649 rs15511  21  120 9.182315e-02\n#&gt; 1650 rs15512  21  121 1.556460e-02\n#&gt; 1651 rs15527  21  136 7.462456e-02\n#&gt; 1652 rs15534  21  143 4.836111e-02\n#&gt; 1653 rs15537  21  146 6.937977e-03\n#&gt; 1654 rs15542  21  151 2.949569e-02\n#&gt; 1655 rs15545  21  154 9.909945e-02\n#&gt; 1656 rs15548  21  157 3.239926e-02\n#&gt; 1657 rs15555  21  164 4.921835e-02\n#&gt; 1658 rs15568  21  177 4.484399e-02\n#&gt; 1659 rs15572  21  181 7.845561e-02\n#&gt; 1660 rs15575  21  184 9.653500e-02\n#&gt; 1661 rs15576  21  185 3.834557e-02\n#&gt; 1662 rs15584  21  193 8.191611e-03\n#&gt; 1663 rs15585  21  194 1.718798e-02\n#&gt; 1664 rs15598  21  207 1.808212e-02\n#&gt; 1665 rs15603  21  212 9.476088e-02\n#&gt; 1666 rs15605  21  214 2.593115e-02\n#&gt; 1667 rs15610  21  219 4.423131e-02\n#&gt; 1668 rs15617  21  226 5.029603e-02\n#&gt; 1669 rs15618  21  227 8.723675e-02\n#&gt; 1670 rs15619  21  228 4.115996e-02\n#&gt; 1671 rs15635  21  244 5.935206e-02\n#&gt; 1672 rs15636  21  245 8.894198e-02\n#&gt; 1673 rs15640  21  249 9.389025e-02\n#&gt; 1674 rs15643  21  252 5.854497e-02\n#&gt; 1675 rs15689  21  298 5.771967e-02\n#&gt; 1676 rs15693  21  302 3.991951e-02\n#&gt; 1677 rs15696  21  305 7.933215e-02\n#&gt; 1678 rs15706  21  315 5.818867e-02\n#&gt; 1679 rs15717  21  326 6.017031e-03\n#&gt; 1680 rs15720  21  329 4.200974e-02\n#&gt; 1681 rs15724  21  333 4.036912e-02\n#&gt; 1682 rs15727  21  336 5.517203e-02\n#&gt; 1683 rs15739  21  348 3.418152e-02\n#&gt; 1684 rs15742  21  351 3.385077e-02\n#&gt; 1685 rs15760  21  369 8.820179e-02\n#&gt; 1686 rs15761  21  370 1.031227e-03\n#&gt; 1687 rs15762  21  371 6.078251e-02\n#&gt; 1688 rs15771  21  380 9.294561e-02\n#&gt; 1689 rs15775  21  384 5.742955e-02\n#&gt; 1690 rs15806  21  415 1.972292e-02\n#&gt; 1691 rs15810  21  419 6.305184e-02\n#&gt; 1692 rs15830  21  439 1.982435e-02\n#&gt; 1693 rs15847  21  456 8.990336e-02\n#&gt; 1694 rs15853  21  462 1.122852e-02\n#&gt; 1695 rs15860  21  469 3.301252e-04\n#&gt; 1696 rs15861  21  470 1.666895e-02\n#&gt; 1697 rs15867  21  476 4.378308e-02\n#&gt; 1698 rs15868  21  477 9.290044e-02\n#&gt; 1699 rs15869  21  478 7.252759e-02\n#&gt; 1700 rs15879  21  488 8.411901e-02\n#&gt; 1701 rs15883  21  492 7.125000e-02\n#&gt; 1702 rs15897  21  506 1.088033e-02\n#&gt; 1703 rs15933  21  542 2.841070e-02\n#&gt; 1704 rs15939  22    4 3.464638e-02\n#&gt; 1705 rs15945  22   10 3.559850e-02\n#&gt; 1706 rs15947  22   12 4.355227e-02\n#&gt; 1707 rs15958  22   23 7.381501e-02\n#&gt; 1708 rs15961  22   26 3.649837e-02\n#&gt; 1709 rs15974  22   39 1.081636e-02\n#&gt; 1710 rs15976  22   41 4.358662e-02\n#&gt; 1711 rs15984  22   49 9.546431e-02\n#&gt; 1712 rs15998  22   63 2.723473e-02\n#&gt; 1713 rs16000  22   65 9.414189e-02\n#&gt; 1714 rs16005  22   70 6.373411e-02\n#&gt; 1715 rs16019  22   84 7.170570e-02\n#&gt; 1716 rs16030  22   95 2.604146e-02\n#&gt; 1717 rs16032  22   97 4.855842e-02\n#&gt; 1718 rs16059  22  124 7.302468e-02\n#&gt; 1719 rs16063  22  128 2.308229e-02\n#&gt; 1720 rs16069  22  134 4.698516e-02\n#&gt; 1721 rs16074  22  139 1.978708e-03\n#&gt; 1722 rs16080  22  145 4.737134e-02\n#&gt; 1723 rs16109  22  174 3.055703e-02\n#&gt; 1724 rs16116  22  181 6.392549e-02\n#&gt; 1725 rs16125  22  190 6.356464e-02\n#&gt; 1726 rs16129  22  194 1.491354e-02\n#&gt; 1727 rs16133  22  198 5.502866e-02\n#&gt; 1728 rs16137  22  202 3.020322e-02\n#&gt; 1729 rs16138  22  203 8.123714e-02\n#&gt; 1730 rs16143  22  208 5.819620e-02\n#&gt; 1731 rs16145  22  210 5.766160e-03\n#&gt; 1732 rs16155  22  220 4.033747e-02\n#&gt; 1733 rs16171  22  236 5.854746e-02\n#&gt; 1734 rs16184  22  249 7.139505e-02\n#&gt; 1735 rs16192  22  257 1.260301e-02\n#&gt; 1736 rs16199  22  264 7.406773e-02\n#&gt; 1737 rs16208  22  273 7.709049e-02\n#&gt; 1738 rs16211  22  276 5.925322e-02\n#&gt; 1739 rs16213  22  278 8.324015e-02\n#&gt; 1740 rs16220  22  285 8.194732e-02\n#&gt; 1741 rs16234  22  299 5.641565e-03\n#&gt; 1742 rs16238  22  303 6.814659e-02\n#&gt; 1743 rs16256  22  321 3.223118e-02\n#&gt; 1744 rs16271  22  336 7.454258e-02\n#&gt; 1745 rs16289  22  354 9.047898e-03\n#&gt; 1746 rs16299  22  364 7.992222e-02\n#&gt; 1747 rs16330  22  395 1.316748e-02\n#&gt; 1748 rs16333  22  398 5.784423e-02\n#&gt; 1749 rs16354  22  419 7.545565e-02\n#&gt; 1750 rs16357  22  422 2.876993e-02\n#&gt; 1751 rs16358  22  423 5.968673e-02\n#&gt; 1752 rs16368  22  433 9.936380e-02\n#&gt; 1753 rs16388  22  453 5.229186e-02\n#&gt; 1754 rs16426  22  491 5.462456e-02\n#&gt; 1755 rs16432  22  497 8.161896e-02\n#&gt; 1756 rs16435  22  500 6.257421e-02\n#&gt; 1757 rs16451  22  516 7.175417e-02\n#&gt; 1758 rs16458  22  523 2.301151e-02\n#&gt; 1759 rs16461  22  526 5.647201e-02\n\n\n\nCodelibrary(plotly)\n\n# Prepare the dataset\ndon &lt;- gwasResults %&gt;% \n  \n  # Compute chromosome size\n  group_by(CHR) %&gt;% \n  summarise(chr_len=max(BP)) %&gt;% \n  \n  # Calculate cumulative position of each chromosome\n  mutate(tot=cumsum(chr_len)-chr_len) %&gt;%\n  select(-chr_len) %&gt;%\n  \n  # Add this info to the initial dataset\n  left_join(gwasResults, ., by=c(\"CHR\"=\"CHR\")) %&gt;%\n  \n  # Add a cumulative position of each SNP\n  arrange(CHR, BP) %&gt;%\n  mutate( BPcum=BP+tot) %&gt;%\n\n  # Add highlight and annotation information\n  mutate( is_highlight=ifelse(SNP %in% snpsOfInterest, \"yes\", \"no\")) %&gt;%\n\n  # Filter SNP to make the plot lighter\n  filter(-log10(P)&gt;0.5)\n  \n# Prepare X axis\naxisdf &lt;- don %&gt;% group_by(CHR) %&gt;% summarize(center=( max(BPcum) + min(BPcum) ) / 2 )\n\n# Prepare text description for each SNP:\ndon$text &lt;- paste(\"SNP: \", don$SNP, \"\\nPosition: \", don$BP, \"\\nChromosome: \", don$CHR, \"\\nLOD score:\", -log10(don$P) %&gt;% round(2), \"\\nWhat else do you wanna know\", sep=\"\")\n\n# Make the plot\np &lt;- ggplot(don, aes(x=BPcum, y=-log10(P), text=text)) +\n    \n    # Show all points\n    geom_point( aes(color=as.factor(CHR)), alpha=0.8, size=1.3) +\n    scale_color_manual(values = rep(c(\"grey\", \"skyblue\"), 22 )) +\n    \n    # custom X axis:\n    scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +\n    scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis\n    ylim(0,9) +\n\n    # Add highlighted points\n    geom_point(data=subset(don, is_highlight==\"yes\"), color=\"orange\", size=2) +\n  \n    # Custom the theme:\n    theme_bw() +\n    theme( \n      legend.position=\"none\",\n      panel.border = element_blank(),\n      panel.grid.major.x = element_blank(),\n      panel.grid.minor.x = element_blank()\n    )\n#&gt; Scale for y is already present.\n#&gt; Adding another scale for y, which will replace the existing scale.\np = ggplotly(p, tooltip=\"text\")\np",
    "crumbs": [
      "ggplot2 图形",
      "点线图",
      "曼哈顿图"
    ]
  },
  {
    "objectID": "曼哈顿图.html#cmplot-的环形版本",
    "href": "曼哈顿图.html#cmplot-的环形版本",
    "title": "",
    "section": "\n1.4 CMplot 的环形版本",
    "text": "1.4 CMplot 的环形版本\n\nCodelibrary(\"CMplot\")\n#&gt; Much appreciate for using CMplot.\n#&gt; Full description, Bug report, Suggestion and the latest codes:\n#&gt; https://github.com/YinLiLin/CMplot",
    "crumbs": [
      "ggplot2 图形",
      "点线图",
      "曼哈顿图"
    ]
  },
  {
    "objectID": "点图.html",
    "href": "点图.html",
    "title": "",
    "section": "",
    "text": "点线图点图 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "点线图",
      "点图"
    ]
  },
  {
    "objectID": "点图.html#geom_dotplot",
    "href": "点图.html#geom_dotplot",
    "title": "",
    "section": "\n1.1 geom_dotplot()\n",
    "text": "1.1 geom_dotplot()\n\n\nCodelibrary(tidyverse)\nlibrary(ggpubr)\nggplot(mtcars,aes(mpg))+\n    geom_dotplot()\n#&gt; Bin width defaults to 1/30 of the range of the data. Pick better value with\n#&gt; `binwidth`.\n\n\n\n\n\n\n\n\nCode# 将数值型变量转换为因子\nToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)\nhead(ToothGrowth)\n#&gt;    len supp dose\n#&gt; 1  4.2   VC  0.5\n#&gt; 2 11.5   VC  0.5\n#&gt; 3  7.3   VC  0.5\n#&gt; 4  5.8   VC  0.5\n#&gt; 5  6.4   VC  0.5\n#&gt; 6 10.0   VC  0.5\nlibrary(ggplot2)\n# 基础点图\np1 &lt;- ggplot(ToothGrowth, aes(x=dose, y=len)) + \n  geom_dotplot(binaxis='y', stackdir='center')\n# 更改点尺寸和堆叠率\np2 &lt;- ggplot(ToothGrowth, aes(x=dose, y=len)) + \n  geom_dotplot(binaxis='y', stackdir='center',\n               stackratio=1.5, dotsize=1.2)\n# 旋转\np3 &lt;- p1 + coord_flip()\n# 选择展示数据\np4 &lt;- p1 + scale_x_discrete(limits=c(\"0.5\", \"2\"))\nggarrange(p1,p2,p3,p4,nrow = 1)\n#&gt; Bin width defaults to 1/30 of the range of the data. Pick better value with\n#&gt; `binwidth`.\n#&gt; Bin width defaults to 1/30 of the range of the data. Pick better value with\n#&gt; `binwidth`.\n#&gt; Bin width defaults to 1/30 of the range of the data. Pick better value with\n#&gt; `binwidth`.\n#&gt; Bin width defaults to 1/30 of the range of the data. Pick better value with\n#&gt; `binwidth`.\n#&gt; Warning: Removed 20 rows containing missing values or values outside the scale range\n#&gt; (`stat_bindot()`).\n\n\n\n\n\n\n\n\nCode# 在点图上添加摘要统计信息 stat_summary()\n# 添加平均值和中位数\np5 &lt;- p1 + stat_summary(fun.y=mean, geom=\"point\", shape=18,\n                 size=3, color=\"red\")\n#&gt; Warning: The `fun.y` argument of `stat_summary()` is deprecated as of ggplot2 3.3.0.\n#&gt; ℹ Please use the `fun` argument instead.\n\n# p6&lt;- p1 + stat_summary(fun.y=median, geom=\"point\", shape=18,\n#                  size=3, color=\"red\")",
    "crumbs": [
      "ggplot2 图形",
      "点线图",
      "点图"
    ]
  },
  {
    "objectID": "点图.html#ggdotplot",
    "href": "点图.html#ggdotplot",
    "title": "",
    "section": "\n1.2 ggdotplot()\n",
    "text": "1.2 ggdotplot()\n\n\nCode\nlibrary(ggpubr)\nlibrary(readxl)\n\n\n\nCode\nf6d &lt;-\n    read_excel(\"data/01source.xlsx\", sheet = \"Fig.6\", range = \"D2:E18\")\nf6d |&gt; pivot_longer(\n    cols = everything(),\n    names_to = \"status\",\n    values_to = \"Ratio\",\n) |&gt; \n    tidyr::drop_na() -&gt;f6d\n\n\n\nCodeggdotplot(f6d,\n          x=\"status\",\n          y=\"Ratio\",\n          add =c(\"mean_sd\"),\n          color = \"status\",\n          fill = \"status\",\n          error.plot = \"errorbar\",\n)+\n    geom_signif(\n        comparisons = list(c(\"relapse\",\"non-relapse\")),\n    )+\n    \n    stat_summary(\n        fun.data = \"mean_sd\",geom = \"pointrange\",width=.3\n    )+\n    ggplot2::annotate(\n        geom=\"segment\",\n        x=0.9,\n        xend=1.1,\n        y=2.42019873,#均值\n    )+\n    ggplot2::annotate(\n        geom=\"segment\",\n        x=1.9,\n        xend=2.1,\n        y=0.789463173,#均值\n    )\n#&gt; Warning in stat_summary(fun.data = \"mean_sd\", geom = \"pointrange\", width =\n#&gt; 0.3): Ignoring unknown parameters: `width`\n#&gt; Bin width defaults to 1/30 of the range of the data. Pick better value with\n#&gt; `binwidth`.",
    "crumbs": [
      "ggplot2 图形",
      "点线图",
      "点图"
    ]
  },
  {
    "objectID": "生存曲线.html",
    "href": "生存曲线.html",
    "title": "",
    "section": "",
    "text": "曲线图生存曲线 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "曲线图",
      "生存曲线"
    ]
  },
  {
    "objectID": "生存曲线.html#kaplan-meier-curve",
    "href": "生存曲线.html#kaplan-meier-curve",
    "title": "",
    "section": "\n1.1 Kaplan-Meier curve",
    "text": "1.1 Kaplan-Meier curve\n\nCodelibrary(tidyverse)\nlibrary(readxl)\nlibrary(survival)\nlibrary(ggsci)\nlibrary(ggsurvfit)\n\n\n\nCode### 数据 三列 “group”分组列， “time”生存时间列，“status”事件状态列\nd&lt;-read_excel(\"data/01source.xlsx\",sheet=1,range = \"A19:E75\") |&gt; \n    rename(\n        LR_DPVB=`LR-DPVB`\n    )  |&gt; \n    pivot_longer(\n        cols = CON:LR_DPVB,\n        names_to = \"treatment\",\n        values_to = \"status\"\n    ) |&gt; drop_na() |&gt; \n    mutate(\n        treatment=factor(treatment,levels=c('CON','LDRT','DPVB','LR_DPVB'))\n    )\n# 加载包\nd\n#&gt; # A tibble: 56 × 3\n#&gt;     Days treatment status\n#&gt;    &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;\n#&gt;  1    11 CON            1\n#&gt;  2    13 CON            1\n#&gt;  3    14 CON            1\n#&gt;  4    14 CON            1\n#&gt;  5    15 CON            1\n#&gt;  6    17 CON            1\n#&gt;  7    17 CON            1\n#&gt;  8    17 CON            1\n#&gt;  9    20 CON            1\n#&gt; 10    20 CON            1\n#&gt; # ℹ 46 more rows\n# 使用 Kaplan-Meier 方法拟合生存曲线\nkm_fit&lt;-survfit2(Surv(Days,status)~treatment,data=d)\nsummary(km_fit)\n#&gt; Call: survfit(formula = Surv(Days, status) ~ treatment, data = d)\n#&gt; \n#&gt;                 treatment=CON \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    11     14       1   0.9286  0.0688       0.8030        1.000\n#&gt;    13     13       1   0.8571  0.0935       0.6921        1.000\n#&gt;    14     12       2   0.7143  0.1207       0.5129        0.995\n#&gt;    15     10       1   0.6429  0.1281       0.4351        0.950\n#&gt;    17      9       3   0.4286  0.1323       0.2341        0.785\n#&gt;    20      6       2   0.2857  0.1207       0.1248        0.654\n#&gt;    21      4       2   0.1429  0.0935       0.0396        0.515\n#&gt;    25      2       1   0.0714  0.0688       0.0108        0.472\n#&gt;    27      1       1   0.0000     NaN           NA           NA\n#&gt; \n#&gt;                 treatment=LDRT \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    13     14       2   0.8571  0.0935       0.6921        1.000\n#&gt;    15     12       1   0.7857  0.1097       0.5977        1.000\n#&gt;    16     11       1   0.7143  0.1207       0.5129        0.995\n#&gt;    18     10       1   0.6429  0.1281       0.4351        0.950\n#&gt;    19      9       2   0.5000  0.1336       0.2961        0.844\n#&gt;    20      7       3   0.2857  0.1207       0.1248        0.654\n#&gt;    24      4       1   0.2143  0.1097       0.0786        0.584\n#&gt;    25      3       1   0.1429  0.0935       0.0396        0.515\n#&gt;    27      2       1   0.0714  0.0688       0.0108        0.472\n#&gt;    30      1       1   0.0000     NaN           NA           NA\n#&gt; \n#&gt;                 treatment=DPVB \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    20     14       1    0.929  0.0688        0.803        1.000\n#&gt;    23     13       1    0.857  0.0935        0.692        1.000\n#&gt;    27     12       1    0.786  0.1097        0.598        1.000\n#&gt;    28     11       1    0.714  0.1207        0.513        0.995\n#&gt;    30     10       1    0.643  0.1281        0.435        0.950\n#&gt;    32      9       1    0.571  0.1323        0.363        0.899\n#&gt;    38      8       1    0.500  0.1336        0.296        0.844\n#&gt;    39      7       1    0.429  0.1323        0.234        0.785\n#&gt;    45      6       1    0.357  0.1281        0.177        0.721\n#&gt; \n#&gt;                 treatment=LR_DPVB \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    30     14       1    0.929  0.0688        0.803            1\n#&gt;    40     13       1    0.857  0.0935        0.692            1",
    "crumbs": [
      "ggplot2 图形",
      "曲线图",
      "生存曲线"
    ]
  },
  {
    "objectID": "生存曲线.html#plot",
    "href": "生存曲线.html#plot",
    "title": "",
    "section": "\n1.2 plot()\n",
    "text": "1.2 plot()\n\n\nCodeplot(km_fit,\n     lty = 1,\n     col = c(\"gray\",\"blue\",\"orange3\",\"darkred\"),\n     lwd = 2,\n)",
    "crumbs": [
      "ggplot2 图形",
      "曲线图",
      "生存曲线"
    ]
  },
  {
    "objectID": "生存曲线.html#survminerggsurvplot",
    "href": "生存曲线.html#survminerggsurvplot",
    "title": "",
    "section": "\n1.3 survminer::ggsurvplot()\n",
    "text": "1.3 survminer::ggsurvplot()\n\n\nCode# 使用 ggplot2 和 survminer 绘制生存曲线图\nlibrary(survminer)\np &lt;- ggsurvplot(\n    fit  = km_fit,\n    data = d,\n    fun = \"pct\",  #event',累计死亡比列，'cumhaz':cumulative hazard累计风险\n    \n    palette = \"jco\",\n    linetype = c(1,5,4,6),\n    surv.median.line = 'none',\n    \n    conf.int = F,\n\n    \n    pval = TRUE,# \"log rank p=0.0053\"\n    log.rank.weights='1',  \n    pval.method = TRUE,\n    pval.coord=c(40,75),\n    pval.method.coord=c(32,75),\n    \n    risk.table = \"abs_pct\", # \"nrisk_cumcensor\" and \"nrisk_cumevents\"\n    risk.table.col = \"treatment\",\n    risk.table.height=0.3,\n    tables.theme = theme_cleantable(),\n    ncensor.plot=T,\n  \n    \n    axes.offset=F,  #(0,0)pos\n    title = \"Hepa1-6 tumor\",\n    xlab=\"Days\",\n    ylab=\"Percent survival (%)\",\n    \n    legend.title = \"\",\n    legend = c(0.2,0.35),\n    legend.labs=c('CON','LDRT','DPVB','LR_DPVB'),\n    \n    ggtheme = theme_survminer(),\n)\np\n\n\n\n\n\n\n\n\nCodefit&lt;- survfit(Surv(time, status) ~ sex, data = lung)\n\n# Basic survival curves\nggsurvplot(fit, data = lung)\n\n\n\n\n\n\nCode\n# Customized survival curves\np &lt;- ggsurvplot(fit, data = lung,\n           surv.median.line = \"hv\", # Add medians survival\n           \n           # Change legends: title & labels\n           legend.title = \"Sex\",\n           legend.labs = c(\"Male\", \"Female\"),\n           # Add p-value and tervals\n           pval = TRUE,\n           \n           conf.int = TRUE,\n           # Add risk table\n           risk.table = TRUE,\n           tables.height = 0.2,\n           tables.theme = theme_cleantable(),\n           \n           # Color palettes. Use custom color: c(\"#E7B800\", \"#2E9FDF\"),\n           # or brewer color (e.g.: \"Dark2\"), or ggsci color (e.g.: \"jco\")\n           palette = c(\"#E7B800\", \"#2E9FDF\"),\n           ggtheme = theme_bw() # Change ggplot2 theme\n)\n#&gt; Warning in geom_segment(aes(x = 0, y = max(y2), xend = max(x1), yend = max(y2)), : All aesthetics have length 1, but the data has 2 rows.\n#&gt; ℹ Please consider using `annotate()` or provide this layer with data containing\n#&gt;   a single row.\n\n\n\nCodep &lt;- ggsurvplot(fit, data = lung,\n                surv.median.line = \"hv\", # Add medians survival\n                \n                # Change legends: title & labels\n                legend.title = \"Sex\",\n                legend.labs = c(\"Male\", \"Female\"),\n                # Add p-value and tervals\n                pval = F,    ##不默认显示P\n                conf.int = TRUE,\n                # Add risk table\n                risk.table = TRUE,\n                tables.height = 0.2,\n                tables.theme = theme_cleantable(),\n                \n                # Color palettes. Use custom color: c(\"#E7B800\", \"#2E9FDF\"),\n                # or brewer color (e.g.: \"Dark2\"), or ggsci color (e.g.: \"jco\")\n                palette = c(\"#E7B800\", \"#2E9FDF\"),\n                ggtheme = theme_bw() # Change ggplot2 theme\n)\n#&gt; Warning in geom_segment(aes(x = 0, y = max(y2), xend = max(x1), yend = max(y2)), : All aesthetics have length 1, but the data has 2 rows.\n#&gt; ℹ Please consider using `annotate()` or provide this layer with data containing\n#&gt;   a single row.\n##计算公式\ndata.survdiff &lt;- survdiff(Surv(time, status) ~ sex,data = lung)\np.val = 1 - pchisq(data.survdiff$chisq, length(data.survdiff$n) - 1)\nHR = (data.survdiff$obs[2]/data.survdiff$exp[2])/(data.survdiff$obs[1]/data.survdiff$exp[1])\nup95 = exp(log(HR) + qnorm(0.975)*sqrt(1/data.survdiff$exp[2]+1/data.survdiff$exp[1]))\nlow95 = exp(log(HR) - qnorm(0.975)*sqrt(1/data.survdiff$exp[2]+1/data.survdiff$exp[1]))\nci &lt;- paste0(sprintf(\"%.3f\",HR),\" [\",sprintf(\"%.3f\",low95),\", \",sprintf(\"%.3f\",up95),\"]\")\n\np$plot &lt;- p$plot + \n  annotate(\"text\", x = 0, y = 0.05, \n                            label = paste0(\"P value = \",sprintf(\"%.3f\",p.val),\"\\n HR (95% CI) = \",ci),   ###添加P和HR 95%CI\n                            size = 5, color = \"black\", hjust = 0)+\n  theme(text = element_text(size = 15))\np$plot\n#&gt; Warning in geom_segment(aes(x = 0, y = max(y2), xend = max(x1), yend = max(y2)), : All aesthetics have length 1, but the data has 2 rows.\n#&gt; ℹ Please consider using `annotate()` or provide this layer with data containing\n#&gt;   a single row.",
    "crumbs": [
      "ggplot2 图形",
      "曲线图",
      "生存曲线"
    ]
  },
  {
    "objectID": "生存曲线.html#ggsurvfit",
    "href": "生存曲线.html#ggsurvfit",
    "title": "",
    "section": "\n1.4 ggsurvfit",
    "text": "1.4 ggsurvfit\n\nCodelibrary(ggsurvfit)\nkm_fit\n#&gt; Call: survfit(formula = Surv(Days, status) ~ treatment, data = d)\n#&gt; \n#&gt;                    n events median 0.95LCL 0.95UCL\n#&gt; treatment=CON     14     14   17.0      15      25\n#&gt; treatment=LDRT    14     14   19.5      18      27\n#&gt; treatment=DPVB    14      9   38.5      30      NA\n#&gt; treatment=LR_DPVB 14      2     NA      NA      NA\n\n\nkm_fit |&gt; tidy_survfit() |&gt; \n    ggplot(aes(time,estimate,min=conf.low,ymax=conf.low,\n               color=strata,fill=strata))+\n    scale_color_jco()+\n    geom_step()\n\n\n\n\n\n\nCode\nkm_fit |&gt; ggsurvfit()+\n    add_confidence_interval()+\n    # 添加删失点\n    add_censor_mark()  +\n    add_quantile()+\n    add_pvalue(\"annotation\",size=3,x=5,y=0.25)+\n    #add_pvalue(caption = \"Log-rank {p.value}\")+\n    add_risktable(size = 3,risktable_height = 0.3)+\n    add_legend_title(\"treatment\")",
    "crumbs": [
      "ggplot2 图形",
      "曲线图",
      "生存曲线"
    ]
  },
  {
    "objectID": "网络图.html",
    "href": "网络图.html",
    "title": "",
    "section": "",
    "text": "关系图网络图 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "ggplot2 图形",
      "关系图",
      "网络图"
    ]
  },
  {
    "objectID": "网络图.html#tbl_graph",
    "href": "网络图.html#tbl_graph",
    "title": "",
    "section": "\n1.1 tbl_graph\n",
    "text": "1.1 tbl_graph\n\n\nCodelibrary(tidygraph)\nlibrary(ggraph)\nrstat_nodes &lt;- data.frame(name = c(\"Hadley\", \"David\", \"Romain\", \"Julia\"))\nrstat_edges &lt;- data.frame(from = c(1, 1, 1, 2, 3, 3, 4, 4, 4),\n                            to = c(2, 3, 4, 1, 1, 2, 1, 2, 3))\ntbl_graph(nodes = rstat_nodes, edges = rstat_edges)\n#&gt; # A tbl_graph: 4 nodes and 9 edges\n#&gt; #\n#&gt; # A directed simple graph with 1 component\n#&gt; #\n#&gt; # Node Data: 4 × 1 (active)\n#&gt;   name  \n#&gt;   &lt;chr&gt; \n#&gt; 1 Hadley\n#&gt; 2 David \n#&gt; 3 Romain\n#&gt; 4 Julia \n#&gt; #\n#&gt; # Edge Data: 9 × 2\n#&gt;    from    to\n#&gt;   &lt;int&gt; &lt;int&gt;\n#&gt; 1     1     2\n#&gt; 2     1     3\n#&gt; 3     1     4\n#&gt; # ℹ 6 more rows",
    "crumbs": [
      "ggplot2 图形",
      "关系图",
      "网络图"
    ]
  },
  {
    "objectID": "网络图.html#节点",
    "href": "网络图.html#节点",
    "title": "",
    "section": "\n1.2 节点",
    "text": "1.2 节点\n\nCode\nhighschool %&gt;% as_tibble()\n#&gt; # A tibble: 506 × 3\n#&gt;     from    to  year\n#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n#&gt;  1     1    14  1957\n#&gt;  2     1    15  1957\n#&gt;  3     1    21  1957\n#&gt;  4     1    54  1957\n#&gt;  5     1    55  1957\n#&gt;  6     2    21  1957\n#&gt;  7     2    22  1957\n#&gt;  8     3     9  1957\n#&gt;  9     3    15  1957\n#&gt; 10     4     5  1957\n#&gt; # ℹ 496 more rows\n\n\ngr &lt;- as_tbl_graph(highschool)\ngr\n#&gt; # A tbl_graph: 70 nodes and 506 edges\n#&gt; #\n#&gt; # A directed multigraph with 1 component\n#&gt; #\n#&gt; # Node Data: 70 × 0 (active)\n#&gt; #\n#&gt; # Edge Data: 506 × 3\n#&gt;    from    to  year\n#&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt;\n#&gt; 1     1    13  1957\n#&gt; 2     1    14  1957\n#&gt; 3     1    20  1957\n#&gt; # ℹ 503 more rows\n\ncreate_layout(gr,layout = \"kk\") %&gt;% \n    ggplot()+\n    theme(\n        axis.text = element_blank(),\n        axis.title = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid = element_blank(),\n    )+\n    geom_point(aes(x = x, y = y))\n\n\n\n\n\n\nCode\n\nggraph(gr, layout = \"kk\") + \n  geom_point(aes(x = x, y = y))\n\n\n\n\n\n\nCode\nggraph(gr, layout = 'kk') + \n  geom_node_point()\n\n\n\n\n\n\n\n\nCodegr2 &lt;- tbl_graph(flare$vertices, flare$edges)\ngr2\n#&gt; # A tbl_graph: 252 nodes and 251 edges\n#&gt; #\n#&gt; # A rooted tree\n#&gt; #\n#&gt; # Node Data: 252 × 3 (active)\n#&gt;    name                                            size shortName            \n#&gt;    &lt;chr&gt;                                          &lt;dbl&gt; &lt;chr&gt;                \n#&gt;  1 flare.analytics.cluster.AgglomerativeCluster    3938 AgglomerativeCluster \n#&gt;  2 flare.analytics.cluster.CommunityStructure      3812 CommunityStructure   \n#&gt;  3 flare.analytics.cluster.HierarchicalCluster     6714 HierarchicalCluster  \n#&gt;  4 flare.analytics.cluster.MergeEdge                743 MergeEdge            \n#&gt;  5 flare.analytics.graph.BetweennessCentrality     3534 BetweennessCentrality\n#&gt;  6 flare.analytics.graph.LinkDistance              5731 LinkDistance         \n#&gt;  7 flare.analytics.graph.MaxFlowMinCut             7840 MaxFlowMinCut        \n#&gt;  8 flare.analytics.graph.ShortestPaths             5914 ShortestPaths        \n#&gt;  9 flare.analytics.graph.SpanningTree              3416 SpanningTree         \n#&gt; 10 flare.analytics.optimization.AspectRatioBanker  7074 AspectRatioBanker    \n#&gt; # ℹ 242 more rows\n#&gt; #\n#&gt; # Edge Data: 251 × 2\n#&gt;    from    to\n#&gt;   &lt;int&gt; &lt;int&gt;\n#&gt; 1   221     1\n#&gt; 2   221     2\n#&gt; 3   221     3\n#&gt; # ℹ 248 more rows\n\n\ncreate_layout(gr2,layout = \"partition\") \n#&gt; # A tibble: 252 × 12\n#&gt;        x     y width height circular leaf  depth name           size shortName\n#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;    &lt;lgl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;    \n#&gt;  1 110     1.5   220      1 FALSE    FALSE     0 flare             0 flare    \n#&gt;  2  10     2.5    20      1 FALSE    FALSE     1 flare.animate     0 animate  \n#&gt;  3  25.5   2.5    11      1 FALSE    FALSE     1 flare.data        0 data     \n#&gt;  4  33     2.5     4      1 FALSE    FALSE     1 flare.display     0 display  \n#&gt;  5  35.5   2.5     1      1 FALSE    FALSE     1 flare.flex        0 flex     \n#&gt;  6  40     2.5     8      1 FALSE    FALSE     1 flare.physics     0 physics  \n#&gt;  7  74     2.5    60      1 FALSE    FALSE     1 flare.query       0 query    \n#&gt;  8 109     2.5    10      1 FALSE    FALSE     1 flare.scale       0 scale    \n#&gt;  9 126.    2.5    25      1 FALSE    FALSE     1 flare.util        0 util     \n#&gt; 10 174.    2.5    71      1 FALSE    FALSE     1 flare.vis         0 vis      \n#&gt; # ℹ 242 more rows\n#&gt; # ℹ 2 more variables: .ggraph.orig_index &lt;int&gt;, .ggraph.index &lt;int&gt;\n\ncreate_layout(gr2,layout = \"partition\") %&gt;% \n    ggplot()+\n    theme(\n        axis.text = element_blank(),\n        axis.title = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid = element_blank(),\n    )+\n    geom_tile(aes(x=x,y = -y, fill = depth))\n\n\n\n\n\n\nCode\nggraph(gr2, layout = 'partition') + \n  geom_node_tile(aes(y = -y, fill = depth))",
    "crumbs": [
      "ggplot2 图形",
      "关系图",
      "网络图"
    ]
  },
  {
    "objectID": "网络图.html#边",
    "href": "网络图.html#边",
    "title": "",
    "section": "\n1.3 边",
    "text": "1.3 边\n\nCodelibrary(ggraph)\nlibrary(tidygraph)\n\nhighschool$year &lt;- factor(highschool$year)\n\ngr &lt;- as_tbl_graph(highschool) %&gt;% \n    activate(edges)\n\ngr\n#&gt; # A tbl_graph: 70 nodes and 506 edges\n#&gt; #\n#&gt; # A directed multigraph with 1 component\n#&gt; #\n#&gt; # Edge Data: 506 × 3 (active)\n#&gt;     from    to year \n#&gt;    &lt;int&gt; &lt;int&gt; &lt;chr&gt;\n#&gt;  1     1    13 1957 \n#&gt;  2     1    14 1957 \n#&gt;  3     1    20 1957 \n#&gt;  4     1    52 1957 \n#&gt;  5     1    53 1957 \n#&gt;  6     2    20 1957 \n#&gt;  7     2    21 1957 \n#&gt;  8     3     9 1957 \n#&gt;  9     3    14 1957 \n#&gt; 10     4     5 1957 \n#&gt; # ℹ 496 more rows\n#&gt; #\n#&gt; # Node Data: 70 × 0\n\n# link\n\nggraph(gr, layout = 'kk') + \n  geom_edge_link(aes(colour = year))\n\n\n\n\n\n\nCode\n\n# fan\n\nggraph(gr, layout = 'kk') + \n  geom_edge_fan(aes(colour = year))\n\n\n\n\n\n\nCode\n# parallel\n\nggraph(gr, layout = 'kk') + \n  geom_edge_parallel(aes(colour = year))\n\n\n\n\n\n\nCode\n# loop  make some of the student love themselves\nloopy_gr&lt;- gr |&gt; \n  bind_edges(tibble::tibble(from = 1:5, to = 1:5, year = rep('1957', 5)))\nggraph(loopy_gr, layout = 'stress') + \n  geom_edge_link(aes(colour = year), alpha = 0.25) + \n  geom_edge_loop(aes(colour = year))\n\n\n\n\n\n\nCode\n\n\n# Force directed 力导向\n\nggraph(gr) + \n  geom_edge_bundle_force(n_cycle = 2, threshold = 0.4)\n#&gt; Using \"stress\" as default layout\n\n\n\n\n\n\nCode\n\n\n# arc\nggraph(gr, layout = 'linear') + \n  geom_edge_arc(aes(colour = year))\n\n\n\n\n\n\n\n\nCode# hive 蜂巢图\nhairball &lt;- as_tbl_graph(highschool) |&gt; \n  mutate(\n    year_pop = map_local(mode = 'in', .f = function(neighborhood, ...) {\n      neighborhood %E&gt;% pull(year) |&gt; table() |&gt; sort(decreasing = TRUE)\n    }),\n    pop_devel = map_chr(year_pop, function(pop) {\n      if (length(pop) == 0 || length(unique(pop)) == 1) return('unchanged')\n      switch(names(pop)[which.max(pop)],\n             '1957' = 'decreased',\n             '1958' = 'increased')\n    }),\n    popularity = map_dbl(year_pop, ~ .[1]) %/% 0\n  ) |&gt; \n  activate(edges) |&gt; \n  mutate(year = as.character(year))\n\n\nggraph(hairball, layout = 'hive', axis = pop_devel, sort.by = popularity) + \n  geom_edge_hive(aes(colour = year)) + \n  geom_axis_hive(label = FALSE) + \n  coord_fixed()\n\n\n\n\n\n\n\n\nCodehierarchy &lt;- as_tbl_graph(hclust(dist(iris[, 1:4]))) |&gt; \n  mutate(Class = map_bfs_back_chr(node_is_root(), .f = function(node, path, ...) {\n    if (leaf[node]) {\n      as.character(iris$Species[as.integer(label[node])])\n    } else {\n      species &lt;- unique(unlist(path$result))\n      if (length(species) == 1) {\n        species\n      } else {\n        NA_character_\n      }\n    }\n  }))\n\n#  elbow\nggraph(hierarchy, layout = 'dendrogram', height = height) + \n  geom_edge_elbow()\n\n\n\n\n\n\nCodeggraph(hierarchy, layout = 'dendrogram', height = height) + \n  geom_edge_elbow2(aes(colour = node.Class))\n\n\n\n\n\n\nCode\nggraph(hierarchy, layout = 'dendrogram', height = height) + \n  geom_edge_diagonal()\n\n\n\n\n\n\nCode\n\nggraph(hierarchy, layout = 'dendrogram', height = height) + \n  geom_edge_bend()\n\n\n\n\n\n\n\n\n1.3.1 箭头\n\nCode# Random names - I swear\nsimple &lt;- create_notable('bull') |&gt; \n  mutate(name = c('Thomas', 'Bob', 'Hadley', 'Winston', 'Baptiste')) |&gt; \n  activate(edges) |&gt; \n  mutate(type = sample(c('friend', 'foe'), 5, TRUE))\n\n\nggraph(simple, layout = 'graphopt') + \n  geom_edge_link(arrow = arrow(length = unit(4, 'mm'))) + \n  geom_node_point(size = 5)\n\n\n\n\n\n\nCode\n\nggraph(simple, layout = 'graphopt') + \n  geom_edge_link(arrow = arrow(length = unit(4, 'mm')), \n                 end_cap = circle(3, 'mm')) + \n  geom_node_point(size = 5)\n\n\n\n\n\n\nCode\nggraph(simple, layout = 'graphopt') + \n  geom_edge_link(aes(start_cap = label_rect(node1.name),\n                     end_cap = label_rect(node2.name)), \n                 arrow = arrow(length = unit(4, 'mm'))) + \n  geom_node_text(aes(label = name))\n\n\n\n\n\n\n\n\n1.3.2 标签\n\nCodeggraph(simple, layout = 'graphopt') + \n  geom_edge_link(aes(label = type), \n                 arrow = arrow(length = unit(4, 'mm')), \n                 end_cap = circle(3, 'mm')) + \n  geom_node_point(size = 5)\n\n\n\n\n\n\nCode\nggraph(simple, layout = 'graphopt') + \n  geom_edge_link(aes(label = type), \n                 angle_calc = 'along',\n                 label_dodge = unit(2.5, 'mm'),\n                 arrow = arrow(length = unit(4, 'mm')), \n                 end_cap = circle(3, 'mm')) + \n  geom_node_point(size = 5)\n\n\n\n\n\n\n\n\n1.3.3 关联\n\nCodeflaregraph &lt;- tbl_graph(flare$vertices, flare$edges)\nfrom &lt;- match(flare$imports$from, flare$vertices$name)\nto &lt;- match(flare$imports$to, flare$vertices$name)\nggraph(flaregraph, layout = 'dendrogram', circular = TRUE) + \n  geom_conn_bundle(data = get_con(from = from, to = to), alpha = 0.1) + \n  coord_fixed()",
    "crumbs": [
      "ggplot2 图形",
      "关系图",
      "网络图"
    ]
  },
  {
    "objectID": "网络图.html#布局",
    "href": "网络图.html#布局",
    "title": "",
    "section": "\n1.4 布局",
    "text": "1.4 布局",
    "crumbs": [
      "ggplot2 图形",
      "关系图",
      "网络图"
    ]
  },
  {
    "objectID": "ggplot2_graphics.html#统计变换-statistical-transformations",
    "href": "ggplot2_graphics.html#统计变换-statistical-transformations",
    "title": "",
    "section": "\n1.3 统计变换 statistical transformations",
    "text": "1.3 统计变换 statistical transformations\nstat_bin()：geom_bar()，geom_freqpoly()，geom_histogram()\n\nCodemtcars %&gt;% \n    ggplot(aes(x =cyl , y= mpg))+\n    stat_summary(geom = \"bar\",fun = mean)\n\n\n\n\n\n\n\nstat_bin2d()：geom_bin2d()\nstat_bindot()：geom_dotplot()\nstat_binhex()：geom_hex()\nstat_boxplot()：geom_boxplot()\nstat_contour()：geom_contour()\nstat_quantile()：geom_quantile()\nstat_smooth()：geom_smooth()\nstat_sum()：geom_count()\nstat_ecdf()：计算经验累积分布图。\nstat_function()：根据 x 值的函数计算 y 值。\nstat_summary()：将 Y 值汇总到不同的 X 值。\nstat_summary2d() ：汇总分箱值。\nstat_summary_hex()\nstat_qq()：对分位数-分位数图执行计算。\nstat_spoke()：将角度和半径转换为位置。\nstat_unique()：删除重复的行。\n\nCodeggplot(diamonds) + \n  stat_summary(\n    aes(x = cut, y = depth),\n    geom = \"errorbar\",\n    fun.min = min,\n    fun.max = max,\n    fun = mean\n  )\n\n\n\n\n\n\nCode\nggplot(mpg, aes(trans, cty)) + \n    geom_point() + \n    stat_summary(geom = \"point\", fun = \"mean\", colour = \"red\", size = 4)",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 Graphics"
    ]
  },
  {
    "objectID": "ggplot2_graphics.html#位置调整-position-adjustments",
    "href": "ggplot2_graphics.html#位置调整-position-adjustments",
    "title": "",
    "section": "\n1.4 位置调整 position adjustments",
    "text": "1.4 位置调整 position adjustments\n\n1.4.0.1 条偏移\n\nCodeggplot(mpg, aes(x = drv, fill = class)) + \n  geom_bar(alpha = 1/5, position = \"identity\")|\n\nggplot(mpg, aes(x = drv, color = class)) + \n  geom_bar(fill = NA, position = \"identity\")\n\n\n\n\n\n\nCode\nggplot(mpg, aes(x = drv, fill = class)) + \n  geom_bar(position = \"fill\")|\n\nggplot(mpg, aes(x = drv, fill = class)) + \n  geom_bar(position = \"dodge\")\n\n\n\n\n\n\n\n\n1.4.0.2 点偏移\nposition_nudge()：按固定偏移量移动点。\nposition_jitter()：为每个位置添加一点随机噪音。\nposition_jitterdodge()：躲避组内的点，然后添加一点随机噪音。\n\nCodeggplot(mpg, aes(x = factor(cyl), y = hwy)) + \n  geom_point(position = \"identity\") |\nggplot(mpg, aes(x = factor(cyl), y = hwy)) + \n  geom_point(position = \"jitter\")\n\n\n\n\n\n\nCode\nggplot(mpg, aes(x = factor(cyl), y = hwy)) + \n  geom_point(position =position_nudge(x=0.1,y=0))|\nggplot(mpg, aes(x = factor(cyl), y = hwy,color=factor(cyl))) + \n  geom_point(position = position_jitterdodge())",
    "crumbs": [
      "ggplot2 图形",
      "ggplot2 Graphics"
    ]
  }
]