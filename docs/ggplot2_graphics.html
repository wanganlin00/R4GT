<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>R for Graphics and Tables</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="styles.css">
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R for Graphics and Tables</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">主页</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./Graph.html" aria-current="page"> 
<span class="menu-text">图</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Table.html"> 
<span class="menu-text">表</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./references.html"> 
<span class="menu-text">参考文献</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ggplot2_graphics.html">ggplot2 Graphics</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Graph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">图</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ggplot2_graphics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">ggplot2 Graphics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ggplot2_extensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ggplot2 extensions</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">条图</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./条图.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">条图</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">点图</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dotplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">dotplot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Q-Q图.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Q-Q图</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">线图</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./生存曲线.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">生存曲线</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ROC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ROC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./折线图.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">折线图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confident_interval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">置信区间</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./回归曲线.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">回归曲线</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">关系图</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./相关图.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">相关图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./热图.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">热图</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#sec-ggplot2" id="toc-sec-ggplot2" class="nav-link active" data-scroll-target="#sec-ggplot2"><span class="header-section-number">1</span> ggplot2 Graphics</a>
  <ul>
<li>
<a href="#ggplotdata-mapping-aesxy" id="toc-ggplotdata-mapping-aesxy" class="nav-link" data-scroll-target="#ggplotdata-mapping-aesxy"><span class="header-section-number">1.1</span> <code>ggplot(data =  ,mapping = aes(x,y,…))</code></a>
  <ul class="collapse">
<li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">1.1.1</span> data</a></li>
  <li>
<a href="#aesthetics-mapping" id="toc-aesthetics-mapping" class="nav-link" data-scroll-target="#aesthetics-mapping"><span class="header-section-number">1.1.2</span> aesthetics mapping</a>
  <ul class="collapse">
<li><a href="#%E5%9D%90%E6%A0%87" id="toc-坐标" class="nav-link" data-scroll-target="#%E5%9D%90%E6%A0%87"><span class="header-section-number">1.1.2.1</span> 坐标</a></li>
  <li><a href="#shape" id="toc-shape" class="nav-link" data-scroll-target="#shape"><span class="header-section-number">1.1.2.2</span> shape</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#geometry" id="toc-geometry" class="nav-link" data-scroll-target="#geometry"><span class="header-section-number">1.2</span> geometry</a>
  <ul class="collapse">
<li>
<a href="#x%E8%BF%9E%E7%BB%AD%E5%9E%8B%E5%8F%98%E9%87%8F" id="toc-x连续型变量" class="nav-link" data-scroll-target="#x%E8%BF%9E%E7%BB%AD%E5%9E%8B%E5%8F%98%E9%87%8F"><span class="header-section-number">1.2.1</span> X=连续型变量</a>
  <ul class="collapse">
<li><a href="#geom_point" id="toc-geom_point" class="nav-link" data-scroll-target="#geom_point"><span class="header-section-number">1.2.1.1</span> geom_point</a></li>
  <li><a href="#geom_line" id="toc-geom_line" class="nav-link" data-scroll-target="#geom_line"><span class="header-section-number">1.2.1.2</span> geom_line</a></li>
  <li><a href="#geom_smooth" id="toc-geom_smooth" class="nav-link" data-scroll-target="#geom_smooth"><span class="header-section-number">1.2.1.3</span> geom_smooth</a></li>
  <li><a href="#geom_histogram" id="toc-geom_histogram" class="nav-link" data-scroll-target="#geom_histogram"><span class="header-section-number">1.2.1.4</span> geom_histogram</a></li>
  <li><a href="#geom_bin2d" id="toc-geom_bin2d" class="nav-link" data-scroll-target="#geom_bin2d"><span class="header-section-number">1.2.1.5</span> geom_bin2d()</a></li>
  <li><a href="#geom_freqpoly" id="toc-geom_freqpoly" class="nav-link" data-scroll-target="#geom_freqpoly"><span class="header-section-number">1.2.1.6</span> geom_freqpoly</a></li>
  <li><a href="#geom_density" id="toc-geom_density" class="nav-link" data-scroll-target="#geom_density"><span class="header-section-number">1.2.1.7</span> geom_density</a></li>
  <li><a href="#geom_rug" id="toc-geom_rug" class="nav-link" data-scroll-target="#geom_rug"><span class="header-section-number">1.2.1.8</span> geom_rug</a></li>
  <li><a href="#geom_jitter" id="toc-geom_jitter" class="nav-link" data-scroll-target="#geom_jitter"><span class="header-section-number">1.2.1.9</span> geom_jitter</a></li>
  </ul>
</li>
  <li>
<a href="#x%E7%A6%BB%E6%95%A3%E5%9E%8B%E5%8F%98%E9%87%8F" id="toc-x离散型变量" class="nav-link" data-scroll-target="#x%E7%A6%BB%E6%95%A3%E5%9E%8B%E5%8F%98%E9%87%8F"><span class="header-section-number">1.2.2</span> X=离散型变量</a>
  <ul class="collapse">
<li><a href="#geom_bar" id="toc-geom_bar" class="nav-link" data-scroll-target="#geom_bar"><span class="header-section-number">1.2.2.1</span> geom_bar</a></li>
  <li><a href="#geom_errorbar" id="toc-geom_errorbar" class="nav-link" data-scroll-target="#geom_errorbar"><span class="header-section-number">1.2.2.2</span> geom_errorbar</a></li>
  <li><a href="#geom_dotplot" id="toc-geom_dotplot" class="nav-link" data-scroll-target="#geom_dotplot"><span class="header-section-number">1.2.2.3</span> geom_dotplot</a></li>
  <li><a href="#geom_boxplot" id="toc-geom_boxplot" class="nav-link" data-scroll-target="#geom_boxplot"><span class="header-section-number">1.2.2.4</span> geom_boxplot</a></li>
  <li><a href="#geom_violin" id="toc-geom_violin" class="nav-link" data-scroll-target="#geom_violin"><span class="header-section-number">1.2.2.5</span> geom_violin</a></li>
  <li><a href="#geom_tile" id="toc-geom_tile" class="nav-link" data-scroll-target="#geom_tile"><span class="header-section-number">1.2.2.6</span> geom_tile</a></li>
  </ul>
</li>
  <li><a href="#%E7%BB%9F%E8%AE%A1%E5%8F%98%E6%8D%A2-statistical-transformations" id="toc-统计变换-statistical-transformations" class="nav-link" data-scroll-target="#%E7%BB%9F%E8%AE%A1%E5%8F%98%E6%8D%A2-statistical-transformations"><span class="header-section-number">1.2.3</span> 统计变换 statistical transformations</a></li>
  <li>
<a href="#%E4%BD%8D%E7%BD%AE%E8%B0%83%E6%95%B4-position-adjustments" id="toc-位置调整-position-adjustments" class="nav-link" data-scroll-target="#%E4%BD%8D%E7%BD%AE%E8%B0%83%E6%95%B4-position-adjustments"><span class="header-section-number">1.2.4</span> 位置调整 position adjustments</a>
  <ul class="collapse">
<li><a href="#%E6%9D%A1" id="toc-条" class="nav-link" data-scroll-target="#%E6%9D%A1"><span class="header-section-number">1.2.4.1</span> 条</a></li>
  <li><a href="#%E7%82%B9" id="toc-点" class="nav-link" data-scroll-target="#%E7%82%B9"><span class="header-section-number">1.2.4.2</span> 点</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#%E5%9D%90%E6%A0%87%E7%B3%BB-coordinate" id="toc-坐标系-coordinate" class="nav-link" data-scroll-target="#%E5%9D%90%E6%A0%87%E7%B3%BB-coordinate"><span class="header-section-number">1.3</span> 坐标系 coordinate</a></li>
  <li>
<a href="#%E5%9D%90%E6%A0%87%E8%BD%B4-axis" id="toc-坐标轴-axis" class="nav-link" data-scroll-target="#%E5%9D%90%E6%A0%87%E8%BD%B4-axis"><span class="header-section-number">1.4</span> 坐标轴 axis</a>
  <ul class="collapse">
<li><a href="#%E5%8F%98%E6%8D%A2" id="toc-变换" class="nav-link" data-scroll-target="#%E5%8F%98%E6%8D%A2"><span class="header-section-number">1.4.1</span> 变换</a></li>
  <li><a href="#limits" id="toc-limits" class="nav-link" data-scroll-target="#limits"><span class="header-section-number">1.4.2</span> limits</a></li>
  <li><a href="#zooming" id="toc-zooming" class="nav-link" data-scroll-target="#zooming"><span class="header-section-number">1.4.3</span> zooming</a></li>
  <li><a href="#%E5%85%B1%E4%BA%AB" id="toc-共享" class="nav-link" data-scroll-target="#%E5%85%B1%E4%BA%AB"><span class="header-section-number">1.4.4</span> 共享</a></li>
  </ul>
</li>
  <li><a href="#%E6%A0%87%E9%A2%98-labels" id="toc-标题-labels" class="nav-link" data-scroll-target="#%E6%A0%87%E9%A2%98-labels"><span class="header-section-number">1.5</span> 标题 labels</a></li>
  <li>
<a href="#%E6%B3%A8%E9%87%8A-annotation" id="toc-注释-annotation" class="nav-link" data-scroll-target="#%E6%B3%A8%E9%87%8A-annotation"><span class="header-section-number">1.6</span> 注释 annotation</a>
  <ul class="collapse">
<li><a href="#%E6%96%87%E6%9C%AC-text" id="toc-文本-text" class="nav-link" data-scroll-target="#%E6%96%87%E6%9C%AC-text"><span class="header-section-number">1.6.1</span> 文本 text</a></li>
  <li><a href="#markdown" id="toc-markdown" class="nav-link" data-scroll-target="#markdown"><span class="header-section-number">1.6.2</span> markdown</a></li>
  <li><a href="#%E6%95%B0%E5%AD%A6%E8%A1%A8%E8%BE%BE%E5%BC%8F" id="toc-数学表达式" class="nav-link" data-scroll-target="#%E6%95%B0%E5%AD%A6%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="header-section-number">1.6.3</span> 数学表达式</a></li>
  <li><a href="#%E7%BA%BF%E6%AE%B5-%E7%9B%B4%E7%BA%BF-%E7%AE%AD%E5%A4%B4" id="toc-线段-直线-箭头" class="nav-link" data-scroll-target="#%E7%BA%BF%E6%AE%B5-%E7%9B%B4%E7%BA%BF-%E7%AE%AD%E5%A4%B4"><span class="header-section-number">1.6.4</span> 线段 直线 箭头</a></li>
  </ul>
</li>
  <li>
<a href="#scale" id="toc-scale" class="nav-link" data-scroll-target="#scale"><span class="header-section-number">1.7</span> scale</a>
  <ul class="collapse">
<li><a href="#xy_continuous" id="toc-xy_continuous" class="nav-link" data-scroll-target="#xy_continuous"><span class="header-section-number">1.7.1</span> x/y_continuous</a></li>
  <li><a href="#xy_discrete" id="toc-xy_discrete" class="nav-link" data-scroll-target="#xy_discrete"><span class="header-section-number">1.7.2</span> x/y_discrete</a></li>
  <li><a href="#color" id="toc-color" class="nav-link" data-scroll-target="#color"><span class="header-section-number">1.7.3</span> color</a></li>
  <li><a href="#fill" id="toc-fill" class="nav-link" data-scroll-target="#fill"><span class="header-section-number">1.7.4</span> fill</a></li>
  </ul>
</li>
  <li><a href="#%E5%88%86%E9%9D%A2" id="toc-分面" class="nav-link" data-scroll-target="#%E5%88%86%E9%9D%A2"><span class="header-section-number">1.8</span> 分面</a></li>
  <li>
<a href="#%E4%B8%BB%E9%A2%98" id="toc-主题" class="nav-link" data-scroll-target="#%E4%B8%BB%E9%A2%98"><span class="header-section-number">1.9</span> 主题</a>
  <ul class="collapse">
<li><a href="#%E5%86%85%E7%BD%AE%E4%B8%BB%E9%A2%98" id="toc-内置主题" class="nav-link" data-scroll-target="#%E5%86%85%E7%BD%AE%E4%B8%BB%E9%A2%98"><span class="header-section-number">1.9.1</span> 内置主题</a></li>
  <li><a href="#%E5%AD%97%E4%BD%93" id="toc-字体" class="nav-link" data-scroll-target="#%E5%AD%97%E4%BD%93"><span class="header-section-number">1.9.2</span> 字体</a></li>
  <li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%BB%E9%A2%98" id="toc-自定义主题" class="nav-link" data-scroll-target="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%BB%E9%A2%98"><span class="header-section-number">1.9.3</span> 自定义主题</a></li>
  <li><a href="#%E5%9B%BE%E4%BE%8B" id="toc-图例" class="nav-link" data-scroll-target="#%E5%9B%BE%E4%BE%8B"><span class="header-section-number">1.9.4</span> 图例</a></li>
  <li><a href="#%E7%BB%98%E5%9B%BE%E5%8C%BA" id="toc-绘图区" class="nav-link" data-scroll-target="#%E7%BB%98%E5%9B%BE%E5%8C%BA"><span class="header-section-number">1.9.5</span> 绘图区</a></li>
  </ul>
</li>
  <li>
<a href="#%E5%9B%BE%E5%BD%A2%E5%B8%83%E5%B1%80patchwork" id="toc-图形布局patchwork" class="nav-link" data-scroll-target="#%E5%9B%BE%E5%BD%A2%E5%B8%83%E5%B1%80patchwork"><span class="header-section-number">1.10</span> 图形布局patchwork</a>
  <ul class="collapse">
<li><a href="#%E5%B8%83%E5%B1%80%E6%96%B9%E5%BC%8F" id="toc-布局方式" class="nav-link" data-scroll-target="#%E5%B8%83%E5%B1%80%E6%96%B9%E5%BC%8F"><span class="header-section-number">1.10.1</span> 布局方式</a></li>
  <li><a href="#%E4%BF%AE%E6%94%B9%E5%AD%90%E5%9B%BE" id="toc-修改子图" class="nav-link" data-scroll-target="#%E4%BF%AE%E6%94%B9%E5%AD%90%E5%9B%BE"><span class="header-section-number">1.10.2</span> 修改子图</a></li>
  <li><a href="#%E6%B7%BB%E5%8A%A0%E6%B3%A8%E9%87%8A" id="toc-添加注释" class="nav-link" data-scroll-target="#%E6%B7%BB%E5%8A%A0%E6%B3%A8%E9%87%8A"><span class="header-section-number">1.10.3</span> 添加注释</a></li>
  <li><a href="#%E5%9B%BE%E5%BD%A2%E7%BC%96%E5%8F%B7" id="toc-图形编号" class="nav-link" data-scroll-target="#%E5%9B%BE%E5%BD%A2%E7%BC%96%E5%8F%B7"><span class="header-section-number">1.10.4</span> 图形编号</a></li>
  <li><a href="#%E5%9B%BE%E5%BD%A2%E6%8F%92%E5%85%A5" id="toc-图形插入" class="nav-link" data-scroll-target="#%E5%9B%BE%E5%BD%A2%E6%8F%92%E5%85%A5"><span class="header-section-number">1.10.5</span> 图形插入</a></li>
  </ul>
</li>
  <li><a href="#%E4%BF%9D%E5%AD%98%E5%92%8C%E5%88%A0%E9%99%A4" id="toc-保存和删除" class="nav-link" data-scroll-target="#%E4%BF%9D%E5%AD%98%E5%92%8C%E5%88%A0%E9%99%A4"><span class="header-section-number">1.11</span> 保存和删除</a></li>
  <li><a href="#ggplot2-%E7%9A%84%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84" id="toc-ggplot2-的内部结构" class="nav-link" data-scroll-target="#ggplot2-%E7%9A%84%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84"><span class="header-section-number">1.12</span> ggplot2 的内部结构</a></li>
  <li><a href="#ggproto%E5%AF%B9%E8%B1%A1" id="toc-ggproto对象" class="nav-link" data-scroll-target="#ggproto%E5%AF%B9%E8%B1%A1"><span class="header-section-number">1.13</span> <strong>ggproto对象</strong></a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><div class="quarto-title-block"><div class="quarto-title-tools-only"><h1></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div><section id="sec-ggplot2" class="level1" style="color:red" data-number="1"><h1 style="color:red" data-number="1">
<span class="header-section-number">1</span> ggplot2 Graphics</h1>
<p><a href="https://ggplot2-book.org/mastery">ggplot2：用于数据分析的优雅图形</a></p>
<p>gg 为 grammar of graphics 的缩写。</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="ggplotdata-mapping-aesxy" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="ggplotdata-mapping-aesxy">
<span class="header-section-number">1.1</span> <code>ggplot(data =  ,mapping = aes(x,y,…))</code>
</h2>
<section id="data" class="level3" data-number="1.1.1"><h3 data-number="1.1.1" class="anchored" data-anchor-id="data">
<span class="header-section-number">1.1.1</span> data</h3>
<p>ggplot2包的内置数据集 <code>mpg</code> 和 <code>diamonds</code></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 11</span></span>
<span><span class="co">#&gt;   manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; </span></span>
<span><span class="co">#&gt; 1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compa…</span></span>
<span><span class="co">#&gt; 2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p     compa…</span></span>
<span><span class="co">#&gt; 3 audi         a4      2    2008     4 manual(m6) f        20    31 p     compa…</span></span>
<span><span class="co">#&gt; 4 audi         a4      2    2008     4 auto(av)   f        21    30 p     compa…</span></span>
<span><span class="co">#&gt; 5 audi         a4      2.8  1999     6 auto(l5)   f        16    26 p     compa…</span></span>
<span><span class="co">#&gt; 6 audi         a4      2.8  1999     6 manual(m5) f        18    26 p     compa…</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-2-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="aesthetics-mapping" class="level3" data-number="1.1.2"><h3 data-number="1.1.2" class="anchored" data-anchor-id="aesthetics-mapping">
<span class="header-section-number">1.1.2</span> aesthetics mapping</h3>
<p><code>mapping=aes(x,y,z,..,color,fill,shape,size,group,linewidth,linetype,alpha,...)</code></p>
<section id="坐标" class="level4" data-number="1.1.2.1"><h4 data-number="1.1.2.1" class="anchored" data-anchor-id="坐标">
<span class="header-section-number">1.1.2.1</span> 坐标</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span><span class="va">hwy</span> <span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="shape" class="level4" data-number="1.1.2.2"><h4 data-number="1.1.2.2" class="anchored" data-anchor-id="shape">
<span class="header-section-number">1.1.2.2</span> shape</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span><span class="co">#颜色 名义型变量</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape<span class="op">=</span><span class="st">"."</span><span class="op">)</span> <span class="co">#像素点</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-4-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, shape <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co">#形状最多可以映射6个</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The shape palette can deal with a maximum of 6 discrete values because more</span></span>
<span><span class="co">#&gt; than 6 becomes difficult to discriminate</span></span>
<span><span class="co">#&gt; ℹ you have requested 7 values. Consider specifying shapes manually if you need</span></span>
<span><span class="co">#&gt;   that many have them.</span></span>
<span><span class="co">#&gt; Warning: Removed 62 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-4-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co">#形状共有26个</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape<span class="op">=</span><span class="fl">22</span>,color<span class="op">=</span><span class="st">"red"</span>,fill<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-4-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">mpg</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">class</span> <span class="op">==</span> <span class="st">"2seater"</span><span class="op">)</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">mpg</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">class</span> <span class="op">==</span> <span class="st">"2seater"</span><span class="op">)</span>, </span>
<span>    shape <span class="op">=</span> <span class="st">"circle open"</span>,<span class="co"># shape = 1</span></span>
<span>    size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-4-4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/shape.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, size <span class="op">=</span><span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span><span class="co">#大小 有序型变量</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, alpha <span class="op">=</span> <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span><span class="co">#透明度 有序型变量</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="co">#更改外观</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-5-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, linetype <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co">#线条类型</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-5-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, linewidth <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co">#线条粗细</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using linewidth for a discrete variable is not advised.</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-5-4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="geometry" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="geometry">
<span class="header-section-number">1.2</span> geometry</h2>
<ul>
<li>
<p>Graphical primitives:</p>
<ul>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_blank.html">geom_blank()</a></code>: display nothing. Most useful for adjusting axes limits using data.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>: points.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path()</a></code>: paths.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon()</a></code>: ribbons, a path with vertical thickness.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment()</a></code>: a line segment, specified by start and end position.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect()</a></code>: rectangles.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon()</a></code>: filled polygons.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code>: text.</p></li>
</ul>
</li>
</ul>
<!-- --><ul>
<li>
<p>One variable:</p>
<ul>
<li>
<p>Discrete:</p>
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>: display distribution of discrete variable.</li>
</ul>
</li>
<li>
<p>Continuous:</p>
<ul>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code>: bin and count continuous variable, display with bars.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code>: smoothed density estimate.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_dotplot.html">geom_dotplot()</a></code>: stack individual points into a dot plot.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_freqpoly()</a></code>: bin and count continuous variable, display with lines.</p></li>
</ul>
</li>
</ul>
</li>
<li>
<p>Two variables:</p>
<ul>
<li>
<p>Both continuous:</p>
<ul>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>: scatterplot.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_quantile.html">geom_quantile()</a></code>: smoothed quantile regression.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_rug.html">geom_rug()</a></code>: marginal rug plots.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code>: smoothed line of best fit.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code>: text labels.</p></li>
</ul>
</li>
<li>
<p>Show distribution:</p>
<ul>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_bin_2d.html">geom_bin2d()</a></code>: bin into rectangles and count.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_density_2d.html">geom_density2d()</a></code>: smoothed 2d density estimate.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">geom_hex()</a></code>: bin into hexagons and count.</p></li>
</ul>
</li>
<li>
<p>At least one discrete:</p>
<ul>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_count.html">geom_count()</a></code>: count number of point at distinct locations</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter()</a></code>: randomly jitter overlapping points.</p></li>
</ul>
</li>
<li>
<p>One continuous, one discrete:</p>
<ul>
<li><p><code>geom_bar(stat = "identity")</code>: a bar chart of precomputed summaries.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code>: boxplots.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin()</a></code>: show density of values in each group.</p></li>
</ul>
</li>
<li>
<p>One time, one continuous:</p>
<ul>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area()</a></code>: area plot.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>: line plot.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_step()</a></code>: step plot.</p></li>
</ul>
</li>
<li>
<p>Display uncertainty:</p>
<ul>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_crossbar()</a></code>: vertical bar with center.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar()</a></code>: error bars.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange()</a></code>: vertical line.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_pointrange()</a></code>: vertical line with center.</p></li>
</ul>
</li>
<li>
<p>Spatial:</p>
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_map.html">geom_map()</a></code>: fast version of for map data.<code><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon()</a></code>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Three variables:</p>
<ul>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">geom_contour()</a></code>: contours.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile()</a></code>: tile the plane with rectangles.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_raster()</a></code>: fast version of for equal sized tiles.<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile()</a></code></p></li>
</ul>
</li>
</ul>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, </span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>, </span>
<span>  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, label <span class="op">=</span> <span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Hide axis label</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="co"># Shrink plot title</span></span>
<span></span>
<span><span class="op">(</span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"point"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"text"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"bar"</span><span class="op">)</span> <span class="op">)</span><span class="op">/</span></span>
<span><span class="op">(</span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"tile"</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_raster</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"raster"</span><span class="op">)</span><span class="op">+</span></span>
<span>     <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"line"</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span></span>
<span><span class="op">(</span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"area"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"path"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"polygon"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="x连续型变量" class="level3" data-number="1.2.1"><h3 data-number="1.2.1" class="anchored" data-anchor-id="x连续型变量">
<span class="header-section-number">1.2.1</span> X=连续型变量</h3>
<section id="geom_point" class="level4" data-number="1.2.1.1"><h4 data-number="1.2.1.1" class="anchored" data-anchor-id="geom_point">
<span class="header-section-number">1.2.1.1</span> geom_point</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span>,y<span class="op">=</span><span class="va">hwy</span><span class="op">)</span>,</span>
<span>               stat <span class="op">=</span> <span class="st">"identity"</span>,position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-7-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>,<span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>,<span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">displ</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html">scale_size_area</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"displ/10"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-8-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_line" class="level4" data-number="1.2.1.2"><h4 data-number="1.2.1.2" class="anchored" data-anchor-id="geom_line">
<span class="header-section-number">1.2.1.2</span> geom_line</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">economics</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 6</span></span>
<span><span class="co">#&gt;   date         pce    pop psavert uempmed unemploy</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 1967-07-01  507. 198712    12.6     4.5     2944</span></span>
<span><span class="co">#&gt; 2 1967-08-01  510. 198911    12.6     4.7     2945</span></span>
<span><span class="co">#&gt; 3 1967-09-01  516. 199113    11.9     4.6     2958</span></span>
<span><span class="co">#&gt; 4 1967-10-01  512. 199311    12.9     4.9     3143</span></span>
<span><span class="co">#&gt; 5 1967-11-01  517. 199498    12.8     4.7     3066</span></span>
<span><span class="co">#&gt; 6 1967-12-01  525. 199657    11.8     4.8     3018</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">economics</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">date</span>,<span class="va">pop</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-9-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_smooth" class="level4" data-number="1.2.1.3"><h4 data-number="1.2.1.3" class="anchored" data-anchor-id="geom_smooth">
<span class="header-section-number">1.2.1.3</span> geom_smooth</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">q</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>,span <span class="op">=</span> <span class="fl">0.2</span>,se<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co"># loess 平滑局部回归   small n</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-10-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>                                   <span class="co">#span 0非常摆动，1不那么摆动</span></span>
<span></span>
<span><span class="va">q</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>span <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>  <span class="co">#不很摆动</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-10-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="va">q</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"rlm"</span><span class="op">)</span>   <span class="co"># robust linear model  稳健线性模型</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-10-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: nlme</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'nlme'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     collapse</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This is mgcv 1.9-1. For overview type 'help("mgcv-package")'.</span></span>
<span><span class="va">q</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"gam"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># gam 广义相加模型   n&gt;1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-10-4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">binomial_smooth</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"glm"</span>, method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">rpart</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/rpart/man/kyphosis.html">kyphosis</a></span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Age</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Kyphosis</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">binomial_smooth</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-11-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_histogram" class="level4" data-number="1.2.1.4"><h4 data-number="1.2.1.4" class="anchored" data-anchor-id="geom_histogram">
<span class="header-section-number">1.2.1.4</span> geom_histogram</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-12-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="va">displ</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># 加权</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-12-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span>,y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   stat <span class="op">=</span> <span class="st">"bin"</span>,position <span class="op">=</span> <span class="st">"stack"</span>,</span>
<span>                   binwidth <span class="op">=</span> <span class="fl">0.5</span></span>
<span>                   <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span>,y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"red"</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-12-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_bin2d" class="level4" data-number="1.2.1.5"><h4 data-number="1.2.1.5" class="anchored" data-anchor-id="geom_bin2d">
<span class="header-section-number">1.2.1.5</span> geom_bin2d()</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">smaller</span> <span class="op">&lt;-</span> <span class="va">diamonds</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">carat</span> <span class="op">&lt;</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">smaller</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">carat</span>, y <span class="op">=</span> <span class="va">price</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bin_2d.html">geom_bin2d</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-13-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># install.packages("hexbin")</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">smaller</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">carat</span>, y <span class="op">=</span> <span class="va">price</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">geom_hex</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Computation failed in `stat_binhex()`.</span></span>
<span><span class="co">#&gt; Caused by error in `compute_group()`:</span></span>
<span><span class="co">#&gt; ! The package "hexbin" is required for `stat_bin_hex()`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-13-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_freqpoly" class="level4" data-number="1.2.1.6"><h4 data-number="1.2.1.6" class="anchored" data-anchor-id="geom_freqpoly">
<span class="header-section-number">1.2.1.6</span> geom_freqpoly</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_freqpoly</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-14-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_density" class="level4" data-number="1.2.1.7"><h4 data-number="1.2.1.7" class="anchored" data-anchor-id="geom_density">
<span class="header-section-number">1.2.1.7</span> geom_density</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>,fill<span class="op">=</span><span class="va">drv</span><span class="op">)</span>,</span>
<span>                 stat <span class="op">=</span> <span class="st">"density"</span>,position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>                 alpha<span class="op">=</span><span class="fl">0.3</span></span>
<span>                 <span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">"图例名"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-15-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_rug" class="level4" data-number="1.2.1.8"><h4 data-number="1.2.1.8" class="anchored" data-anchor-id="geom_rug">
<span class="header-section-number">1.2.1.8</span> geom_rug</h4>
<p>y→<code>sides="r","l"</code></p>
<p>x→<code>sides="b","t"</code></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_rug.html">geom_rug</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span>,y<span class="op">=</span><span class="va">hwy</span><span class="op">)</span>,</span>
<span>           sides <span class="op">=</span> <span class="st">"br"</span>,color<span class="op">=</span><span class="st">"brown"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-16-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_jitter" class="level4" data-number="1.2.1.9"><h4 data-number="1.2.1.9" class="anchored" data-anchor-id="geom_jitter">
<span class="header-section-number">1.2.1.9</span> geom_jitter</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span>,y<span class="op">=</span><span class="va">hwy</span><span class="op">)</span>,</span>
<span>               stat <span class="op">=</span> <span class="st">"identity"</span>,position <span class="op">=</span> <span class="st">"jitter"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-17-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="x离散型变量" class="level3" data-number="1.2.2"><h3 data-number="1.2.2" class="anchored" data-anchor-id="x离散型变量">
<span class="header-section-number">1.2.2</span> X=离散型变量</h3>
<section id="geom_bar" class="level4" data-number="1.2.2.1"><h4 data-number="1.2.2.1" class="anchored" data-anchor-id="geom_bar">
<span class="header-section-number">1.2.2.1</span> geom_bar</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>,fill<span class="op">=</span><span class="va">drv</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"count"</span>,position <span class="op">=</span> <span class="st">"stack"</span><span class="op">)</span> <span class="op">|</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>,fill<span class="op">=</span><span class="va">drv</span><span class="op">)</span>,</span>
<span>             position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-18-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>,y<span class="op">=</span><span class="va">hwy</span>,fill<span class="op">=</span><span class="va">drv</span><span class="op">)</span>,</span>
<span>             position <span class="op">=</span> <span class="st">"stack"</span><span class="op">)</span> <span class="op">|</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>,y<span class="op">=</span><span class="va">hwy</span>,fill<span class="op">=</span><span class="va">drv</span><span class="op">)</span>,</span>
<span>             position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">label_percent</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-18-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>有序条形图</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="co">#降序条形图</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-19-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_errorbar" class="level4" data-number="1.2.2.2"><h4 data-number="1.2.2.2" class="anchored" data-anchor-id="geom_errorbar">
<span class="header-section-number">1.2.2.2</span> geom_errorbar</h4>
<ul>
<li><p>geom_errorbarh</p></li>
<li><p>geom_linerange</p></li>
<li><p>geom_crossbar</p></li>
<li><p>geom_pointrange</p></li>
</ul>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18</span>, <span class="fl">11</span>, <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y <span class="op">=</span> <span class="va">y</span>, se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, ymin <span class="op">=</span> <span class="va">y</span> <span class="op">-</span> <span class="va">se</span>, ymax <span class="op">=</span> <span class="va">y</span> <span class="op">+</span> <span class="va">se</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">base</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">base</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange</a></span><span class="op">(</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">base</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">/</span></span>
<span><span class="op">(</span><span class="va">base</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_crossbar</a></span><span class="op">(</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">base</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_pointrange</a></span><span class="op">(</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">base</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-20-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/g.csv"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">summarise</span><span class="op">(</span></span>
<span>        mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">liverweight</span><span class="op">)</span>,</span>
<span>        sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">liverweight</span><span class="op">)</span>,</span>
<span>        .by<span class="op">=</span><span class="va">treatment</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">treatment</span>,<span class="va">mean</span>,fill<span class="op">=</span><span class="va">treatment</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">mean</span><span class="op">-</span><span class="va">sd</span>,ymax<span class="op">=</span><span class="va">mean</span><span class="op">+</span><span class="va">sd</span><span class="op">)</span>,width<span class="op">=</span><span class="fl">.2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 20 Columns: 2</span></span>
<span><span class="co">#&gt; ── Column specification ────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Delimiter: ","</span></span>
<span><span class="co">#&gt; chr (1): treatment</span></span>
<span><span class="co">#&gt; dbl (1): liverweight</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-21-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_dotplot" class="level4" data-number="1.2.2.3"><h4 data-number="1.2.2.3" class="anchored" data-anchor-id="geom_dotplot">
<span class="header-section-number">1.2.2.3</span> geom_dotplot</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_dotplot.html">geom_dotplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">drv</span>,y<span class="op">=</span><span class="va">hwy</span><span class="op">)</span>,</span>
<span>                 position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>                 stackdir <span class="op">=</span> <span class="st">"center"</span>,binaxis <span class="op">=</span> <span class="st">'y'</span>,<span class="co"># stacking along y axis</span></span>
<span>                 fill<span class="op">=</span><span class="st">"red"</span>,binwidth <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-22-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_boxplot" class="level4" data-number="1.2.2.4"><h4 data-number="1.2.2.4" class="anchored" data-anchor-id="geom_boxplot">
<span class="header-section-number">1.2.2.4</span> geom_boxplot</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">drv</span>,y<span class="op">=</span><span class="va">hwy</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"boxplot"</span>,position <span class="op">=</span> <span class="st">"dodge"</span>,</span>
<span>             notch<span class="op">=</span><span class="cn">TRUE</span>, varwidth<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>             width<span class="op">=</span><span class="fl">0.1</span>,fill<span class="op">=</span><span class="st">"green"</span></span>
<span>            <span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">drv</span>,y<span class="op">=</span><span class="va">hwy</span><span class="op">)</span>,alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-23-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_violin" class="level4" data-number="1.2.2.5"><h4 data-number="1.2.2.5" class="anchored" data-anchor-id="geom_violin">
<span class="header-section-number">1.2.2.5</span> geom_violin</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">drv</span>,y<span class="op">=</span><span class="va">hwy</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"ydensity"</span>,position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-24-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_tile" class="level4" data-number="1.2.2.6"><h4 data-number="1.2.2.6" class="anchored" data-anchor-id="geom_tile">
<span class="header-section-number">1.2.2.6</span> geom_tile</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 设置随机数种子以确保结果的可重复性  </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>  </span>
<span>  </span>
<span><span class="co"># 生成随机数据集  </span></span>
<span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>  </span>
<span>  year <span class="op">=</span> <span class="fl">2000</span><span class="op">:</span><span class="fl">2024</span>,  </span>
<span>  lung <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  liver <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>, </span>
<span>  bone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  luk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  eso <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  gas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,   </span>
<span>  eye <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  brain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  pan <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  kidney <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  breast<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>                   names_to <span class="op">=</span> <span class="st">"cancer"</span>,</span>
<span>                   values_to <span class="op">=</span> <span class="st">"morbidity"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mydata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">cancer</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span><span class="va">morbidity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-25-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="统计变换-statistical-transformations" class="level3" data-number="1.2.3"><h3 data-number="1.2.3" class="anchored" data-anchor-id="统计变换-statistical-transformations">
<span class="header-section-number">1.2.3</span> 统计变换 statistical transformations</h3>
<p>stat_bin()：geom_bar()，geom_freqpoly()，geom_histogram()</p>
<p>stat_bin2d()：geom_bin2d()</p>
<p>stat_bindot()：geom_dotplot()</p>
<p>stat_binhex()：geom_hex()</p>
<p>stat_boxplot()：geom_boxplot()</p>
<p>stat_contour()：geom_contour()</p>
<p>stat_quantile()：geom_quantile()</p>
<p>stat_smooth()：geom_smooth()</p>
<p>stat_sum()：geom_count()</p>
<p>stat_ecdf()：计算经验累积分布图。</p>
<p>stat_function()：根据 x 值的函数计算 y 值。</p>
<p>stat_summary()：将 Y 值汇总到不同的 X 值。</p>
<p>stat_summary2d() ：汇总分箱值。</p>
<p>stat_summary_hex()</p>
<p>stat_qq()：对分位数-分位数图执行计算。</p>
<p>stat_spoke()：将角度和半径转换为位置。</p>
<p>stat_unique()：删除重复的行。</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cut</span>, y <span class="op">=</span> <span class="va">depth</span><span class="op">)</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>    fun.min <span class="op">=</span> <span class="va">min</span>,</span>
<span>    fun.max <span class="op">=</span> <span class="va">max</span>,</span>
<span>    fun <span class="op">=</span> <span class="va">mean</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-26-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">trans</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"point"</span>, fun <span class="op">=</span> <span class="st">"mean"</span>, colour <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-26-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="位置调整-position-adjustments" class="level3" data-number="1.2.4"><h3 data-number="1.2.4" class="anchored" data-anchor-id="位置调整-position-adjustments">
<span class="header-section-number">1.2.4</span> 位置调整 position adjustments</h3>
<section id="条" class="level4" data-number="1.2.4.1"><h4 data-number="1.2.4.1" class="anchored" data-anchor-id="条">
<span class="header-section-number">1.2.4.1</span> 条</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">drv</span>, fill <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span><span class="op">|</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">drv</span>, color <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NA</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-27-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">drv</span>, fill <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span><span class="op">|</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">drv</span>, fill <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-27-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="点" class="level4" data-number="1.2.4.2"><h4 data-number="1.2.4.2" class="anchored" data-anchor-id="点">
<span class="header-section-number">1.2.4.2</span> 点</h4>
<p>position_nudge()：按固定偏移量移动点。</p>
<p>position_jitter()：为每个位置添加一点随机噪音。</p>
<p>position_jitterdodge()：躲避组内的点，然后添加一点随机噪音。</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">|</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"jitter"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-28-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>position <span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">0.1</span>,y<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">hwy</span>,color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html">position_jitterdodge</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-28-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="坐标系-coordinate" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="坐标系-coordinate">
<span class="header-section-number">1.3</span> 坐标系 coordinate</h2>
<p>默认坐标系是笛卡尔坐标系</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">clarity</span>, fill <span class="op">=</span> <span class="va">clarity</span><span class="op">)</span>, </span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">bar</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-29-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bar</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|</span><span class="co">#笛卡尔坐标</span></span>
<span><span class="va">bar</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span><span class="op">|</span> <span class="co">#水平条形图</span></span>
<span><span class="va">bar</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html">coord_polar</a></span><span class="op">(</span><span class="op">)</span><span class="co">#极坐标</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-29-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="坐标轴-axis" class="level2" data-number="1.4"><h2 data-number="1.4" class="anchored" data-anchor-id="坐标轴-axis">
<span class="header-section-number">1.4</span> 坐标轴 axis</h2>
<section id="变换" class="level3" data-number="1.4.1"><h3 data-number="1.4.1" class="anchored" data-anchor-id="变换">
<span class="header-section-number">1.4.1</span> 变换</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">cty</span><span class="op">)</span>,<span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-30-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="limits" class="level3" data-number="1.4.2"><h3 data-number="1.4.2" class="anchored" data-anchor-id="limits">
<span class="header-section-number">1.4.2</span> limits</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-31-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">drv</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="st">"f"</span>, <span class="st">"r"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">25</span>, <span class="cn">NA</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-31-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># filter</span></span>
<span><span class="va">mpg</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">displ</span> <span class="op">&gt;=</span> <span class="fl">5</span> <span class="op">&amp;</span> <span class="va">displ</span> <span class="op">&lt;=</span> <span class="fl">6</span> <span class="op">&amp;</span> <span class="va">hwy</span> <span class="op">&gt;=</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">hwy</span> <span class="op">&lt;=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="co"># limits</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>    <span class="co">#取子集</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; Warning: Removed 202 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-32-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="zooming" class="level3" data-number="1.4.3"><h3 data-number="1.4.3" class="anchored" data-anchor-id="zooming">
<span class="header-section-number">1.4.3</span> zooming</h3>
<p>调整绘制的数据,在每个刻度中设置<code>coord_cartesian(xlim= ,ylim= )</code></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span>   <span class="co">#放大局部</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-33-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="共享" class="level3" data-number="1.4.4"><h3 data-number="1.4.4" class="anchored" data-anchor-id="共享">
<span class="header-section-number">1.4.4</span> 共享</h3>
<p>shared 坐标轴相同</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x_scale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">$</span><span class="va">displ</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y_scale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">$</span><span class="va">hwy</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">col_scale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">$</span><span class="va">drv</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">[</span><span class="va">mpg</span><span class="op">$</span><span class="va">class</span><span class="op">==</span><span class="st">"suv"</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">x_scale</span> <span class="op">+</span></span>
<span>  <span class="va">y_scale</span> <span class="op">+</span></span>
<span>  <span class="va">col_scale</span><span class="op">|</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">[</span><span class="va">mpg</span><span class="op">$</span><span class="va">class</span><span class="op">==</span><span class="st">"compact"</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">x_scale</span> <span class="op">+</span></span>
<span>  <span class="va">y_scale</span> <span class="op">+</span></span>
<span>  <span class="va">col_scale</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-34-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="标题-labels" class="level2" data-number="1.5"><h2 data-number="1.5" class="anchored" data-anchor-id="标题-labels">
<span class="header-section-number">1.5</span> 标题 labels</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">cty</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"city driving (mpg)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"highway driving (mpg)"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"主标题"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-35-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Engine displacement (L)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Highway fuel economy (mpg)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Car type"</span>, <span class="co"># 图例 美学映射color</span></span>
<span>    title <span class="op">=</span> <span class="st">"Fuel efficiency generally decreases with engine size"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Two seaters (sports cars) are an </span></span>
<span><span class="st">    exception because of their light weight"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Data from fueleconomy.gov"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-35-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="注释-annotation" class="level2" data-number="1.6"><h2 data-number="1.6" class="anchored" data-anchor-id="注释-annotation">
<span class="header-section-number">1.6</span> 注释 annotation</h2>
<section id="文本-text" class="level3" data-number="1.6.1"><h3 data-number="1.6.1" class="anchored" data-anchor-id="文本-text">
<span class="header-section-number">1.6.1</span> 文本 text</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 字体</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">1</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sans"</span>, <span class="st">"serif"</span>, <span class="st">"mono"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">family</span>, family <span class="op">=</span> <span class="va">family</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-36-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># 样式</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">1</span>, face <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"plain"</span>, <span class="st">"bold"</span>, <span class="st">"italic"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">face</span>, fontface <span class="op">=</span> <span class="va">face</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-36-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># 位置</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"bottom-left"</span>, <span class="st">"top-left"</span>,  </span>
<span>    <span class="st">"bottom-right"</span>, <span class="st">"top-right"</span>, <span class="st">"center"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">text</span><span class="op">)</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">text</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="st">"inward"</span>, hjust <span class="op">=</span> <span class="st">"inward"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-36-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="co"># 自定义</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span>, </span>
<span>  response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">3.4</span>, <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">treatment</span>, <span class="va">response</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="va">response</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    nudge_x <span class="op">=</span> <span class="op">-</span><span class="fl">0.3</span>,</span>
<span>    nudge_y<span class="op">=</span><span class="fl">.2</span></span>
<span>  <span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-36-4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">cyl</span>,<span class="va">am</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">summarise</span><span class="op">(</span>n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>pct <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>         lbls <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">(</span><span class="va">pct</span><span class="op">)</span></span>
<span>         <span class="op">)</span><span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>,<span class="va">pct</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">am</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">lbls</span><span class="op">)</span>,</span>
<span>              position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html">position_stack</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>              size<span class="op">=</span><span class="fl">3</span></span>
<span>              <span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'cyl'. You can override using the `.groups`</span></span>
<span><span class="co">#&gt; argument.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-37-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">label_info</span> <span class="op">&lt;-</span> <span class="va">mpg</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">drv</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">displ</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">slice_head</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        drive_type <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>       <span class="co"># vectorise multiple if_else () statements </span></span>
<span>        <span class="va">drv</span> <span class="op">==</span> <span class="st">"f"</span> <span class="op">~</span> <span class="st">"front-wheel drive"</span>,</span>
<span>        <span class="va">drv</span> <span class="op">==</span> <span class="st">"r"</span> <span class="op">~</span> <span class="st">"rear-wheel drive"</span>,</span>
<span>        <span class="va">drv</span> <span class="op">==</span> <span class="st">"4"</span> <span class="op">~</span> <span class="st">"4-wheel drive"</span><span class="op">)</span></span>
<span>        <span class="op">)</span><span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span>, <span class="va">drv</span>, <span class="va">drive_type</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,formula<span class="op">=</span><span class="st">"y~x"</span>,se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span><span class="op">+</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="co">#添加注释  geom_label 标签加背景框</span></span>
<span>    data <span class="op">=</span> <span class="va">label_info</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, label <span class="op">=</span> <span class="va">drive_type</span><span class="op">)</span>,<span class="co">#label映射</span></span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">5</span>, nudge_y <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-38-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html">geom_label_repel</a></span><span class="op">(</span>                   </span>
<span>    data <span class="op">=</span> <span class="va">label_info</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, label <span class="op">=</span> <span class="va">drive_type</span><span class="op">)</span>,</span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">5</span>, nudge_y <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-38-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">potential_outliers</span> <span class="op">&lt;-</span> <span class="va">mpg</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hwy</span> <span class="op">&gt;</span> <span class="fl">40</span> <span class="op">|</span> <span class="op">(</span><span class="va">hwy</span> <span class="op">&gt;</span> <span class="fl">20</span> <span class="op">&amp;</span> <span class="va">displ</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">potential_outliers</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">potential_outliers</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">potential_outliers</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">3</span>, shape <span class="op">=</span> <span class="st">"circle open"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-38-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="markdown" class="level3" data-number="1.6.2"><h3 data-number="1.6.2" class="anchored" data-anchor-id="markdown">
<span class="header-section-number">1.6.2</span> markdown</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Axis title with *italics* and **boldface**"</span><span class="op">)</span></span>
<span><span class="va">base</span> <span class="op">|</span></span>
<span><span class="va">base</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu">ggtext</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_markdown.html">element_markdown</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>  <span class="co">#ggtext::element_markdown</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-39-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="数学表达式" class="level3" data-number="1.6.3"><h3 data-number="1.6.3" class="anchored" data-anchor-id="数学表达式">
<span class="header-section-number">1.6.3</span> 数学表达式</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">^</span> <span class="fl">2</span>, <span class="va">i</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="co">#数学方程式</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-40-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, to <span class="op">=</span> <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">values</span>, y <span class="op">=</span> <span class="va">values</span> <span class="op">^</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="va">x</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>         <span class="co">#数学表达式   ？plotmath</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-40-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="线段-直线-箭头" class="level3" data-number="1.6.4"><h3 data-number="1.6.4" class="anchored" data-anchor-id="线段-直线-箭头">
<span class="header-section-number">1.6.4</span> 线段 直线 箭头</h3>
<p>geom_hline()</p>
<p>geom_vline()</p>
<p>geom_abline</p>
<p>geom_segment() arrow</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">trend_text</span> <span class="op">&lt;-</span> <span class="st">"Larger engine sizes tend to have lower fuel economy."</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">str_wrap</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">trend_text</span></span>
<span><span class="co">#&gt; [1] "Larger engine sizes tend to\nhave lower fuel economy."</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"label"</span>, x <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="fl">38</span>,</span>
<span>    label <span class="op">=</span> <span class="va">trend_text</span>,</span>
<span>    hjust <span class="op">=</span> <span class="st">"left"</span>, color <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="fl">35</span>, xend <span class="op">=</span> <span class="fl">5</span>, yend <span class="op">=</span> <span class="fl">25</span>, color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"closed"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-41-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">manufacturer</span> <span class="op">==</span> <span class="st">"subaru"</span><span class="op">)</span>, </span>
<span>    colour <span class="op">=</span> <span class="st">"orange"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">p</span><span class="op">|</span><span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"point"</span>, x <span class="op">=</span> <span class="fl">5.5</span>, y <span class="op">=</span> <span class="fl">40</span>, colour <span class="op">=</span> <span class="st">"orange"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"point"</span>, x <span class="op">=</span> <span class="fl">5.5</span>, y <span class="op">=</span> <span class="fl">40</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">5.6</span>, y <span class="op">=</span> <span class="fl">40</span>, label <span class="op">=</span> <span class="st">"subaru"</span>, hjust <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"curve"</span>, x <span class="op">=</span> <span class="fl">4</span>, y <span class="op">=</span> <span class="fl">35</span>, xend <span class="op">=</span> <span class="fl">2.65</span>, yend <span class="op">=</span> <span class="fl">27</span>, </span>
<span>    curvature <span class="op">=</span> <span class="fl">.3</span>, arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">4.1</span>, y <span class="op">=</span> <span class="fl">35</span>, label <span class="op">=</span> <span class="st">"subaru"</span>, hjust <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-42-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="scale" class="level2" data-number="1.7"><h2 data-number="1.7" class="anchored" data-anchor-id="scale">
<span class="header-section-number">1.7</span> scale</h2>
<section id="xy_continuous" class="level3" data-number="1.7.1"><h3 data-number="1.7.1" class="anchored" data-anchor-id="xy_continuous">
<span class="header-section-number">1.7.1</span> x/y_continuous</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wt</span>, y <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Weight (1000 lbs.)"</span>,   </span>
<span>                     n.breaks <span class="op">=</span> <span class="fl">10</span>,                 </span>
<span>                     minor_breaks <span class="op">=</span> <span class="cn">NULL</span>,           </span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">5.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>        </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Miles per gallon"</span>,     </span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">35</span>, <span class="fl">5</span><span class="op">)</span>,       </span>
<span>                     minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">35</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">35</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>          </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Fuel efficiency by car weight"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-43-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">diamonds</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">price</span>, y <span class="op">=</span> <span class="va">cut</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/dollar_format.html">label_dollar</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1000</span>, suffix <span class="op">=</span> <span class="st">"K"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-44-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">diamonds</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cut</span>, fill <span class="op">=</span> <span class="va">clarity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Percentage"</span>, labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">label_percent</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-44-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="xy_discrete" class="level3" data-number="1.7.2"><h3 data-number="1.7.2" class="anchored" data-anchor-id="xy_discrete">
<span class="header-section-number">1.7.2</span> x/y_discrete</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">drv</span><span class="op">)</span>,fill<span class="op">=</span><span class="va">class</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">-&gt;</span><span class="va">p</span></span>
<span><span class="va">p</span> <span class="op">|</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"drv"</span>,                                  </span>
<span>                   limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"f"</span>, <span class="st">"r"</span><span class="op">)</span>,    </span>
<span>                   labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'f'</span><span class="op">=</span><span class="st">"drv='f'"</span>,<span class="st">'r'</span><span class="op">=</span> <span class="st">"drv='r'"</span><span class="op">)</span>,</span>
<span>                   position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Warning: Removed 103 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_count()`).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-45-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="color" class="level3" data-number="1.7.3"><h3 data-number="1.7.3" class="anchored" data-anchor-id="color">
<span class="header-section-number">1.7.3</span> color</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">display.brewer.all</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-46-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span>, y<span class="op">=</span><span class="va">hwy</span>, color<span class="op">=</span><span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape<span class="op">=</span><span class="fl">19</span>, size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> </span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="http://jrnold.github.io/ggthemes/reference/colorblind.html">scale_color_colorblind</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-46-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span>, y<span class="op">=</span><span class="va">hwy</span>, color<span class="op">=</span><span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"A. Default color gradient"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_color_gradient</a></span><span class="op">(</span>low<span class="op">=</span><span class="st">"grey"</span>, high<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"B. Greyscale gradient"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_color_gradient</a></span><span class="op">(</span>low<span class="op">=</span><span class="st">"red"</span>, high<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"C. Red-blue color gradient"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-47-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_steps.html">scale_color_steps</a></span><span class="op">(</span>low<span class="op">=</span><span class="st">"red"</span>, high<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"D. Red-blue binned color Gradient"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_steps.html">scale_color_steps2</a></span><span class="op">(</span>low<span class="op">=</span><span class="st">"red"</span>, mid<span class="op">=</span><span class="st">"white"</span>, high<span class="op">=</span><span class="st">"blue"</span>,</span>
<span>                       midpoint<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">disp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"E. Red-white-blue binned gradient"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_c</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>    <span class="co"># viridis_c,d,b</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"F. Viridis color gradient"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-47-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">geom_hex</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Default, continuous"</span>, x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Computation failed in `stat_binhex()`.</span></span>
<span><span class="co">#&gt; Caused by error in `compute_group()`:</span></span>
<span><span class="co">#&gt; ! The package "hexbin" is required for `stat_bin_hex()`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-48-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">geom_hex</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Viridis, continuous"</span>, x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Computation failed in `stat_binhex()`.</span></span>
<span><span class="co">#&gt; Caused by error in `compute_group()`:</span></span>
<span><span class="co">#&gt; ! The package "hexbin" is required for `stat_bin_hex()`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-48-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">geom_hex</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_b</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Viridis, binned"</span>, x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Computation failed in `stat_binhex()`.</span></span>
<span><span class="co">#&gt; Caused by error in `compute_group()`:</span></span>
<span><span class="co">#&gt; ! The package "hexbin" is required for `stat_bin_hex()`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-48-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="fill" class="level3" data-number="1.7.4"><h3 data-number="1.7.4" class="anchored" data-anchor-id="fill">
<span class="header-section-number">1.7.4</span> fill</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">drv</span>,fill<span class="op">=</span><span class="va">class</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"A. Default colors"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Set2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"B. ColorBrewer Set2 palette"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-49-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"C. Viridis color scheme"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gold4"</span>, <span class="st">"orange2"</span>, <span class="st">"deepskyblue3"</span>, <span class="st">"blue4"</span>,</span>
<span>                               <span class="st">"brown2"</span>, <span class="st">"yellowgreen"</span>,<span class="st">"lightpink"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"D. Manual color selection"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-49-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="分面" class="level2" data-number="1.8"><h2 data-number="1.8" class="anchored" data-anchor-id="分面">
<span class="header-section-number">1.8</span> 分面</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 一个分类变量</span></span>
<span><span class="va">q</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">drv</span>,nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-50-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">q</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">drv</span>,ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>  <span class="co">#</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-50-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># 多个分类变量</span></span>
<span><span class="va">q</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">drv</span><span class="op">~</span><span class="va">class</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-50-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">q</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">drv</span><span class="op">~</span><span class="va">.</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-50-4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">q</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">drv</span><span class="op">)</span>   <span class="co">#</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-50-5.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">drv</span> <span class="op">~</span> <span class="va">cyl</span><span class="op">)</span> <span class="op">|</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">drv</span> <span class="op">~</span> <span class="va">cyl</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-51-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="主题" class="level2" data-number="1.9"><h2 data-number="1.9" class="anchored" data-anchor-id="主题">
<span class="header-section-number">1.9</span> 主题</h2>
<section id="内置主题" class="level3" data-number="1.9.1"><h3 data-number="1.9.1" class="anchored" data-anchor-id="内置主题">
<span class="header-section-number">1.9.1</span> 内置主题</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>,<span class="va">hwy</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_grey</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"theme_grey"</span><span class="op">)</span>  <span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"theme_bw"</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-52-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"theme_minimal"</span><span class="op">)</span><span class="op">|</span>  </span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"theme_classic"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-52-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="字体" class="level3" data-number="1.9.2"><h3 data-number="1.9.2" class="anchored" data-anchor-id="字体">
<span class="header-section-number">1.9.2</span> 字体</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">findfont</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yixuan/showtext">showtext</a></span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_files.html">font_files</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">family</span>, ignore.case<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">path</span>, <span class="va">file</span>, <span class="va">family</span>, <span class="va">face</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">findfont</span><span class="op">(</span><span class="st">"comic"</span><span class="op">)</span></span>
<span><span class="co">#&gt;               path        file        family        face</span></span>
<span><span class="co">#&gt; 1 C:/Windows/Fonts   comic.ttf Comic Sans MS     Regular</span></span>
<span><span class="co">#&gt; 2 C:/Windows/Fonts comicbd.ttf Comic Sans MS        Bold</span></span>
<span><span class="co">#&gt; 3 C:/Windows/Fonts  comici.ttf Comic Sans MS      Italic</span></span>
<span><span class="co">#&gt; 4 C:/Windows/Fonts  comicz.ttf Comic Sans MS Bold Italic</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_add.html">font_add</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Times New Roman"</span>, regular <span class="op">=</span> <span class="st">"C:\\Windows\\Fonts\\Times New Roman\\times.ttf"</span>,</span>
<span>         bold <span class="op">=</span> <span class="st">"C:\\Windows\\Fonts\\Times New Roman\\timesbd.ttf"</span>,</span>
<span>         italic <span class="op">=</span> <span class="st">"C:\\Windows\\Fonts\\Times New Roman\\timesi.ttf"</span>,</span>
<span>         bolditalic <span class="op">=</span> <span class="st">"C:\\Windows\\Fonts\\Times New Roman\\timesbi.ttf"</span><span class="op">)</span></span>
<span><span class="fu">findfont</span><span class="op">(</span><span class="st">"Times New Roman"</span><span class="op">)</span></span>
<span><span class="co">#&gt;               path        file          family        face</span></span>
<span><span class="co">#&gt; 1 C:/Windows/Fonts   times.ttf Times New Roman     Regular</span></span>
<span><span class="co">#&gt; 2 C:/Windows/Fonts timesbd.ttf Times New Roman        Bold</span></span>
<span><span class="co">#&gt; 3 C:/Windows/Fonts timesbi.ttf Times New Roman Bold Italic</span></span>
<span><span class="co">#&gt; 4 C:/Windows/Fonts  timesi.ttf Times New Roman      Italic</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_families.html">font_families</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "sans"                        "serif"                      </span></span>
<span><span class="co">#&gt;  [3] "mono"                        "wqy-microhei"               </span></span>
<span><span class="co">#&gt;  [5] "Times New Roman Regular"     "Times New Roman Bold"       </span></span>
<span><span class="co">#&gt;  [7] "Times New Roman Bold Italic" "Times New Roman Italic"     </span></span>
<span><span class="co">#&gt;  [9] "黑体 常规"                   "楷体 常规"                  </span></span>
<span><span class="co">#&gt; [11] "Times New Roman"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="自定义主题" class="level3" data-number="1.9.3"><h3 data-number="1.9.3" class="anchored" data-anchor-id="自定义主题">
<span class="header-section-number">1.9.3</span> 自定义主题</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mytheme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face<span class="op">=</span><span class="st">"bold.italic"</span>,  size<span class="op">=</span><span class="st">"14"</span>, color<span class="op">=</span><span class="st">"brown"</span><span class="op">)</span>,</span>
<span>                 axis.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face<span class="op">=</span><span class="st">"bold.italic"</span>,  size<span class="op">=</span><span class="fl">10</span>, color<span class="op">=</span><span class="st">"brown"</span><span class="op">)</span>,</span>
<span>                 axis.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face<span class="op">=</span><span class="st">"bold"</span>, size<span class="op">=</span><span class="fl">9</span>,  color<span class="op">=</span><span class="st">"darkblue"</span><span class="op">)</span>, </span>
<span>                 panel.background<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">"white"</span>,  color<span class="op">=</span><span class="st">"darkblue"</span><span class="op">)</span>,  </span>
<span>                 panel.grid.major.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"grey"</span>,  linetype<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,  </span>
<span>                 panel.grid.minor.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"grey"</span>,  linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,  </span>
<span>                 panel.grid.minor.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,  legend.position<span class="op">=</span><span class="st">"top"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">drv</span>, y<span class="op">=</span><span class="va">hwy</span>, fill<span class="op">=</span><span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="va">mytheme</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-54-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="图例" class="level3" data-number="1.9.4"><h3 data-number="1.9.4" class="anchored" data-anchor-id="图例">
<span class="header-section-number">1.9.4</span> 图例</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 位置和布局</span></span>
<span><span class="va">base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">base</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="co"># the default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-55-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">base</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-55-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">base</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-55-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">base</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span>, override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-55-4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># 文本</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">mpg</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Cylinders"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Fuel Efficiency for 32 Automobiles"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Weight (1000 lbs)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Miles per gallon"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.95</span>, <span class="fl">.95</span><span class="op">)</span>,</span>
<span>        legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>        legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightgrey"</span>,</span>
<span>                                         color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                                         linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        legend.key <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.direction <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2</span></span>
<span><span class="co">#&gt; 3.5.0.</span></span>
<span><span class="co">#&gt; ℹ Please use the `legend.position.inside` argument of `theme()` instead.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-55-5.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Larger engine sizes tend to have lower fuel economy"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Source: https://fueleconomy.gov."</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    legend.box.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>,hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    plot.title.position <span class="op">=</span> <span class="st">"plot"</span>,</span>
<span>    plot.caption.position <span class="op">=</span> <span class="st">"plot"</span>,</span>
<span>    plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-56-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="绘图区" class="level3" data-number="1.9.5"><h3 data-number="1.9.5" class="anchored" data-anchor-id="绘图区">
<span class="header-section-number">1.9.5</span> 绘图区</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Automatic"</span>, <span class="st">"Manual"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">disp</span>, y <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>                     </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>                   </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,                             </span>
<span>              linetype<span class="op">=</span><span class="st">"dotted"</span>, se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"Number of cylinders"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">am</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>                                      </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Mileage, transmission type, and number of cylinders"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Engine displacement (cu. in.)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Miles per gallon"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>                                                  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span>
<span>        panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"lightgrey"</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"lightgrey"</span>,</span>
<span>                                        linetype<span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span>,</span>
<span>        axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.key <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-57-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="图形布局patchwork" class="level2" data-number="1.10"><h2 data-number="1.10" class="anchored" data-anchor-id="图形布局patchwork">
<span class="header-section-number">1.10</span> 图形布局patchwork</h2>
<section id="布局方式" class="level3" data-number="1.10.1"><h3 data-number="1.10.1" class="anchored" data-anchor-id="布局方式">
<span class="header-section-number">1.10.1</span> 布局方式</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">drv</span>, y <span class="op">=</span> <span class="va">cty</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Plot 1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">drv</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Plot 2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cty</span>, color <span class="op">=</span> <span class="va">drv</span>, fill <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Plot 3"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span>, fill <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Plot 4"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cty</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">drv</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Plot 5"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-59-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-60-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-61-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-62-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p3</span> <span class="op">|</span> <span class="va">p4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-62-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p3</span> <span class="op">|</span> <span class="op">(</span><span class="va">p2</span> <span class="op">/</span> <span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-63-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span> <span class="va">layout</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">AAB</span></span>
<span><span class="st">C#B</span></span>
<span><span class="st">CDD</span></span>
<span><span class="st">"</span></span>
<span>  <span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">layout</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-64-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span>, guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-65-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="修改子图" class="level3" data-number="1.10.2"><h3 data-number="1.10.2" class="anchored" data-anchor-id="修改子图">
<span class="header-section-number">1.10.2</span> 修改子图</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="va">p12</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span>
<span>  <span class="va">p12</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p12</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">p12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-66-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="va">p1</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-66-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="va">p1</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">45</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-66-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="添加注释" class="level3" data-number="1.10.3"><h3 data-number="1.10.3" class="anchored" data-anchor-id="添加注释">
<span class="header-section-number">1.10.3</span> 添加注释</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="va">p3</span> <span class="op">+</span>                                      </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'主标题'</span>,caption <span class="op">=</span> <span class="st">"脚注"</span>,</span>
<span>                  theme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_gray</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"mono"</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">8</span><span class="op">)</span>,</span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-67-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="op">(</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/guide_area.html">guide_area</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span><span class="op">)</span> <span class="op">/</span> <span class="va">p5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"City and highway mileage for cars with different drive trains"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Source: https://fueleconomy.gov."</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span></span>
<span>    guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-67-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="图形编号" class="level3" data-number="1.10.4"><h3 data-number="1.10.4" class="anchored" data-anchor-id="图形编号">
<span class="header-section-number">1.10.4</span> 图形编号</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p123</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">|</span> <span class="op">(</span><span class="va">p2</span> <span class="op">/</span> <span class="va">p3</span><span class="op">)</span></span>
<span><span class="va">p123</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"I"</span><span class="op">)</span> <span class="co"># Uppercase roman numerics i</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-68-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">p123</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span> <span class="co"># lowercase letters A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-68-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p123</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span> <span class="co">#  numbers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-68-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  </span>
<span><span class="va">p123</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-68-4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p123</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p123</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>tag_level <span class="op">=</span> <span class="st">"new"</span><span class="op">)</span></span>
<span><span class="va">p123</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"I"</span>,<span class="st">"a"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-68-5.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="图形插入" class="level3" data-number="1.10.5"><h3 data-number="1.10.5" class="anchored" data-anchor-id="图形插入">
<span class="header-section-number">1.10.5</span> 图形插入</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/inset_element.html">inset_element</a></span><span class="op">(</span><span class="va">p2</span>, left <span class="op">=</span> <span class="fl">0.6</span>, bottom <span class="op">=</span> <span class="fl">0.6</span>, right <span class="op">=</span> <span class="fl">1</span>, top <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-69-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="va">p24</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">/</span> <span class="va">p4</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span>
<span>  <span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/inset_element.html">inset_element</a></span><span class="op">(</span><span class="va">p24</span>, left <span class="op">=</span> <span class="fl">0.5</span>, bottom <span class="op">=</span> <span class="fl">0.05</span>, right <span class="op">=</span> <span class="fl">0.95</span>, top <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-69-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="va">p12</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/inset_element.html">inset_element</a></span><span class="op">(</span><span class="va">p2</span>, left <span class="op">=</span> <span class="fl">0.5</span>, bottom <span class="op">=</span> <span class="fl">0.5</span>, right <span class="op">=</span> <span class="fl">0.9</span>, top <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span>  <span class="va">p12</span> <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-69-3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="va">p12</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-69-4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="保存和删除" class="level2" data-number="1.11"><h2 data-number="1.11" class="anchored" data-anchor-id="保存和删除">
<span class="header-section-number">1.11</span> 保存和删除</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svglite.r-lib.org">svglite</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"ggsave.svg"</span>, width <span class="op">=</span> <span class="fl">20</span>, height <span class="op">=</span> <span class="fl">20</span>, units <span class="op">=</span> <span class="st">"cm"</span><span class="op">)</span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html">unlink</a></span><span class="op">(</span><span class="st">"ggsave.svg"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="ggplot2-的内部结构" class="level2" data-number="1.12"><h2 data-number="1.12" class="anchored" data-anchor-id="ggplot2-的内部结构">
<span class="header-section-number">1.12</span> ggplot2 的内部结构</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"jitter"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"A plot for expository purposes"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-71-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ggprint</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_build.html">ggplot_build</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">gtable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_gtable.html">ggplot_gtable</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.draw.html">grid.draw</a></span><span class="op">(</span><span class="va">gtable</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">ggprint</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-72-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p_built</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_build.html">ggplot_build</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_built</span> <span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;      colour        x        y PANEL group shape size fill alpha stroke</span></span>
<span><span class="co">#&gt; 1   #00BA38 1.767385 29.04692     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 2   #00BA38 1.779773 29.15194     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 3   #00BA38 1.976448 30.77814     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 4   #00BA38 1.970823 30.37771     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 5   #00BA38 2.786053 25.70846     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 6   #00BA38 2.831331 25.73572     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 7   #00BA38 3.084410 27.01035     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 8   #F8766D 1.806981 25.99238     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 9   #F8766D 1.787019 24.96076     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 10  #F8766D 2.037209 28.32164     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 11  #F8766D 2.031835 26.73734     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 12  #F8766D 2.803323 24.61591     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 13  #F8766D 2.821173 24.93911     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 14  #F8766D 3.093628 24.64943     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 15  #F8766D 3.082713 25.13807     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 16  #F8766D 2.769765 23.99082     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 17  #F8766D 3.114283 25.25673     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 18  #F8766D 4.236953 23.33551     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 19  #619CFF 5.335211 20.37053     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 20  #619CFF 5.321781 14.81809     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 21  #619CFF 5.283038 19.71366     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 22  #619CFF 5.671630 17.36100     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 23  #619CFF 6.038297 17.10525     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 24  #619CFF 5.732564 25.74664     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 25  #619CFF 5.676562 22.60204     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 26  #619CFF 6.187115 25.98762     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 27  #619CFF 6.175819 24.87986     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 28  #619CFF 7.028669 24.12225     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 29  #F8766D 5.321105 19.05622     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 30  #F8766D 5.278746 14.34140     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 31  #F8766D 5.704519 15.13107     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 32  #F8766D 6.500463 16.60401     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 33  #00BA38 2.396365 27.33542     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 34  #00BA38 2.390231 29.83168     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 35  #00BA38 3.112008 25.74484     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 36  #00BA38 3.534620 29.03418     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 37  #00BA38 3.622772 25.74189     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 38  #00BA38 2.380276 23.90531     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 39  #00BA38 3.023258 23.82610     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 40  #00BA38 3.336608 21.79428     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 41  #00BA38 3.276630 22.24435     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 42  #00BA38 3.325406 24.29460     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 43  #00BA38 3.271618 23.67997     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 44  #00BA38 3.283089 17.33850     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 45  #00BA38 3.816214 22.30670     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 46  #00BA38 3.803259 21.25791     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 47  #00BA38 3.839192 23.21158     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 48  #00BA38 4.024944 23.08708     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 49  #F8766D 3.722582 18.72062     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 50  #F8766D 3.723848 18.02785     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 51  #F8766D 3.862451 17.34612     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 52  #F8766D 3.924025 16.73514     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 53  #F8766D 4.720194 19.34077     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 54  #F8766D 4.715034 19.29608     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 55  #F8766D 4.708938 11.87173     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 56  #F8766D 5.208688 17.17428     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 57  #F8766D 5.202502 15.21981     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 58  #F8766D 3.872759 17.19270     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 59  #F8766D 4.738936 17.27737     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 60  #F8766D 4.697238 12.03239     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 61  #F8766D 4.733710 16.78488     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 62  #F8766D 5.230557 16.30768     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 63  #F8766D 5.691053 18.16418     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 64  #F8766D 5.919106 14.66299     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 65  #F8766D 4.739009 16.04133     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 66  #F8766D 4.700964 11.71892     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 67  #F8766D 4.722044 16.72389     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 68  #F8766D 4.726070 17.28553     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 69  #F8766D 4.734337 16.11048     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 70  #F8766D 4.730609 11.76769     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 71  #F8766D 5.178997 14.78657     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 72  #F8766D 5.201561 15.75372     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 73  #F8766D 5.724607 16.76480     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 74  #F8766D 5.868224 15.36175     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 75  #619CFF 4.566835 17.09052     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 76  #619CFF 5.409523 17.03880     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 77  #619CFF 5.438758 17.63823     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 78  #F8766D 3.961246 17.14821     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 79  #F8766D 3.964623 19.37334     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 80  #F8766D 4.029912 17.25249     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 81  #F8766D 4.030852 19.39677     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 82  #F8766D 4.573844 18.60666     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 83  #F8766D 4.996931 16.88502     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 84  #F8766D 4.227030 16.61598     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 85  #F8766D 4.200593 16.74958     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 86  #F8766D 4.587502 15.67467     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 87  #F8766D 4.577617 16.39744     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 88  #F8766D 4.639492 16.89370     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 89  #F8766D 5.413256 15.38495     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 90  #F8766D 5.395187 17.18730     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 91  #619CFF 3.824527 25.63775     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 92  #619CFF 3.802077 25.02959     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 93  #619CFF 4.025991 25.89732     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 94  #619CFF 3.973712 24.27180     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 95  #619CFF 4.593057 20.65600     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 96  #619CFF 4.571709 22.23025     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 97  #619CFF 4.606725 22.67764     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 98  #619CFF 4.612550 21.96620     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 99  #619CFF 5.433011 20.14043     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 100 #00BA38 1.608225 32.82401     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 101 #00BA38 1.560008 31.69745     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 102 #00BA38 1.579337 31.61259     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 103 #00BA38 1.600461 29.22821     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 104 #00BA38 1.638751 31.69464     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 105 #00BA38 1.777011 33.97055     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 106 #00BA38 1.796975 35.80591     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 107 #00BA38 1.835005 35.69425     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 108 #00BA38 1.984558 28.70598     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 109 #00BA38 2.363958 26.19613     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 110 #00BA38 2.368529 26.63068     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 111 #00BA38 2.405860 30.02787     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 112 #00BA38 2.381869 30.73507     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 113 #00BA38 2.481247 26.33764     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 114 #00BA38 2.461744 25.90365     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 115 #00BA38 3.312542 28.12287     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 116 #00BA38 1.960408 25.85143     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 117 #00BA38 2.011533 29.33392     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 118 #00BA38 2.004485 28.39719     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 119 #00BA38 2.038957 27.37574     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 120 #00BA38 2.720188 24.06923     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 121 #00BA38 2.681605 24.16771     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 122 #00BA38 2.664355 23.76682     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 123 #F8766D 2.984553 22.37968     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 124 #F8766D 3.683057 18.72318     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 125 #F8766D 3.974925 19.93581     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 126 #F8766D 4.697462 16.69238     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 127 #F8766D 4.688008 11.64583     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 128 #F8766D 4.661013 19.11923     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 129 #F8766D 5.709572 18.26909     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 130 #F8766D 6.112262 14.17454     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 131 #F8766D 4.035512 14.87325     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 132 #F8766D 4.213724 18.08884     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 133 #F8766D 4.373704 18.37230     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 134 #F8766D 4.562636 14.79030     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 135 #619CFF 5.425738 16.76789     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 136 #619CFF 5.397741 16.21305     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 137 #619CFF 5.397364 18.32279     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 138 #F8766D 4.003754 17.32114     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 139 #F8766D 4.006280 19.18473     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 140 #F8766D 4.600332 18.70711     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 141 #F8766D 5.004909 17.18179     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 142 #00BA38 2.380109 28.68962     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 143 #00BA38 2.361079 26.92399     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 144 #00BA38 2.464177 30.72788     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 145 #00BA38 2.467865 32.20935     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 146 #00BA38 3.520032 27.31879     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 147 #00BA38 3.506839 25.94509     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 148 #00BA38 2.961881 26.17307     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 149 #00BA38 2.970279 25.26556     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 150 #00BA38 3.515182 24.66823     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 151 #F8766D 3.294832 17.37844     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 152 #F8766D 3.287630 16.66878     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 153 #F8766D 4.025586 19.93104     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 154 #F8766D 5.575201 18.34750     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 155 #00BA38 3.100411 26.30478     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 156 #00BA38 3.809106 25.87914     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 157 #00BA38 3.836894 27.32127     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 158 #00BA38 3.816914 27.63282     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 159 #00BA38 5.281958 25.36105     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 160 #F8766D 2.479656 25.14643     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 161 #F8766D 2.517608 23.73414     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 162 #F8766D 2.476203 27.08829     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 163 #F8766D 2.488423 25.03779     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 164 #F8766D 2.467977 25.95023     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 165 #F8766D 2.484887 23.34113     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 166 #F8766D 2.194877 25.95766     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 167 #F8766D 2.195964 26.04226     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 168 #F8766D 2.494856 25.76958     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 169 #F8766D 2.460401 26.28052     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 170 #F8766D 2.534661 24.94254     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 171 #F8766D 2.518775 27.38090     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 172 #F8766D 2.460154 25.20343     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 173 #F8766D 2.499887 27.14608     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 174 #F8766D 2.678748 19.81460     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 175 #F8766D 2.729221 20.12069     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 176 #F8766D 3.410290 18.82957     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 177 #F8766D 3.424672 16.83292     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 178 #F8766D 3.990400 20.28926     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 179 #F8766D 4.678479 16.93172     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 180 #00BA38 2.213521 28.62611     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 181 #00BA38 2.169546 27.34342     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 182 #00BA38 2.407445 30.91564     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 183 #00BA38 2.428250 31.24281     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 184 #00BA38 2.991238 25.63111     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 185 #00BA38 3.005920 26.18163     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 186 #00BA38 3.509076 28.03780     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 187 #00BA38 2.191874 26.98147     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 188 #00BA38 2.233795 28.72760     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 189 #00BA38 2.415032 31.16068     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 190 #00BA38 2.423621 31.10122     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 191 #00BA38 2.998445 26.01762     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 192 #00BA38 3.036241 25.67349     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 193 #00BA38 3.294233 27.34421     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 194 #00BA38 1.819298 30.22380     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 195 #00BA38 1.775591 32.85051     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 196 #00BA38 1.768322 34.92110     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 197 #00BA38 1.771558 37.32308     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 198 #00BA38 1.831336 35.31736     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 199 #F8766D 4.711513 15.18389     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 200 #F8766D 5.735524 17.81366     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 201 #F8766D 2.687634 19.90851     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 202 #F8766D 2.722330 19.82888     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 203 #F8766D 2.705133 21.76738     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 204 #F8766D 3.394128 16.70186     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 205 #F8766D 3.392817 19.38064     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 206 #F8766D 3.964371 17.83500     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 207 #F8766D 4.006347 19.94960     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 208 #00BA38 1.991503 29.08912     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 209 #00BA38 1.960542 25.61566     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 210 #00BA38 1.988835 28.72385     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 211 #00BA38 2.037926 29.03832     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 212 #00BA38 2.808537 24.31205     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 213 #00BA38 1.919795 44.36579     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 214 #00BA38 1.983528 28.96789     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 215 #00BA38 1.987543 26.24385     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 216 #00BA38 2.017406 29.25582     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 217 #00BA38 1.995187 28.65331     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 218 #00BA38 2.525185 28.83494     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 219 #00BA38 2.502464 29.38374     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 220 #00BA38 2.775895 23.12603     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 221 #00BA38 2.783482 24.03764     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 222 #00BA38 1.883704 44.28538     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 223 #00BA38 1.898457 41.16524     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 224 #00BA38 2.012421 29.15648     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 225 #00BA38 1.970707 26.09071     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 226 #00BA38 2.462143 28.19584     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 227 #00BA38 2.472723 29.10053     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 228 #00BA38 1.783306 28.62686     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 229 #00BA38 1.782366 29.04936     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 230 #00BA38 1.992224 28.23076     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 231 #00BA38 2.001187 28.97703     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 232 #00BA38 2.805727 26.25083     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 233 #00BA38 2.806901 25.60939     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 234 #00BA38 3.583273 25.98308     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;      colour        x        y     ymin     ymax        se flipped_aes PANEL</span></span>
<span><span class="co">#&gt; 1   #F8766D 1.800000 24.33592 23.07845 25.59339 0.6250675       FALSE     1</span></span>
<span><span class="co">#&gt; 2   #F8766D 1.859494 24.17860 22.94830 25.40890 0.6115600       FALSE     1</span></span>
<span><span class="co">#&gt; 3   #F8766D 1.918987 24.02127 22.81795 25.22460 0.5981528       FALSE     1</span></span>
<span><span class="co">#&gt; 4   #F8766D 1.978481 23.86395 22.68738 25.04052 0.5848527       FALSE     1</span></span>
<span><span class="co">#&gt; 5   #F8766D 2.037975 23.70663 22.55658 24.85668 0.5716673       FALSE     1</span></span>
<span><span class="co">#&gt; 6   #F8766D 2.097468 23.54931 22.42554 24.67307 0.5586045       FALSE     1</span></span>
<span><span class="co">#&gt; 7   #F8766D 2.156962 23.39198 22.29423 24.48974 0.5456732       FALSE     1</span></span>
<span><span class="co">#&gt; 8   #F8766D 2.216456 23.23466 22.16264 24.30668 0.5328831       FALSE     1</span></span>
<span><span class="co">#&gt; 9   #F8766D 2.275949 23.07734 22.03074 24.12394 0.5202445       FALSE     1</span></span>
<span><span class="co">#&gt; 10  #F8766D 2.335443 22.92002 21.89852 23.94152 0.5077687       FALSE     1</span></span>
<span><span class="co">#&gt; 11  #F8766D 2.394937 22.76269 21.76594 23.75945 0.4954680       FALSE     1</span></span>
<span><span class="co">#&gt; 12  #F8766D 2.454430 22.60537 21.63298 23.57776 0.4833558       FALSE     1</span></span>
<span><span class="co">#&gt; 13  #F8766D 2.513924 22.44805 21.49962 23.39648 0.4714467       FALSE     1</span></span>
<span><span class="co">#&gt; 14  #F8766D 2.573418 22.29073 21.36582 23.21564 0.4597563       FALSE     1</span></span>
<span><span class="co">#&gt; 15  #F8766D 2.632911 22.13340 21.23154 23.03527 0.4483019       FALSE     1</span></span>
<span><span class="co">#&gt; 16  #F8766D 2.692405 21.97608 21.09675 22.85542 0.4371019       FALSE     1</span></span>
<span><span class="co">#&gt; 17  #F8766D 2.751899 21.81876 20.96140 22.67611 0.4261765       FALSE     1</span></span>
<span><span class="co">#&gt; 18  #F8766D 2.811392 21.66144 20.82546 22.49741 0.4155472       FALSE     1</span></span>
<span><span class="co">#&gt; 19  #F8766D 2.870886 21.50411 20.68888 22.31935 0.4052375       FALSE     1</span></span>
<span><span class="co">#&gt; 20  #F8766D 2.930380 21.34679 20.55161 22.14198 0.3952722       FALSE     1</span></span>
<span><span class="co">#&gt; 21  #F8766D 2.989873 21.18947 20.41358 21.96535 0.3856781       FALSE     1</span></span>
<span><span class="co">#&gt; 22  #F8766D 3.049367 21.03215 20.27476 21.78953 0.3764836       FALSE     1</span></span>
<span><span class="co">#&gt; 23  #F8766D 3.108861 20.87482 20.13507 21.61458 0.3677187       FALSE     1</span></span>
<span><span class="co">#&gt; 24  #F8766D 3.168354 20.71750 19.99445 21.44055 0.3594147       FALSE     1</span></span>
<span><span class="co">#&gt; 25  #F8766D 3.227848 20.56018 19.85284 21.26751 0.3516043       FALSE     1</span></span>
<span><span class="co">#&gt; 26  #F8766D 3.287342 20.40286 19.71017 21.09554 0.3443212       FALSE     1</span></span>
<span><span class="co">#&gt; 27  #F8766D 3.346835 20.24553 19.56637 20.92470 0.3375995       FALSE     1</span></span>
<span><span class="co">#&gt; 28  #F8766D 3.406329 20.08821 19.42137 20.75505 0.3314732       FALSE     1</span></span>
<span><span class="co">#&gt; 29  #F8766D 3.465823 19.93089 19.27511 20.58667 0.3259761       FALSE     1</span></span>
<span><span class="co">#&gt; 30  #F8766D 3.525316 19.77357 19.12751 20.41962 0.3211403       FALSE     1</span></span>
<span><span class="co">#&gt; 31  #F8766D 3.584810 19.61624 18.97853 20.25396 0.3169962       FALSE     1</span></span>
<span><span class="co">#&gt; 32  #F8766D 3.644304 19.45892 18.82810 20.08974 0.3135712       FALSE     1</span></span>
<span><span class="co">#&gt; 33  #F8766D 3.703797 19.30160 18.67617 19.92703 0.3108890       FALSE     1</span></span>
<span><span class="co">#&gt; 34  #F8766D 3.763291 19.14428 18.52271 19.76584 0.3089691       FALSE     1</span></span>
<span><span class="co">#&gt; 35  #F8766D 3.822785 18.98695 18.36769 19.60622 0.3078256       FALSE     1</span></span>
<span><span class="co">#&gt; 36  #F8766D 3.882278 18.82963 18.21109 19.44817 0.3074672       FALSE     1</span></span>
<span><span class="co">#&gt; 37  #F8766D 3.941772 18.67231 18.05290 19.29172 0.3078967       FALSE     1</span></span>
<span><span class="co">#&gt; 38  #F8766D 4.001266 18.51499 17.89313 19.13684 0.3091108       FALSE     1</span></span>
<span><span class="co">#&gt; 39  #F8766D 4.060759 18.35766 17.73181 18.98352 0.3111002       FALSE     1</span></span>
<span><span class="co">#&gt; 40  #F8766D 4.120253 18.20034 17.56895 18.83173 0.3138504       FALSE     1</span></span>
<span><span class="co">#&gt; 41  #F8766D 4.179747 18.04302 17.40461 18.68143 0.3173414       FALSE     1</span></span>
<span><span class="co">#&gt; 42  #F8766D 4.239241 17.88570 17.23882 18.53257 0.3215491       FALSE     1</span></span>
<span><span class="co">#&gt; 43  #F8766D 4.298734 17.72837 17.07165 18.38510 0.3264459       FALSE     1</span></span>
<span><span class="co">#&gt; 44  #F8766D 4.358228 17.57105 16.90315 18.23895 0.3320012       FALSE     1</span></span>
<span><span class="co">#&gt; 45  #F8766D 4.417722 17.41373 16.73339 18.09406 0.3381826       FALSE     1</span></span>
<span><span class="co">#&gt; 46  #F8766D 4.477215 17.25640 16.56244 17.95037 0.3449565       FALSE     1</span></span>
<span><span class="co">#&gt; 47  #F8766D 4.536709 17.09908 16.39037 17.80780 0.3522886       FALSE     1</span></span>
<span><span class="co">#&gt; 48  #F8766D 4.596203 16.94176 16.21724 17.66628 0.3601449       FALSE     1</span></span>
<span><span class="co">#&gt; 49  #F8766D 4.655696 16.78444 16.04313 17.52575 0.3684918       FALSE     1</span></span>
<span><span class="co">#&gt; 50  #F8766D 4.715190 16.62711 15.86809 17.38614 0.3772968       FALSE     1</span></span>
<span><span class="co">#&gt; 51  #F8766D 4.774684 16.46979 15.69220 17.24739 0.3865286       FALSE     1</span></span>
<span><span class="co">#&gt; 52  #F8766D 4.834177 16.31247 15.51550 17.10944 0.3961574       FALSE     1</span></span>
<span><span class="co">#&gt; 53  #F8766D 4.893671 16.15515 15.33807 16.97223 0.4061548       FALSE     1</span></span>
<span><span class="co">#&gt; 54  #F8766D 4.953165 15.99782 15.15995 16.83570 0.4164945       FALSE     1</span></span>
<span><span class="co">#&gt; 55  #F8766D 5.012658 15.84050 14.98118 16.69982 0.4271514       FALSE     1</span></span>
<span><span class="co">#&gt; 56  #F8766D 5.072152 15.68318 14.80183 16.56453 0.4381025       FALSE     1</span></span>
<span><span class="co">#&gt; 57  #F8766D 5.131646 15.52586 14.62193 16.42978 0.4493262       FALSE     1</span></span>
<span><span class="co">#&gt; 58  #F8766D 5.191139 15.36853 14.44152 16.29555 0.4608027       FALSE     1</span></span>
<span><span class="co">#&gt; 59  #F8766D 5.250633 15.21121 14.26064 16.16179 0.4725135       FALSE     1</span></span>
<span><span class="co">#&gt; 60  #F8766D 5.310127 15.05389 14.07932 16.02846 0.4844416       FALSE     1</span></span>
<span><span class="co">#&gt; 61  #F8766D 5.369620 14.89657 13.89759 15.89554 0.4965714       FALSE     1</span></span>
<span><span class="co">#&gt; 62  #F8766D 5.429114 14.73924 13.71549 15.76300 0.5088884       FALSE     1</span></span>
<span><span class="co">#&gt; 63  #F8766D 5.488608 14.58192 13.53304 15.63080 0.5213794       FALSE     1</span></span>
<span><span class="co">#&gt; 64  #F8766D 5.548101 14.42460 13.35026 15.49893 0.5340322       FALSE     1</span></span>
<span><span class="co">#&gt; 65  #F8766D 5.607595 14.26728 13.16719 15.36737 0.5468355       FALSE     1</span></span>
<span><span class="co">#&gt; 66  #F8766D 5.667089 14.10995 12.98382 15.23608 0.5597790       FALSE     1</span></span>
<span><span class="co">#&gt; 67  #F8766D 5.726582 13.95263 12.80020 15.10506 0.5728532       FALSE     1</span></span>
<span><span class="co">#&gt; 68  #F8766D 5.786076 13.79531 12.61633 14.97429 0.5860494       FALSE     1</span></span>
<span><span class="co">#&gt; 69  #F8766D 5.845570 13.63799 12.43223 14.84374 0.5993594       FALSE     1</span></span>
<span><span class="co">#&gt; 70  #F8766D 5.905063 13.48066 12.24792 14.71341 0.6127760       FALSE     1</span></span>
<span><span class="co">#&gt; 71  #F8766D 5.964557 13.32334 12.06340 14.58328 0.6262922       FALSE     1</span></span>
<span><span class="co">#&gt; 72  #F8766D 6.024051 13.16602 11.87870 14.45333 0.6399017       FALSE     1</span></span>
<span><span class="co">#&gt; 73  #F8766D 6.083544 13.00870 11.69383 14.32357 0.6535987       FALSE     1</span></span>
<span><span class="co">#&gt; 74  #F8766D 6.143038 12.85137 11.50878 14.19396 0.6673778       FALSE     1</span></span>
<span><span class="co">#&gt; 75  #F8766D 6.202532 12.69405 11.32359 14.06452 0.6812340       FALSE     1</span></span>
<span><span class="co">#&gt; 76  #F8766D 6.262025 12.53673 11.13824 13.93522 0.6951627       FALSE     1</span></span>
<span><span class="co">#&gt; 77  #F8766D 6.321519 12.37941 10.95276 13.80605 0.7091597       FALSE     1</span></span>
<span><span class="co">#&gt; 78  #F8766D 6.381013 12.22208 10.76715 13.67702 0.7232209       FALSE     1</span></span>
<span><span class="co">#&gt; 79  #F8766D 6.440506 12.06476 10.58142 13.54810 0.7373428       FALSE     1</span></span>
<span><span class="co">#&gt; 80  #F8766D 6.500000 11.90744 10.39557 13.41931 0.7515218       FALSE     1</span></span>
<span><span class="co">#&gt; 81  #00BA38 1.600000 31.78093 30.16782 33.39404 0.8049250       FALSE     1</span></span>
<span><span class="co">#&gt; 82  #00BA38 1.627848 31.65273 30.07403 33.23143 0.7877576       FALSE     1</span></span>
<span><span class="co">#&gt; 83  #00BA38 1.655696 31.52453 29.97980 33.06925 0.7708055       FALSE     1</span></span>
<span><span class="co">#&gt; 84  #00BA38 1.683544 31.39632 29.88511 32.90754 0.7540832       FALSE     1</span></span>
<span><span class="co">#&gt; 85  #00BA38 1.711392 31.26812 29.78993 32.74632 0.7376065       FALSE     1</span></span>
<span><span class="co">#&gt; 86  #00BA38 1.739241 31.13992 29.69422 32.58562 0.7213920       FALSE     1</span></span>
<span><span class="co">#&gt; 87  #00BA38 1.767089 31.01172 29.59795 32.42549 0.7054579       FALSE     1</span></span>
<span><span class="co">#&gt; 88  #00BA38 1.794937 30.88352 29.50108 32.26595 0.6898237       FALSE     1</span></span>
<span><span class="co">#&gt; 89  #00BA38 1.822785 30.75532 29.40357 32.10706 0.6745101       FALSE     1</span></span>
<span><span class="co">#&gt; 90  #00BA38 1.850633 30.62711 29.30537 31.94886 0.6595396       FALSE     1</span></span>
<span><span class="co">#&gt; 91  #00BA38 1.878481 30.49891 29.20643 31.79139 0.6449359       FALSE     1</span></span>
<span><span class="co">#&gt; 92  #00BA38 1.906329 30.37071 29.10671 31.63471 0.6307246       FALSE     1</span></span>
<span><span class="co">#&gt; 93  #00BA38 1.934177 30.24251 29.00615 31.47887 0.6169329       FALSE     1</span></span>
<span><span class="co">#&gt; 94  #00BA38 1.962025 30.11431 28.90469 31.32393 0.6035894       FALSE     1</span></span>
<span><span class="co">#&gt; 95  #00BA38 1.989873 29.98610 28.80227 31.16994 0.5907245       FALSE     1</span></span>
<span><span class="co">#&gt; 96  #00BA38 2.017722 29.85790 28.69882 31.01698 0.5783702       FALSE     1</span></span>
<span><span class="co">#&gt; 97  #00BA38 2.045570 29.72970 28.59429 30.86511 0.5665599       FALSE     1</span></span>
<span><span class="co">#&gt; 98  #00BA38 2.073418 29.60150 28.48860 30.71440 0.5553282       FALSE     1</span></span>
<span><span class="co">#&gt; 99  #00BA38 2.101266 29.47330 28.38167 30.56492 0.5447111       FALSE     1</span></span>
<span><span class="co">#&gt; 100 #00BA38 2.129114 29.34509 28.27344 30.41675 0.5347450       FALSE     1</span></span>
<span><span class="co">#&gt; 101 #00BA38 2.156962 29.21689 28.16383 30.26995 0.5254670       FALSE     1</span></span>
<span><span class="co">#&gt; 102 #00BA38 2.184810 29.08869 28.05277 30.12461 0.5169143       FALSE     1</span></span>
<span><span class="co">#&gt; 103 #00BA38 2.212658 28.96049 27.94018 29.98080 0.5091233       FALSE     1</span></span>
<span><span class="co">#&gt; 104 #00BA38 2.240506 28.83229 27.82600 29.83858 0.5021295       FALSE     1</span></span>
<span><span class="co">#&gt; 105 #00BA38 2.268354 28.70409 27.71015 29.69802 0.4959666       FALSE     1</span></span>
<span><span class="co">#&gt; 106 #00BA38 2.296203 28.57588 27.59257 29.55920 0.4906659       FALSE     1</span></span>
<span><span class="co">#&gt; 107 #00BA38 2.324051 28.44768 27.47320 29.42216 0.4862556       FALSE     1</span></span>
<span><span class="co">#&gt; 108 #00BA38 2.351899 28.31948 27.35201 29.28695 0.4827602       FALSE     1</span></span>
<span><span class="co">#&gt; 109 #00BA38 2.379747 28.19128 27.22894 29.15362 0.4801996       FALSE     1</span></span>
<span><span class="co">#&gt; 110 #00BA38 2.407595 28.06308 27.10396 29.02219 0.4785888       FALSE     1</span></span>
<span><span class="co">#&gt; 111 #00BA38 2.435443 27.93487 26.97707 28.89268 0.4779375       FALSE     1</span></span>
<span><span class="co">#&gt; 112 #00BA38 2.463291 27.80667 26.84824 28.76511 0.4782494       FALSE     1</span></span>
<span><span class="co">#&gt; 113 #00BA38 2.491139 27.67847 26.71749 28.63946 0.4795229       FALSE     1</span></span>
<span><span class="co">#&gt; 114 #00BA38 2.518987 27.55027 26.58482 28.51572 0.4817501       FALSE     1</span></span>
<span><span class="co">#&gt; 115 #00BA38 2.546835 27.42207 26.45027 28.39386 0.4849181       FALSE     1</span></span>
<span><span class="co">#&gt; 116 #00BA38 2.574684 27.29387 26.31387 28.27386 0.4890084       FALSE     1</span></span>
<span><span class="co">#&gt; 117 #00BA38 2.602532 27.16566 26.17567 28.15566 0.4939983       FALSE     1</span></span>
<span><span class="co">#&gt; 118 #00BA38 2.630380 27.03746 26.03572 28.03920 0.4998607       FALSE     1</span></span>
<span><span class="co">#&gt; 119 #00BA38 2.658228 26.90926 25.89408 27.92444 0.5065654       FALSE     1</span></span>
<span><span class="co">#&gt; 120 #00BA38 2.686076 26.78106 25.75082 27.81130 0.5140794       FALSE     1</span></span>
<span><span class="co">#&gt; 121 #00BA38 2.713924 26.65286 25.60601 27.69970 0.5223678       FALSE     1</span></span>
<span><span class="co">#&gt; 122 #00BA38 2.741772 26.52465 25.45972 27.58959 0.5313943       FALSE     1</span></span>
<span><span class="co">#&gt; 123 #00BA38 2.769620 26.39645 25.31202 27.48089 0.5411221       FALSE     1</span></span>
<span><span class="co">#&gt; 124 #00BA38 2.797468 26.26825 25.16299 27.37351 0.5515140       FALSE     1</span></span>
<span><span class="co">#&gt; 125 #00BA38 2.825316 26.14005 25.01271 27.26739 0.5625332       FALSE     1</span></span>
<span><span class="co">#&gt; 126 #00BA38 2.853165 26.01185 24.86124 27.16246 0.5741435       FALSE     1</span></span>
<span><span class="co">#&gt; 127 #00BA38 2.881013 25.88364 24.70865 27.05864 0.5863100       FALSE     1</span></span>
<span><span class="co">#&gt; 128 #00BA38 2.908861 25.75544 24.55502 26.95586 0.5989986       FALSE     1</span></span>
<span><span class="co">#&gt; 129 #00BA38 2.936709 25.62724 24.40041 26.85407 0.6121770       FALSE     1</span></span>
<span><span class="co">#&gt; 130 #00BA38 2.964557 25.49904 24.24488 26.75320 0.6258141       FALSE     1</span></span>
<span><span class="co">#&gt; 131 #00BA38 2.992405 25.37084 24.08849 26.65319 0.6398807       FALSE     1</span></span>
<span><span class="co">#&gt; 132 #00BA38 3.020253 25.24264 23.93129 26.55398 0.6543490       FALSE     1</span></span>
<span><span class="co">#&gt; 133 #00BA38 3.048101 25.11443 23.77334 26.45553 0.6691931       FALSE     1</span></span>
<span><span class="co">#&gt; 134 #00BA38 3.075949 24.98623 23.61469 26.35778 0.6843884       FALSE     1</span></span>
<span><span class="co">#&gt; 135 #00BA38 3.103797 24.85803 23.45538 26.26069 0.6999120       FALSE     1</span></span>
<span><span class="co">#&gt; 136 #00BA38 3.131646 24.72983 23.29545 26.16421 0.7157427       FALSE     1</span></span>
<span><span class="co">#&gt; 137 #00BA38 3.159494 24.60163 23.13495 26.06831 0.7318605       FALSE     1</span></span>
<span><span class="co">#&gt; 138 #00BA38 3.187342 24.47342 22.97390 25.97294 0.7482468       FALSE     1</span></span>
<span><span class="co">#&gt; 139 #00BA38 3.215190 24.34522 22.81236 25.87809 0.7648843       FALSE     1</span></span>
<span><span class="co">#&gt; 140 #00BA38 3.243038 24.21702 22.65034 25.78370 0.7817572       FALSE     1</span></span>
<span><span class="co">#&gt; 141 #00BA38 3.270886 24.08882 22.48789 25.68975 0.7988503       FALSE     1</span></span>
<span><span class="co">#&gt; 142 #00BA38 3.298734 23.96062 22.32502 25.59622 0.8161499       FALSE     1</span></span>
<span><span class="co">#&gt; 143 #00BA38 3.326582 23.83242 22.16176 25.50307 0.8336432       FALSE     1</span></span>
<span><span class="co">#&gt; 144 #00BA38 3.354430 23.70421 21.99813 25.41029 0.8513181       FALSE     1</span></span>
<span><span class="co">#&gt; 145 #00BA38 3.382278 23.57601 21.83417 25.31785 0.8691637       FALSE     1</span></span>
<span><span class="co">#&gt; 146 #00BA38 3.410127 23.44781 21.66988 25.22574 0.8871695       FALSE     1</span></span>
<span><span class="co">#&gt; 147 #00BA38 3.437975 23.31961 21.50529 25.13392 0.9053261       FALSE     1</span></span>
<span><span class="co">#&gt; 148 #00BA38 3.465823 23.19141 21.34042 25.04239 0.9236246       FALSE     1</span></span>
<span><span class="co">#&gt; 149 #00BA38 3.493671 23.06320 21.17528 24.95113 0.9420567       FALSE     1</span></span>
<span><span class="co">#&gt; 150 #00BA38 3.521519 22.93500 21.00989 24.86012 0.9606146       FALSE     1</span></span>
<span><span class="co">#&gt; 151 #00BA38 3.549367 22.80680 20.84426 24.76934 0.9792914       FALSE     1</span></span>
<span><span class="co">#&gt; 152 #00BA38 3.577215 22.67860 20.67840 24.67880 0.9980801       FALSE     1</span></span>
<span><span class="co">#&gt; 153 #00BA38 3.605063 22.55040 20.51233 24.58846 1.0169748       FALSE     1</span></span>
<span><span class="co">#&gt; 154 #00BA38 3.632911 22.42220 20.34607 24.49832 1.0359695       FALSE     1</span></span>
<span><span class="co">#&gt; 155 #00BA38 3.660759 22.29399 20.17961 24.40838 1.0550589       FALSE     1</span></span>
<span><span class="co">#&gt; 156 #00BA38 3.688608 22.16579 20.01297 24.31861 1.0742380       FALSE     1</span></span>
<span><span class="co">#&gt; 157 #00BA38 3.716456 22.03759 19.84616 24.22902 1.0935019       FALSE     1</span></span>
<span><span class="co">#&gt; 158 #00BA38 3.744304 21.90939 19.67919 24.13958 1.1128463       FALSE     1</span></span>
<span><span class="co">#&gt; 159 #00BA38 3.772152 21.78119 19.51207 24.05030 1.1322671       FALSE     1</span></span>
<span><span class="co">#&gt; 160 #00BA38 3.800000 21.65298 19.34480 23.96116 1.1517604       FALSE     1</span></span>
<span><span class="co">#&gt; 161 #619CFF 3.800000 23.46965 18.42826 28.51104 2.2285773       FALSE     1</span></span>
<span><span class="co">#&gt; 162 #619CFF 3.824051 23.41154 18.44650 28.37658 2.1948252       FALSE     1</span></span>
<span><span class="co">#&gt; 163 #619CFF 3.848101 23.35344 18.46432 28.24255 2.1612617       FALSE     1</span></span>
<span><span class="co">#&gt; 164 #619CFF 3.872152 23.29533 18.48170 28.10897 2.1278958       FALSE     1</span></span>
<span><span class="co">#&gt; 165 #619CFF 3.896203 23.23723 18.49860 27.97585 2.0947368       FALSE     1</span></span>
<span><span class="co">#&gt; 166 #619CFF 3.920253 23.17912 18.51502 27.84322 2.0617947       FALSE     1</span></span>
<span><span class="co">#&gt; 167 #619CFF 3.944304 23.12102 18.53092 27.71111 2.0290802       FALSE     1</span></span>
<span><span class="co">#&gt; 168 #619CFF 3.968354 23.06291 18.54628 27.57954 1.9966044       FALSE     1</span></span>
<span><span class="co">#&gt; 169 #619CFF 3.992405 23.00480 18.56107 27.44854 1.9643791       FALSE     1</span></span>
<span><span class="co">#&gt; 170 #619CFF 4.016456 22.94670 18.57527 27.31813 1.9324168       FALSE     1</span></span>
<span><span class="co">#&gt; 171 #619CFF 4.040506 22.88859 18.58884 27.18834 1.9007309       FALSE     1</span></span>
<span><span class="co">#&gt; 172 #619CFF 4.064557 22.83049 18.60176 27.05922 1.8693354       FALSE     1</span></span>
<span><span class="co">#&gt; 173 #619CFF 4.088608 22.77238 18.61398 26.93078 1.8382452       FALSE     1</span></span>
<span><span class="co">#&gt; 174 #619CFF 4.112658 22.71427 18.62548 26.80307 1.8074760       FALSE     1</span></span>
<span><span class="co">#&gt; 175 #619CFF 4.136709 22.65617 18.63621 26.67612 1.7770445       FALSE     1</span></span>
<span><span class="co">#&gt; 176 #619CFF 4.160759 22.59806 18.64615 26.54998 1.7469684       FALSE     1</span></span>
<span><span class="co">#&gt; 177 #619CFF 4.184810 22.53996 18.65523 26.42468 1.7172662       FALSE     1</span></span>
<span><span class="co">#&gt; 178 #619CFF 4.208861 22.48185 18.66342 26.30028 1.6879578       FALSE     1</span></span>
<span><span class="co">#&gt; 179 #619CFF 4.232911 22.42374 18.67068 26.17681 1.6590641       FALSE     1</span></span>
<span><span class="co">#&gt; 180 #619CFF 4.256962 22.36564 18.67695 26.05433 1.6306070       FALSE     1</span></span>
<span><span class="co">#&gt; 181 #619CFF 4.281013 22.30753 18.68218 25.93289 1.6026099       FALSE     1</span></span>
<span><span class="co">#&gt; 182 #619CFF 4.305063 22.24943 18.68631 25.81254 1.5750972       FALSE     1</span></span>
<span><span class="co">#&gt; 183 #619CFF 4.329114 22.19132 18.68929 25.69335 1.5480948       FALSE     1</span></span>
<span><span class="co">#&gt; 184 #619CFF 4.353165 22.13322 18.69105 25.57538 1.5216299       FALSE     1</span></span>
<span><span class="co">#&gt; 185 #619CFF 4.377215 22.07511 18.69153 25.45869 1.4957310       FALSE     1</span></span>
<span><span class="co">#&gt; 186 #619CFF 4.401266 22.01700 18.69066 25.34334 1.4704279       FALSE     1</span></span>
<span><span class="co">#&gt; 187 #619CFF 4.425316 21.95890 18.68838 25.22942 1.4457521       FALSE     1</span></span>
<span><span class="co">#&gt; 188 #619CFF 4.449367 21.90079 18.68460 25.11698 1.4217360       FALSE     1</span></span>
<span><span class="co">#&gt; 189 #619CFF 4.473418 21.84269 18.67925 25.00612 1.3984138       FALSE     1</span></span>
<span><span class="co">#&gt; 190 #619CFF 4.497468 21.78458 18.67226 24.89690 1.3758208       FALSE     1</span></span>
<span><span class="co">#&gt; 191 #619CFF 4.521519 21.72647 18.66353 24.78942 1.3539933       FALSE     1</span></span>
<span><span class="co">#&gt; 192 #619CFF 4.545570 21.66837 18.65298 24.68375 1.3329691       FALSE     1</span></span>
<span><span class="co">#&gt; 193 #619CFF 4.569620 21.61026 18.64053 24.57999 1.3127867       FALSE     1</span></span>
<span><span class="co">#&gt; 194 #619CFF 4.593671 21.55216 18.62609 24.47822 1.2934855       FALSE     1</span></span>
<span><span class="co">#&gt; 195 #619CFF 4.617722 21.49405 18.60956 24.37854 1.2751055       FALSE     1</span></span>
<span><span class="co">#&gt; 196 #619CFF 4.641772 21.43594 18.59086 24.28103 1.2576872       FALSE     1</span></span>
<span><span class="co">#&gt; 197 #619CFF 4.665823 21.37784 18.56989 24.18579 1.2412710       FALSE     1</span></span>
<span><span class="co">#&gt; 198 #619CFF 4.689873 21.31973 18.54656 24.09291 1.2258972       FALSE     1</span></span>
<span><span class="co">#&gt; 199 #619CFF 4.713924 21.26163 18.52079 24.00247 1.2116055       FALSE     1</span></span>
<span><span class="co">#&gt; 200 #619CFF 4.737975 21.20352 18.49247 23.91457 1.1984345       FALSE     1</span></span>
<span><span class="co">#&gt; 201 #619CFF 4.762025 21.14542 18.46154 23.82929 1.1864216       FALSE     1</span></span>
<span><span class="co">#&gt; 202 #619CFF 4.786076 21.08731 18.42791 23.74671 1.1756023       FALSE     1</span></span>
<span><span class="co">#&gt; 203 #619CFF 4.810127 21.02920 18.39151 23.66690 1.1660099       FALSE     1</span></span>
<span><span class="co">#&gt; 204 #619CFF 4.834177 20.97110 18.35226 23.58994 1.1576747       FALSE     1</span></span>
<span><span class="co">#&gt; 205 #619CFF 4.858228 20.91299 18.31010 23.51588 1.1506242       FALSE     1</span></span>
<span><span class="co">#&gt; 206 #619CFF 4.882278 20.85489 18.26498 23.44479 1.1448821       FALSE     1</span></span>
<span><span class="co">#&gt; 207 #619CFF 4.906329 20.79678 18.21686 23.37670 1.1404681       FALSE     1</span></span>
<span><span class="co">#&gt; 208 #619CFF 4.930380 20.73867 18.16570 23.31165 1.1373978       FALSE     1</span></span>
<span><span class="co">#&gt; 209 #619CFF 4.954430 20.68057 18.11148 23.24966 1.1356819       FALSE     1</span></span>
<span><span class="co">#&gt; 210 #619CFF 4.978481 20.62246 18.05418 23.19075 1.1353267       FALSE     1</span></span>
<span><span class="co">#&gt; 211 #619CFF 5.002532 20.56436 17.99379 23.13492 1.1363334       FALSE     1</span></span>
<span><span class="co">#&gt; 212 #619CFF 5.026582 20.50625 17.93034 23.08217 1.1386984       FALSE     1</span></span>
<span><span class="co">#&gt; 213 #619CFF 5.050633 20.44815 17.86383 23.03246 1.1424133       FALSE     1</span></span>
<span><span class="co">#&gt; 214 #619CFF 5.074684 20.39004 17.79429 22.98579 1.1474649       FALSE     1</span></span>
<span><span class="co">#&gt; 215 #619CFF 5.098734 20.33193 17.72178 22.94209 1.1538358       FALSE     1</span></span>
<span><span class="co">#&gt; 216 #619CFF 5.122785 20.27383 17.64632 22.90133 1.1615041       FALSE     1</span></span>
<span><span class="co">#&gt; 217 #619CFF 5.146835 20.21572 17.56799 22.86345 1.1704445       FALSE     1</span></span>
<span><span class="co">#&gt; 218 #619CFF 5.170886 20.15762 17.48685 22.82838 1.1806279       FALSE     1</span></span>
<span><span class="co">#&gt; 219 #619CFF 5.194937 20.09951 17.40297 22.79605 1.1920226       FALSE     1</span></span>
<span><span class="co">#&gt; 220 #619CFF 5.218987 20.04140 17.31642 22.76639 1.2045942       FALSE     1</span></span>
<span><span class="co">#&gt; 221 #619CFF 5.243038 19.98330 17.22730 22.73930 1.2183062       FALSE     1</span></span>
<span><span class="co">#&gt; 222 #619CFF 5.267089 19.92519 17.13568 22.71470 1.2331205       FALSE     1</span></span>
<span><span class="co">#&gt; 223 #619CFF 5.291139 19.86709 17.04166 22.69252 1.2489981       FALSE     1</span></span>
<span><span class="co">#&gt; 224 #619CFF 5.315190 19.80898 16.94532 22.67264 1.2658988       FALSE     1</span></span>
<span><span class="co">#&gt; 225 #619CFF 5.339241 19.75087 16.84676 22.65499 1.2837823       FALSE     1</span></span>
<span><span class="co">#&gt; 226 #619CFF 5.363291 19.69277 16.74606 22.63947 1.3026080       FALSE     1</span></span>
<span><span class="co">#&gt; 227 #619CFF 5.387342 19.63466 16.64333 22.62599 1.3223358       FALSE     1</span></span>
<span><span class="co">#&gt; 228 #619CFF 5.411392 19.57656 16.53865 22.61447 1.3429259       FALSE     1</span></span>
<span><span class="co">#&gt; 229 #619CFF 5.435443 19.51845 16.43210 22.60480 1.3643392       FALSE     1</span></span>
<span><span class="co">#&gt; 230 #619CFF 5.459494 19.46035 16.32378 22.59691 1.3865376       FALSE     1</span></span>
<span><span class="co">#&gt; 231 #619CFF 5.483544 19.40224 16.21377 22.59071 1.4094840       FALSE     1</span></span>
<span><span class="co">#&gt; 232 #619CFF 5.507595 19.34413 16.10214 22.58613 1.4331425       FALSE     1</span></span>
<span><span class="co">#&gt; 233 #619CFF 5.531646 19.28603 15.98898 22.58307 1.4574784       FALSE     1</span></span>
<span><span class="co">#&gt; 234 #619CFF 5.555696 19.22792 15.87437 22.58148 1.4824584       FALSE     1</span></span>
<span><span class="co">#&gt; 235 #619CFF 5.579747 19.16982 15.75837 22.58126 1.5080503       FALSE     1</span></span>
<span><span class="co">#&gt; 236 #619CFF 5.603797 19.11171 15.64105 22.58237 1.5342237       FALSE     1</span></span>
<span><span class="co">#&gt; 237 #619CFF 5.627848 19.05360 15.52249 22.58472 1.5609493       FALSE     1</span></span>
<span><span class="co">#&gt; 238 #619CFF 5.651899 18.99550 15.40274 22.58825 1.5881991       FALSE     1</span></span>
<span><span class="co">#&gt; 239 #619CFF 5.675949 18.93739 15.28187 22.59292 1.6159468       FALSE     1</span></span>
<span><span class="co">#&gt; 240 #619CFF 5.700000 18.87929 15.15992 22.59865 1.6441669       FALSE     1</span></span>
<span><span class="co">#&gt; 241 #F8766D 2.000000 26.31880 24.82002 27.81758 0.7469075       FALSE     2</span></span>
<span><span class="co">#&gt; 242 #F8766D 2.051899 26.15027 24.68063 27.61991 0.7323869       FALSE     2</span></span>
<span><span class="co">#&gt; 243 #F8766D 2.103797 25.98174 24.54107 27.42240 0.7179459       FALSE     2</span></span>
<span><span class="co">#&gt; 244 #F8766D 2.155696 25.81321 24.40135 27.22506 0.7035895       FALSE     2</span></span>
<span><span class="co">#&gt; 245 #F8766D 2.207595 25.64468 24.26145 27.02791 0.6893229       FALSE     2</span></span>
<span><span class="co">#&gt; 246 #F8766D 2.259494 25.47615 24.12136 26.83094 0.6751519       FALSE     2</span></span>
<span><span class="co">#&gt; 247 #F8766D 2.311392 25.30762 23.98106 26.63418 0.6610825       FALSE     2</span></span>
<span><span class="co">#&gt; 248 #F8766D 2.363291 25.13909 23.84055 26.43764 0.6471215       FALSE     2</span></span>
<span><span class="co">#&gt; 249 #F8766D 2.415190 24.97056 23.69980 26.24132 0.6332759       FALSE     2</span></span>
<span><span class="co">#&gt; 250 #F8766D 2.467089 24.80203 23.55881 26.04526 0.6195535       FALSE     2</span></span>
<span><span class="co">#&gt; 251 #F8766D 2.518987 24.63350 23.41755 25.84946 0.6059628       FALSE     2</span></span>
<span><span class="co">#&gt; 252 #F8766D 2.570886 24.46497 23.27601 25.65394 0.5925126       FALSE     2</span></span>
<span><span class="co">#&gt; 253 #F8766D 2.622785 24.29644 23.13417 25.45872 0.5792130       FALSE     2</span></span>
<span><span class="co">#&gt; 254 #F8766D 2.674684 24.12791 22.99200 25.26383 0.5660743       FALSE     2</span></span>
<span><span class="co">#&gt; 255 #F8766D 2.726582 23.95939 22.84949 25.06928 0.5531082       FALSE     2</span></span>
<span><span class="co">#&gt; 256 #F8766D 2.778481 23.79086 22.70661 24.87510 0.5403270       FALSE     2</span></span>
<span><span class="co">#&gt; 257 #F8766D 2.830380 23.62233 22.56333 24.68132 0.5277442       FALSE     2</span></span>
<span><span class="co">#&gt; 258 #F8766D 2.882278 23.45380 22.41962 24.48797 0.5153743       FALSE     2</span></span>
<span><span class="co">#&gt; 259 #F8766D 2.934177 23.28527 22.27546 24.29508 0.5032330       FALSE     2</span></span>
<span><span class="co">#&gt; 260 #F8766D 2.986076 23.11674 22.13080 24.10268 0.4913373       FALSE     2</span></span>
<span><span class="co">#&gt; 261 #F8766D 3.037975 22.94821 21.98561 23.91081 0.4797053       FALSE     2</span></span>
<span><span class="co">#&gt; 262 #F8766D 3.089873 22.77968 21.83985 23.71951 0.4683569       FALSE     2</span></span>
<span><span class="co">#&gt; 263 #F8766D 3.141772 22.61115 21.69348 23.52882 0.4573131       FALSE     2</span></span>
<span><span class="co">#&gt; 264 #F8766D 3.193671 22.44262 21.54646 23.33878 0.4465964       FALSE     2</span></span>
<span><span class="co">#&gt; 265 #F8766D 3.245570 22.27409 21.39873 23.14945 0.4362310       FALSE     2</span></span>
<span><span class="co">#&gt; 266 #F8766D 3.297468 22.10556 21.25024 22.96088 0.4262426       FALSE     2</span></span>
<span><span class="co">#&gt; 267 #F8766D 3.349367 21.93703 21.10095 22.77312 0.4166582       FALSE     2</span></span>
<span><span class="co">#&gt; 268 #F8766D 3.401266 21.76850 20.95078 22.58622 0.4075063       FALSE     2</span></span>
<span><span class="co">#&gt; 269 #F8766D 3.453165 21.59997 20.79969 22.40026 0.3988167       FALSE     2</span></span>
<span><span class="co">#&gt; 270 #F8766D 3.505063 21.43144 20.64761 22.21528 0.3906204       FALSE     2</span></span>
<span><span class="co">#&gt; 271 #F8766D 3.556962 21.26291 20.49447 22.03136 0.3829488       FALSE     2</span></span>
<span><span class="co">#&gt; 272 #F8766D 3.608861 21.09439 20.34022 21.84855 0.3758343       FALSE     2</span></span>
<span><span class="co">#&gt; 273 #F8766D 3.660759 20.92586 20.18478 21.66693 0.3693089       FALSE     2</span></span>
<span><span class="co">#&gt; 274 #F8766D 3.712658 20.75733 20.02810 21.48655 0.3634045       FALSE     2</span></span>
<span><span class="co">#&gt; 275 #F8766D 3.764557 20.58880 19.87011 21.30748 0.3581517       FALSE     2</span></span>
<span><span class="co">#&gt; 276 #F8766D 3.816456 20.42027 19.71076 21.12978 0.3535795       FALSE     2</span></span>
<span><span class="co">#&gt; 277 #F8766D 3.868354 20.25174 19.54998 20.95349 0.3497147       FALSE     2</span></span>
<span><span class="co">#&gt; 278 #F8766D 3.920253 20.08321 19.38774 20.77867 0.3465809       FALSE     2</span></span>
<span><span class="co">#&gt; 279 #F8766D 3.972152 19.91468 19.22400 20.60536 0.3441982       FALSE     2</span></span>
<span><span class="co">#&gt; 280 #F8766D 4.024051 19.74615 19.05871 20.43359 0.3425821       FALSE     2</span></span>
<span><span class="co">#&gt; 281 #F8766D 4.075949 19.57762 18.89186 20.26338 0.3417436       FALSE     2</span></span>
<span><span class="co">#&gt; 282 #F8766D 4.127848 19.40909 18.72344 20.09474 0.3416883       FALSE     2</span></span>
<span><span class="co">#&gt; 283 #F8766D 4.179747 19.24056 18.55345 19.92767 0.3424167       FALSE     2</span></span>
<span><span class="co">#&gt; 284 #F8766D 4.231646 19.07203 18.38190 19.76217 0.3439237       FALSE     2</span></span>
<span><span class="co">#&gt; 285 #F8766D 4.283544 18.90350 18.20880 19.59820 0.3461993       FALSE     2</span></span>
<span><span class="co">#&gt; 286 #F8766D 4.335443 18.73497 18.03420 19.43575 0.3492283       FALSE     2</span></span>
<span><span class="co">#&gt; 287 #F8766D 4.387342 18.56644 17.85812 19.27477 0.3529915       FALSE     2</span></span>
<span><span class="co">#&gt; 288 #F8766D 4.439241 18.39792 17.68061 19.11522 0.3574655       FALSE     2</span></span>
<span><span class="co">#&gt; 289 #F8766D 4.491139 18.22939 17.50173 18.95704 0.3626241       FALSE     2</span></span>
<span><span class="co">#&gt; 290 #F8766D 4.543038 18.06086 17.32153 18.80018 0.3684386       FALSE     2</span></span>
<span><span class="co">#&gt; 291 #F8766D 4.594937 17.89233 17.14008 18.64458 0.3748783       FALSE     2</span></span>
<span><span class="co">#&gt; 292 #F8766D 4.646835 17.72380 16.95744 18.49016 0.3819118       FALSE     2</span></span>
<span><span class="co">#&gt; 293 #F8766D 4.698734 17.55527 16.77367 18.33687 0.3895068       FALSE     2</span></span>
<span><span class="co">#&gt; 294 #F8766D 4.750633 17.38674 16.58883 18.18464 0.3976311       FALSE     2</span></span>
<span><span class="co">#&gt; 295 #F8766D 4.802532 17.21821 16.40300 18.03342 0.4062531       FALSE     2</span></span>
<span><span class="co">#&gt; 296 #F8766D 4.854430 17.04968 16.21624 17.88312 0.4153416       FALSE     2</span></span>
<span><span class="co">#&gt; 297 #F8766D 4.906329 16.88115 16.02859 17.73371 0.4248668       FALSE     2</span></span>
<span><span class="co">#&gt; 298 #F8766D 4.958228 16.71262 15.84013 17.58511 0.4348000       FALSE     2</span></span>
<span><span class="co">#&gt; 299 #F8766D 5.010127 16.54409 15.65091 17.43728 0.4451139       FALSE     2</span></span>
<span><span class="co">#&gt; 300 #F8766D 5.062025 16.37556 15.46097 17.29016 0.4557825       FALSE     2</span></span>
<span><span class="co">#&gt; 301 #F8766D 5.113924 16.20703 15.27037 17.14370 0.4667817       FALSE     2</span></span>
<span><span class="co">#&gt; 302 #F8766D 5.165823 16.03850 15.07915 16.99786 0.4780885       FALSE     2</span></span>
<span><span class="co">#&gt; 303 #F8766D 5.217722 15.86997 14.88736 16.85259 0.4896817       FALSE     2</span></span>
<span><span class="co">#&gt; 304 #F8766D 5.269620 15.70144 14.69503 16.70786 0.5015414       FALSE     2</span></span>
<span><span class="co">#&gt; 305 #F8766D 5.321519 15.53292 14.50220 16.56363 0.5136491       FALSE     2</span></span>
<span><span class="co">#&gt; 306 #F8766D 5.373418 15.36439 14.30891 16.41986 0.5259878       FALSE     2</span></span>
<span><span class="co">#&gt; 307 #F8766D 5.425316 15.19586 14.11519 16.27652 0.5385415       FALSE     2</span></span>
<span><span class="co">#&gt; 308 #F8766D 5.477215 15.02733 13.92107 16.13358 0.5512955       FALSE     2</span></span>
<span><span class="co">#&gt; 309 #F8766D 5.529114 14.85880 13.72657 15.99102 0.5642364       FALSE     2</span></span>
<span><span class="co">#&gt; 310 #F8766D 5.581013 14.69027 13.53173 15.84881 0.5773514       FALSE     2</span></span>
<span><span class="co">#&gt; 311 #F8766D 5.632911 14.52174 13.33655 15.70692 0.5906291       FALSE     2</span></span>
<span><span class="co">#&gt; 312 #F8766D 5.684810 14.35321 13.14108 15.56534 0.6040586       FALSE     2</span></span>
<span><span class="co">#&gt; 313 #F8766D 5.736709 14.18468 12.94531 15.42405 0.6176301       FALSE     2</span></span>
<span><span class="co">#&gt; 314 #F8766D 5.788608 14.01615 12.74929 15.28302 0.6313345       FALSE     2</span></span>
<span><span class="co">#&gt; 315 #F8766D 5.840506 13.84762 12.55301 15.14224 0.6451632       FALSE     2</span></span>
<span><span class="co">#&gt; 316 #F8766D 5.892405 13.67909 12.35649 15.00169 0.6591084       FALSE     2</span></span>
<span><span class="co">#&gt; 317 #F8766D 5.944304 13.51056 12.15976 14.86136 0.6731629       FALSE     2</span></span>
<span><span class="co">#&gt; 318 #F8766D 5.996203 13.34203 11.96282 14.72124 0.6873200       FALSE     2</span></span>
<span><span class="co">#&gt; 319 #F8766D 6.048101 13.17350 11.76569 14.58131 0.7015734       FALSE     2</span></span>
<span><span class="co">#&gt; 320 #F8766D 6.100000 13.00497 11.56838 14.44157 0.7159175       FALSE     2</span></span>
<span><span class="co">#&gt; 321 #00BA38 1.800000 31.28839 30.00524 32.57153 0.6378289       FALSE     2</span></span>
<span><span class="co">#&gt; 322 #00BA38 1.844304 31.14798 29.90153 32.39443 0.6195883       FALSE     2</span></span>
<span><span class="co">#&gt; 323 #00BA38 1.888608 31.00757 29.79698 32.21815 0.6017611       FALSE     2</span></span>
<span><span class="co">#&gt; 324 #00BA38 1.932911 30.86715 29.69152 32.04279 0.5843854       FALSE     2</span></span>
<span><span class="co">#&gt; 325 #00BA38 1.977215 30.72674 29.58508 31.86841 0.5675024       FALSE     2</span></span>
<span><span class="co">#&gt; 326 #00BA38 2.021519 30.58633 29.47755 31.69512 0.5511576       FALSE     2</span></span>
<span><span class="co">#&gt; 327 #00BA38 2.065823 30.44592 29.36884 31.52301 0.5354002       FALSE     2</span></span>
<span><span class="co">#&gt; 328 #00BA38 2.110127 30.30551 29.25884 31.35219 0.5202836       FALSE     2</span></span>
<span><span class="co">#&gt; 329 #00BA38 2.154430 30.16510 29.14743 31.18277 0.5058652       FALSE     2</span></span>
<span><span class="co">#&gt; 330 #00BA38 2.198734 30.02469 29.03450 31.01488 0.4922064       FALSE     2</span></span>
<span><span class="co">#&gt; 331 #00BA38 2.243038 29.88428 28.91991 30.84865 0.4793722       FALSE     2</span></span>
<span><span class="co">#&gt; 332 #00BA38 2.287342 29.74387 28.80352 30.68422 0.4674304       FALSE     2</span></span>
<span><span class="co">#&gt; 333 #00BA38 2.331646 29.60346 28.68520 30.52172 0.4564511       FALSE     2</span></span>
<span><span class="co">#&gt; 334 #00BA38 2.375949 29.46305 28.56479 30.36130 0.4465054       FALSE     2</span></span>
<span><span class="co">#&gt; 335 #00BA38 2.420253 29.32264 28.44217 30.20310 0.4376636       FALSE     2</span></span>
<span><span class="co">#&gt; 336 #00BA38 2.464557 29.18223 28.31719 30.04726 0.4299939       FALSE     2</span></span>
<span><span class="co">#&gt; 337 #00BA38 2.508861 29.04182 28.18972 29.89391 0.4235600       FALSE     2</span></span>
<span><span class="co">#&gt; 338 #00BA38 2.553165 28.90140 28.05965 29.74316 0.4184189       FALSE     2</span></span>
<span><span class="co">#&gt; 339 #00BA38 2.597468 28.76099 27.92689 29.59510 0.4146186       FALSE     2</span></span>
<span><span class="co">#&gt; 340 #00BA38 2.641772 28.62058 27.79135 29.44982 0.4121963       FALSE     2</span></span>
<span><span class="co">#&gt; 341 #00BA38 2.686076 28.48017 27.65299 29.30735 0.4111763       FALSE     2</span></span>
<span><span class="co">#&gt; 342 #00BA38 2.730380 28.33976 27.51179 29.16773 0.4115690       FALSE     2</span></span>
<span><span class="co">#&gt; 343 #00BA38 2.774684 28.19935 27.36776 29.03095 0.4133705       FALSE     2</span></span>
<span><span class="co">#&gt; 344 #00BA38 2.818987 28.05894 27.22093 28.89696 0.4165624       FALSE     2</span></span>
<span><span class="co">#&gt; 345 #00BA38 2.863291 27.91853 27.07136 28.76570 0.4211131       FALSE     2</span></span>
<span><span class="co">#&gt; 346 #00BA38 2.907595 27.77812 26.91915 28.63709 0.4269791       FALSE     2</span></span>
<span><span class="co">#&gt; 347 #00BA38 2.951899 27.63771 26.76440 28.51102 0.4341073       FALSE     2</span></span>
<span><span class="co">#&gt; 348 #00BA38 2.996203 27.49730 26.60723 28.38737 0.4424365       FALSE     2</span></span>
<span><span class="co">#&gt; 349 #00BA38 3.040506 27.35689 26.44778 28.26599 0.4519003       FALSE     2</span></span>
<span><span class="co">#&gt; 350 #00BA38 3.084810 27.21648 26.28619 28.14676 0.4624291       FALSE     2</span></span>
<span><span class="co">#&gt; 351 #00BA38 3.129114 27.07607 26.12260 28.02953 0.4739520       FALSE     2</span></span>
<span><span class="co">#&gt; 352 #00BA38 3.173418 26.93566 25.95715 27.91416 0.4863982       FALSE     2</span></span>
<span><span class="co">#&gt; 353 #00BA38 3.217722 26.79524 25.78998 27.80051 0.4996989       FALSE     2</span></span>
<span><span class="co">#&gt; 354 #00BA38 3.262025 26.65483 25.62123 27.68844 0.5137875       FALSE     2</span></span>
<span><span class="co">#&gt; 355 #00BA38 3.306329 26.51442 25.45101 27.57783 0.5286012       FALSE     2</span></span>
<span><span class="co">#&gt; 356 #00BA38 3.350633 26.37401 25.27946 27.46856 0.5440808       FALSE     2</span></span>
<span><span class="co">#&gt; 357 #00BA38 3.394937 26.23360 25.10668 27.36052 0.5601709       FALSE     2</span></span>
<span><span class="co">#&gt; 358 #00BA38 3.439241 26.09319 24.93278 27.25360 0.5768206       FALSE     2</span></span>
<span><span class="co">#&gt; 359 #00BA38 3.483544 25.95278 24.75784 27.14772 0.5939827       FALSE     2</span></span>
<span><span class="co">#&gt; 360 #00BA38 3.527848 25.81237 24.58196 27.04278 0.6116142       FALSE     2</span></span>
<span><span class="co">#&gt; 361 #00BA38 3.572152 25.67196 24.40522 26.93870 0.6296756       FALSE     2</span></span>
<span><span class="co">#&gt; 362 #00BA38 3.616456 25.53155 24.22768 26.83542 0.6481309       FALSE     2</span></span>
<span><span class="co">#&gt; 363 #00BA38 3.660759 25.39114 24.04941 26.73286 0.6669476       FALSE     2</span></span>
<span><span class="co">#&gt; 364 #00BA38 3.705063 25.25073 23.87048 26.63097 0.6860957       FALSE     2</span></span>
<span><span class="co">#&gt; 365 #00BA38 3.749367 25.11032 23.69094 26.52970 0.7055485       FALSE     2</span></span>
<span><span class="co">#&gt; 366 #00BA38 3.793671 24.96991 23.51083 26.42898 0.7252812       FALSE     2</span></span>
<span><span class="co">#&gt; 367 #00BA38 3.837975 24.82949 23.33020 26.32879 0.7452718       FALSE     2</span></span>
<span><span class="co">#&gt; 368 #00BA38 3.882278 24.68908 23.14910 26.22907 0.7655000       FALSE     2</span></span>
<span><span class="co">#&gt; 369 #00BA38 3.926582 24.54867 22.96755 26.12980 0.7859474       FALSE     2</span></span>
<span><span class="co">#&gt; 370 #00BA38 3.970886 24.40826 22.78560 26.03093 0.8065974       FALSE     2</span></span>
<span><span class="co">#&gt; 371 #00BA38 4.015190 24.26785 22.60327 25.93244 0.8274349       FALSE     2</span></span>
<span><span class="co">#&gt; 372 #00BA38 4.059494 24.12744 22.42059 25.83429 0.8484459       FALSE     2</span></span>
<span><span class="co">#&gt; 373 #00BA38 4.103797 23.98703 22.23758 25.73648 0.8696180       FALSE     2</span></span>
<span><span class="co">#&gt; 374 #00BA38 4.148101 23.84662 22.05428 25.63896 0.8909396       FALSE     2</span></span>
<span><span class="co">#&gt; 375 #00BA38 4.192405 23.70621 21.87070 25.54172 0.9124003       FALSE     2</span></span>
<span><span class="co">#&gt; 376 #00BA38 4.236709 23.56580 21.68685 25.44474 0.9339905       FALSE     2</span></span>
<span><span class="co">#&gt; 377 #00BA38 4.281013 23.42539 21.50276 25.34801 0.9557013       FALSE     2</span></span>
<span><span class="co">#&gt; 378 #00BA38 4.325316 23.28498 21.31845 25.25150 0.9775248       FALSE     2</span></span>
<span><span class="co">#&gt; 379 #00BA38 4.369620 23.14457 21.13392 25.15521 0.9994536       FALSE     2</span></span>
<span><span class="co">#&gt; 380 #00BA38 4.413924 23.00416 20.94920 25.05911 1.0214809       FALSE     2</span></span>
<span><span class="co">#&gt; 381 #00BA38 4.458228 22.86374 20.76429 24.96320 1.0436005       FALSE     2</span></span>
<span><span class="co">#&gt; 382 #00BA38 4.502532 22.72333 20.57921 24.86746 1.0658065       FALSE     2</span></span>
<span><span class="co">#&gt; 383 #00BA38 4.546835 22.58292 20.39396 24.77189 1.0880938       FALSE     2</span></span>
<span><span class="co">#&gt; 384 #00BA38 4.591139 22.44251 20.20856 24.67647 1.1104574       FALSE     2</span></span>
<span><span class="co">#&gt; 385 #00BA38 4.635443 22.30210 20.02302 24.58119 1.1328929       FALSE     2</span></span>
<span><span class="co">#&gt; 386 #00BA38 4.679747 22.16169 19.83733 24.48605 1.1553959       FALSE     2</span></span>
<span><span class="co">#&gt; 387 #00BA38 4.724051 22.02128 19.65153 24.39104 1.1779627       FALSE     2</span></span>
<span><span class="co">#&gt; 388 #00BA38 4.768354 21.88087 19.46560 24.29614 1.2005897       FALSE     2</span></span>
<span><span class="co">#&gt; 389 #00BA38 4.812658 21.74046 19.27955 24.20137 1.2232735       FALSE     2</span></span>
<span><span class="co">#&gt; 390 #00BA38 4.856962 21.60005 19.09340 24.10670 1.2460110       FALSE     2</span></span>
<span><span class="co">#&gt; 391 #00BA38 4.901266 21.45964 18.90714 24.01213 1.2687993       FALSE     2</span></span>
<span><span class="co">#&gt; 392 #00BA38 4.945570 21.31923 18.72079 23.91766 1.2916358       FALSE     2</span></span>
<span><span class="co">#&gt; 393 #00BA38 4.989873 21.17882 18.53435 23.82329 1.3145179       FALSE     2</span></span>
<span><span class="co">#&gt; 394 #00BA38 5.034177 21.03841 18.34782 23.72899 1.3374432       FALSE     2</span></span>
<span><span class="co">#&gt; 395 #00BA38 5.078481 20.89800 18.16120 23.63479 1.3604097       FALSE     2</span></span>
<span><span class="co">#&gt; 396 #00BA38 5.122785 20.75758 17.97451 23.54066 1.3834152       FALSE     2</span></span>
<span><span class="co">#&gt; 397 #00BA38 5.167089 20.61717 17.78775 23.44660 1.4064579       FALSE     2</span></span>
<span><span class="co">#&gt; 398 #00BA38 5.211392 20.47676 17.60091 23.35262 1.4295359       FALSE     2</span></span>
<span><span class="co">#&gt; 399 #00BA38 5.255696 20.33635 17.41400 23.25870 1.4526475       FALSE     2</span></span>
<span><span class="co">#&gt; 400 #00BA38 5.300000 20.19594 17.22703 23.16485 1.4757912       FALSE     2</span></span>
<span><span class="co">#&gt; 401 #619CFF 4.000000 21.70513 17.63528 25.77498 1.8679207       FALSE     2</span></span>
<span><span class="co">#&gt; 402 #619CFF 4.037975 21.69321 17.70716 25.67925 1.8294576       FALSE     2</span></span>
<span><span class="co">#&gt; 403 #619CFF 4.075949 21.68128 17.77834 25.58422 1.7913135       FALSE     2</span></span>
<span><span class="co">#&gt; 404 #619CFF 4.113924 21.66936 17.84879 25.48993 1.7535091       FALSE     2</span></span>
<span><span class="co">#&gt; 405 #619CFF 4.151899 21.65743 17.91844 25.39642 1.7160670       FALSE     2</span></span>
<span><span class="co">#&gt; 406 #619CFF 4.189873 21.64551 17.98726 25.30376 1.6790114       FALSE     2</span></span>
<span><span class="co">#&gt; 407 #619CFF 4.227848 21.63358 18.05517 25.21200 1.6423684       FALSE     2</span></span>
<span><span class="co">#&gt; 408 #619CFF 4.265823 21.62166 18.12213 25.12120 1.6061662       FALSE     2</span></span>
<span><span class="co">#&gt; 409 #619CFF 4.303797 21.60974 18.18805 25.03142 1.5704354       FALSE     2</span></span>
<span><span class="co">#&gt; 410 #619CFF 4.341772 21.59781 18.25288 24.94275 1.5352089       FALSE     2</span></span>
<span><span class="co">#&gt; 411 #619CFF 4.379747 21.58589 18.31653 24.85525 1.5005221       FALSE     2</span></span>
<span><span class="co">#&gt; 412 #619CFF 4.417722 21.57396 18.37892 24.76900 1.4664135       FALSE     2</span></span>
<span><span class="co">#&gt; 413 #619CFF 4.455696 21.56204 18.43997 24.68411 1.4329242       FALSE     2</span></span>
<span><span class="co">#&gt; 414 #619CFF 4.493671 21.55012 18.49956 24.60067 1.4000987       FALSE     2</span></span>
<span><span class="co">#&gt; 415 #619CFF 4.531646 21.53819 18.55761 24.51878 1.3679849       FALSE     2</span></span>
<span><span class="co">#&gt; 416 #619CFF 4.569620 21.52627 18.61399 24.43854 1.3366339       FALSE     2</span></span>
<span><span class="co">#&gt; 417 #619CFF 4.607595 21.51434 18.66859 24.36009 1.3061008       FALSE     2</span></span>
<span><span class="co">#&gt; 418 #619CFF 4.645570 21.50242 18.72129 24.28355 1.2764442       FALSE     2</span></span>
<span><span class="co">#&gt; 419 #619CFF 4.683544 21.49050 18.77193 24.20906 1.2477266       FALSE     2</span></span>
<span><span class="co">#&gt; 420 #619CFF 4.721519 21.47857 18.82039 24.13675 1.2200143       FALSE     2</span></span>
<span><span class="co">#&gt; 421 #619CFF 4.759494 21.46665 18.86650 24.06679 1.1933775       FALSE     2</span></span>
<span><span class="co">#&gt; 422 #619CFF 4.797468 21.45472 18.91011 23.99934 1.1678896       FALSE     2</span></span>
<span><span class="co">#&gt; 423 #619CFF 4.835443 21.44280 18.95105 23.93455 1.1436274       FALSE     2</span></span>
<span><span class="co">#&gt; 424 #619CFF 4.873418 21.43088 18.98914 23.87261 1.1206707       FALSE     2</span></span>
<span><span class="co">#&gt; 425 #619CFF 4.911392 21.41895 19.02422 23.81369 1.0991012       FALSE     2</span></span>
<span><span class="co">#&gt; 426 #619CFF 4.949367 21.40703 19.05608 23.75797 1.0790020       FALSE     2</span></span>
<span><span class="co">#&gt; 427 #619CFF 4.987342 21.39510 19.08457 23.70564 1.0604569       FALSE     2</span></span>
<span><span class="co">#&gt; 428 #619CFF 5.025316 21.38318 19.10948 23.65688 1.0435486       FALSE     2</span></span>
<span><span class="co">#&gt; 429 #619CFF 5.063291 21.37126 19.13066 23.61185 1.0283579       FALSE     2</span></span>
<span><span class="co">#&gt; 430 #619CFF 5.101266 21.35933 19.14792 23.57074 1.0149619       FALSE     2</span></span>
<span><span class="co">#&gt; 431 #619CFF 5.139241 21.34741 19.16112 23.53370 1.0034326       FALSE     2</span></span>
<span><span class="co">#&gt; 432 #619CFF 5.177215 21.33548 19.17010 23.50086 0.9938348       FALSE     2</span></span>
<span><span class="co">#&gt; 433 #619CFF 5.215190 21.32356 19.17476 23.47236 0.9862250       FALSE     2</span></span>
<span><span class="co">#&gt; 434 #619CFF 5.253165 21.31163 19.17498 23.44829 0.9806494       FALSE     2</span></span>
<span><span class="co">#&gt; 435 #619CFF 5.291139 21.29971 19.17070 23.42872 0.9771429       FALSE     2</span></span>
<span><span class="co">#&gt; 436 #619CFF 5.329114 21.28779 19.16186 23.41371 0.9757277       FALSE     2</span></span>
<span><span class="co">#&gt; 437 #619CFF 5.367089 21.27586 19.14844 23.40328 0.9764131       FALSE     2</span></span>
<span><span class="co">#&gt; 438 #619CFF 5.405063 21.26394 19.13046 23.39742 0.9791944       FALSE     2</span></span>
<span><span class="co">#&gt; 439 #619CFF 5.443038 21.25201 19.10794 23.39608 0.9840541       FALSE     2</span></span>
<span><span class="co">#&gt; 440 #619CFF 5.481013 21.24009 19.08097 23.39921 0.9909615       FALSE     2</span></span>
<span><span class="co">#&gt; 441 #619CFF 5.518987 21.22817 19.04963 23.40671 0.9998741       FALSE     2</span></span>
<span><span class="co">#&gt; 442 #619CFF 5.556962 21.21624 19.01403 23.41845 1.0107390       FALSE     2</span></span>
<span><span class="co">#&gt; 443 #619CFF 5.594937 21.20432 18.97432 23.43432 1.0234939       FALSE     2</span></span>
<span><span class="co">#&gt; 444 #619CFF 5.632911 21.19239 18.93064 23.45415 1.0380692       FALSE     2</span></span>
<span><span class="co">#&gt; 445 #619CFF 5.670886 21.18047 18.88315 23.47779 1.0543895       FALSE     2</span></span>
<span><span class="co">#&gt; 446 #619CFF 5.708861 21.16855 18.83204 23.50505 1.0723749       FALSE     2</span></span>
<span><span class="co">#&gt; 447 #619CFF 5.746835 21.15662 18.77748 23.53576 1.0919433       FALSE     2</span></span>
<span><span class="co">#&gt; 448 #619CFF 5.784810 21.14470 18.71965 23.56974 1.1130112       FALSE     2</span></span>
<span><span class="co">#&gt; 449 #619CFF 5.822785 21.13277 18.65874 23.60681 1.1354951       FALSE     2</span></span>
<span><span class="co">#&gt; 450 #619CFF 5.860759 21.12085 18.59492 23.64677 1.1593126       FALSE     2</span></span>
<span><span class="co">#&gt; 451 #619CFF 5.898734 21.10893 18.52838 23.68948 1.1843833       FALSE     2</span></span>
<span><span class="co">#&gt; 452 #619CFF 5.936709 21.09700 18.45927 23.73474 1.2106292       FALSE     2</span></span>
<span><span class="co">#&gt; 453 #619CFF 5.974684 21.08508 18.38776 23.78240 1.2379758       FALSE     2</span></span>
<span><span class="co">#&gt; 454 #619CFF 6.012658 21.07315 18.31401 23.83230 1.2663516       FALSE     2</span></span>
<span><span class="co">#&gt; 455 #619CFF 6.050633 21.06123 18.23817 23.88429 1.2956891       FALSE     2</span></span>
<span><span class="co">#&gt; 456 #619CFF 6.088608 21.04931 18.16036 23.93825 1.3259244       FALSE     2</span></span>
<span><span class="co">#&gt; 457 #619CFF 6.126582 21.03738 18.08074 23.99402 1.3569975       FALSE     2</span></span>
<span><span class="co">#&gt; 458 #619CFF 6.164557 21.02546 17.99941 24.05151 1.3888521       FALSE     2</span></span>
<span><span class="co">#&gt; 459 #619CFF 6.202532 21.01353 17.91649 24.11058 1.4214358       FALSE     2</span></span>
<span><span class="co">#&gt; 460 #619CFF 6.240506 21.00161 17.83209 24.17113 1.4546996       FALSE     2</span></span>
<span><span class="co">#&gt; 461 #619CFF 6.278481 20.98969 17.74631 24.23306 1.4885977       FALSE     2</span></span>
<span><span class="co">#&gt; 462 #619CFF 6.316456 20.97776 17.65924 24.29628 1.5230880       FALSE     2</span></span>
<span><span class="co">#&gt; 463 #619CFF 6.354430 20.96584 17.57096 24.36071 1.5581311       FALSE     2</span></span>
<span><span class="co">#&gt; 464 #619CFF 6.392405 20.95391 17.48156 24.42627 1.5936904       FALSE     2</span></span>
<span><span class="co">#&gt; 465 #619CFF 6.430380 20.94199 17.39111 24.49287 1.6297323       FALSE     2</span></span>
<span><span class="co">#&gt; 466 #619CFF 6.468354 20.93006 17.29967 24.56046 1.6662254       FALSE     2</span></span>
<span><span class="co">#&gt; 467 #619CFF 6.506329 20.91814 17.20732 24.62897 1.7031407       FALSE     2</span></span>
<span><span class="co">#&gt; 468 #619CFF 6.544304 20.90622 17.11410 24.69833 1.7404513       FALSE     2</span></span>
<span><span class="co">#&gt; 469 #619CFF 6.582278 20.89429 17.02007 24.76851 1.7781323       FALSE     2</span></span>
<span><span class="co">#&gt; 470 #619CFF 6.620253 20.88237 16.92529 24.83944 1.8161608       FALSE     2</span></span>
<span><span class="co">#&gt; 471 #619CFF 6.658228 20.87044 16.82980 24.91109 1.8545153       FALSE     2</span></span>
<span><span class="co">#&gt; 472 #619CFF 6.696203 20.85852 16.73364 24.98340 1.8931760       FALSE     2</span></span>
<span><span class="co">#&gt; 473 #619CFF 6.734177 20.84660 16.63686 25.05633 1.9321245       FALSE     2</span></span>
<span><span class="co">#&gt; 474 #619CFF 6.772152 20.83467 16.53948 25.12986 1.9713437       FALSE     2</span></span>
<span><span class="co">#&gt; 475 #619CFF 6.810127 20.82275 16.44155 25.20394 2.0108179       FALSE     2</span></span>
<span><span class="co">#&gt; 476 #619CFF 6.848101 20.81082 16.34310 25.27855 2.0505323       FALSE     2</span></span>
<span><span class="co">#&gt; 477 #619CFF 6.886076 20.79890 16.24415 25.35365 2.0904732       FALSE     2</span></span>
<span><span class="co">#&gt; 478 #619CFF 6.924051 20.78698 16.14474 25.42922 2.1306279       FALSE     2</span></span>
<span><span class="co">#&gt; 479 #619CFF 6.962025 20.77505 16.04488 25.50522 2.1709845       FALSE     2</span></span>
<span><span class="co">#&gt; 480 #619CFF 7.000000 20.76313 15.94461 25.58164 2.2115319       FALSE     2</span></span>
<span><span class="co">#&gt;     group   fill linewidth linetype weight alpha</span></span>
<span><span class="co">#&gt; 1       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 2       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 3       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 4       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 5       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 6       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 7       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 8       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 9       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 10      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 11      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 12      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 13      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 14      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 15      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 16      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 17      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 18      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 19      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 20      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 21      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 22      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 23      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 24      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 25      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 26      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 27      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 28      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 29      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 30      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 31      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 32      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 33      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 34      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 35      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 36      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 37      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 38      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 39      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 40      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 41      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 42      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 43      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 44      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 45      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 46      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 47      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 48      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 49      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 50      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 51      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 52      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 53      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 54      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 55      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 56      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 57      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 58      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 59      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 60      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 61      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 62      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 63      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 64      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 65      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 66      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 67      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 68      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 69      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 70      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 71      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 72      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 73      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 74      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 75      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 76      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 77      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 78      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 79      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 80      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 81      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 82      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 83      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 84      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 85      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 86      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 87      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 88      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 89      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 90      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 91      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 92      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 93      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 94      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 95      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 96      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 97      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 98      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 99      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 100     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 101     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 102     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 103     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 104     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 105     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 106     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 107     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 108     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 109     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 110     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 111     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 112     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 113     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 114     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 115     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 116     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 117     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 118     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 119     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 120     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 121     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 122     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 123     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 124     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 125     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 126     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 127     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 128     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 129     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 130     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 131     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 132     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 133     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 134     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 135     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 136     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 137     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 138     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 139     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 140     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 141     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 142     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 143     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 144     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 145     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 146     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 147     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 148     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 149     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 150     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 151     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 152     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 153     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 154     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 155     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 156     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 157     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 158     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 159     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 160     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 161     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 162     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 163     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 164     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 165     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 166     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 167     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 168     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 169     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 170     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 171     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 172     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 173     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 174     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 175     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 176     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 177     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 178     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 179     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 180     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 181     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 182     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 183     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 184     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 185     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 186     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 187     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 188     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 189     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 190     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 191     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 192     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 193     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 194     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 195     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 196     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 197     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 198     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 199     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 200     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 201     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 202     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 203     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 204     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 205     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 206     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 207     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 208     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 209     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 210     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 211     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 212     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 213     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 214     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 215     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 216     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 217     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 218     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 219     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 220     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 221     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 222     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 223     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 224     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 225     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 226     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 227     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 228     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 229     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 230     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 231     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 232     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 233     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 234     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 235     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 236     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 237     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 238     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 239     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 240     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 241     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 242     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 243     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 244     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 245     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 246     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 247     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 248     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 249     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 250     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 251     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 252     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 253     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 254     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 255     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 256     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 257     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 258     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 259     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 260     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 261     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 262     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 263     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 264     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 265     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 266     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 267     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 268     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 269     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 270     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 271     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 272     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 273     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 274     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 275     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 276     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 277     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 278     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 279     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 280     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 281     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 282     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 283     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 284     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 285     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 286     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 287     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 288     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 289     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 290     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 291     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 292     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 293     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 294     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 295     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 296     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 297     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 298     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 299     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 300     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 301     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 302     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 303     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 304     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 305     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 306     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 307     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 308     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 309     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 310     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 311     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 312     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 313     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 314     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 315     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 316     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 317     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 318     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 319     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 320     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 321     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 322     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 323     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 324     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 325     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 326     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 327     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 328     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 329     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 330     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 331     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 332     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 333     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 334     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 335     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 336     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 337     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 338     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 339     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 340     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 341     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 342     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 343     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 344     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 345     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 346     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 347     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 348     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 349     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 350     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 351     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 352     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 353     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 354     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 355     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 356     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 357     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 358     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 359     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 360     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 361     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 362     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 363     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 364     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 365     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 366     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 367     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 368     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 369     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 370     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 371     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 372     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 373     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 374     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 375     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 376     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 377     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 378     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 379     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 380     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 381     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 382     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 383     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 384     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 385     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 386     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 387     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 388     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 389     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 390     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 391     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 392     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 393     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 394     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 395     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 396     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 397     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 398     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 399     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 400     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 401     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 402     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 403     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 404     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 405     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 406     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 407     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 408     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 409     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 410     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 411     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 412     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 413     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 414     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 415     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 416     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 417     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 418     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 419     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 420     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 421     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 422     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 423     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 424     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 425     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 426     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 427     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 428     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 429     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 430     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 431     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 432     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 433     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 434     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 435     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 436     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 437     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 438     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 439     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 440     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 441     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 442     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 443     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 444     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 445     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 446     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 447     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 448     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 449     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 450     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 451     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 452     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 453     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 454     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 455     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 456     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 457     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 458     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 459     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 460     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 461     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 462     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 463     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 464     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 465     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 466     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 467     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 468     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 469     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 470     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 471     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 472     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 473     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 474     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 475     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 476     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 477     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 478     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 479     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 480     3 grey60         1        1      1   0.4</span></span>
<span><span class="va">p_built</span> <span class="op">$</span><span class="va">layout</span></span>
<span><span class="co">#&gt; &lt;ggproto object: Class Layout, gg&gt;</span></span>
<span><span class="co">#&gt;     coord: &lt;ggproto object: Class CoordCartesian, Coord, gg&gt;</span></span>
<span><span class="co">#&gt;         aspect: function</span></span>
<span><span class="co">#&gt;         backtransform_range: function</span></span>
<span><span class="co">#&gt;         clip: on</span></span>
<span><span class="co">#&gt;         default: TRUE</span></span>
<span><span class="co">#&gt;         distance: function</span></span>
<span><span class="co">#&gt;         expand: TRUE</span></span>
<span><span class="co">#&gt;         is_free: function</span></span>
<span><span class="co">#&gt;         is_linear: function</span></span>
<span><span class="co">#&gt;         labels: function</span></span>
<span><span class="co">#&gt;         limits: list</span></span>
<span><span class="co">#&gt;         modify_scales: function</span></span>
<span><span class="co">#&gt;         range: function</span></span>
<span><span class="co">#&gt;         render_axis_h: function</span></span>
<span><span class="co">#&gt;         render_axis_v: function</span></span>
<span><span class="co">#&gt;         render_bg: function</span></span>
<span><span class="co">#&gt;         render_fg: function</span></span>
<span><span class="co">#&gt;         setup_data: function</span></span>
<span><span class="co">#&gt;         setup_layout: function</span></span>
<span><span class="co">#&gt;         setup_panel_guides: function</span></span>
<span><span class="co">#&gt;         setup_panel_params: function</span></span>
<span><span class="co">#&gt;         setup_params: function</span></span>
<span><span class="co">#&gt;         train_panel_guides: function</span></span>
<span><span class="co">#&gt;         transform: function</span></span>
<span><span class="co">#&gt;         super:  &lt;ggproto object: Class CoordCartesian, Coord, gg&gt;</span></span>
<span><span class="co">#&gt;     coord_params: list</span></span>
<span><span class="co">#&gt;     facet: &lt;ggproto object: Class FacetWrap, Facet, gg&gt;</span></span>
<span><span class="co">#&gt;         compute_layout: function</span></span>
<span><span class="co">#&gt;         draw_back: function</span></span>
<span><span class="co">#&gt;         draw_front: function</span></span>
<span><span class="co">#&gt;         draw_labels: function</span></span>
<span><span class="co">#&gt;         draw_panels: function</span></span>
<span><span class="co">#&gt;         finish_data: function</span></span>
<span><span class="co">#&gt;         init_scales: function</span></span>
<span><span class="co">#&gt;         map_data: function</span></span>
<span><span class="co">#&gt;         params: list</span></span>
<span><span class="co">#&gt;         setup_data: function</span></span>
<span><span class="co">#&gt;         setup_params: function</span></span>
<span><span class="co">#&gt;         shrink: TRUE</span></span>
<span><span class="co">#&gt;         train_scales: function</span></span>
<span><span class="co">#&gt;         vars: function</span></span>
<span><span class="co">#&gt;         super:  &lt;ggproto object: Class FacetWrap, Facet, gg&gt;</span></span>
<span><span class="co">#&gt;     facet_params: list</span></span>
<span><span class="co">#&gt;     finish_data: function</span></span>
<span><span class="co">#&gt;     get_scales: function</span></span>
<span><span class="co">#&gt;     layout: data.frame</span></span>
<span><span class="co">#&gt;     map_position: function</span></span>
<span><span class="co">#&gt;     panel_params: list</span></span>
<span><span class="co">#&gt;     panel_scales_x: list</span></span>
<span><span class="co">#&gt;     panel_scales_y: list</span></span>
<span><span class="co">#&gt;     render: function</span></span>
<span><span class="co">#&gt;     render_labels: function</span></span>
<span><span class="co">#&gt;     reset_scales: function</span></span>
<span><span class="co">#&gt;     resolve_label: function</span></span>
<span><span class="co">#&gt;     setup: function</span></span>
<span><span class="co">#&gt;     setup_panel_guides: function</span></span>
<span><span class="co">#&gt;     setup_panel_params: function</span></span>
<span><span class="co">#&gt;     train_position: function</span></span>
<span><span class="co">#&gt;     super:  &lt;ggproto object: Class Layout, gg&gt;</span></span>
<span><span class="va">p_built</span> <span class="op">$</span><span class="va">plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-73-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">p_gtable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_gtable.html">ggplot_gtable</a></span><span class="op">(</span><span class="va">p_built</span><span class="op">)</span></span>
<span><span class="va">p_gtable</span></span>
<span><span class="co">#&gt; TableGrob (17 x 17) "layout": 25 grobs</span></span>
<span><span class="co">#&gt;     z         cells             name</span></span>
<span><span class="co">#&gt; 1   0 ( 1-17, 1-17)       background</span></span>
<span><span class="co">#&gt; 2   1 (10-10, 7- 7)        panel-1-1</span></span>
<span><span class="co">#&gt; 3   1 (10-10,11-11)        panel-2-1</span></span>
<span><span class="co">#&gt; 4   3 ( 8- 8, 7- 7)       axis-t-1-1</span></span>
<span><span class="co">#&gt; 5   3 ( 8- 8,11-11)       axis-t-2-1</span></span>
<span><span class="co">#&gt; 6   3 (11-11, 7- 7)       axis-b-1-1</span></span>
<span><span class="co">#&gt; 7   3 (11-11,11-11)       axis-b-2-1</span></span>
<span><span class="co">#&gt; 8   3 (10-10,10-10)       axis-l-1-2</span></span>
<span><span class="co">#&gt; 9   3 (10-10, 6- 6)       axis-l-1-1</span></span>
<span><span class="co">#&gt; 10  3 (10-10,12-12)       axis-r-1-2</span></span>
<span><span class="co">#&gt; 11  3 (10-10, 8- 8)       axis-r-1-1</span></span>
<span><span class="co">#&gt; 12  2 ( 9- 9, 7- 7)      strip-t-1-1</span></span>
<span><span class="co">#&gt; 13  2 ( 9- 9,11-11)      strip-t-2-1</span></span>
<span><span class="co">#&gt; 14  4 ( 7- 7, 7-11)           xlab-t</span></span>
<span><span class="co">#&gt; 15  5 (12-12, 7-11)           xlab-b</span></span>
<span><span class="co">#&gt; 16  6 (10-10, 5- 5)           ylab-l</span></span>
<span><span class="co">#&gt; 17  7 (10-10,13-13)           ylab-r</span></span>
<span><span class="co">#&gt; 18  8 (10-10,15-15)  guide-box-right</span></span>
<span><span class="co">#&gt; 19  9 (10-10, 3- 3)   guide-box-left</span></span>
<span><span class="co">#&gt; 20 10 (14-14, 7-11) guide-box-bottom</span></span>
<span><span class="co">#&gt; 21 11 ( 5- 5, 7-11)    guide-box-top</span></span>
<span><span class="co">#&gt; 22 12 (10-10, 7-11) guide-box-inside</span></span>
<span><span class="co">#&gt; 23 13 ( 4- 4, 7-11)         subtitle</span></span>
<span><span class="co">#&gt; 24 14 ( 3- 3, 7-11)            title</span></span>
<span><span class="co">#&gt; 25 15 (15-15, 7-11)          caption</span></span>
<span><span class="co">#&gt;                                               grob</span></span>
<span><span class="co">#&gt; 1                rect[plot.background..rect.11755]</span></span>
<span><span class="co">#&gt; 2                       gTree[panel-1.gTree.11635]</span></span>
<span><span class="co">#&gt; 3                       gTree[panel-2.gTree.11650]</span></span>
<span><span class="co">#&gt; 4                                   zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 5                                   zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 6            absoluteGrob[GRID.absoluteGrob.11654]</span></span>
<span><span class="co">#&gt; 7            absoluteGrob[GRID.absoluteGrob.11654]</span></span>
<span><span class="co">#&gt; 8                                   zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 9            absoluteGrob[GRID.absoluteGrob.11662]</span></span>
<span><span class="co">#&gt; 10                                  zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 11                                  zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 12                                   gtable[strip]</span></span>
<span><span class="co">#&gt; 13                                   gtable[strip]</span></span>
<span><span class="co">#&gt; 14                                  zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 15 titleGrob[axis.title.x.bottom..titleGrob.11717]</span></span>
<span><span class="co">#&gt; 16   titleGrob[axis.title.y.left..titleGrob.11720]</span></span>
<span><span class="co">#&gt; 17                                  zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 18                               gtable[guide-box]</span></span>
<span><span class="co">#&gt; 19                                  zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 20                                  zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 21                                  zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 22                                  zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 23         zeroGrob[plot.subtitle..zeroGrob.11752]</span></span>
<span><span class="co">#&gt; 24          titleGrob[plot.title..titleGrob.11751]</span></span>
<span><span class="co">#&gt; 25          zeroGrob[plot.caption..zeroGrob.11753]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.draw.html">grid.draw</a></span><span class="op">(</span><span class="va">p_gtable</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-74-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="ggproto对象" class="level2" data-number="1.13"><h2 data-number="1.13" class="anchored" data-anchor-id="ggproto对象">
<span class="header-section-number">1.13</span> <strong>ggproto对象</strong>
</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">NewObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggproto.html">ggproto</a></span><span class="op">(</span></span>
<span>  `_class` <span class="op">=</span> <span class="cn">NULL</span>,     <span class="co"># 类</span></span>
<span>  `_inherits` <span class="op">=</span> <span class="cn">NULL</span>   <span class="co"># 继承</span></span>
<span><span class="op">)</span></span>
<span><span class="va">NewObject</span> </span>
<span><span class="co">#&gt; &lt;ggproto object: Class gg&gt;</span></span>
<span><span class="co">#&gt;     _inherits: NULL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>创建新类，子类继承</p>


<!-- -->

</section></section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb128" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># ggplot2 Graphics {#sec-ggplot2 style="color:red"}</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">ggplot2：用于数据分析的优雅图形</span><span class="co">](https://ggplot2-book.org/mastery)</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>gg 为 grammar of graphics 的缩写。</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a><span class="fu">## `ggplot(data =  ,mapping = aes(x,y,…))`</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a><span class="fu">### data</span></span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>ggplot2包的内置数据集 <span class="in">`mpg`</span> 和 <span class="in">`diamonds`</span></span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mpg)</span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg)</span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a><span class="fu">### aesthetics mapping</span></span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a><span class="in">`mapping=aes(x,y,z,..,color,fill,shape,size,group,linewidth,linetype,alpha,...)`</span></span>
<span id="cb128-30"><a href="#cb128-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-31"><a href="#cb128-31" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 坐标</span></span>
<span id="cb128-32"><a href="#cb128-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-35"><a href="#cb128-35" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-36"><a href="#cb128-36" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb128-37"><a href="#cb128-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span>hwy ))</span>
<span id="cb128-38"><a href="#cb128-38" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-39"><a href="#cb128-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-40"><a href="#cb128-40" aria-hidden="true" tabindex="-1"></a><span class="fu">#### shape</span></span>
<span id="cb128-41"><a href="#cb128-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-44"><a href="#cb128-44" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-45"><a href="#cb128-45" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span><span class="co">#颜色 名义型变量</span></span>
<span id="cb128-46"><a href="#cb128-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="st">"."</span>) <span class="co">#像素点</span></span>
<span id="cb128-47"><a href="#cb128-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-48"><a href="#cb128-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-49"><a href="#cb128-49" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">shape =</span> class)) <span class="sc">+</span> <span class="co">#形状最多可以映射6个</span></span>
<span id="cb128-50"><a href="#cb128-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb128-51"><a href="#cb128-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-52"><a href="#cb128-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-53"><a href="#cb128-53" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> <span class="co">#形状共有26个</span></span>
<span id="cb128-54"><a href="#cb128-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="dv">22</span>,<span class="at">color=</span><span class="st">"red"</span>,<span class="at">fill=</span><span class="st">"green"</span>)</span>
<span id="cb128-55"><a href="#cb128-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-56"><a href="#cb128-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-57"><a href="#cb128-57" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb128-58"><a href="#cb128-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb128-59"><a href="#cb128-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb128-60"><a href="#cb128-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> mpg <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"2seater"</span>), </span>
<span id="cb128-61"><a href="#cb128-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span></span>
<span id="cb128-62"><a href="#cb128-62" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb128-63"><a href="#cb128-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb128-64"><a href="#cb128-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> mpg <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"2seater"</span>), </span>
<span id="cb128-65"><a href="#cb128-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"circle open"</span>,<span class="co"># shape = 1</span></span>
<span id="cb128-66"><a href="#cb128-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span></span>
<span id="cb128-67"><a href="#cb128-67" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb128-68"><a href="#cb128-68" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-69"><a href="#cb128-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-70"><a href="#cb128-70" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/shape.png)</span>{fig-align="center" width="80%"}</span>
<span id="cb128-71"><a href="#cb128-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-74"><a href="#cb128-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-75"><a href="#cb128-75" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">size =</span>cty)) <span class="sc">+</span><span class="co">#大小 有序型变量</span></span>
<span id="cb128-76"><a href="#cb128-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb128-77"><a href="#cb128-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-78"><a href="#cb128-78" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">alpha =</span> cty)) <span class="sc">+</span><span class="co">#透明度 有序型变量</span></span>
<span id="cb128-79"><a href="#cb128-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"red"</span>) <span class="co">#更改外观</span></span>
<span id="cb128-80"><a href="#cb128-80" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">linetype =</span> drv)) <span class="sc">+</span> <span class="co">#线条类型</span></span>
<span id="cb128-81"><a href="#cb128-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb128-82"><a href="#cb128-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-83"><a href="#cb128-83" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">linewidth =</span> drv)) <span class="sc">+</span> <span class="co">#线条粗细</span></span>
<span id="cb128-84"><a href="#cb128-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb128-85"><a href="#cb128-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-86"><a href="#cb128-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-87"><a href="#cb128-87" aria-hidden="true" tabindex="-1"></a><span class="fu">## geometry</span></span>
<span id="cb128-88"><a href="#cb128-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-89"><a href="#cb128-89" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Graphical primitives:</span>
<span id="cb128-90"><a href="#cb128-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-91"><a href="#cb128-91" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_blank()`</span>: display nothing. Most useful for adjusting axes limits using data.</span>
<span id="cb128-92"><a href="#cb128-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-93"><a href="#cb128-93" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_point()`</span>: points.</span>
<span id="cb128-94"><a href="#cb128-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-95"><a href="#cb128-95" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_path()`</span>: paths.</span>
<span id="cb128-96"><a href="#cb128-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-97"><a href="#cb128-97" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_ribbon()`</span>: ribbons, a path with vertical thickness.</span>
<span id="cb128-98"><a href="#cb128-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-99"><a href="#cb128-99" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_segment()`</span>: a line segment, specified by start and end position.</span>
<span id="cb128-100"><a href="#cb128-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-101"><a href="#cb128-101" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_rect()`</span>: rectangles.</span>
<span id="cb128-102"><a href="#cb128-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-103"><a href="#cb128-103" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_polygon()`</span>: filled polygons.</span>
<span id="cb128-104"><a href="#cb128-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-105"><a href="#cb128-105" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_text()`</span>: text.</span>
<span id="cb128-106"><a href="#cb128-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-107"><a href="#cb128-107" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb128-108"><a href="#cb128-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-109"><a href="#cb128-109" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>One variable:</span>
<span id="cb128-110"><a href="#cb128-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-111"><a href="#cb128-111" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Discrete:</span>
<span id="cb128-112"><a href="#cb128-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-113"><a href="#cb128-113" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_bar()`</span>: display distribution of discrete variable.</span>
<span id="cb128-114"><a href="#cb128-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-115"><a href="#cb128-115" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Continuous:</span>
<span id="cb128-116"><a href="#cb128-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-117"><a href="#cb128-117" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_histogram()`</span>: bin and count continuous variable, display with bars.</span>
<span id="cb128-118"><a href="#cb128-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-119"><a href="#cb128-119" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_density()`</span>: smoothed density estimate.</span>
<span id="cb128-120"><a href="#cb128-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-121"><a href="#cb128-121" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_dotplot()`</span>: stack individual points into a dot plot.</span>
<span id="cb128-122"><a href="#cb128-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-123"><a href="#cb128-123" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_freqpoly()`</span>: bin and count continuous variable, display with lines.</span>
<span id="cb128-124"><a href="#cb128-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-125"><a href="#cb128-125" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Two variables:</span>
<span id="cb128-126"><a href="#cb128-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-127"><a href="#cb128-127" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Both continuous:</span>
<span id="cb128-128"><a href="#cb128-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-129"><a href="#cb128-129" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_point()`</span>: scatterplot.</span>
<span id="cb128-130"><a href="#cb128-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-131"><a href="#cb128-131" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_quantile()`</span>: smoothed quantile regression.</span>
<span id="cb128-132"><a href="#cb128-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-133"><a href="#cb128-133" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_rug()`</span>: marginal rug plots.</span>
<span id="cb128-134"><a href="#cb128-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-135"><a href="#cb128-135" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_smooth()`</span>: smoothed line of best fit.</span>
<span id="cb128-136"><a href="#cb128-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-137"><a href="#cb128-137" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_text()`</span>: text labels.</span>
<span id="cb128-138"><a href="#cb128-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-139"><a href="#cb128-139" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Show distribution:</span>
<span id="cb128-140"><a href="#cb128-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-141"><a href="#cb128-141" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_bin2d()`</span>: bin into rectangles and count.</span>
<span id="cb128-142"><a href="#cb128-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-143"><a href="#cb128-143" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_density2d()`</span>: smoothed 2d density estimate.</span>
<span id="cb128-144"><a href="#cb128-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-145"><a href="#cb128-145" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_hex()`</span>: bin into hexagons and count.</span>
<span id="cb128-146"><a href="#cb128-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-147"><a href="#cb128-147" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>At least one discrete:</span>
<span id="cb128-148"><a href="#cb128-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-149"><a href="#cb128-149" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_count()`</span>: count number of point at distinct locations</span>
<span id="cb128-150"><a href="#cb128-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-151"><a href="#cb128-151" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_jitter()`</span>: randomly jitter overlapping points.</span>
<span id="cb128-152"><a href="#cb128-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-153"><a href="#cb128-153" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>One continuous, one discrete:</span>
<span id="cb128-154"><a href="#cb128-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-155"><a href="#cb128-155" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_bar(stat = "identity")`</span>: a bar chart of precomputed summaries.</span>
<span id="cb128-156"><a href="#cb128-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-157"><a href="#cb128-157" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_boxplot()`</span>: boxplots.</span>
<span id="cb128-158"><a href="#cb128-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-159"><a href="#cb128-159" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_violin()`</span>: show density of values in each group.</span>
<span id="cb128-160"><a href="#cb128-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-161"><a href="#cb128-161" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>One time, one continuous:</span>
<span id="cb128-162"><a href="#cb128-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-163"><a href="#cb128-163" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_area()`</span>: area plot.</span>
<span id="cb128-164"><a href="#cb128-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-165"><a href="#cb128-165" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_line()`</span>: line plot.</span>
<span id="cb128-166"><a href="#cb128-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-167"><a href="#cb128-167" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_step()`</span>: step plot.</span>
<span id="cb128-168"><a href="#cb128-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-169"><a href="#cb128-169" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Display uncertainty:</span>
<span id="cb128-170"><a href="#cb128-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-171"><a href="#cb128-171" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_crossbar()`</span>: vertical bar with center.</span>
<span id="cb128-172"><a href="#cb128-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-173"><a href="#cb128-173" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_errorbar()`</span>: error bars.</span>
<span id="cb128-174"><a href="#cb128-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-175"><a href="#cb128-175" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_linerange()`</span>: vertical line.</span>
<span id="cb128-176"><a href="#cb128-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-177"><a href="#cb128-177" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_pointrange()`</span>: vertical line with center.</span>
<span id="cb128-178"><a href="#cb128-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-179"><a href="#cb128-179" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Spatial:</span>
<span id="cb128-180"><a href="#cb128-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-181"><a href="#cb128-181" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_map()`</span>: fast version of for map data.<span class="in">`geom_polygon()`</span></span>
<span id="cb128-182"><a href="#cb128-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-183"><a href="#cb128-183" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Three variables:</span>
<span id="cb128-184"><a href="#cb128-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-185"><a href="#cb128-185" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_contour()`</span>: contours.</span>
<span id="cb128-186"><a href="#cb128-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-187"><a href="#cb128-187" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_tile()`</span>: tile the plane with rectangles.</span>
<span id="cb128-188"><a href="#cb128-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-189"><a href="#cb128-189" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_raster()`</span>: fast version of for equal sized tiles.<span class="in">`geom_tile()`</span></span>
<span id="cb128-190"><a href="#cb128-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-193"><a href="#cb128-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-194"><a href="#cb128-194" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb128-195"><a href="#cb128-195" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">5</span>), </span>
<span id="cb128-196"><a href="#cb128-196" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>), </span>
<span id="cb128-197"><a href="#cb128-197" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>)</span>
<span id="cb128-198"><a href="#cb128-198" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-199"><a href="#cb128-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-200"><a href="#cb128-200" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> label)) <span class="sc">+</span> </span>
<span id="cb128-201"><a href="#cb128-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="co"># Hide axis label</span></span>
<span id="cb128-202"><a href="#cb128-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) <span class="co"># Shrink plot title</span></span>
<span id="cb128-203"><a href="#cb128-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-204"><a href="#cb128-204" aria-hidden="true" tabindex="-1"></a>(p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb128-205"><a href="#cb128-205" aria-hidden="true" tabindex="-1"></a>        p <span class="sc">+</span> <span class="fu">geom_text</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"text"</span>) <span class="sc">+</span></span>
<span id="cb128-206"><a href="#cb128-206" aria-hidden="true" tabindex="-1"></a>        p <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"bar"</span>) )<span class="sc">/</span></span>
<span id="cb128-207"><a href="#cb128-207" aria-hidden="true" tabindex="-1"></a>(p <span class="sc">+</span> <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"tile"</span>) <span class="sc">+</span></span>
<span id="cb128-208"><a href="#cb128-208" aria-hidden="true" tabindex="-1"></a>     p <span class="sc">+</span> <span class="fu">geom_raster</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"raster"</span>)<span class="sc">+</span></span>
<span id="cb128-209"><a href="#cb128-209" aria-hidden="true" tabindex="-1"></a>     p <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"line"</span>)) <span class="sc">/</span></span>
<span id="cb128-210"><a href="#cb128-210" aria-hidden="true" tabindex="-1"></a>(p <span class="sc">+</span> <span class="fu">geom_area</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"area"</span>) <span class="sc">+</span></span>
<span id="cb128-211"><a href="#cb128-211" aria-hidden="true" tabindex="-1"></a>    p <span class="sc">+</span> <span class="fu">geom_path</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"path"</span>) <span class="sc">+</span></span>
<span id="cb128-212"><a href="#cb128-212" aria-hidden="true" tabindex="-1"></a>    p <span class="sc">+</span> <span class="fu">geom_polygon</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"polygon"</span>))</span>
<span id="cb128-213"><a href="#cb128-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-214"><a href="#cb128-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-215"><a href="#cb128-215" aria-hidden="true" tabindex="-1"></a><span class="fu">### X=连续型变量</span></span>
<span id="cb128-216"><a href="#cb128-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-217"><a href="#cb128-217" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_point</span></span>
<span id="cb128-218"><a href="#cb128-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-221"><a href="#cb128-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-222"><a href="#cb128-222" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb128-223"><a href="#cb128-223" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>displ,<span class="at">y=</span>hwy),</span>
<span id="cb128-224"><a href="#cb128-224" aria-hidden="true" tabindex="-1"></a>               <span class="at">stat =</span> <span class="st">"identity"</span>,<span class="at">position =</span> <span class="st">"identity"</span>)</span>
<span id="cb128-225"><a href="#cb128-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-226"><a href="#cb128-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-229"><a href="#cb128-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-230"><a href="#cb128-230" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ,hwy)) <span class="sc">+</span></span>
<span id="cb128-231"><a href="#cb128-231" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">|</span></span>
<span id="cb128-232"><a href="#cb128-232" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-233"><a href="#cb128-233" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ,hwy)) <span class="sc">+</span></span>
<span id="cb128-234"><a href="#cb128-234" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> displ<span class="sc">/</span><span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb128-235"><a href="#cb128-235" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_area</span>(<span class="at">name=</span><span class="st">"displ/10"</span>)</span>
<span id="cb128-236"><a href="#cb128-236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-237"><a href="#cb128-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-238"><a href="#cb128-238" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_line</span></span>
<span id="cb128-239"><a href="#cb128-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-242"><a href="#cb128-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-243"><a href="#cb128-243" aria-hidden="true" tabindex="-1"></a>economics <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb128-244"><a href="#cb128-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-245"><a href="#cb128-245" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(economics,<span class="fu">aes</span>(date,pop))<span class="sc">+</span></span>
<span id="cb128-246"><a href="#cb128-246" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb128-247"><a href="#cb128-247" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>()</span>
<span id="cb128-248"><a href="#cb128-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-249"><a href="#cb128-249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-250"><a href="#cb128-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-251"><a href="#cb128-251" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_smooth</span></span>
<span id="cb128-252"><a href="#cb128-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-255"><a href="#cb128-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-256"><a href="#cb128-256" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span></span>
<span id="cb128-257"><a href="#cb128-257" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span>
<span id="cb128-258"><a href="#cb128-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-259"><a href="#cb128-259" aria-hidden="true" tabindex="-1"></a>q<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>,<span class="at">span =</span> <span class="fl">0.2</span>,<span class="at">se=</span>T) <span class="co"># loess 平滑局部回归   small n</span></span>
<span id="cb128-260"><a href="#cb128-260" aria-hidden="true" tabindex="-1"></a>                                   <span class="co">#span 0非常摆动，1不那么摆动</span></span>
<span id="cb128-261"><a href="#cb128-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-262"><a href="#cb128-262" aria-hidden="true" tabindex="-1"></a>q<span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="dv">1</span>)  <span class="co">#不很摆动</span></span>
<span id="cb128-263"><a href="#cb128-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-264"><a href="#cb128-264" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb128-265"><a href="#cb128-265" aria-hidden="true" tabindex="-1"></a>q<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"rlm"</span>)   <span class="co"># robust linear model  稳健线性模型</span></span>
<span id="cb128-266"><a href="#cb128-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-267"><a href="#cb128-267" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb128-268"><a href="#cb128-268" aria-hidden="true" tabindex="-1"></a>q<span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"gam"</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x)) <span class="co"># gam 广义相加模型   n&gt;1000</span></span>
<span id="cb128-269"><a href="#cb128-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-270"><a href="#cb128-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-273"><a href="#cb128-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-274"><a href="#cb128-274" aria-hidden="true" tabindex="-1"></a>binomial_smooth <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb128-275"><a href="#cb128-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"binomial"</span>), ...)</span>
<span id="cb128-276"><a href="#cb128-276" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-277"><a href="#cb128-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-278"><a href="#cb128-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-279"><a href="#cb128-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-280"><a href="#cb128-280" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rpart<span class="sc">::</span>kyphosis,<span class="fu">aes</span>(Age,<span class="fu">as.numeric</span>(Kyphosis)<span class="sc">-</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb128-281"><a href="#cb128-281" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb128-282"><a href="#cb128-282" aria-hidden="true" tabindex="-1"></a>    <span class="fu">binomial_smooth</span>()</span>
<span id="cb128-283"><a href="#cb128-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-284"><a href="#cb128-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-285"><a href="#cb128-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-286"><a href="#cb128-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-287"><a href="#cb128-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-288"><a href="#cb128-288" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_histogram</span></span>
<span id="cb128-289"><a href="#cb128-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-292"><a href="#cb128-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-293"><a href="#cb128-293" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">2.5</span>)</span>
<span id="cb128-294"><a href="#cb128-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-295"><a href="#cb128-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-296"><a href="#cb128-296" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy)) <span class="sc">+</span></span>
<span id="cb128-297"><a href="#cb128-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">|</span></span>
<span id="cb128-298"><a href="#cb128-298" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy)) <span class="sc">+</span></span>
<span id="cb128-299"><a href="#cb128-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">weight =</span> displ), <span class="at">binwidth =</span> <span class="dv">1</span>) <span class="co"># 加权</span></span>
<span id="cb128-300"><a href="#cb128-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-301"><a href="#cb128-301" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb128-302"><a href="#cb128-302" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>displ,<span class="at">y=</span><span class="fu">after_stat</span>(density)),</span>
<span id="cb128-303"><a href="#cb128-303" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stat =</span> <span class="st">"bin"</span>,<span class="at">position =</span> <span class="st">"stack"</span>,</span>
<span id="cb128-304"><a href="#cb128-304" aria-hidden="true" tabindex="-1"></a>                   <span class="at">binwidth =</span> <span class="fl">0.5</span></span>
<span id="cb128-305"><a href="#cb128-305" aria-hidden="true" tabindex="-1"></a>                   ) <span class="sc">+</span></span>
<span id="cb128-306"><a href="#cb128-306" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span>scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb128-307"><a href="#cb128-307" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>displ,<span class="at">y=</span><span class="fu">after_stat</span>(density)),</span>
<span id="cb128-308"><a href="#cb128-308" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"red"</span>, <span class="at">linewidth=</span><span class="dv">1</span>)</span>
<span id="cb128-309"><a href="#cb128-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-310"><a href="#cb128-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-311"><a href="#cb128-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-312"><a href="#cb128-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-313"><a href="#cb128-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-314"><a href="#cb128-314" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_bin2d()</span></span>
<span id="cb128-315"><a href="#cb128-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-318"><a href="#cb128-318" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-319"><a href="#cb128-319" aria-hidden="true" tabindex="-1"></a>smaller <span class="ot">&lt;-</span> diamonds <span class="sc">|&gt;</span> </span>
<span id="cb128-320"><a href="#cb128-320" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(carat <span class="sc">&lt;</span> <span class="dv">3</span>)</span>
<span id="cb128-321"><a href="#cb128-321" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(smaller, <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span></span>
<span id="cb128-322"><a href="#cb128-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bin2d</span>()</span>
<span id="cb128-323"><a href="#cb128-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-324"><a href="#cb128-324" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("hexbin")</span></span>
<span id="cb128-325"><a href="#cb128-325" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(smaller, <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span></span>
<span id="cb128-326"><a href="#cb128-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>()</span>
<span id="cb128-327"><a href="#cb128-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-328"><a href="#cb128-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-329"><a href="#cb128-329" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_freqpoly</span></span>
<span id="cb128-330"><a href="#cb128-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-333"><a href="#cb128-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-334"><a href="#cb128-334" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy)) <span class="sc">+</span> </span>
<span id="cb128-335"><a href="#cb128-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="fl">2.5</span>)</span>
<span id="cb128-336"><a href="#cb128-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-337"><a href="#cb128-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-338"><a href="#cb128-338" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_density</span></span>
<span id="cb128-339"><a href="#cb128-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-342"><a href="#cb128-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-343"><a href="#cb128-343" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mpg)</span>
<span id="cb128-344"><a href="#cb128-344" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="fu">aes</span>(displ,<span class="at">fill=</span>drv),</span>
<span id="cb128-345"><a href="#cb128-345" aria-hidden="true" tabindex="-1"></a>                 <span class="at">stat =</span> <span class="st">"density"</span>,<span class="at">position =</span> <span class="st">"identity"</span>,</span>
<span id="cb128-346"><a href="#cb128-346" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.3</span></span>
<span id="cb128-347"><a href="#cb128-347" aria-hidden="true" tabindex="-1"></a>                 )<span class="sc">+</span></span>
<span id="cb128-348"><a href="#cb128-348" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent)<span class="sc">+</span></span>
<span id="cb128-349"><a href="#cb128-349" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">"图例名"</span>)<span class="sc">+</span></span>
<span id="cb128-350"><a href="#cb128-350" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb128-351"><a href="#cb128-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-352"><a href="#cb128-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-353"><a href="#cb128-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-354"><a href="#cb128-354" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_rug</span></span>
<span id="cb128-355"><a href="#cb128-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-356"><a href="#cb128-356" aria-hidden="true" tabindex="-1"></a>y→<span class="in">`sides="r","l"`</span></span>
<span id="cb128-357"><a href="#cb128-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-358"><a href="#cb128-358" aria-hidden="true" tabindex="-1"></a>x→<span class="in">`sides="b","t"`</span></span>
<span id="cb128-359"><a href="#cb128-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-362"><a href="#cb128-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-363"><a href="#cb128-363" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">x=</span>displ,<span class="at">y=</span>hwy),</span>
<span id="cb128-364"><a href="#cb128-364" aria-hidden="true" tabindex="-1"></a>           <span class="at">sides =</span> <span class="st">"br"</span>,<span class="at">color=</span><span class="st">"brown"</span>)</span>
<span id="cb128-365"><a href="#cb128-365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-366"><a href="#cb128-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-367"><a href="#cb128-367" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_jitter</span></span>
<span id="cb128-368"><a href="#cb128-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-371"><a href="#cb128-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-372"><a href="#cb128-372" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>displ,<span class="at">y=</span>hwy),</span>
<span id="cb128-373"><a href="#cb128-373" aria-hidden="true" tabindex="-1"></a>               <span class="at">stat =</span> <span class="st">"identity"</span>,<span class="at">position =</span> <span class="st">"jitter"</span>)</span>
<span id="cb128-374"><a href="#cb128-374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-375"><a href="#cb128-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-376"><a href="#cb128-376" aria-hidden="true" tabindex="-1"></a><span class="fu">### X=离散型变量</span></span>
<span id="cb128-377"><a href="#cb128-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-378"><a href="#cb128-378" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_bar</span></span>
<span id="cb128-379"><a href="#cb128-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-382"><a href="#cb128-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-383"><a href="#cb128-383" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb128-384"><a href="#cb128-384" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(cyl),<span class="at">fill=</span>drv),</span>
<span id="cb128-385"><a href="#cb128-385" aria-hidden="true" tabindex="-1"></a>             <span class="at">stat =</span> <span class="st">"count"</span>,<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">|</span></span>
<span id="cb128-386"><a href="#cb128-386" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb128-387"><a href="#cb128-387" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(cyl),<span class="at">fill=</span>drv),</span>
<span id="cb128-388"><a href="#cb128-388" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="st">"dodge"</span>)</span>
<span id="cb128-389"><a href="#cb128-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-390"><a href="#cb128-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-391"><a href="#cb128-391" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb128-392"><a href="#cb128-392" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(cyl),<span class="at">y=</span>hwy,<span class="at">fill=</span>drv),</span>
<span id="cb128-393"><a href="#cb128-393" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">|</span></span>
<span id="cb128-394"><a href="#cb128-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-395"><a href="#cb128-395" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb128-396"><a href="#cb128-396" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(cyl),<span class="at">y=</span>hwy,<span class="at">fill=</span>drv),</span>
<span id="cb128-397"><a href="#cb128-397" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="st">"fill"</span>)<span class="sc">+</span></span>
<span id="cb128-398"><a href="#cb128-398" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>())</span>
<span id="cb128-399"><a href="#cb128-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-400"><a href="#cb128-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-401"><a href="#cb128-401" aria-hidden="true" tabindex="-1"></a>有序条形图</span>
<span id="cb128-402"><a href="#cb128-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-405"><a href="#cb128-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-406"><a href="#cb128-406" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_infreq</span>(class))) <span class="sc">+</span>  <span class="co">#降序条形图</span></span>
<span id="cb128-407"><a href="#cb128-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span>
<span id="cb128-408"><a href="#cb128-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-409"><a href="#cb128-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-410"><a href="#cb128-410" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_errorbar</span></span>
<span id="cb128-411"><a href="#cb128-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-412"><a href="#cb128-412" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>geom_errorbarh</span>
<span id="cb128-413"><a href="#cb128-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-414"><a href="#cb128-414" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>geom_linerange</span>
<span id="cb128-415"><a href="#cb128-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-416"><a href="#cb128-416" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>geom_crossbar</span>
<span id="cb128-417"><a href="#cb128-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-418"><a href="#cb128-418" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>geom_pointrange</span>
<span id="cb128-419"><a href="#cb128-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-422"><a href="#cb128-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-423"><a href="#cb128-423" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">11</span>, <span class="dv">16</span>)</span>
<span id="cb128-424"><a href="#cb128-424" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">y =</span> y, <span class="at">se =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>))</span>
<span id="cb128-425"><a href="#cb128-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-426"><a href="#cb128-426" aria-hidden="true" tabindex="-1"></a>base <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">ymin =</span> y <span class="sc">-</span> se, <span class="at">ymax =</span> y <span class="sc">+</span> se))</span>
<span id="cb128-427"><a href="#cb128-427" aria-hidden="true" tabindex="-1"></a>(base <span class="sc">+</span> <span class="fu">geom_errorbar</span>()<span class="sc">|</span></span>
<span id="cb128-428"><a href="#cb128-428" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">geom_linerange</span>()<span class="sc">|</span></span>
<span id="cb128-429"><a href="#cb128-429" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">geom_ribbon</span>())<span class="sc">/</span></span>
<span id="cb128-430"><a href="#cb128-430" aria-hidden="true" tabindex="-1"></a>(base <span class="sc">+</span> <span class="fu">geom_crossbar</span>()<span class="sc">|</span></span>
<span id="cb128-431"><a href="#cb128-431" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">geom_pointrange</span>()<span class="sc">|</span></span>
<span id="cb128-432"><a href="#cb128-432" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">stat =</span> <span class="st">"identity"</span>))</span>
<span id="cb128-433"><a href="#cb128-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-434"><a href="#cb128-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-437"><a href="#cb128-437" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-438"><a href="#cb128-438" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">"data/g.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb128-439"><a href="#cb128-439" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb128-440"><a href="#cb128-440" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean=</span><span class="fu">mean</span>(liverweight),</span>
<span id="cb128-441"><a href="#cb128-441" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd=</span><span class="fu">sd</span>(liverweight),</span>
<span id="cb128-442"><a href="#cb128-442" aria-hidden="true" tabindex="-1"></a>        <span class="at">.by=</span>treatment</span>
<span id="cb128-443"><a href="#cb128-443" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb128-444"><a href="#cb128-444" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(treatment,mean,<span class="at">fill=</span>treatment))<span class="sc">+</span></span>
<span id="cb128-445"><a href="#cb128-445" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb128-446"><a href="#cb128-446" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>mean<span class="sc">-</span>sd,<span class="at">ymax=</span>mean<span class="sc">+</span>sd),<span class="at">width=</span>.<span class="dv">2</span>)</span>
<span id="cb128-447"><a href="#cb128-447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-448"><a href="#cb128-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-449"><a href="#cb128-449" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_dotplot</span></span>
<span id="cb128-450"><a href="#cb128-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-453"><a href="#cb128-453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-454"><a href="#cb128-454" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg)<span class="sc">+</span><span class="fu">geom_dotplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>drv,<span class="at">y=</span>hwy),</span>
<span id="cb128-455"><a href="#cb128-455" aria-hidden="true" tabindex="-1"></a>                 <span class="at">position =</span> <span class="st">"identity"</span>,</span>
<span id="cb128-456"><a href="#cb128-456" aria-hidden="true" tabindex="-1"></a>                 <span class="at">stackdir =</span> <span class="st">"center"</span>,<span class="at">binaxis =</span> <span class="st">'y'</span>,<span class="co"># stacking along y axis</span></span>
<span id="cb128-457"><a href="#cb128-457" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"red"</span>,<span class="at">binwidth =</span> <span class="fl">0.7</span>)</span>
<span id="cb128-458"><a href="#cb128-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-459"><a href="#cb128-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-460"><a href="#cb128-460" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_boxplot</span></span>
<span id="cb128-461"><a href="#cb128-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-464"><a href="#cb128-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-465"><a href="#cb128-465" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>drv,<span class="at">y=</span>hwy),</span>
<span id="cb128-466"><a href="#cb128-466" aria-hidden="true" tabindex="-1"></a>             <span class="at">stat =</span> <span class="st">"boxplot"</span>,<span class="at">position =</span> <span class="st">"dodge"</span>,</span>
<span id="cb128-467"><a href="#cb128-467" aria-hidden="true" tabindex="-1"></a>             <span class="at">notch=</span><span class="cn">TRUE</span>, <span class="at">varwidth=</span><span class="cn">TRUE</span>,</span>
<span id="cb128-468"><a href="#cb128-468" aria-hidden="true" tabindex="-1"></a>             <span class="at">width=</span><span class="fl">0.1</span>,<span class="at">fill=</span><span class="st">"green"</span></span>
<span id="cb128-469"><a href="#cb128-469" aria-hidden="true" tabindex="-1"></a>            )<span class="sc">+</span></span>
<span id="cb128-470"><a href="#cb128-470" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">x=</span>drv,<span class="at">y=</span>hwy),<span class="at">alpha=</span><span class="fl">0.2</span>)</span>
<span id="cb128-471"><a href="#cb128-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-472"><a href="#cb128-472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-473"><a href="#cb128-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-474"><a href="#cb128-474" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_violin</span></span>
<span id="cb128-475"><a href="#cb128-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-478"><a href="#cb128-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-479"><a href="#cb128-479" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> <span class="fu">geom_violin</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>drv,<span class="at">y=</span>hwy),</span>
<span id="cb128-480"><a href="#cb128-480" aria-hidden="true" tabindex="-1"></a>             <span class="at">stat =</span> <span class="st">"ydensity"</span>,<span class="at">position =</span> <span class="st">"dodge"</span>)</span>
<span id="cb128-481"><a href="#cb128-481" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-482"><a href="#cb128-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-483"><a href="#cb128-483" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_tile</span></span>
<span id="cb128-484"><a href="#cb128-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-487"><a href="#cb128-487" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-488"><a href="#cb128-488" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置随机数种子以确保结果的可重复性  </span></span>
<span id="cb128-489"><a href="#cb128-489" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)  </span>
<span id="cb128-490"><a href="#cb128-490" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-491"><a href="#cb128-491" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成随机数据集  </span></span>
<span id="cb128-492"><a href="#cb128-492" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(  </span>
<span id="cb128-493"><a href="#cb128-493" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2000</span><span class="sc">:</span><span class="dv">2024</span>,  </span>
<span id="cb128-494"><a href="#cb128-494" aria-hidden="true" tabindex="-1"></a>  <span class="at">lung =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb128-495"><a href="#cb128-495" aria-hidden="true" tabindex="-1"></a>  <span class="at">liver =</span> <span class="fu">runif</span>(<span class="dv">25</span>), </span>
<span id="cb128-496"><a href="#cb128-496" aria-hidden="true" tabindex="-1"></a>  <span class="at">bone =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb128-497"><a href="#cb128-497" aria-hidden="true" tabindex="-1"></a>  <span class="at">luk =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb128-498"><a href="#cb128-498" aria-hidden="true" tabindex="-1"></a>  <span class="at">eso =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb128-499"><a href="#cb128-499" aria-hidden="true" tabindex="-1"></a>  <span class="at">gas =</span> <span class="fu">runif</span>(<span class="dv">25</span>),   </span>
<span id="cb128-500"><a href="#cb128-500" aria-hidden="true" tabindex="-1"></a>  <span class="at">eye =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb128-501"><a href="#cb128-501" aria-hidden="true" tabindex="-1"></a>  <span class="at">brain =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb128-502"><a href="#cb128-502" aria-hidden="true" tabindex="-1"></a>  <span class="at">pan =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb128-503"><a href="#cb128-503" aria-hidden="true" tabindex="-1"></a>  <span class="at">kidney =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb128-504"><a href="#cb128-504" aria-hidden="true" tabindex="-1"></a>  <span class="at">breast=</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb128-505"><a href="#cb128-505" aria-hidden="true" tabindex="-1"></a>)  <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb128-506"><a href="#cb128-506" aria-hidden="true" tabindex="-1"></a>                   <span class="at">names_to =</span> <span class="st">"cancer"</span>,</span>
<span id="cb128-507"><a href="#cb128-507" aria-hidden="true" tabindex="-1"></a>                   <span class="at">values_to =</span> <span class="st">"morbidity"</span>)</span>
<span id="cb128-508"><a href="#cb128-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-509"><a href="#cb128-509" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mydata, <span class="fu">aes</span>(year, cancer)) <span class="sc">+</span>  </span>
<span id="cb128-510"><a href="#cb128-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span>morbidity)) <span class="sc">+</span>  </span>
<span id="cb128-511"><a href="#cb128-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"red"</span>)</span>
<span id="cb128-512"><a href="#cb128-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-513"><a href="#cb128-513" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-514"><a href="#cb128-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-515"><a href="#cb128-515" aria-hidden="true" tabindex="-1"></a><span class="fu">### 统计变换 statistical transformations</span></span>
<span id="cb128-516"><a href="#cb128-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-517"><a href="#cb128-517" aria-hidden="true" tabindex="-1"></a>stat_bin()：geom_bar()，geom_freqpoly()，geom_histogram()</span>
<span id="cb128-518"><a href="#cb128-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-519"><a href="#cb128-519" aria-hidden="true" tabindex="-1"></a>stat_bin2d()：geom_bin2d()</span>
<span id="cb128-520"><a href="#cb128-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-521"><a href="#cb128-521" aria-hidden="true" tabindex="-1"></a>stat_bindot()：geom_dotplot()</span>
<span id="cb128-522"><a href="#cb128-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-523"><a href="#cb128-523" aria-hidden="true" tabindex="-1"></a>stat_binhex()：geom_hex()</span>
<span id="cb128-524"><a href="#cb128-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-525"><a href="#cb128-525" aria-hidden="true" tabindex="-1"></a>stat_boxplot()：geom_boxplot()</span>
<span id="cb128-526"><a href="#cb128-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-527"><a href="#cb128-527" aria-hidden="true" tabindex="-1"></a>stat_contour()：geom_contour()</span>
<span id="cb128-528"><a href="#cb128-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-529"><a href="#cb128-529" aria-hidden="true" tabindex="-1"></a>stat_quantile()：geom_quantile()</span>
<span id="cb128-530"><a href="#cb128-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-531"><a href="#cb128-531" aria-hidden="true" tabindex="-1"></a>stat_smooth()：geom_smooth()</span>
<span id="cb128-532"><a href="#cb128-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-533"><a href="#cb128-533" aria-hidden="true" tabindex="-1"></a>stat_sum()：geom_count()</span>
<span id="cb128-534"><a href="#cb128-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-535"><a href="#cb128-535" aria-hidden="true" tabindex="-1"></a>stat_ecdf()：计算经验累积分布图。</span>
<span id="cb128-536"><a href="#cb128-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-537"><a href="#cb128-537" aria-hidden="true" tabindex="-1"></a>stat_function()：根据 x 值的函数计算 y 值。</span>
<span id="cb128-538"><a href="#cb128-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-539"><a href="#cb128-539" aria-hidden="true" tabindex="-1"></a>stat_summary()：将 Y 值汇总到不同的 X 值。</span>
<span id="cb128-540"><a href="#cb128-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-541"><a href="#cb128-541" aria-hidden="true" tabindex="-1"></a>stat_summary2d() ：汇总分箱值。</span>
<span id="cb128-542"><a href="#cb128-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-543"><a href="#cb128-543" aria-hidden="true" tabindex="-1"></a>stat_summary_hex()</span>
<span id="cb128-544"><a href="#cb128-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-545"><a href="#cb128-545" aria-hidden="true" tabindex="-1"></a>stat_qq()：对分位数-分位数图执行计算。</span>
<span id="cb128-546"><a href="#cb128-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-547"><a href="#cb128-547" aria-hidden="true" tabindex="-1"></a>stat_spoke()：将角度和半径转换为位置。</span>
<span id="cb128-548"><a href="#cb128-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-549"><a href="#cb128-549" aria-hidden="true" tabindex="-1"></a>stat_unique()：删除重复的行。</span>
<span id="cb128-550"><a href="#cb128-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-553"><a href="#cb128-553" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-554"><a href="#cb128-554" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> </span>
<span id="cb128-555"><a href="#cb128-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(</span>
<span id="cb128-556"><a href="#cb128-556" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">y =</span> depth),</span>
<span id="cb128-557"><a href="#cb128-557" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb128-558"><a href="#cb128-558" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun.min =</span> min,</span>
<span id="cb128-559"><a href="#cb128-559" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun.max =</span> max,</span>
<span id="cb128-560"><a href="#cb128-560" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> mean</span>
<span id="cb128-561"><a href="#cb128-561" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb128-562"><a href="#cb128-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-563"><a href="#cb128-563" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(trans, cty)) <span class="sc">+</span> </span>
<span id="cb128-564"><a href="#cb128-564" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb128-565"><a href="#cb128-565" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>)</span>
<span id="cb128-566"><a href="#cb128-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-567"><a href="#cb128-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-568"><a href="#cb128-568" aria-hidden="true" tabindex="-1"></a><span class="fu">### 位置调整 position adjustments</span></span>
<span id="cb128-569"><a href="#cb128-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-570"><a href="#cb128-570" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 条</span></span>
<span id="cb128-571"><a href="#cb128-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-574"><a href="#cb128-574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-575"><a href="#cb128-575" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">fill =</span> class)) <span class="sc">+</span> </span>
<span id="cb128-576"><a href="#cb128-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">position =</span> <span class="st">"identity"</span>)<span class="sc">|</span></span>
<span id="cb128-577"><a href="#cb128-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-578"><a href="#cb128-578" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb128-579"><a href="#cb128-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span>
<span id="cb128-580"><a href="#cb128-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-581"><a href="#cb128-581" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">fill =</span> class)) <span class="sc">+</span> </span>
<span id="cb128-582"><a href="#cb128-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>)<span class="sc">|</span></span>
<span id="cb128-583"><a href="#cb128-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-584"><a href="#cb128-584" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">fill =</span> class)) <span class="sc">+</span> </span>
<span id="cb128-585"><a href="#cb128-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>)</span>
<span id="cb128-586"><a href="#cb128-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-587"><a href="#cb128-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-588"><a href="#cb128-588" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 点</span></span>
<span id="cb128-589"><a href="#cb128-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-590"><a href="#cb128-590" aria-hidden="true" tabindex="-1"></a>position_nudge()：按固定偏移量移动点。</span>
<span id="cb128-591"><a href="#cb128-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-592"><a href="#cb128-592" aria-hidden="true" tabindex="-1"></a>position_jitter()：为每个位置添加一点随机噪音。</span>
<span id="cb128-593"><a href="#cb128-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-594"><a href="#cb128-594" aria-hidden="true" tabindex="-1"></a>position_jitterdodge()：躲避组内的点，然后添加一点随机噪音。</span>
<span id="cb128-595"><a href="#cb128-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-598"><a href="#cb128-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-599"><a href="#cb128-599" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl), <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb128-600"><a href="#cb128-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">|</span></span>
<span id="cb128-601"><a href="#cb128-601" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl), <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb128-602"><a href="#cb128-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)</span>
<span id="cb128-603"><a href="#cb128-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-604"><a href="#cb128-604" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl), <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb128-605"><a href="#cb128-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span><span class="fu">position_nudge</span>(<span class="at">x=</span><span class="fl">0.1</span>,<span class="at">y=</span><span class="dv">0</span>))<span class="sc">|</span></span>
<span id="cb128-606"><a href="#cb128-606" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl), <span class="at">y =</span> hwy,<span class="at">color=</span><span class="fu">factor</span>(cyl))) <span class="sc">+</span> </span>
<span id="cb128-607"><a href="#cb128-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitterdodge</span>())</span>
<span id="cb128-608"><a href="#cb128-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-609"><a href="#cb128-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-610"><a href="#cb128-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-611"><a href="#cb128-611" aria-hidden="true" tabindex="-1"></a><span class="fu">## 坐标系 coordinate</span></span>
<span id="cb128-612"><a href="#cb128-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-613"><a href="#cb128-613" aria-hidden="true" tabindex="-1"></a>默认坐标系是笛卡尔坐标系</span>
<span id="cb128-614"><a href="#cb128-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-617"><a href="#cb128-617" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-618"><a href="#cb128-618" aria-hidden="true" tabindex="-1"></a>bar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb128-619"><a href="#cb128-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(</span>
<span id="cb128-620"><a href="#cb128-620" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> clarity, <span class="at">fill =</span> clarity), </span>
<span id="cb128-621"><a href="#cb128-621" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb128-622"><a href="#cb128-622" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span></span>
<span id="cb128-623"><a href="#cb128-623" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb128-624"><a href="#cb128-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span>
<span id="cb128-625"><a href="#cb128-625" aria-hidden="true" tabindex="-1"></a>bar</span>
<span id="cb128-626"><a href="#cb128-626" aria-hidden="true" tabindex="-1"></a>bar <span class="sc">+</span> <span class="fu">coord_cartesian</span>() <span class="sc">|</span><span class="co">#笛卡尔坐标</span></span>
<span id="cb128-627"><a href="#cb128-627" aria-hidden="true" tabindex="-1"></a>bar <span class="sc">+</span> <span class="fu">coord_flip</span>()<span class="sc">|</span> <span class="co">#水平条形图</span></span>
<span id="cb128-628"><a href="#cb128-628" aria-hidden="true" tabindex="-1"></a>bar <span class="sc">+</span> <span class="fu">coord_polar</span>()<span class="co">#极坐标</span></span>
<span id="cb128-629"><a href="#cb128-629" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-630"><a href="#cb128-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-631"><a href="#cb128-631" aria-hidden="true" tabindex="-1"></a><span class="fu">## 坐标轴 axis</span></span>
<span id="cb128-632"><a href="#cb128-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-633"><a href="#cb128-633" aria-hidden="true" tabindex="-1"></a><span class="fu">### 变换</span></span>
<span id="cb128-634"><a href="#cb128-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-637"><a href="#cb128-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-638"><a href="#cb128-638" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">log10</span>(cty),hwy)) <span class="sc">+</span></span>
<span id="cb128-639"><a href="#cb128-639" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb128-640"><a href="#cb128-640" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>()</span>
<span id="cb128-641"><a href="#cb128-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-642"><a href="#cb128-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-643"><a href="#cb128-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-644"><a href="#cb128-644" aria-hidden="true" tabindex="-1"></a><span class="fu">### limits</span></span>
<span id="cb128-645"><a href="#cb128-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-648"><a href="#cb128-648" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-649"><a href="#cb128-649" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span></span>
<span id="cb128-650"><a href="#cb128-650" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|</span> </span>
<span id="cb128-651"><a href="#cb128-651" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span></span>
<span id="cb128-652"><a href="#cb128-652" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb128-653"><a href="#cb128-653" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="dv">5</span>, <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb128-654"><a href="#cb128-654" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">10</span>, <span class="dv">25</span>)</span>
<span id="cb128-655"><a href="#cb128-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-656"><a href="#cb128-656" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(drv, hwy)) <span class="sc">+</span></span>
<span id="cb128-657"><a href="#cb128-657" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb128-658"><a href="#cb128-658" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="st">"f"</span>, <span class="st">"r"</span>) <span class="sc">+</span></span>
<span id="cb128-659"><a href="#cb128-659" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">25</span>, <span class="cn">NA</span>)</span>
<span id="cb128-660"><a href="#cb128-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-661"><a href="#cb128-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-664"><a href="#cb128-664" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-665"><a href="#cb128-665" aria-hidden="true" tabindex="-1"></a><span class="co"># filter</span></span>
<span id="cb128-666"><a href="#cb128-666" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span></span>
<span id="cb128-667"><a href="#cb128-667" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(displ <span class="sc">&gt;=</span> <span class="dv">5</span> <span class="sc">&amp;</span> displ <span class="sc">&lt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> hwy <span class="sc">&gt;=</span> <span class="dv">10</span> <span class="sc">&amp;</span> hwy <span class="sc">&lt;=</span> <span class="dv">25</span>) <span class="sc">|&gt;</span></span>
<span id="cb128-668"><a href="#cb128-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb128-669"><a href="#cb128-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb128-670"><a href="#cb128-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">|</span></span>
<span id="cb128-671"><a href="#cb128-671" aria-hidden="true" tabindex="-1"></a><span class="co"># limits</span></span>
<span id="cb128-672"><a href="#cb128-672" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb128-673"><a href="#cb128-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb128-674"><a href="#cb128-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb128-675"><a href="#cb128-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>)) <span class="sc">+</span>    <span class="co">#取子集</span></span>
<span id="cb128-676"><a href="#cb128-676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>))  </span>
<span id="cb128-677"><a href="#cb128-677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-678"><a href="#cb128-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-679"><a href="#cb128-679" aria-hidden="true" tabindex="-1"></a><span class="fu">### zooming</span></span>
<span id="cb128-680"><a href="#cb128-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-681"><a href="#cb128-681" aria-hidden="true" tabindex="-1"></a>调整绘制的数据,在每个刻度中设置<span class="in">`coord_cartesian(xlim= ,ylim= )`</span></span>
<span id="cb128-682"><a href="#cb128-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-685"><a href="#cb128-685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-686"><a href="#cb128-686" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb128-687"><a href="#cb128-687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb128-688"><a href="#cb128-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">|</span></span>
<span id="cb128-689"><a href="#cb128-689" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb128-690"><a href="#cb128-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb128-691"><a href="#cb128-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb128-692"><a href="#cb128-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>))   <span class="co">#放大局部</span></span>
<span id="cb128-693"><a href="#cb128-693" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-694"><a href="#cb128-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-695"><a href="#cb128-695" aria-hidden="true" tabindex="-1"></a><span class="fu">### 共享</span></span>
<span id="cb128-696"><a href="#cb128-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-697"><a href="#cb128-697" aria-hidden="true" tabindex="-1"></a>shared 坐标轴相同</span>
<span id="cb128-698"><a href="#cb128-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-701"><a href="#cb128-701" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-702"><a href="#cb128-702" aria-hidden="true" tabindex="-1"></a>x_scale <span class="ot">&lt;-</span> <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">range</span>(mpg<span class="sc">$</span>displ))</span>
<span id="cb128-703"><a href="#cb128-703" aria-hidden="true" tabindex="-1"></a>y_scale <span class="ot">&lt;-</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">range</span>(mpg<span class="sc">$</span>hwy))</span>
<span id="cb128-704"><a href="#cb128-704" aria-hidden="true" tabindex="-1"></a>col_scale <span class="ot">&lt;-</span> <span class="fu">scale_color_discrete</span>(<span class="at">limits =</span> <span class="fu">unique</span>(mpg<span class="sc">$</span>drv))</span>
<span id="cb128-705"><a href="#cb128-705" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg[mpg<span class="sc">$</span>class<span class="sc">==</span><span class="st">"suv"</span>,], <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb128-706"><a href="#cb128-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb128-707"><a href="#cb128-707" aria-hidden="true" tabindex="-1"></a>  x_scale <span class="sc">+</span></span>
<span id="cb128-708"><a href="#cb128-708" aria-hidden="true" tabindex="-1"></a>  y_scale <span class="sc">+</span></span>
<span id="cb128-709"><a href="#cb128-709" aria-hidden="true" tabindex="-1"></a>  col_scale<span class="sc">|</span></span>
<span id="cb128-710"><a href="#cb128-710" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg[mpg<span class="sc">$</span>class<span class="sc">==</span><span class="st">"compact"</span>,], <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb128-711"><a href="#cb128-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb128-712"><a href="#cb128-712" aria-hidden="true" tabindex="-1"></a>  x_scale <span class="sc">+</span></span>
<span id="cb128-713"><a href="#cb128-713" aria-hidden="true" tabindex="-1"></a>  y_scale <span class="sc">+</span></span>
<span id="cb128-714"><a href="#cb128-714" aria-hidden="true" tabindex="-1"></a>  col_scale</span>
<span id="cb128-715"><a href="#cb128-715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-716"><a href="#cb128-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-717"><a href="#cb128-717" aria-hidden="true" tabindex="-1"></a><span class="fu">## 标题 labels</span></span>
<span id="cb128-718"><a href="#cb128-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-721"><a href="#cb128-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-722"><a href="#cb128-722" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span></span>
<span id="cb128-723"><a href="#cb128-723" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb128-724"><a href="#cb128-724" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"city driving (mpg)"</span>) <span class="sc">+</span></span>
<span id="cb128-725"><a href="#cb128-725" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"highway driving (mpg)"</span>)<span class="sc">+</span></span>
<span id="cb128-726"><a href="#cb128-726" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"主标题"</span>)</span>
<span id="cb128-727"><a href="#cb128-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-728"><a href="#cb128-728" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb128-729"><a href="#cb128-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb128-730"><a href="#cb128-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb128-731"><a href="#cb128-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb128-732"><a href="#cb128-732" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Engine displacement (L)"</span>,</span>
<span id="cb128-733"><a href="#cb128-733" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Highway fuel economy (mpg)"</span>,</span>
<span id="cb128-734"><a href="#cb128-734" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Car type"</span>, <span class="co"># 图例 美学映射color</span></span>
<span id="cb128-735"><a href="#cb128-735" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Fuel efficiency generally decreases with engine size"</span>,</span>
<span id="cb128-736"><a href="#cb128-736" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Two seaters (sports cars) are an </span></span>
<span id="cb128-737"><a href="#cb128-737" aria-hidden="true" tabindex="-1"></a><span class="st">    exception because of their light weight"</span>,</span>
<span id="cb128-738"><a href="#cb128-738" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Data from fueleconomy.gov"</span></span>
<span id="cb128-739"><a href="#cb128-739" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb128-740"><a href="#cb128-740" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-741"><a href="#cb128-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-742"><a href="#cb128-742" aria-hidden="true" tabindex="-1"></a><span class="fu">## 注释 annotation</span></span>
<span id="cb128-743"><a href="#cb128-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-744"><a href="#cb128-744" aria-hidden="true" tabindex="-1"></a><span class="fu">### 文本 text</span></span>
<span id="cb128-745"><a href="#cb128-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-748"><a href="#cb128-748" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-749"><a href="#cb128-749" aria-hidden="true" tabindex="-1"></a><span class="co"># 字体</span></span>
<span id="cb128-750"><a href="#cb128-750" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">family =</span> <span class="fu">c</span>(<span class="st">"sans"</span>, <span class="st">"serif"</span>, <span class="st">"mono"</span>))</span>
<span id="cb128-751"><a href="#cb128-751" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb128-752"><a href="#cb128-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> family, <span class="at">family =</span> family))</span>
<span id="cb128-753"><a href="#cb128-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-754"><a href="#cb128-754" aria-hidden="true" tabindex="-1"></a><span class="co"># 样式</span></span>
<span id="cb128-755"><a href="#cb128-755" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">face =</span> <span class="fu">c</span>(<span class="st">"plain"</span>, <span class="st">"bold"</span>, <span class="st">"italic"</span>))</span>
<span id="cb128-756"><a href="#cb128-756" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb128-757"><a href="#cb128-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> face, <span class="at">fontface =</span> face))</span>
<span id="cb128-758"><a href="#cb128-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-759"><a href="#cb128-759" aria-hidden="true" tabindex="-1"></a><span class="co"># 位置</span></span>
<span id="cb128-760"><a href="#cb128-760" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb128-761"><a href="#cb128-761" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">1.5</span>),</span>
<span id="cb128-762"><a href="#cb128-762" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">1.5</span>),</span>
<span id="cb128-763"><a href="#cb128-763" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="fu">c</span>(</span>
<span id="cb128-764"><a href="#cb128-764" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bottom-left"</span>, <span class="st">"top-left"</span>,  </span>
<span id="cb128-765"><a href="#cb128-765" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bottom-right"</span>, <span class="st">"top-right"</span>, <span class="st">"center"</span></span>
<span id="cb128-766"><a href="#cb128-766" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb128-767"><a href="#cb128-767" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-768"><a href="#cb128-768" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb128-769"><a href="#cb128-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> text))<span class="sc">|</span></span>
<span id="cb128-770"><a href="#cb128-770" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb128-771"><a href="#cb128-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> text), <span class="at">vjust =</span> <span class="st">"inward"</span>, <span class="at">hjust =</span> <span class="st">"inward"</span>)</span>
<span id="cb128-772"><a href="#cb128-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-773"><a href="#cb128-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-774"><a href="#cb128-774" aria-hidden="true" tabindex="-1"></a><span class="co"># 自定义</span></span>
<span id="cb128-775"><a href="#cb128-775" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb128-776"><a href="#cb128-776" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>), </span>
<span id="cb128-777"><a href="#cb128-777" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">3.4</span>, <span class="fl">2.5</span>)</span>
<span id="cb128-778"><a href="#cb128-778" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-779"><a href="#cb128-779" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(treatment, response)) <span class="sc">+</span> </span>
<span id="cb128-780"><a href="#cb128-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb128-781"><a href="#cb128-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb128-782"><a href="#cb128-782" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"("</span>, response, <span class="st">")"</span>)), </span>
<span id="cb128-783"><a href="#cb128-783" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="sc">-</span><span class="fl">0.3</span>,</span>
<span id="cb128-784"><a href="#cb128-784" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_y=</span>.<span class="dv">2</span></span>
<span id="cb128-785"><a href="#cb128-785" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb128-786"><a href="#cb128-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-787"><a href="#cb128-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-790"><a href="#cb128-790" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-791"><a href="#cb128-791" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span></span>
<span id="cb128-792"><a href="#cb128-792" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(cyl,am) <span class="sc">|&gt;</span> </span>
<span id="cb128-793"><a href="#cb128-793" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb128-794"><a href="#cb128-794" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pct =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="cb128-795"><a href="#cb128-795" aria-hidden="true" tabindex="-1"></a>         <span class="at">lbls =</span> scales<span class="sc">::</span><span class="fu">percent</span>(pct)</span>
<span id="cb128-796"><a href="#cb128-796" aria-hidden="true" tabindex="-1"></a>         )<span class="sc">|&gt;</span> </span>
<span id="cb128-797"><a href="#cb128-797" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">factor</span>(cyl),pct,<span class="at">fill=</span><span class="fu">factor</span>(am)))<span class="sc">+</span></span>
<span id="cb128-798"><a href="#cb128-798" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>,<span class="at">position =</span> <span class="st">"fill"</span>)<span class="sc">+</span></span>
<span id="cb128-799"><a href="#cb128-799" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label=</span>lbls),</span>
<span id="cb128-800"><a href="#cb128-800" aria-hidden="true" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb128-801"><a href="#cb128-801" aria-hidden="true" tabindex="-1"></a>              <span class="at">size=</span><span class="dv">3</span></span>
<span id="cb128-802"><a href="#cb128-802" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb128-803"><a href="#cb128-803" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-804"><a href="#cb128-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-807"><a href="#cb128-807" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-808"><a href="#cb128-808" aria-hidden="true" tabindex="-1"></a>label_info <span class="ot">&lt;-</span> mpg <span class="sc">|&gt;</span></span>
<span id="cb128-809"><a href="#cb128-809" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(drv) <span class="sc">|&gt;</span></span>
<span id="cb128-810"><a href="#cb128-810" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(displ)) <span class="sc">|&gt;</span></span>
<span id="cb128-811"><a href="#cb128-811" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>)<span class="sc">|&gt;</span></span>
<span id="cb128-812"><a href="#cb128-812" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb128-813"><a href="#cb128-813" aria-hidden="true" tabindex="-1"></a>        <span class="at">drive_type =</span> <span class="fu">case_when</span>(       <span class="co"># vectorise multiple if_else () statements </span></span>
<span id="cb128-814"><a href="#cb128-814" aria-hidden="true" tabindex="-1"></a>        drv <span class="sc">==</span> <span class="st">"f"</span> <span class="sc">~</span> <span class="st">"front-wheel drive"</span>,</span>
<span id="cb128-815"><a href="#cb128-815" aria-hidden="true" tabindex="-1"></a>        drv <span class="sc">==</span> <span class="st">"r"</span> <span class="sc">~</span> <span class="st">"rear-wheel drive"</span>,</span>
<span id="cb128-816"><a href="#cb128-816" aria-hidden="true" tabindex="-1"></a>        drv <span class="sc">==</span> <span class="st">"4"</span> <span class="sc">~</span> <span class="st">"4-wheel drive"</span>)</span>
<span id="cb128-817"><a href="#cb128-817" aria-hidden="true" tabindex="-1"></a>        )<span class="sc">|&gt;</span></span>
<span id="cb128-818"><a href="#cb128-818" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(displ, hwy, drv, drive_type)</span>
<span id="cb128-819"><a href="#cb128-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-820"><a href="#cb128-820" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb128-821"><a href="#cb128-821" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb128-822"><a href="#cb128-822" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">formula=</span><span class="st">"y~x"</span>,<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb128-823"><a href="#cb128-823" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb128-824"><a href="#cb128-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-825"><a href="#cb128-825" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span>  <span class="fu">geom_text</span>(<span class="co">#添加注释  geom_label 标签加背景框</span></span>
<span id="cb128-826"><a href="#cb128-826" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> label_info, </span>
<span id="cb128-827"><a href="#cb128-827" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">label =</span> drive_type),<span class="co">#label映射</span></span>
<span id="cb128-828"><a href="#cb128-828" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">nudge_y =</span> <span class="dv">2</span></span>
<span id="cb128-829"><a href="#cb128-829" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb128-830"><a href="#cb128-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-831"><a href="#cb128-831" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(                   </span>
<span id="cb128-832"><a href="#cb128-832" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> label_info, </span>
<span id="cb128-833"><a href="#cb128-833" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">label =</span> drive_type),</span>
<span id="cb128-834"><a href="#cb128-834" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">nudge_y =</span> <span class="dv">2</span></span>
<span id="cb128-835"><a href="#cb128-835" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb128-836"><a href="#cb128-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-837"><a href="#cb128-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-838"><a href="#cb128-838" aria-hidden="true" tabindex="-1"></a>potential_outliers <span class="ot">&lt;-</span> mpg <span class="sc">|&gt;</span></span>
<span id="cb128-839"><a href="#cb128-839" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(hwy <span class="sc">&gt;</span> <span class="dv">40</span> <span class="sc">|</span> (hwy <span class="sc">&gt;</span> <span class="dv">20</span> <span class="sc">&amp;</span> displ <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb128-840"><a href="#cb128-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-841"><a href="#cb128-841" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb128-842"><a href="#cb128-842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb128-843"><a href="#cb128-843" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> potential_outliers, <span class="fu">aes</span>(<span class="at">label =</span> model)) <span class="sc">+</span></span>
<span id="cb128-844"><a href="#cb128-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> potential_outliers, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb128-845"><a href="#cb128-845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb128-846"><a href="#cb128-846" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> potential_outliers,</span>
<span id="cb128-847"><a href="#cb128-847" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="st">"circle open"</span></span>
<span id="cb128-848"><a href="#cb128-848" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb128-849"><a href="#cb128-849" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-850"><a href="#cb128-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-851"><a href="#cb128-851" aria-hidden="true" tabindex="-1"></a><span class="fu">### markdown</span></span>
<span id="cb128-852"><a href="#cb128-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-855"><a href="#cb128-855" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-856"><a href="#cb128-856" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb128-857"><a href="#cb128-857" aria-hidden="true" tabindex="-1"></a>base <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb128-858"><a href="#cb128-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb128-859"><a href="#cb128-859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Axis title with *italics* and **boldface**"</span>)</span>
<span id="cb128-860"><a href="#cb128-860" aria-hidden="true" tabindex="-1"></a>base <span class="sc">|</span></span>
<span id="cb128-861"><a href="#cb128-861" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.x =</span> ggtext<span class="sc">::</span><span class="fu">element_markdown</span>())  <span class="co">#ggtext::element_markdown</span></span>
<span id="cb128-862"><a href="#cb128-862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-863"><a href="#cb128-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-864"><a href="#cb128-864" aria-hidden="true" tabindex="-1"></a><span class="fu">### 数学表达式</span></span>
<span id="cb128-865"><a href="#cb128-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-868"><a href="#cb128-868" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-869"><a href="#cb128-869" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb128-870"><a href="#cb128-870" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb128-871"><a href="#cb128-871" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">cumsum</span>(x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb128-872"><a href="#cb128-872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb128-873"><a href="#cb128-873" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb128-874"><a href="#cb128-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb128-875"><a href="#cb128-875" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">quote</span>(x[i]),</span>
<span id="cb128-876"><a href="#cb128-876" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">quote</span>(<span class="fu">sum</span>(x[i] <span class="sc">^</span> <span class="dv">2</span>, i <span class="sc">==</span> <span class="dv">1</span>, n)) <span class="co">#数学方程式</span></span>
<span id="cb128-877"><a href="#cb128-877" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb128-878"><a href="#cb128-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-879"><a href="#cb128-879" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">to =</span> <span class="dv">2</span>, <span class="at">by =</span> .<span class="dv">01</span>)</span>
<span id="cb128-880"><a href="#cb128-880" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> values, <span class="at">y =</span> values <span class="sc">^</span> <span class="dv">3</span>)</span>
<span id="cb128-881"><a href="#cb128-881" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb128-882"><a href="#cb128-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span> </span>
<span id="cb128-883"><a href="#cb128-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">quote</span>(<span class="fu">f</span>(x) <span class="sc">==</span> x<span class="sc">^</span><span class="dv">3</span>))         <span class="co">#数学表达式   ？plotmath</span></span>
<span id="cb128-884"><a href="#cb128-884" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-885"><a href="#cb128-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-886"><a href="#cb128-886" aria-hidden="true" tabindex="-1"></a><span class="fu">### 线段 直线 箭头</span></span>
<span id="cb128-887"><a href="#cb128-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-888"><a href="#cb128-888" aria-hidden="true" tabindex="-1"></a>geom_hline()</span>
<span id="cb128-889"><a href="#cb128-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-890"><a href="#cb128-890" aria-hidden="true" tabindex="-1"></a>geom_vline()</span>
<span id="cb128-891"><a href="#cb128-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-892"><a href="#cb128-892" aria-hidden="true" tabindex="-1"></a>geom_abline</span>
<span id="cb128-893"><a href="#cb128-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-894"><a href="#cb128-894" aria-hidden="true" tabindex="-1"></a>geom_segment() arrow</span>
<span id="cb128-895"><a href="#cb128-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-898"><a href="#cb128-898" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-899"><a href="#cb128-899" aria-hidden="true" tabindex="-1"></a>trend_text <span class="ot">&lt;-</span> <span class="st">"Larger engine sizes tend to have lower fuel economy."</span> <span class="sc">|&gt;</span></span>
<span id="cb128-900"><a href="#cb128-900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_wrap</span>(<span class="at">width =</span> <span class="dv">30</span>)</span>
<span id="cb128-901"><a href="#cb128-901" aria-hidden="true" tabindex="-1"></a>trend_text</span>
<span id="cb128-902"><a href="#cb128-902" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb128-903"><a href="#cb128-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb128-904"><a href="#cb128-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb128-905"><a href="#cb128-905" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">x =</span> <span class="fl">3.5</span>, <span class="at">y =</span> <span class="dv">38</span>,</span>
<span id="cb128-906"><a href="#cb128-906" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> trend_text,</span>
<span id="cb128-907"><a href="#cb128-907" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">color =</span> <span class="st">"red"</span></span>
<span id="cb128-908"><a href="#cb128-908" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb128-909"><a href="#cb128-909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb128-910"><a href="#cb128-910" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"segment"</span>,</span>
<span id="cb128-911"><a href="#cb128-911" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">35</span>, <span class="at">xend =</span> <span class="dv">5</span>, <span class="at">yend =</span> <span class="dv">25</span>, <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb128-912"><a href="#cb128-912" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>)</span>
<span id="cb128-913"><a href="#cb128-913" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb128-914"><a href="#cb128-914" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-915"><a href="#cb128-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-918"><a href="#cb128-918" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-919"><a href="#cb128-919" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span></span>
<span id="cb128-920"><a href="#cb128-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb128-921"><a href="#cb128-921" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(mpg, manufacturer <span class="sc">==</span> <span class="st">"subaru"</span>), </span>
<span id="cb128-922"><a href="#cb128-922" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"orange"</span>,</span>
<span id="cb128-923"><a href="#cb128-923" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb128-924"><a href="#cb128-924" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb128-925"><a href="#cb128-925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb128-926"><a href="#cb128-926" aria-hidden="true" tabindex="-1"></a>p<span class="sc">|</span>p <span class="sc">+</span> </span>
<span id="cb128-927"><a href="#cb128-927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">x =</span> <span class="fl">5.5</span>, <span class="at">y =</span> <span class="dv">40</span>, <span class="at">colour =</span> <span class="st">"orange"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb128-928"><a href="#cb128-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">x =</span> <span class="fl">5.5</span>, <span class="at">y =</span> <span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb128-929"><a href="#cb128-929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">5.6</span>, <span class="at">y =</span> <span class="dv">40</span>, <span class="at">label =</span> <span class="st">"subaru"</span>, <span class="at">hjust =</span> <span class="st">"left"</span>)<span class="sc">|</span></span>
<span id="cb128-930"><a href="#cb128-930" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb128-931"><a href="#cb128-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb128-932"><a href="#cb128-932" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"curve"</span>, <span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="dv">35</span>, <span class="at">xend =</span> <span class="fl">2.65</span>, <span class="at">yend =</span> <span class="dv">27</span>, </span>
<span id="cb128-933"><a href="#cb128-933" aria-hidden="true" tabindex="-1"></a>    <span class="at">curvature =</span> .<span class="dv">3</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>))</span>
<span id="cb128-934"><a href="#cb128-934" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb128-935"><a href="#cb128-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">4.1</span>, <span class="at">y =</span> <span class="dv">35</span>, <span class="at">label =</span> <span class="st">"subaru"</span>, <span class="at">hjust =</span> <span class="st">"left"</span>)</span>
<span id="cb128-936"><a href="#cb128-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-937"><a href="#cb128-937" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-938"><a href="#cb128-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-939"><a href="#cb128-939" aria-hidden="true" tabindex="-1"></a><span class="fu">## scale</span></span>
<span id="cb128-940"><a href="#cb128-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-941"><a href="#cb128-941" aria-hidden="true" tabindex="-1"></a><span class="fu">### x/y_continuous</span></span>
<span id="cb128-942"><a href="#cb128-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-945"><a href="#cb128-945" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-946"><a href="#cb128-946" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb128-947"><a href="#cb128-947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb128-948"><a href="#cb128-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Weight (1000 lbs.)"</span>,   </span>
<span id="cb128-949"><a href="#cb128-949" aria-hidden="true" tabindex="-1"></a>                     <span class="at">n.breaks =</span> <span class="dv">10</span>,                 </span>
<span id="cb128-950"><a href="#cb128-950" aria-hidden="true" tabindex="-1"></a>                     <span class="at">minor_breaks =</span> <span class="cn">NULL</span>,           </span>
<span id="cb128-951"><a href="#cb128-951" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">5.5</span>)) <span class="sc">+</span>        </span>
<span id="cb128-952"><a href="#cb128-952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Miles per gallon"</span>,     </span>
<span id="cb128-953"><a href="#cb128-953" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">35</span>, <span class="dv">5</span>),       </span>
<span id="cb128-954"><a href="#cb128-954" aria-hidden="true" tabindex="-1"></a>                     <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">35</span>, <span class="dv">1</span>), </span>
<span id="cb128-955"><a href="#cb128-955" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">35</span>)) <span class="sc">+</span>          </span>
<span id="cb128-956"><a href="#cb128-956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fuel efficiency by car weight"</span>)</span>
<span id="cb128-957"><a href="#cb128-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-958"><a href="#cb128-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-959"><a href="#cb128-959" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-960"><a href="#cb128-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-963"><a href="#cb128-963" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-964"><a href="#cb128-964" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">x =</span> price, <span class="at">y =</span> cut)) <span class="sc">+</span></span>
<span id="cb128-965"><a href="#cb128-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb128-966"><a href="#cb128-966" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_dollar</span>(<span class="at">scale =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>, <span class="at">suffix =</span> <span class="st">"K"</span>))</span>
<span id="cb128-967"><a href="#cb128-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-968"><a href="#cb128-968" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> clarity)) <span class="sc">+</span></span>
<span id="cb128-969"><a href="#cb128-969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb128-970"><a href="#cb128-970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Percentage"</span>, <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>())</span>
<span id="cb128-971"><a href="#cb128-971" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-972"><a href="#cb128-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-973"><a href="#cb128-973" aria-hidden="true" tabindex="-1"></a><span class="fu">### x/y_discrete</span></span>
<span id="cb128-974"><a href="#cb128-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-977"><a href="#cb128-977" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-978"><a href="#cb128-978" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg,<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(drv),<span class="at">fill=</span>class))<span class="sc">+</span></span>
<span id="cb128-979"><a href="#cb128-979" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="ot">-&gt;</span>p</span>
<span id="cb128-980"><a href="#cb128-980" aria-hidden="true" tabindex="-1"></a>p <span class="sc">|</span> p <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"drv"</span>,                                  </span>
<span id="cb128-981"><a href="#cb128-981" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"f"</span>, <span class="st">"r"</span>),    </span>
<span id="cb128-982"><a href="#cb128-982" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'f'</span><span class="ot">=</span><span class="st">"drv='f'"</span>,<span class="st">'r'</span><span class="ot">=</span> <span class="st">"drv='r'"</span>),</span>
<span id="cb128-983"><a href="#cb128-983" aria-hidden="true" tabindex="-1"></a>                   <span class="at">position =</span> <span class="st">"top"</span>) </span>
<span id="cb128-984"><a href="#cb128-984" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-985"><a href="#cb128-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-986"><a href="#cb128-986" aria-hidden="true" tabindex="-1"></a><span class="fu">### color</span></span>
<span id="cb128-987"><a href="#cb128-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-990"><a href="#cb128-990" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-991"><a href="#cb128-991" aria-hidden="true" tabindex="-1"></a>RColorBrewer<span class="sc">::</span><span class="fu">display.brewer.all</span>()</span>
<span id="cb128-992"><a href="#cb128-992" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy, <span class="at">color=</span>drv)) <span class="sc">+</span></span>
<span id="cb128-993"><a href="#cb128-993" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="dv">19</span>, <span class="at">size=</span><span class="dv">3</span>) </span>
<span id="cb128-994"><a href="#cb128-994" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> ggthemes<span class="sc">::</span><span class="fu">scale_color_colorblind</span>()</span>
<span id="cb128-995"><a href="#cb128-995" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-996"><a href="#cb128-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-999"><a href="#cb128-999" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1000"><a href="#cb128-1000" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy, <span class="at">color=</span>cty)) <span class="sc">+</span></span>
<span id="cb128-1001"><a href="#cb128-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb128-1002"><a href="#cb128-1002" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"A. Default color gradient"</span>)<span class="sc">|</span></span>
<span id="cb128-1003"><a href="#cb128-1003" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_gradient</span>(<span class="at">low=</span><span class="st">"grey"</span>, <span class="at">high=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb128-1004"><a href="#cb128-1004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"B. Greyscale gradient"</span>)<span class="sc">|</span></span>
<span id="cb128-1005"><a href="#cb128-1005" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_gradient</span>(<span class="at">low=</span><span class="st">"red"</span>, <span class="at">high=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb128-1006"><a href="#cb128-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"C. Red-blue color gradient"</span>)</span>
<span id="cb128-1007"><a href="#cb128-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1008"><a href="#cb128-1008" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_steps</span>(<span class="at">low=</span><span class="st">"red"</span>, <span class="at">high=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb128-1009"><a href="#cb128-1009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"D. Red-blue binned color Gradient"</span>)<span class="sc">|</span></span>
<span id="cb128-1010"><a href="#cb128-1010" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_steps2</span>(<span class="at">low=</span><span class="st">"red"</span>, <span class="at">mid=</span><span class="st">"white"</span>, <span class="at">high=</span><span class="st">"blue"</span>,</span>
<span id="cb128-1011"><a href="#cb128-1011" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint=</span><span class="fu">median</span>(mtcars<span class="sc">$</span>disp)) <span class="sc">+</span></span>
<span id="cb128-1012"><a href="#cb128-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"E. Red-white-blue binned gradient"</span>)<span class="sc">|</span></span>
<span id="cb128-1013"><a href="#cb128-1013" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_viridis_c</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span>    <span class="co"># viridis_c,d,b</span></span>
<span id="cb128-1014"><a href="#cb128-1014" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"F. Viridis color gradient"</span>)</span>
<span id="cb128-1015"><a href="#cb128-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1016"><a href="#cb128-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1017"><a href="#cb128-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1020"><a href="#cb128-1020" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1021"><a href="#cb128-1021" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb128-1022"><a href="#cb128-1022" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>),</span>
<span id="cb128-1023"><a href="#cb128-1023" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>)</span>
<span id="cb128-1024"><a href="#cb128-1024" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-1025"><a href="#cb128-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1026"><a href="#cb128-1026" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb128-1027"><a href="#cb128-1027" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>() <span class="sc">+</span></span>
<span id="cb128-1028"><a href="#cb128-1028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb128-1029"><a href="#cb128-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Default, continuous"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb128-1030"><a href="#cb128-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1031"><a href="#cb128-1031" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb128-1032"><a href="#cb128-1032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>() <span class="sc">+</span></span>
<span id="cb128-1033"><a href="#cb128-1033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb128-1034"><a href="#cb128-1034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb128-1035"><a href="#cb128-1035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Viridis, continuous"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb128-1036"><a href="#cb128-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1037"><a href="#cb128-1037" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb128-1038"><a href="#cb128-1038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>() <span class="sc">+</span></span>
<span id="cb128-1039"><a href="#cb128-1039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb128-1040"><a href="#cb128-1040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_b</span>() <span class="sc">+</span></span>
<span id="cb128-1041"><a href="#cb128-1041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Viridis, binned"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb128-1042"><a href="#cb128-1042" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1043"><a href="#cb128-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1044"><a href="#cb128-1044" aria-hidden="true" tabindex="-1"></a><span class="fu">### fill</span></span>
<span id="cb128-1045"><a href="#cb128-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1048"><a href="#cb128-1048" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1049"><a href="#cb128-1049" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg,<span class="fu">aes</span>(drv,<span class="at">fill=</span>class))<span class="sc">+</span></span>
<span id="cb128-1050"><a href="#cb128-1050" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>()</span>
<span id="cb128-1051"><a href="#cb128-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1052"><a href="#cb128-1052" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"A. Default colors"</span>)<span class="sc">|</span></span>
<span id="cb128-1053"><a href="#cb128-1053" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb128-1054"><a href="#cb128-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"B. ColorBrewer Set2 palette"</span>)</span>
<span id="cb128-1055"><a href="#cb128-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1056"><a href="#cb128-1056" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb128-1057"><a href="#cb128-1057" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"C. Viridis color scheme"</span>)<span class="sc">|</span></span>
<span id="cb128-1058"><a href="#cb128-1058" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"gold4"</span>, <span class="st">"orange2"</span>, <span class="st">"deepskyblue3"</span>, <span class="st">"blue4"</span>,</span>
<span id="cb128-1059"><a href="#cb128-1059" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"brown2"</span>, <span class="st">"yellowgreen"</span>,<span class="st">"lightpink"</span>)) <span class="sc">+</span></span>
<span id="cb128-1060"><a href="#cb128-1060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"D. Manual color selection"</span>)</span>
<span id="cb128-1061"><a href="#cb128-1061" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1062"><a href="#cb128-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1063"><a href="#cb128-1063" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分面</span></span>
<span id="cb128-1064"><a href="#cb128-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1067"><a href="#cb128-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1068"><a href="#cb128-1068" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg,<span class="fu">aes</span>(<span class="at">x=</span>displ))<span class="sc">+</span></span>
<span id="cb128-1069"><a href="#cb128-1069" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">"lightblue"</span>)</span>
<span id="cb128-1070"><a href="#cb128-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1071"><a href="#cb128-1071" aria-hidden="true" tabindex="-1"></a><span class="co"># 一个分类变量</span></span>
<span id="cb128-1072"><a href="#cb128-1072" aria-hidden="true" tabindex="-1"></a>q <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>drv,<span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb128-1073"><a href="#cb128-1073" aria-hidden="true" tabindex="-1"></a>q <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>drv,<span class="at">ncol =</span> <span class="dv">3</span>)  <span class="co">#</span></span>
<span id="cb128-1074"><a href="#cb128-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1075"><a href="#cb128-1075" aria-hidden="true" tabindex="-1"></a><span class="co"># 多个分类变量</span></span>
<span id="cb128-1076"><a href="#cb128-1076" aria-hidden="true" tabindex="-1"></a>q <span class="sc">+</span> <span class="fu">facet_grid</span>(drv<span class="sc">~</span>class)</span>
<span id="cb128-1077"><a href="#cb128-1077" aria-hidden="true" tabindex="-1"></a>q <span class="sc">+</span> <span class="fu">facet_grid</span>(drv<span class="sc">~</span>.)</span>
<span id="cb128-1078"><a href="#cb128-1078" aria-hidden="true" tabindex="-1"></a>q <span class="sc">+</span> <span class="fu">facet_grid</span>(.<span class="sc">~</span>drv)   <span class="co">#</span></span>
<span id="cb128-1079"><a href="#cb128-1079" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1080"><a href="#cb128-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1083"><a href="#cb128-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1084"><a href="#cb128-1084" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb128-1085"><a href="#cb128-1085" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb128-1086"><a href="#cb128-1086" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(drv <span class="sc">~</span> cyl) <span class="sc">|</span></span>
<span id="cb128-1087"><a href="#cb128-1087" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb128-1088"><a href="#cb128-1088" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb128-1089"><a href="#cb128-1089" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(drv <span class="sc">~</span> cyl, <span class="at">scales =</span> <span class="st">"free_y"</span>)</span>
<span id="cb128-1090"><a href="#cb128-1090" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1091"><a href="#cb128-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1092"><a href="#cb128-1092" aria-hidden="true" tabindex="-1"></a><span class="fu">## 主题</span></span>
<span id="cb128-1093"><a href="#cb128-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1094"><a href="#cb128-1094" aria-hidden="true" tabindex="-1"></a><span class="fu">### 内置主题</span></span>
<span id="cb128-1095"><a href="#cb128-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1098"><a href="#cb128-1098" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1099"><a href="#cb128-1099" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg,<span class="fu">aes</span>(displ,hwy))</span>
<span id="cb128-1100"><a href="#cb128-1100" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_grey</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_grey"</span>)  <span class="sc">|</span></span>
<span id="cb128-1101"><a href="#cb128-1101" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_bw"</span>)  </span>
<span id="cb128-1102"><a href="#cb128-1102" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_minimal"</span>)<span class="sc">|</span>  </span>
<span id="cb128-1103"><a href="#cb128-1103" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_classic"</span>)</span>
<span id="cb128-1104"><a href="#cb128-1104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1105"><a href="#cb128-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1106"><a href="#cb128-1106" aria-hidden="true" tabindex="-1"></a><span class="fu">### 字体</span></span>
<span id="cb128-1107"><a href="#cb128-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1110"><a href="#cb128-1110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1111"><a href="#cb128-1111" aria-hidden="true" tabindex="-1"></a>findfont <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb128-1112"><a href="#cb128-1112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressMessages</span>(<span class="fu">require</span>(showtext))</span>
<span id="cb128-1113"><a href="#cb128-1113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressMessages</span>(<span class="fu">require</span>(dplyr))</span>
<span id="cb128-1114"><a href="#cb128-1114" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">font_files</span>(), <span class="fu">grepl</span>(x, family, <span class="at">ignore.case=</span><span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb128-1115"><a href="#cb128-1115" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(path, file, family, face)</span>
<span id="cb128-1116"><a href="#cb128-1116" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-1117"><a href="#cb128-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1118"><a href="#cb128-1118" aria-hidden="true" tabindex="-1"></a><span class="fu">findfont</span>(<span class="st">"comic"</span>)</span>
<span id="cb128-1119"><a href="#cb128-1119" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add</span>(<span class="at">family =</span> <span class="st">"Times New Roman"</span>, <span class="at">regular =</span> <span class="st">"C:</span><span class="sc">\\</span><span class="st">Windows</span><span class="sc">\\</span><span class="st">Fonts</span><span class="sc">\\</span><span class="st">Times New Roman</span><span class="sc">\\</span><span class="st">times.ttf"</span>,</span>
<span id="cb128-1120"><a href="#cb128-1120" aria-hidden="true" tabindex="-1"></a>         <span class="at">bold =</span> <span class="st">"C:</span><span class="sc">\\</span><span class="st">Windows</span><span class="sc">\\</span><span class="st">Fonts</span><span class="sc">\\</span><span class="st">Times New Roman</span><span class="sc">\\</span><span class="st">timesbd.ttf"</span>,</span>
<span id="cb128-1121"><a href="#cb128-1121" aria-hidden="true" tabindex="-1"></a>         <span class="at">italic =</span> <span class="st">"C:</span><span class="sc">\\</span><span class="st">Windows</span><span class="sc">\\</span><span class="st">Fonts</span><span class="sc">\\</span><span class="st">Times New Roman</span><span class="sc">\\</span><span class="st">timesi.ttf"</span>,</span>
<span id="cb128-1122"><a href="#cb128-1122" aria-hidden="true" tabindex="-1"></a>         <span class="at">bolditalic =</span> <span class="st">"C:</span><span class="sc">\\</span><span class="st">Windows</span><span class="sc">\\</span><span class="st">Fonts</span><span class="sc">\\</span><span class="st">Times New Roman</span><span class="sc">\\</span><span class="st">timesbi.ttf"</span>)</span>
<span id="cb128-1123"><a href="#cb128-1123" aria-hidden="true" tabindex="-1"></a><span class="fu">findfont</span>(<span class="st">"Times New Roman"</span>)</span>
<span id="cb128-1124"><a href="#cb128-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">font_families</span>()</span>
<span id="cb128-1125"><a href="#cb128-1125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1126"><a href="#cb128-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1127"><a href="#cb128-1127" aria-hidden="true" tabindex="-1"></a><span class="fu">### 自定义主题</span></span>
<span id="cb128-1128"><a href="#cb128-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1131"><a href="#cb128-1131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1132"><a href="#cb128-1132" aria-hidden="true" tabindex="-1"></a>mytheme <span class="ot">&lt;-</span> <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold.italic"</span>,  <span class="at">size=</span><span class="st">"14"</span>, <span class="at">color=</span><span class="st">"brown"</span>),</span>
<span id="cb128-1133"><a href="#cb128-1133" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold.italic"</span>,  <span class="at">size=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">"brown"</span>),</span>
<span id="cb128-1134"><a href="#cb128-1134" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">9</span>,  <span class="at">color=</span><span class="st">"darkblue"</span>), </span>
<span id="cb128-1135"><a href="#cb128-1135" aria-hidden="true" tabindex="-1"></a>                 <span class="at">panel.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"white"</span>,  <span class="at">color=</span><span class="st">"darkblue"</span>),  </span>
<span id="cb128-1136"><a href="#cb128-1136" aria-hidden="true" tabindex="-1"></a>                 <span class="at">panel.grid.major.y=</span><span class="fu">element_line</span>(<span class="at">color=</span><span class="st">"grey"</span>,  <span class="at">linetype=</span><span class="dv">1</span>),  </span>
<span id="cb128-1137"><a href="#cb128-1137" aria-hidden="true" tabindex="-1"></a>                 <span class="at">panel.grid.minor.y=</span><span class="fu">element_line</span>(<span class="at">color=</span><span class="st">"grey"</span>,  <span class="at">linetype=</span><span class="dv">2</span>),  </span>
<span id="cb128-1138"><a href="#cb128-1138" aria-hidden="true" tabindex="-1"></a>                 <span class="at">panel.grid.minor.x=</span><span class="fu">element_blank</span>(),  <span class="at">legend.position=</span><span class="st">"top"</span>) </span>
<span id="cb128-1139"><a href="#cb128-1139" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>drv, <span class="at">y=</span>hwy, <span class="at">fill=</span>drv)) <span class="sc">+</span>  </span>
<span id="cb128-1140"><a href="#cb128-1140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span>  </span>
<span id="cb128-1141"><a href="#cb128-1141" aria-hidden="true" tabindex="-1"></a>  mytheme </span>
<span id="cb128-1142"><a href="#cb128-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1143"><a href="#cb128-1143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1144"><a href="#cb128-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1145"><a href="#cb128-1145" aria-hidden="true" tabindex="-1"></a><span class="fu">### 图例</span></span>
<span id="cb128-1146"><a href="#cb128-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1149"><a href="#cb128-1149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1150"><a href="#cb128-1150" aria-hidden="true" tabindex="-1"></a><span class="co"># 位置和布局</span></span>
<span id="cb128-1151"><a href="#cb128-1151" aria-hidden="true" tabindex="-1"></a>base <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb128-1152"><a href="#cb128-1152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> class))</span>
<span id="cb128-1153"><a href="#cb128-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1154"><a href="#cb128-1154" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="co"># the default</span></span>
<span id="cb128-1155"><a href="#cb128-1155" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"left"</span>)</span>
<span id="cb128-1156"><a href="#cb128-1156" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> </span>
<span id="cb128-1157"><a href="#cb128-1157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb128-1158"><a href="#cb128-1158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">3</span>))</span>
<span id="cb128-1159"><a href="#cb128-1159" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> </span>
<span id="cb128-1160"><a href="#cb128-1160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb128-1161"><a href="#cb128-1161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>)))</span>
<span id="cb128-1162"><a href="#cb128-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1163"><a href="#cb128-1163" aria-hidden="true" tabindex="-1"></a><span class="co"># 文本</span></span>
<span id="cb128-1164"><a href="#cb128-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1165"><a href="#cb128-1165" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg, <span class="at">color =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb128-1166"><a href="#cb128-1166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb128-1167"><a href="#cb128-1167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name=</span><span class="st">"Cylinders"</span>) <span class="sc">+</span></span>
<span id="cb128-1168"><a href="#cb128-1168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fuel Efficiency for 32 Automobiles"</span>,</span>
<span id="cb128-1169"><a href="#cb128-1169" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Weight (1000 lbs)"</span>,</span>
<span id="cb128-1170"><a href="#cb128-1170" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Miles per gallon"</span>) <span class="sc">+</span></span>
<span id="cb128-1171"><a href="#cb128-1171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">95</span>, .<span class="dv">95</span>),</span>
<span id="cb128-1172"><a href="#cb128-1172" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb128-1173"><a href="#cb128-1173" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"lightgrey"</span>,</span>
<span id="cb128-1174"><a href="#cb128-1174" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb128-1175"><a href="#cb128-1175" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">linewidth =</span> <span class="dv">1</span>),</span>
<span id="cb128-1176"><a href="#cb128-1176" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb128-1177"><a href="#cb128-1177" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>)</span>
<span id="cb128-1178"><a href="#cb128-1178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1179"><a href="#cb128-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1182"><a href="#cb128-1182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1183"><a href="#cb128-1183" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb128-1184"><a href="#cb128-1184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb128-1185"><a href="#cb128-1185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb128-1186"><a href="#cb128-1186" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Larger engine sizes tend to have lower fuel economy"</span>,</span>
<span id="cb128-1187"><a href="#cb128-1187" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Source: https://fueleconomy.gov."</span></span>
<span id="cb128-1188"><a href="#cb128-1188" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb128-1189"><a href="#cb128-1189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb128-1190"><a href="#cb128-1190" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>),</span>
<span id="cb128-1191"><a href="#cb128-1191" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb128-1192"><a href="#cb128-1192" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"blue"</span>),</span>
<span id="cb128-1193"><a href="#cb128-1193" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>,<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb128-1194"><a href="#cb128-1194" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title.position =</span> <span class="st">"plot"</span>,</span>
<span id="cb128-1195"><a href="#cb128-1195" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption.position =</span> <span class="st">"plot"</span>,</span>
<span id="cb128-1196"><a href="#cb128-1196" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb128-1197"><a href="#cb128-1197" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb128-1198"><a href="#cb128-1198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1199"><a href="#cb128-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1200"><a href="#cb128-1200" aria-hidden="true" tabindex="-1"></a><span class="fu">### 绘图区</span></span>
<span id="cb128-1201"><a href="#cb128-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1204"><a href="#cb128-1204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1205"><a href="#cb128-1205" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">factor</span>(mtcars<span class="sc">$</span>am, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Automatic"</span>, <span class="st">"Manual"</span>)) </span>
<span id="cb128-1206"><a href="#cb128-1206" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, <span class="fu">aes</span>(<span class="at">x =</span> disp, <span class="at">y =</span> mpg)) <span class="sc">+</span>                     </span>
<span id="cb128-1207"><a href="#cb128-1207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(cyl)), <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span>                   </span>
<span id="cb128-1208"><a href="#cb128-1208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>),                             </span>
<span id="cb128-1209"><a href="#cb128-1209" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype=</span><span class="st">"dotted"</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb128-1210"><a href="#cb128-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"Number of cylinders"</span>) <span class="sc">+</span></span>
<span id="cb128-1211"><a href="#cb128-1211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>am, <span class="at">ncol=</span><span class="dv">2</span>) <span class="sc">+</span>                                      </span>
<span id="cb128-1212"><a href="#cb128-1212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mileage, transmission type, and number of cylinders"</span>,</span>
<span id="cb128-1213"><a href="#cb128-1213" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Engine displacement (cu. in.)"</span>,</span>
<span id="cb128-1214"><a href="#cb128-1214" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Miles per gallon"</span>) <span class="sc">+</span></span>
<span id="cb128-1215"><a href="#cb128-1215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>                                                  </span>
<span id="cb128-1216"><a href="#cb128-1216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb128-1217"><a href="#cb128-1217" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color=</span><span class="st">"lightgrey"</span>),</span>
<span id="cb128-1218"><a href="#cb128-1218" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color=</span><span class="st">"lightgrey"</span>,</span>
<span id="cb128-1219"><a href="#cb128-1219" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">linetype=</span><span class="st">"dashed"</span>),</span>
<span id="cb128-1220"><a href="#cb128-1220" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb128-1221"><a href="#cb128-1221" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb128-1222"><a href="#cb128-1222" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_blank</span>())</span>
<span id="cb128-1223"><a href="#cb128-1223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1224"><a href="#cb128-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1225"><a href="#cb128-1225" aria-hidden="true" tabindex="-1"></a><span class="fu">## 图形布局patchwork</span></span>
<span id="cb128-1226"><a href="#cb128-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1227"><a href="#cb128-1227" aria-hidden="true" tabindex="-1"></a><span class="fu">### 布局方式</span></span>
<span id="cb128-1228"><a href="#cb128-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1231"><a href="#cb128-1231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1232"><a href="#cb128-1232" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">y =</span> cty, <span class="at">color =</span> drv)) <span class="sc">+</span> </span>
<span id="cb128-1233"><a href="#cb128-1233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb128-1234"><a href="#cb128-1234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Plot 1"</span>)</span>
<span id="cb128-1235"><a href="#cb128-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1236"><a href="#cb128-1236" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">y =</span> hwy, <span class="at">color =</span> drv)) <span class="sc">+</span> </span>
<span id="cb128-1237"><a href="#cb128-1237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb128-1238"><a href="#cb128-1238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Plot 2"</span>)</span>
<span id="cb128-1239"><a href="#cb128-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1240"><a href="#cb128-1240" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">color =</span> drv, <span class="at">fill =</span> drv)) <span class="sc">+</span> </span>
<span id="cb128-1241"><a href="#cb128-1241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb128-1242"><a href="#cb128-1242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Plot 3"</span>)</span>
<span id="cb128-1243"><a href="#cb128-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1244"><a href="#cb128-1244" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">color =</span> drv, <span class="at">fill =</span> drv)) <span class="sc">+</span> </span>
<span id="cb128-1245"><a href="#cb128-1245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb128-1246"><a href="#cb128-1246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Plot 4"</span>)</span>
<span id="cb128-1247"><a href="#cb128-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1248"><a href="#cb128-1248" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy, <span class="at">color =</span> drv)) <span class="sc">+</span> </span>
<span id="cb128-1249"><a href="#cb128-1249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb128-1250"><a href="#cb128-1250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>drv) <span class="sc">+</span></span>
<span id="cb128-1251"><a href="#cb128-1251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Plot 5"</span>)</span>
<span id="cb128-1252"><a href="#cb128-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1253"><a href="#cb128-1253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1254"><a href="#cb128-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1257"><a href="#cb128-1257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1258"><a href="#cb128-1258" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span>
<span id="cb128-1259"><a href="#cb128-1259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1260"><a href="#cb128-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1263"><a href="#cb128-1263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1264"><a href="#cb128-1264" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4</span>
<span id="cb128-1265"><a href="#cb128-1265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1266"><a href="#cb128-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1269"><a href="#cb128-1269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1270"><a href="#cb128-1270" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb128-1271"><a href="#cb128-1271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1272"><a href="#cb128-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1275"><a href="#cb128-1275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1276"><a href="#cb128-1276" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span>
<span id="cb128-1277"><a href="#cb128-1277" aria-hidden="true" tabindex="-1"></a>p3 <span class="sc">|</span> p4</span>
<span id="cb128-1278"><a href="#cb128-1278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1279"><a href="#cb128-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1282"><a href="#cb128-1282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1283"><a href="#cb128-1283" aria-hidden="true" tabindex="-1"></a>p3 <span class="sc">|</span> (p2 <span class="sc">/</span> (p1 <span class="sc">|</span> p4))</span>
<span id="cb128-1284"><a href="#cb128-1284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1285"><a href="#cb128-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1288"><a href="#cb128-1288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1289"><a href="#cb128-1289" aria-hidden="true" tabindex="-1"></a> layout <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb128-1290"><a href="#cb128-1290" aria-hidden="true" tabindex="-1"></a><span class="st">AAB</span></span>
<span id="cb128-1291"><a href="#cb128-1291" aria-hidden="true" tabindex="-1"></a><span class="st">C#B</span></span>
<span id="cb128-1292"><a href="#cb128-1292" aria-hidden="true" tabindex="-1"></a><span class="st">CDD</span></span>
<span id="cb128-1293"><a href="#cb128-1293" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb128-1294"><a href="#cb128-1294" aria-hidden="true" tabindex="-1"></a>  p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">design =</span> layout)</span>
<span id="cb128-1295"><a href="#cb128-1295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1296"><a href="#cb128-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1299"><a href="#cb128-1299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1300"><a href="#cb128-1300" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">guides =</span> <span class="st">"collect"</span>)</span>
<span id="cb128-1301"><a href="#cb128-1301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1302"><a href="#cb128-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1303"><a href="#cb128-1303" aria-hidden="true" tabindex="-1"></a><span class="fu">### 修改子图</span></span>
<span id="cb128-1304"><a href="#cb128-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1307"><a href="#cb128-1307" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1308"><a href="#cb128-1308" aria-hidden="true" tabindex="-1"></a>  p12 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2</span>
<span id="cb128-1309"><a href="#cb128-1309" aria-hidden="true" tabindex="-1"></a>  p12[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> p12[[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fu">theme_light</span>()</span>
<span id="cb128-1310"><a href="#cb128-1310" aria-hidden="true" tabindex="-1"></a>  p12</span>
<span id="cb128-1311"><a href="#cb128-1311" aria-hidden="true" tabindex="-1"></a>  p1 <span class="sc">+</span> p4 <span class="sc">&amp;</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb128-1312"><a href="#cb128-1312" aria-hidden="true" tabindex="-1"></a>  p1 <span class="sc">+</span> p4 <span class="sc">&amp;</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">45</span>))</span>
<span id="cb128-1313"><a href="#cb128-1313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1314"><a href="#cb128-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1315"><a href="#cb128-1315" aria-hidden="true" tabindex="-1"></a><span class="fu">### 添加注释</span></span>
<span id="cb128-1316"><a href="#cb128-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1319"><a href="#cb128-1319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1320"><a href="#cb128-1320" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2) <span class="sc">/</span> p3 <span class="sc">+</span>                                      </span>
<span id="cb128-1321"><a href="#cb128-1321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">'主标题'</span>,<span class="at">caption =</span> <span class="st">"脚注"</span>,</span>
<span id="cb128-1322"><a href="#cb128-1322" aria-hidden="true" tabindex="-1"></a>                  <span class="at">theme =</span> <span class="fu">theme_gray</span>(<span class="at">base_family =</span> <span class="st">"mono"</span>)) <span class="sc">&amp;</span><span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb128-1323"><a href="#cb128-1323" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb128-1324"><a href="#cb128-1324" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>)</span>
<span id="cb128-1325"><a href="#cb128-1325" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb128-1326"><a href="#cb128-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1327"><a href="#cb128-1327" aria-hidden="true" tabindex="-1"></a>(<span class="fu">guide_area</span>() <span class="sc">/</span> (p1 <span class="sc">+</span> p2) <span class="sc">/</span> (p3 <span class="sc">+</span> p4) <span class="sc">/</span> p5) <span class="sc">+</span></span>
<span id="cb128-1328"><a href="#cb128-1328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb128-1329"><a href="#cb128-1329" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"City and highway mileage for cars with different drive trains"</span>,</span>
<span id="cb128-1330"><a href="#cb128-1330" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Source: https://fueleconomy.gov."</span></span>
<span id="cb128-1331"><a href="#cb128-1331" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb128-1332"><a href="#cb128-1332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(</span>
<span id="cb128-1333"><a href="#cb128-1333" aria-hidden="true" tabindex="-1"></a>    <span class="at">guides =</span> <span class="st">"collect"</span>,</span>
<span id="cb128-1334"><a href="#cb128-1334" aria-hidden="true" tabindex="-1"></a>    <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb128-1335"><a href="#cb128-1335" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb128-1336"><a href="#cb128-1336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb128-1337"><a href="#cb128-1337" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb128-1338"><a href="#cb128-1338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1339"><a href="#cb128-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1340"><a href="#cb128-1340" aria-hidden="true" tabindex="-1"></a><span class="fu">### 图形编号</span></span>
<span id="cb128-1341"><a href="#cb128-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1344"><a href="#cb128-1344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1345"><a href="#cb128-1345" aria-hidden="true" tabindex="-1"></a>p123 <span class="ot">&lt;-</span> p1 <span class="sc">|</span> (p2 <span class="sc">/</span> p3)</span>
<span id="cb128-1346"><a href="#cb128-1346" aria-hidden="true" tabindex="-1"></a>p123 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"I"</span>) <span class="co"># Uppercase roman numerics i</span></span>
<span id="cb128-1347"><a href="#cb128-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1348"><a href="#cb128-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1349"><a href="#cb128-1349" aria-hidden="true" tabindex="-1"></a>p123 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>) <span class="co"># lowercase letters A</span></span>
<span id="cb128-1350"><a href="#cb128-1350" aria-hidden="true" tabindex="-1"></a>p123 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"1"</span>) <span class="co">#  numbers</span></span>
<span id="cb128-1351"><a href="#cb128-1351" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-1352"><a href="#cb128-1352" aria-hidden="true" tabindex="-1"></a>p123[[<span class="dv">2</span>]] </span>
<span id="cb128-1353"><a href="#cb128-1353" aria-hidden="true" tabindex="-1"></a>p123[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> p123[[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">tag_level =</span> <span class="st">"new"</span>)</span>
<span id="cb128-1354"><a href="#cb128-1354" aria-hidden="true" tabindex="-1"></a>p123 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="fu">c</span>(<span class="st">"I"</span>,<span class="st">"a"</span>))</span>
<span id="cb128-1355"><a href="#cb128-1355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1356"><a href="#cb128-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1357"><a href="#cb128-1357" aria-hidden="true" tabindex="-1"></a><span class="fu">### 图形插入</span></span>
<span id="cb128-1358"><a href="#cb128-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1361"><a href="#cb128-1361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1362"><a href="#cb128-1362" aria-hidden="true" tabindex="-1"></a>  p1 <span class="sc">+</span> <span class="fu">inset_element</span>(p2, <span class="at">left =</span> <span class="fl">0.6</span>, <span class="at">bottom =</span> <span class="fl">0.6</span>, <span class="at">right =</span> <span class="dv">1</span>, <span class="at">top =</span> <span class="dv">1</span>)</span>
<span id="cb128-1363"><a href="#cb128-1363" aria-hidden="true" tabindex="-1"></a>  p24 <span class="ot">&lt;-</span> p2 <span class="sc">/</span> p4 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)</span>
<span id="cb128-1364"><a href="#cb128-1364" aria-hidden="true" tabindex="-1"></a>  p1 <span class="sc">+</span> <span class="fu">inset_element</span>(p24, <span class="at">left =</span> <span class="fl">0.5</span>, <span class="at">bottom =</span> <span class="fl">0.05</span>, <span class="at">right =</span> <span class="fl">0.95</span>, <span class="at">top =</span> <span class="fl">0.9</span>)</span>
<span id="cb128-1365"><a href="#cb128-1365" aria-hidden="true" tabindex="-1"></a>  p12 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">inset_element</span>(p2, <span class="at">left =</span> <span class="fl">0.5</span>, <span class="at">bottom =</span> <span class="fl">0.5</span>, <span class="at">right =</span> <span class="fl">0.9</span>, <span class="at">top =</span> <span class="fl">0.95</span>)</span>
<span id="cb128-1366"><a href="#cb128-1366" aria-hidden="true" tabindex="-1"></a>  p12 <span class="sc">&amp;</span> <span class="fu">theme_bw</span>()</span>
<span id="cb128-1367"><a href="#cb128-1367" aria-hidden="true" tabindex="-1"></a>  p12 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb128-1368"><a href="#cb128-1368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1369"><a href="#cb128-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1370"><a href="#cb128-1370" aria-hidden="true" tabindex="-1"></a><span class="fu">## 保存和删除</span></span>
<span id="cb128-1371"><a href="#cb128-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1374"><a href="#cb128-1374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1375"><a href="#cb128-1375" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(svglite)</span>
<span id="cb128-1376"><a href="#cb128-1376" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"ggsave.svg"</span>, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb128-1377"><a href="#cb128-1377" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">unlink</span>(<span class="st">"ggsave.svg"</span>)</span>
<span id="cb128-1378"><a href="#cb128-1378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1379"><a href="#cb128-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1380"><a href="#cb128-1380" aria-hidden="true" tabindex="-1"></a><span class="fu">## ggplot2 的内部结构</span></span>
<span id="cb128-1381"><a href="#cb128-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1384"><a href="#cb128-1384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1385"><a href="#cb128-1385" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">color =</span> drv)) <span class="sc">+</span> </span>
<span id="cb128-1386"><a href="#cb128-1386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>) <span class="sc">+</span></span>
<span id="cb128-1387"><a href="#cb128-1387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span> </span>
<span id="cb128-1388"><a href="#cb128-1388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(year)) <span class="sc">+</span> </span>
<span id="cb128-1389"><a href="#cb128-1389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"A plot for expository purposes"</span>)</span>
<span id="cb128-1390"><a href="#cb128-1390" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb128-1391"><a href="#cb128-1391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1392"><a href="#cb128-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1395"><a href="#cb128-1395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1396"><a href="#cb128-1396" aria-hidden="true" tabindex="-1"></a>ggprint <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb128-1397"><a href="#cb128-1397" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(x)</span>
<span id="cb128-1398"><a href="#cb128-1398" aria-hidden="true" tabindex="-1"></a>  gtable <span class="ot">&lt;-</span> <span class="fu">ggplot_gtable</span>(data)</span>
<span id="cb128-1399"><a href="#cb128-1399" aria-hidden="true" tabindex="-1"></a>  grid<span class="sc">::</span><span class="fu">grid.newpage</span>()</span>
<span id="cb128-1400"><a href="#cb128-1400" aria-hidden="true" tabindex="-1"></a>  grid<span class="sc">::</span><span class="fu">grid.draw</span>(gtable)</span>
<span id="cb128-1401"><a href="#cb128-1401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">invisible</span>(x))</span>
<span id="cb128-1402"><a href="#cb128-1402" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-1403"><a href="#cb128-1403" aria-hidden="true" tabindex="-1"></a><span class="fu">ggprint</span>(p)</span>
<span id="cb128-1404"><a href="#cb128-1404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1405"><a href="#cb128-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1408"><a href="#cb128-1408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1409"><a href="#cb128-1409" aria-hidden="true" tabindex="-1"></a>p_built <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(p)</span>
<span id="cb128-1410"><a href="#cb128-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1411"><a href="#cb128-1411" aria-hidden="true" tabindex="-1"></a>p_built <span class="sc">$</span>data</span>
<span id="cb128-1412"><a href="#cb128-1412" aria-hidden="true" tabindex="-1"></a>p_built <span class="sc">$</span>layout</span>
<span id="cb128-1413"><a href="#cb128-1413" aria-hidden="true" tabindex="-1"></a>p_built <span class="sc">$</span>plot</span>
<span id="cb128-1414"><a href="#cb128-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1415"><a href="#cb128-1415" aria-hidden="true" tabindex="-1"></a>p_gtable <span class="ot">&lt;-</span> <span class="fu">ggplot_gtable</span>(p_built)</span>
<span id="cb128-1416"><a href="#cb128-1416" aria-hidden="true" tabindex="-1"></a>p_gtable</span>
<span id="cb128-1417"><a href="#cb128-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1418"><a href="#cb128-1418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1419"><a href="#cb128-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1422"><a href="#cb128-1422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1423"><a href="#cb128-1423" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.newpage</span>()</span>
<span id="cb128-1424"><a href="#cb128-1424" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.draw</span>(p_gtable)</span>
<span id="cb128-1425"><a href="#cb128-1425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1426"><a href="#cb128-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1427"><a href="#cb128-1427" aria-hidden="true" tabindex="-1"></a><span class="fu">## **ggproto对象**</span></span>
<span id="cb128-1428"><a href="#cb128-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1431"><a href="#cb128-1431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-1432"><a href="#cb128-1432" aria-hidden="true" tabindex="-1"></a>NewObject <span class="ot">&lt;-</span> <span class="fu">ggproto</span>(</span>
<span id="cb128-1433"><a href="#cb128-1433" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">_class</span><span class="st">`</span> <span class="ot">=</span> <span class="cn">NULL</span>,     <span class="co"># 类</span></span>
<span id="cb128-1434"><a href="#cb128-1434" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">_inherits</span><span class="st">`</span> <span class="ot">=</span> <span class="cn">NULL</span>   <span class="co"># 继承</span></span>
<span id="cb128-1435"><a href="#cb128-1435" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-1436"><a href="#cb128-1436" aria-hidden="true" tabindex="-1"></a>NewObject </span>
<span id="cb128-1437"><a href="#cb128-1437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1438"><a href="#cb128-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1439"><a href="#cb128-1439" aria-hidden="true" tabindex="-1"></a>创建新类，子类继承</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>