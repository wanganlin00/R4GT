# 热图

## `pheatmap`

```{r}
library(pheatmap)
```

```{r}
# read test matrix
test <- read.delim("data/heatmap/heatmap.txt",header = T,row.names = 1,sep = "\t")
test

sample_group <- read.delim("data/heatmap/sample.class.txt",header = T,row.names = 1,sep = "\t")
gene_group <- read.delim("data/heatmap/gene.class.txt",header = T,row.names = 1,sep = "\t")
```

```{r}
#| fig-width: 10
#| fig-asp: 0.75
pheatmap(test,
         annotation_legend = T,#legend_breaks = seq(-1,1,0.2), legend_labels = seq(-1,1,0.2),
         show_rownames = T,show_colnames = T,
         fontsize = 12,
         color = colorRampPalette(c("#0000ff","#ffffff","#ff0000"))(200),
         border_color = NA,
         scale = "row",       # 归一化
         cluster_rows = T,cluster_cols = T,clustering_distance_rows = "correlation",
         display_numbers = TRUE, #number_format = "%.1e",
         
         treeheight_row = 12,
         treeheight_col = 12,
         
         annotation_row = gene_group,
         annotation_col = sample_group,
         )
```

## 相关性

```{r}
r <- cor(test,method = "pearson",use = "pairwise.complete.obs")

r

pheatmap::pheatmap(r,fontsize = 12,
         color = colorRampPalette(c("#0000ff","#ffffff","#ff0000"))(200),)
```

## `geom_tile()`

```{r}
# 设置随机数种子以确保结果的可重复性  
set.seed(10)  
library(tidyverse)
# 生成随机数据集  
mydata <- tibble(  
  year = 2000:2024,  
  lung = runif(25),  
  liver = runif(25), 
  bone = runif(25),  
  luk = runif(25),  
  eso = runif(25),  
  gas = runif(25),   
  eye = runif(25),  
  brain = runif(25),  
  pan = runif(25),  
  kidney = runif(25),  
  breast= runif(25),  
)  |> pivot_longer(cols = -1,
                   names_to = "cancer",
                   values_to = "morbidity")

ggplot(mydata, aes(year, cancer)) +  
  geom_tile(aes(fill =morbidity)) +  
  scale_fill_gradient(low = "white", high = "red")
```

## `ComplexHeatmap`

<https://jokergoo.github.io/ComplexHeatmap-reference/book/>
